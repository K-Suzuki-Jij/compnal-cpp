\hypertarget{exact__diag_8hpp_source}{}\doxysection{exact\+\_\+diag.\+hpp}
\label{exact__diag_8hpp_source}\index{src/solver/exact\_diag.hpp@{src/solver/exact\_diag.hpp}}
\mbox{\hyperlink{exact__diag_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/07.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../model/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}./utility.hpp"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{26 \textcolor{keyword}{namespace }solver \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{30 \textcolor{keyword}{template}<\textcolor{keyword}{class} ModelClass>}
\DoxyCodeLine{31 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag}{ExactDiag}} \{}
\DoxyCodeLine{32    }
\DoxyCodeLine{34    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} = \textcolor{keyword}{typename} ModelClass::ValueType;}
\DoxyCodeLine{35    }
\DoxyCodeLine{37    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef6fb4a525be81943447384b6170f3ef}{QType}} = \textcolor{keyword}{typename} ModelClass::QType;}
\DoxyCodeLine{38    }
\DoxyCodeLine{40    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}} = \textcolor{keyword}{typename} ModelClass::QHash;}
\DoxyCodeLine{41    }
\DoxyCodeLine{43    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{44    }
\DoxyCodeLine{46    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{sparse\_matrix::BraketVector<RealType>}};}
\DoxyCodeLine{47       }
\DoxyCodeLine{48 \textcolor{keyword}{public}:}
\DoxyCodeLine{49    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{50    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{53 \textcolor{comment}{}   \textcolor{keyword}{const} ModelClass \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}};}
\DoxyCodeLine{54    }
\DoxyCodeLine{56    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all}{sparse\_matrix::ParametersAll}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}};}
\DoxyCodeLine{57    }
\DoxyCodeLine{59    \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522}{DiagMethod}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} = \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}};}
\DoxyCodeLine{60 }
\DoxyCodeLine{61    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{62    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{63    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{66 \textcolor{comment}{}   \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a535e85ef2697a25abb2e128542d65c68}{ExactDiag}}(\textcolor{keyword}{const} ModelClass \&model\_input): \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}(model\_input) \{}
\DoxyCodeLine{67       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}} = \textcolor{keyword}{true};}
\DoxyCodeLine{68       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{ii}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{cg}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{flag\_symmetric\_crs}}   = \textcolor{keyword}{true};}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70    }
\DoxyCodeLine{74    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cdd5d5e73ad0ff77578a0dca66fc565}{ExactDiag}}(\textcolor{keyword}{const} ModelClass \&model\_input,}
\DoxyCodeLine{75              \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all}{sparse\_matrix::ParametersAll}} \&params\_input): \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag}{ExactDiag}}(model\_input) \{}
\DoxyCodeLine{76       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}} = params\_input;}
\DoxyCodeLine{77    \}}
\DoxyCodeLine{78     }
\DoxyCodeLine{79    }
\DoxyCodeLine{80    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{81    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{82    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{85 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0e57f30ab281b750b7ebbb24ade22afd}{CalculateGroundState}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_display\_info = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{86       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_affb70f954c79af21f543b0797daba72e}{calculated\_eigenvector\_set\_}}.count(0) != 0) \{}
\DoxyCodeLine{87          \textcolor{keywordflow}{return};}
\DoxyCodeLine{88       \}}
\DoxyCodeLine{89       }
\DoxyCodeLine{90       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef9f604139cf2607458c7e5d14afae5c}{GenerateBasis}}(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetQNumber(), flag\_display\_info);}
\DoxyCodeLine{91       }
\DoxyCodeLine{92       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} ham;}
\DoxyCodeLine{93       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\&ham);}
\DoxyCodeLine{94       }
\DoxyCodeLine{95       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.size() == 0) \{}
\DoxyCodeLine{96          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.emplace\_back();}
\DoxyCodeLine{97       \}}
\DoxyCodeLine{98       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size() == 0) \{}
\DoxyCodeLine{99          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.emplace\_back();}
\DoxyCodeLine{100       \}}
\DoxyCodeLine{101       }
\DoxyCodeLine{102       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}}) \{}
\DoxyCodeLine{103          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{sparse\_matrix::EigenvalueDecompositionLanczos}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], ham, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}});}
\DoxyCodeLine{104       \}}
\DoxyCodeLine{105       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522a779f87f3b11a08240fd9da58d90071fe}{DiagMethod::LOBPCG}}) \{}
\DoxyCodeLine{106          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086}{sparse\_matrix::EigenvalueDecompositionLOBPCG}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], ham, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}});}
\DoxyCodeLine{107       \}}
\DoxyCodeLine{108       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{109          std::stringstream ss;}
\DoxyCodeLine{110          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{111          ss << \textcolor{stringliteral}{"{}Invalid diagonalization method detected."{}} << std::endl;}
\DoxyCodeLine{112          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{113       \}}
\DoxyCodeLine{114       }
\DoxyCodeLine{115       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61}{sparse\_matrix::InverseIteration}}(\&ham, \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{ii}});}
\DoxyCodeLine{116       }
\DoxyCodeLine{117       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_affb70f954c79af21f543b0797daba72e}{calculated\_eigenvector\_set\_}}.emplace(0);}
\DoxyCodeLine{118    \}}
\DoxyCodeLine{119    }
\DoxyCodeLine{120    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a22420e816fb2c86f9e710312e8f346e2}{CalculateTargetState}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_sector) \{}
\DoxyCodeLine{121       \textcolor{keywordflow}{if} (target\_sector < 0) \{}
\DoxyCodeLine{122          std::stringstream ss;}
\DoxyCodeLine{123          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{124          ss << \textcolor{stringliteral}{"{}Invalid target\_sector: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{125          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{126       \}}
\DoxyCodeLine{127       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0e57f30ab281b750b7ebbb24ade22afd}{CalculateGroundState}}();}
\DoxyCodeLine{128       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_sector) != 0) \{}
\DoxyCodeLine{129          \textcolor{keywordflow}{return};}
\DoxyCodeLine{130       \}}
\DoxyCodeLine{131       }
\DoxyCodeLine{132       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis();}
\DoxyCodeLine{133       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} ham;}
\DoxyCodeLine{134       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\&ham);}
\DoxyCodeLine{135       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}}) \{}
\DoxyCodeLine{136          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} sector = 1; sector <= target\_sector; ++sector) \{}
\DoxyCodeLine{137             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(sector) == 0) \{}
\DoxyCodeLine{138                \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size()) != sector) \{}
\DoxyCodeLine{139                   std::stringstream ss;}
\DoxyCodeLine{140                   ss << \textcolor{stringliteral}{"{}Unknown Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{141                   ss << \textcolor{stringliteral}{"{}sector: "{}} << sector << \textcolor{stringliteral}{"{}, size: "{}} << \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size() << std::endl;}
\DoxyCodeLine{142                   \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{143                \}}
\DoxyCodeLine{144                \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} temp\_vector(ham.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{145                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_value = 0.0;}
\DoxyCodeLine{146                \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{sparse\_matrix::EigenvalueDecompositionLanczos}}(\&temp\_value, \&temp\_vector, ham, sector, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}});}
\DoxyCodeLine{147                \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61}{sparse\_matrix::InverseIteration}}(\&ham, \&temp\_vector, temp\_value, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{ii}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}});}
\DoxyCodeLine{148                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.push\_back(temp\_value);}
\DoxyCodeLine{149                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.push\_back(temp\_vector);}
\DoxyCodeLine{150                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.SetCalculatedEigenvectorSet(sector);}
\DoxyCodeLine{151             \}}
\DoxyCodeLine{152          \}}
\DoxyCodeLine{153       \}}
\DoxyCodeLine{154       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522a779f87f3b11a08240fd9da58d90071fe}{DiagMethod::LOBPCG}}) \{}
\DoxyCodeLine{155          std::stringstream ss;}
\DoxyCodeLine{156          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{157          ss << \textcolor{stringliteral}{"{}LOBPCG is under construction: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{158          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{159       \}}
\DoxyCodeLine{160       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{161          std::stringstream ss;}
\DoxyCodeLine{162          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{163          ss << \textcolor{stringliteral}{"{}Invalid diag\_method: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{164          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{165       \}}
\DoxyCodeLine{166       }
\DoxyCodeLine{167    \}}
\DoxyCodeLine{168    }
\DoxyCodeLine{169    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1aafb57ecb9c2dcc044f4a6828cc93e8}{CalculateExpectationValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} level = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{170       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(level) == 0) \{}
\DoxyCodeLine{171          std::stringstream ss;}
\DoxyCodeLine{172          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{173          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{174          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{175       \}}
\DoxyCodeLine{176       }
\DoxyCodeLine{177       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis     = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasis();}
\DoxyCodeLine{178       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{179       }
\DoxyCodeLine{180       \textcolor{keyword}{const} std::int64\_t dim = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(level).val.size();}
\DoxyCodeLine{181       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size()) != dim || \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_inv.size()) != dim) \{}
\DoxyCodeLine{182          std::stringstream ss;}
\DoxyCodeLine{183          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{184          ss << \textcolor{stringliteral}{"{}Unknown error detected"{}} << std::endl;}
\DoxyCodeLine{185          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{186       \}}
\DoxyCodeLine{187       }
\DoxyCodeLine{188       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{189       \textcolor{keyword}{const} std::int64\_t site\_constant = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site));}
\DoxyCodeLine{190       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(level);}
\DoxyCodeLine{191       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{192       }
\DoxyCodeLine{193 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: val)}}
\DoxyCodeLine{194       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{195          \textcolor{keyword}{const} std::int64\_t global\_basis = basis[i];}
\DoxyCodeLine{196          \textcolor{keyword}{const} \textcolor{keywordtype}{int}          local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite);}
\DoxyCodeLine{197          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{198          \textcolor{keywordflow}{for} (std::int64\_t j = m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{199             \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant;}
\DoxyCodeLine{200             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{201                temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_inv.at(a\_basis)]*m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{202             \}}
\DoxyCodeLine{203          \}}
\DoxyCodeLine{204          val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*temp\_val;}
\DoxyCodeLine{205       \}}
\DoxyCodeLine{206       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{207    \}}
\DoxyCodeLine{208    }
\DoxyCodeLine{209    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{210       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1aafb57ecb9c2dcc044f4a6828cc93e8}{CalculateExpectationValue}}(m, site, target\_level);}
\DoxyCodeLine{211    \}}
\DoxyCodeLine{212    }
\DoxyCodeLine{213    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a490b6895fcfb239a483be3dd2f10134a}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{214       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{215          std::stringstream ss;}
\DoxyCodeLine{216          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{217          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{218          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{219       \}}
\DoxyCodeLine{220       }
\DoxyCodeLine{221       \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} || m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} || m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{222          std::stringstream ss;}
\DoxyCodeLine{223          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{224          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{225          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{226       \}}
\DoxyCodeLine{227       }
\DoxyCodeLine{228       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} m1\_dagger = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{229       }
\DoxyCodeLine{230       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors  = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateTargetSector(m1\_dagger, m\_2);}
\DoxyCodeLine{231       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{232       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{233       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{234       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{235       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{236       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m1;}
\DoxyCodeLine{237       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m2;}
\DoxyCodeLine{238       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{239       }
\DoxyCodeLine{240       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&sector: target\_sectors) \{}
\DoxyCodeLine{241          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector);}
\DoxyCodeLine{242          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector);}
\DoxyCodeLine{243          \textcolor{keyword}{const} std::int64\_t dim\_target = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size());}
\DoxyCodeLine{244          vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target);}
\DoxyCodeLine{245          vector\_work\_m2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target);}
\DoxyCodeLine{246 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{247          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target; ++i) \{}
\DoxyCodeLine{248             \textcolor{keyword}{const} std::int64\_t global\_basis = basis[i];}
\DoxyCodeLine{249             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{250             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{251             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m1 = 0.0;}
\DoxyCodeLine{252             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m2 = 0.0;}
\DoxyCodeLine{253             }
\DoxyCodeLine{254             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{255             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{256                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{257                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{258                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{259                \}}
\DoxyCodeLine{260                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{261                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{262                \}}
\DoxyCodeLine{263             \}}
\DoxyCodeLine{264             }
\DoxyCodeLine{265             \textcolor{keywordflow}{for} (std::int64\_t j = m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1]; j < m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1 + 1]; ++j)\{}
\DoxyCodeLine{266                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m1 -\/ m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{267                \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{268                   temp\_val\_m1 += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_inv.at(a\_basis)]*m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{269                \}}
\DoxyCodeLine{270             \}}
\DoxyCodeLine{271             vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m1*fermion\_sign\_m1;}
\DoxyCodeLine{272             }
\DoxyCodeLine{273             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{274             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{275                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{276                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_2; site++) \{}
\DoxyCodeLine{277                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{278                \}}
\DoxyCodeLine{279                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{280                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{281                \}}
\DoxyCodeLine{282             \}}
\DoxyCodeLine{283             }
\DoxyCodeLine{284             \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{285                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{286                \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{287                   temp\_val\_m2 += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_inv.at(a\_basis)]*m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{288                \}}
\DoxyCodeLine{289             \}}
\DoxyCodeLine{290             vector\_work\_m2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m2*fermion\_sign\_m2;}
\DoxyCodeLine{291          \}}
\DoxyCodeLine{292          val += \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{sparse\_matrix::CalculateInnerProduct}}(vector\_work\_m1, vector\_work\_m2);}
\DoxyCodeLine{293       \}}
\DoxyCodeLine{294       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{295    \}}
\DoxyCodeLine{296    }
\DoxyCodeLine{297    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ae5779b9d1389557e8dcf81b91e978507}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{298                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{299                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_3,}
\DoxyCodeLine{300                                          \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{301       }
\DoxyCodeLine{302       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{303          std::stringstream ss;}
\DoxyCodeLine{304          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{305          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{306          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{307       \}}
\DoxyCodeLine{308       }
\DoxyCodeLine{309       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{310       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{311       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{312       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c4 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} \&\& m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{313       }
\DoxyCodeLine{314       \textcolor{keywordflow}{if} (!(c1 \&\& c2 \&\& c3 \&\& c4)) \{}
\DoxyCodeLine{315          std::stringstream ss;}
\DoxyCodeLine{316          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{317          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{318          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{319       \}}
\DoxyCodeLine{320       }
\DoxyCodeLine{321       \textcolor{keywordflow}{if} (site\_1 == site\_2) \{}
\DoxyCodeLine{322          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1*m\_2, site\_1, m\_3, site\_3, target\_level);}
\DoxyCodeLine{323       \}}
\DoxyCodeLine{324       \textcolor{keywordflow}{if} (site\_2 == site\_3) \{}
\DoxyCodeLine{325          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2*m\_3, site\_3, target\_level);}
\DoxyCodeLine{326       \}}
\DoxyCodeLine{327       }
\DoxyCodeLine{328       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}  m1\_dagger      = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{329       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateTargetSector(m1\_dagger, m\_2, m\_3);}
\DoxyCodeLine{330       }
\DoxyCodeLine{331       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_gs\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{332       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{333       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{334       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{335       \textcolor{keyword}{const} std::int64\_t site\_constant\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_3));}
\DoxyCodeLine{336       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{337       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_a;}
\DoxyCodeLine{338       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_b;}
\DoxyCodeLine{339       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_c;}
\DoxyCodeLine{340       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{341       }
\DoxyCodeLine{342       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: target\_sectors) \{}
\DoxyCodeLine{343          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_m1 = std::get<0>(it);}
\DoxyCodeLine{344          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_m3 = std::get<1>(it);}
\DoxyCodeLine{345          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_m1);}
\DoxyCodeLine{346          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_m3);}
\DoxyCodeLine{347          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_m1);}
\DoxyCodeLine{348          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m3 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_m3);}
\DoxyCodeLine{349          \textcolor{keyword}{const} std::int64\_t dim\_target\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_m1.size());}
\DoxyCodeLine{350          \textcolor{keyword}{const} std::int64\_t dim\_target\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_m3.size());}
\DoxyCodeLine{351          }
\DoxyCodeLine{352          \textcolor{comment}{//m3|gs>}}
\DoxyCodeLine{353          vector\_work\_a.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_m3);}
\DoxyCodeLine{354 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{355          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_m3; ++i) \{}
\DoxyCodeLine{356             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_m3[i];}
\DoxyCodeLine{357             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_3, dim\_onsite);}
\DoxyCodeLine{358             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{359             }
\DoxyCodeLine{360             \textcolor{keywordtype}{int} fermion\_sign\_m3 = 1;}
\DoxyCodeLine{361             \textcolor{keywordflow}{if} (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{362                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{363                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{364                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{365                \}}
\DoxyCodeLine{366                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{367                   fermion\_sign\_m3 = -\/1;}
\DoxyCodeLine{368                \}}
\DoxyCodeLine{369             \}}
\DoxyCodeLine{370             }
\DoxyCodeLine{371             \textcolor{keywordflow}{for} (std::int64\_t j = m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{372                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m3;}
\DoxyCodeLine{373                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{374                   temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{375                \}}
\DoxyCodeLine{376             \}}
\DoxyCodeLine{377             vector\_work\_a.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m3;}
\DoxyCodeLine{378          \}}
\DoxyCodeLine{379          }
\DoxyCodeLine{380          \textcolor{comment}{//m2 * m3|gs> and m1\_dag|gs>}}
\DoxyCodeLine{381          vector\_work\_b.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_m1);}
\DoxyCodeLine{382          vector\_work\_c.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_m1);}
\DoxyCodeLine{383          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m3\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasisInv(sector\_m3);}
\DoxyCodeLine{384 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{385          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_m1; ++i) \{}
\DoxyCodeLine{386             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_m1[i];}
\DoxyCodeLine{387             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{388             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{389             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m1 = 0.0;}
\DoxyCodeLine{390             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m2 = 0.0;}
\DoxyCodeLine{391             }
\DoxyCodeLine{392             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{393             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{394                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{395                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{396                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{397                \}}
\DoxyCodeLine{398                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{399                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{400                \}}
\DoxyCodeLine{401             \}}
\DoxyCodeLine{402             }
\DoxyCodeLine{403             \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{404                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{405                \textcolor{keywordflow}{if} (basis\_m3\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{406                   temp\_val\_m2 += vector\_work\_a.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_m3\_sector\_inv.at(a\_basis)]*m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{407                \}}
\DoxyCodeLine{408             \}}
\DoxyCodeLine{409             vector\_work\_b.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m2*fermion\_sign\_m2;}
\DoxyCodeLine{410             }
\DoxyCodeLine{411             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{412             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{413                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{414                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{415                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{416                \}}
\DoxyCodeLine{417                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{418                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{419                \}}
\DoxyCodeLine{420             \}}
\DoxyCodeLine{421             }
\DoxyCodeLine{422             \textcolor{keywordflow}{for} (std::int64\_t j = m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1]; j < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1 + 1]; ++j)\{}
\DoxyCodeLine{423                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m1 -\/ m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{424                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{425                   temp\_val\_m1 += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{426                \}}
\DoxyCodeLine{427             \}}
\DoxyCodeLine{428             vector\_work\_c.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m1*fermion\_sign\_m1;}
\DoxyCodeLine{429          \}}
\DoxyCodeLine{430          val += \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{sparse\_matrix::CalculateInnerProduct}}(vector\_work\_b, vector\_work\_c);}
\DoxyCodeLine{431       \}}
\DoxyCodeLine{432       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{433    \}}
\DoxyCodeLine{434    }
\DoxyCodeLine{435    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7c3c205f875f049444abaa9f17d2faeb}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{436                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{437                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_3,}
\DoxyCodeLine{438                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_4, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_4,}
\DoxyCodeLine{439                                          \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{440       }
\DoxyCodeLine{441       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{442          std::stringstream ss;}
\DoxyCodeLine{443          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{444          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{445          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{446       \}}
\DoxyCodeLine{447       }
\DoxyCodeLine{448       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{449       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{450       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{451       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c4 = (m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{452       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c5 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} \&\& m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} \&\& m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{453       }
\DoxyCodeLine{454       \textcolor{keywordflow}{if} (!(c1 \&\& c2 \&\& c3 \&\& c4 \&\& c5)) \{}
\DoxyCodeLine{455          std::stringstream ss;}
\DoxyCodeLine{456          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{457          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{458          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{459       \}}
\DoxyCodeLine{460       }
\DoxyCodeLine{461       \textcolor{keywordflow}{if} (site\_1 == site\_2) \{}
\DoxyCodeLine{462          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1*m\_2, site\_1, m\_3, site\_3, m\_4, site\_4);}
\DoxyCodeLine{463       \}}
\DoxyCodeLine{464       \textcolor{keywordflow}{if} (site\_2 == site\_3) \{}
\DoxyCodeLine{465          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2*m\_3, site\_2, m\_4, site\_4);}
\DoxyCodeLine{466       \}}
\DoxyCodeLine{467       \textcolor{keywordflow}{if} (site\_3 == site\_4) \{}
\DoxyCodeLine{468          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2, site\_2, m\_3*m\_4, site\_3);}
\DoxyCodeLine{469       \}}
\DoxyCodeLine{470       }
\DoxyCodeLine{471       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}  m1\_dagger = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{472       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}  m2\_dagger = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_2);}
\DoxyCodeLine{473       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateTargetSector(m1\_dagger, m2\_dagger, m\_3, m\_4);}
\DoxyCodeLine{474       }
\DoxyCodeLine{475       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_gs\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{476       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{477       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{478       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{479       \textcolor{keyword}{const} std::int64\_t site\_constant\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_3));}
\DoxyCodeLine{480       \textcolor{keyword}{const} std::int64\_t site\_constant\_m4 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_4));}
\DoxyCodeLine{481       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{482       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m1;}
\DoxyCodeLine{483       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m2m1;}
\DoxyCodeLine{484       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m4;}
\DoxyCodeLine{485       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m3m4;}
\DoxyCodeLine{486       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{487       }
\DoxyCodeLine{488       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: target\_sectors) \{}
\DoxyCodeLine{489          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_bra\_change\_1 = std::get<0>(it);}
\DoxyCodeLine{490          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_bra\_change\_2 = std::get<1>(it);}
\DoxyCodeLine{491          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_ket\_change\_1 = std::get<2>(it);}
\DoxyCodeLine{492          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_bra\_change\_1);}
\DoxyCodeLine{493          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_bra\_change\_2);}
\DoxyCodeLine{494          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_ket\_change\_1);}
\DoxyCodeLine{495          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_bra\_change\_1);}
\DoxyCodeLine{496          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_bra\_change\_2);}
\DoxyCodeLine{497          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_ket\_1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_ket\_change\_1);}
\DoxyCodeLine{498          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_ket\_1\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasisInv(sector\_ket\_change\_1);}
\DoxyCodeLine{499          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_1\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasisInv(sector\_bra\_change\_1);}
\DoxyCodeLine{500          \textcolor{keyword}{const} std::int64\_t dim\_target\_bra\_1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_bra\_1.size());}
\DoxyCodeLine{501          \textcolor{keyword}{const} std::int64\_t dim\_target\_bra\_2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_bra\_2.size());}
\DoxyCodeLine{502          \textcolor{keyword}{const} std::int64\_t dim\_target\_ket\_1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_ket\_1.size());}
\DoxyCodeLine{503          }
\DoxyCodeLine{504          \textcolor{comment}{//m4|gs>}}
\DoxyCodeLine{505          vector\_work\_m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_ket\_1);}
\DoxyCodeLine{506 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{507          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_ket\_1; ++i) \{}
\DoxyCodeLine{508             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_ket\_1[i];}
\DoxyCodeLine{509             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_4, dim\_onsite);}
\DoxyCodeLine{510             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{511             }
\DoxyCodeLine{512             \textcolor{keywordtype}{int} fermion\_sign\_m4 = 1;}
\DoxyCodeLine{513             \textcolor{keywordflow}{if} (m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{514                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{515                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{516                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{517                \}}
\DoxyCodeLine{518                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{519                   fermion\_sign\_m4 = -\/1;}
\DoxyCodeLine{520                \}}
\DoxyCodeLine{521             \}}
\DoxyCodeLine{522             }
\DoxyCodeLine{523             \textcolor{keywordflow}{for} (std::int64\_t j = m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{524                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m4;}
\DoxyCodeLine{525                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{526                   temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{527                \}}
\DoxyCodeLine{528             \}}
\DoxyCodeLine{529             vector\_work\_m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m4;}
\DoxyCodeLine{530          \}}
\DoxyCodeLine{531          }
\DoxyCodeLine{532          \textcolor{comment}{//m1\_dag|gs>}}
\DoxyCodeLine{533          vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_bra\_1);}
\DoxyCodeLine{534 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{535          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_bra\_1; ++i) \{}
\DoxyCodeLine{536             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_bra\_1[i];}
\DoxyCodeLine{537             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{538             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{539             }
\DoxyCodeLine{540             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{541             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{542                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{543                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{544                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{545                \}}
\DoxyCodeLine{546                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{547                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{548                \}}
\DoxyCodeLine{549             \}}
\DoxyCodeLine{550             }
\DoxyCodeLine{551             \textcolor{keywordflow}{for} (std::int64\_t j = m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{552                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{553                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{554                   temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{555                \}}
\DoxyCodeLine{556             \}}
\DoxyCodeLine{557             vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m1;}
\DoxyCodeLine{558          \}}
\DoxyCodeLine{559          }
\DoxyCodeLine{560          \textcolor{comment}{//m3 * m4|gs> and m2\_dag * m1\_dag|gs>}}
\DoxyCodeLine{561          vector\_work\_m3m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_bra\_2);}
\DoxyCodeLine{562          vector\_work\_m2m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_bra\_2);}
\DoxyCodeLine{563          }
\DoxyCodeLine{564 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{565          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_bra\_2; ++i) \{}
\DoxyCodeLine{566             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_bra\_2[i];}
\DoxyCodeLine{567             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{568             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m3 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_3, dim\_onsite);}
\DoxyCodeLine{569             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{570             }
\DoxyCodeLine{571             \textcolor{keywordtype}{int} fermion\_sign\_m3 = 1;}
\DoxyCodeLine{572             \textcolor{keywordflow}{if} (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{573                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{574                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{575                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{576                \}}
\DoxyCodeLine{577                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{578                   fermion\_sign\_m3 = -\/1;}
\DoxyCodeLine{579                \}}
\DoxyCodeLine{580             \}}
\DoxyCodeLine{581             }
\DoxyCodeLine{582             \textcolor{keywordflow}{for} (std::int64\_t j = m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m3]; j < m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m3 + 1]; ++j)\{}
\DoxyCodeLine{583                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m3 -\/ m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m3;}
\DoxyCodeLine{584                \textcolor{keywordflow}{if} (basis\_ket\_1\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{585                   temp\_val += vector\_work\_m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_ket\_1\_inv.at(a\_basis)]*m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{586                \}}
\DoxyCodeLine{587             \}}
\DoxyCodeLine{588             vector\_work\_m3m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m3;}
\DoxyCodeLine{589             }
\DoxyCodeLine{590             temp\_val = 0.0;}
\DoxyCodeLine{591             }
\DoxyCodeLine{592             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{593             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{594                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{595                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{596                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{597                \}}
\DoxyCodeLine{598                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{599                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{600                \}}
\DoxyCodeLine{601             \}}
\DoxyCodeLine{602             }
\DoxyCodeLine{603             \textcolor{keywordflow}{for} (std::int64\_t j = m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2]; j < m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{604                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{605                \textcolor{keywordflow}{if} (basis\_bra\_1\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{606                   temp\_val += vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_bra\_1\_inv.at(a\_basis)]*m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{607                \}}
\DoxyCodeLine{608             \}}
\DoxyCodeLine{609             vector\_work\_m2m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m2;}
\DoxyCodeLine{610          \}}
\DoxyCodeLine{611          val += \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{sparse\_matrix::CalculateInnerProduct}}(vector\_work\_m2m1, vector\_work\_m3m4);}
\DoxyCodeLine{612       \}}
\DoxyCodeLine{613       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{614    \}}
\DoxyCodeLine{615    }
\DoxyCodeLine{616    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<BraketVector> \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3998505c06a97dc70312e94409ac1770}{GetEigenvectors}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}; \}}
\DoxyCodeLine{617    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<RealType>     \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acaaec962f1fe4e3fcddc0b1e2ecebfc6}{GetEigenvalues}}()\textcolor{keyword}{  const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}; \}}
\DoxyCodeLine{618    }
\DoxyCodeLine{619 \textcolor{keyword}{private}:}
\DoxyCodeLine{620    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{621    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{622    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{623    std::vector<BraketVector> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}};}
\DoxyCodeLine{624    std::vector<RealType>     \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}};}
\DoxyCodeLine{625    }
\DoxyCodeLine{628    std::unordered\_map<QType, std::vector<std::int64\_t>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}};}
\DoxyCodeLine{629    }
\DoxyCodeLine{632    std::unordered\_map<QType, std::unordered\_map<std::int64\_t, std::int64\_t>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a6a65dea6a239083cf479222a02f546c5}{bases\_inv\_}};}
\DoxyCodeLine{633    }
\DoxyCodeLine{635    std::unordered\_set<int> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_affb70f954c79af21f543b0797daba72e}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{636    }
\DoxyCodeLine{637    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{638    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{639    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{640    std::unordered\_set<QType> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1) \{}
\DoxyCodeLine{641       std::unordered\_set<QType> target\_q\_set;}
\DoxyCodeLine{642       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{643          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{644             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{645                target\_q\_set.emplace(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateQNumber(i, m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]));}
\DoxyCodeLine{646             \}}
\DoxyCodeLine{647          \}}
\DoxyCodeLine{648       \}}
\DoxyCodeLine{649       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{650    \}}
\DoxyCodeLine{651    }
\DoxyCodeLine{656    std::vector<QType> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a5cc7ea84e576863cd2ab55ef61e75e30}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{657       std::unordered\_set<QType, QHash> q\_set\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_1);}
\DoxyCodeLine{658       std::unordered\_set<QType, QHash> q\_set\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_2);}
\DoxyCodeLine{659       }
\DoxyCodeLine{660       std::vector<QType> target\_q\_set;}
\DoxyCodeLine{661       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q\_m1: q\_set\_m1) \{}
\DoxyCodeLine{662          \textcolor{keywordflow}{if} (q\_set\_m2.count(q\_m1) > 0 \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q\_m1)) \{}
\DoxyCodeLine{663             target\_q\_set.push\_back(q\_m1);}
\DoxyCodeLine{664          \}}
\DoxyCodeLine{665       \}}
\DoxyCodeLine{666    }
\DoxyCodeLine{667       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{668    \}}
\DoxyCodeLine{669    }
\DoxyCodeLine{675    std::vector<std::vector<QType>> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ac1fd4a4602fcf9af48101c8d8ac46d47}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{676       std::unordered\_set<QType, QHash> q\_set\_m1\_bra = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_1\_bra);}
\DoxyCodeLine{677       std::unordered\_set<QType, QHash> q\_set\_m2\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_2\_ket);}
\DoxyCodeLine{678       std::unordered\_set<QType, QHash> q\_set\_m3\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_3\_ket);}
\DoxyCodeLine{679       }
\DoxyCodeLine{680       std::unordered\_map<QType, std::vector<QType>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> q\_list\_m2\_m3\_ket;}
\DoxyCodeLine{681       }
\DoxyCodeLine{682       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q2: q\_set\_m2\_ket) \{}
\DoxyCodeLine{683          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q3: q\_set\_m3\_ket) \{}
\DoxyCodeLine{684             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q2 + q3) \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q3)) \{}
\DoxyCodeLine{685                q\_list\_m2\_m3\_ket[q2 + q3].push\_back(q3);}
\DoxyCodeLine{686             \}}
\DoxyCodeLine{687          \}}
\DoxyCodeLine{688       \}}
\DoxyCodeLine{689       }
\DoxyCodeLine{690       std::vector<std::vector<QType>> target\_q\_set;}
\DoxyCodeLine{691       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q1: q\_set\_m1\_bra) \{}
\DoxyCodeLine{692          \textcolor{keywordflow}{if} (q\_list\_m2\_m3\_ket.count(q1) > 0) \{}
\DoxyCodeLine{693             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q3: q\_list\_m2\_m3\_ket.at(q1)) \{}
\DoxyCodeLine{694                target\_q\_set.push\_back(\{q1, q3\});}
\DoxyCodeLine{695             \}}
\DoxyCodeLine{696          \}}
\DoxyCodeLine{697       \}}
\DoxyCodeLine{698       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{699    \}}
\DoxyCodeLine{700    }
\DoxyCodeLine{707    std::vector<std::vector<QType>> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a6c393215396e23e56985ad8ca6b5b551}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra,}
\DoxyCodeLine{708                                                         \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_bra,}
\DoxyCodeLine{709                                                         \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket,}
\DoxyCodeLine{710                                                         \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_4\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{711       std::unordered\_set<QType, QHash> q\_set\_m1\_bra = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_1\_bra);}
\DoxyCodeLine{712       std::unordered\_set<QType, QHash> q\_set\_m2\_bra = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_2\_bra);}
\DoxyCodeLine{713       std::unordered\_set<QType, QHash> q\_set\_m3\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_3\_ket);}
\DoxyCodeLine{714       std::unordered\_set<QType, QHash> q\_set\_m4\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_4\_ket);}
\DoxyCodeLine{715 }
\DoxyCodeLine{716       std::unordered\_map<QType, std::vector<QType>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> q\_list\_m1\_m2\_bra;}
\DoxyCodeLine{717       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q1: q\_set\_m1\_bra) \{}
\DoxyCodeLine{718          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q2: q\_set\_m2\_bra) \{}
\DoxyCodeLine{719             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumbe(q1 + q2) \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q1)) \{}
\DoxyCodeLine{720                q\_list\_m1\_m2\_bra[q1 + q2].push\_back(q1);}
\DoxyCodeLine{721             \}}
\DoxyCodeLine{722          \}}
\DoxyCodeLine{723       \}}
\DoxyCodeLine{724       }
\DoxyCodeLine{725       std::unordered\_map<QType, std::vector<QType>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> q\_list\_m3\_m4\_ket;}
\DoxyCodeLine{726       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q3: q\_set\_m3\_ket) \{}
\DoxyCodeLine{727          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q4: q\_set\_m4\_ket) \{}
\DoxyCodeLine{728             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumbe(q3 + q4) \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q4)) \{}
\DoxyCodeLine{729                q\_list\_m3\_m4\_ket[q3 + q4].push\_back(q4);}
\DoxyCodeLine{730             \}}
\DoxyCodeLine{731          \}}
\DoxyCodeLine{732       \}}
\DoxyCodeLine{733       }
\DoxyCodeLine{734       std::vector<std::vector<QType>> target\_q\_set;}
\DoxyCodeLine{735       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} it\_q1\_q2: q\_list\_m1\_m2\_bra) \{}
\DoxyCodeLine{736          \textcolor{keywordflow}{if} (q\_list\_m3\_m4\_ket.count(it\_q1\_q2.first) > 0) \{}
\DoxyCodeLine{737             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} q4: q\_list\_m3\_m4\_ket.at(it\_q1\_q2.first)) \{}
\DoxyCodeLine{738                target\_q\_set.push\_back(\{it\_q1\_q2.second, it\_q1\_q2.first, q4\});}
\DoxyCodeLine{739             \}}
\DoxyCodeLine{740          \}}
\DoxyCodeLine{741       \}}
\DoxyCodeLine{742       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{743    \}}
\DoxyCodeLine{744    }
\DoxyCodeLine{745    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(std::int64\_t global\_basis, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{746       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < site; ++i) \{}
\DoxyCodeLine{747          global\_basis = global\_basis/dim\_onsite;}
\DoxyCodeLine{748       \}}
\DoxyCodeLine{749       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(global\_basis\%dim\_onsite);}
\DoxyCodeLine{750    \}}
\DoxyCodeLine{751    }
\DoxyCodeLine{752    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef9f604139cf2607458c7e5d14afae5c}{GenerateBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef6fb4a525be81943447384b6170f3ef}{QType}} \&q\_number, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_display\_info = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{753       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}}.count(q\_number) == 0) \{}
\DoxyCodeLine{754          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}}[q\_number] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(q\_number, flag\_display\_info);}
\DoxyCodeLine{755          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}}.at(q\_number);}
\DoxyCodeLine{756          \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a6a65dea6a239083cf479222a02f546c5}{bases\_inv\_}}[q\_number];}
\DoxyCodeLine{757          basis\_inv.clear();}
\DoxyCodeLine{758          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < basis.size(); ++i) \{}
\DoxyCodeLine{759             basis\_inv[basis[i]] = i;}
\DoxyCodeLine{760          \}}
\DoxyCodeLine{761       \}}
\DoxyCodeLine{762    \}}
\DoxyCodeLine{763    }
\DoxyCodeLine{764    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{765                                        \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{766                                        \textcolor{keyword}{const} \textcolor{keywordtype}{int} site,}
\DoxyCodeLine{767                                        \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix\_onsite,}
\DoxyCodeLine{768                                        \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} coeef)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{769       }
\DoxyCodeLine{770       \textcolor{keywordflow}{if} (std::abs(coeef) <= edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a4c81b233063eedecf43f9a44c78ee01e}{zero\_precision}}) \{}
\DoxyCodeLine{771          \textcolor{keywordflow}{return};}
\DoxyCodeLine{772       \}}
\DoxyCodeLine{773       }
\DoxyCodeLine{774       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site];}
\DoxyCodeLine{775       \textcolor{keyword}{const} std::int64\_t site\_constant = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}[site];}
\DoxyCodeLine{776       }
\DoxyCodeLine{777       \textcolor{keywordflow}{for} (std::int64\_t i = matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite]; i < matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite + 1]; ++i) \{}
\DoxyCodeLine{778          \textcolor{keyword}{const} std::int64\_t a\_basis = basis + (matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i] -\/ basis\_onsite)*site\_constant;}
\DoxyCodeLine{779          \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(a\_basis) == 0) \{}
\DoxyCodeLine{780             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[a\_basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{781             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(coeef*matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i]);}
\DoxyCodeLine{782             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(a\_basis);}
\DoxyCodeLine{783          \}}
\DoxyCodeLine{784          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{785             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}[edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.at(a\_basis)] += coeef*matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i];}
\DoxyCodeLine{786          \}}
\DoxyCodeLine{787       \}}
\DoxyCodeLine{788    \}}
\DoxyCodeLine{789    }
\DoxyCodeLine{790    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{791                                           \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{792                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{793                                           \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix\_onsite\_1,}
\DoxyCodeLine{794                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{795                                           \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix\_onsite\_2,}
\DoxyCodeLine{796                                           \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} coeef,}
\DoxyCodeLine{797                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} fermion\_sign = 1.0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{798       }
\DoxyCodeLine{799       \textcolor{keywordflow}{if} (std::abs(coeef) <= edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a4c81b233063eedecf43f9a44c78ee01e}{zero\_precision}}) \{}
\DoxyCodeLine{800          \textcolor{keywordflow}{return};}
\DoxyCodeLine{801       \}}
\DoxyCodeLine{802       }
\DoxyCodeLine{803       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite\_1  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site\_1];}
\DoxyCodeLine{804       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite\_2  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site\_2];}
\DoxyCodeLine{805       \textcolor{keyword}{const} std::int64\_t site\_constant\_1 = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}[site\_1];}
\DoxyCodeLine{806       \textcolor{keyword}{const} std::int64\_t site\_constant\_2 = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}[site\_2];}
\DoxyCodeLine{807       }
\DoxyCodeLine{808       \textcolor{keywordflow}{for} (std::int64\_t i1 = matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_1]; i1 < matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_1 + 1]; ++i1) \{}
\DoxyCodeLine{809          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val\_1 = matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i1];}
\DoxyCodeLine{810          \textcolor{keyword}{const} std::int64\_t col\_1 = matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i1];}
\DoxyCodeLine{811          \textcolor{keywordflow}{for} (std::int64\_t i2 = matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_2]; i2 < matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_2 + 1]; ++i2) \{}
\DoxyCodeLine{812             \textcolor{keyword}{const} std::int64\_t a\_basis = basis + (col\_1 -\/ basis\_onsite\_1)*site\_constant\_1 + (matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i2] -\/ basis\_onsite\_2)*site\_constant\_2;}
\DoxyCodeLine{813             \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(a\_basis) == 0) \{}
\DoxyCodeLine{814                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[a\_basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{815                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(fermion\_sign*coeef*val\_1*matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i2]);}
\DoxyCodeLine{816                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(a\_basis);}
\DoxyCodeLine{817             \}}
\DoxyCodeLine{818             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{819                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}[edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.at(a\_basis)] += fermion\_sign*coeef*val\_1*matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i2];}
\DoxyCodeLine{820             \}}
\DoxyCodeLine{821          \}}
\DoxyCodeLine{822       \}}
\DoxyCodeLine{823    \}}
\DoxyCodeLine{824    }
\DoxyCodeLine{825    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} *ham)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{826       \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{827       std::cout << \textcolor{stringliteral}{"{}Generating Hamiltonian..."{}} << std::flush;}
\DoxyCodeLine{828       }
\DoxyCodeLine{829       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis     = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasis();}
\DoxyCodeLine{830       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{831       }
\DoxyCodeLine{832       \textcolor{keyword}{const} std::int64\_t dim\_target = basis.size();}
\DoxyCodeLine{833       std::int64\_t num\_total\_elements = 0;}
\DoxyCodeLine{834       }
\DoxyCodeLine{835 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{836       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{837       std::vector<ExactDiagMatrixComponents<RealType>> components(num\_threads);}
\DoxyCodeLine{838       }
\DoxyCodeLine{839       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} thread\_num = 0; thread\_num < num\_threads; ++thread\_num) \{}
\DoxyCodeLine{840          components[thread\_num].site\_constant.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{841          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize(); ++site) \{}
\DoxyCodeLine{842             components[thread\_num].site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetDimOnsite(), site));}
\DoxyCodeLine{843          \}}
\DoxyCodeLine{844          components[thread\_num].basis\_onsite.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{845       \}}
\DoxyCodeLine{846       }
\DoxyCodeLine{847       std::vector<std::int64\_t> num\_row\_element(dim\_target + 1);}
\DoxyCodeLine{848       }
\DoxyCodeLine{849 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{850       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{851          \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{852          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components[thread\_num], basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{853          \textcolor{keyword}{const} std::size\_t size = components[thread\_num].basis\_affected.size();}
\DoxyCodeLine{854          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{855             \textcolor{keyword}{const} std::int64\_t a\_basis = components[thread\_num].basis\_affected[i];}
\DoxyCodeLine{856             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components[thread\_num].val[i];}
\DoxyCodeLine{857             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{858                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{859                \textcolor{keywordflow}{if} ((inv < row \&\& std::abs(val) > components[thread\_num].zero\_precision) || inv == row) \{}
\DoxyCodeLine{860                   num\_row\_element[row + 1]++;}
\DoxyCodeLine{861                \}}
\DoxyCodeLine{862             \}}
\DoxyCodeLine{863             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) == 0 \&\& std::abs(val) > components[thread\_num].zero\_precision) \{}
\DoxyCodeLine{864                \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Matrix elements are not in the target space"{}});}
\DoxyCodeLine{865             \}}
\DoxyCodeLine{866          \}}
\DoxyCodeLine{867          components[thread\_num].val.clear();}
\DoxyCodeLine{868          components[thread\_num].basis\_affected.clear();}
\DoxyCodeLine{869          components[thread\_num].inv\_basis\_affected.clear();}
\DoxyCodeLine{870       \}}
\DoxyCodeLine{871       }
\DoxyCodeLine{872 \textcolor{preprocessor}{\#pragma omp parallel for reduction(+:num\_total\_elements)}}
\DoxyCodeLine{873       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row <= dim\_target; ++row) \{}
\DoxyCodeLine{874          num\_total\_elements += num\_row\_element[row];}
\DoxyCodeLine{875       \}}
\DoxyCodeLine{876       }
\DoxyCodeLine{877       \textcolor{comment}{//Do not use openmp here}}
\DoxyCodeLine{878       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{879          num\_row\_element[row + 1] += num\_row\_element[row];}
\DoxyCodeLine{880       \}}
\DoxyCodeLine{881       }
\DoxyCodeLine{882       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.resize(dim\_target + 1);}
\DoxyCodeLine{883       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.resize(num\_total\_elements);}
\DoxyCodeLine{884       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.resize(num\_total\_elements);}
\DoxyCodeLine{885       }
\DoxyCodeLine{886 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{887       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{888          \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{889          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components[thread\_num], basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{890          \textcolor{keyword}{const} std::size\_t size = components[thread\_num].basis\_affected.size();}
\DoxyCodeLine{891          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{892             \textcolor{keyword}{const} std::int64\_t a\_basis = components[thread\_num].basis\_affected[i];}
\DoxyCodeLine{893             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components[thread\_num].val[i];}
\DoxyCodeLine{894             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{895                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{896                \textcolor{keywordflow}{if} ((inv < row \&\& std::abs(val) > components[thread\_num].zero\_precision) || inv == row) \{}
\DoxyCodeLine{897                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[num\_row\_element[row]] = inv;}
\DoxyCodeLine{898                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[num\_row\_element[row]] = val;}
\DoxyCodeLine{899                   num\_row\_element[row]++;}
\DoxyCodeLine{900                \}}
\DoxyCodeLine{901             \}}
\DoxyCodeLine{902          \}}
\DoxyCodeLine{903          ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = num\_row\_element[row];}
\DoxyCodeLine{904          components[thread\_num].val.clear();}
\DoxyCodeLine{905          components[thread\_num].basis\_affected.clear();}
\DoxyCodeLine{906          components[thread\_num].inv\_basis\_affected.clear();}
\DoxyCodeLine{907       \}}
\DoxyCodeLine{908 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{909       \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} components;}
\DoxyCodeLine{910       components.\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{911       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize(); ++site) \{}
\DoxyCodeLine{912          components.site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetDimOnsite(), site));}
\DoxyCodeLine{913       \}}
\DoxyCodeLine{914       components.basis\_onsite.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{915       }
\DoxyCodeLine{916       std::vector<std::int64\_t> num\_row\_element(dim\_target + 1);}
\DoxyCodeLine{917       }
\DoxyCodeLine{918       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{919          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components, basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{920          \textcolor{keyword}{const} std::size\_t size = components.basis\_affected.size();}
\DoxyCodeLine{921          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{922             \textcolor{keyword}{const} std::int64\_t a\_basis = components.basis\_affected[i];}
\DoxyCodeLine{923             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components.val[i];}
\DoxyCodeLine{924             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{925                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{926                \textcolor{keywordflow}{if} ((inv <= row \&\& std::abs(val) > components.zero\_precision) || inv == row) \{}
\DoxyCodeLine{927                   num\_row\_element[row + 1]++;}
\DoxyCodeLine{928                \}}
\DoxyCodeLine{929             \}}
\DoxyCodeLine{930             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) == 0 \&\& std::abs(val) > components.zero\_precision) \{}
\DoxyCodeLine{931                \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Matrix elements are not in the target space"{}});}
\DoxyCodeLine{932             \}}
\DoxyCodeLine{933          \}}
\DoxyCodeLine{934          components.val.clear();}
\DoxyCodeLine{935          components.basis\_affected.clear();}
\DoxyCodeLine{936          components.inv\_basis\_affected.clear();}
\DoxyCodeLine{937       \}}
\DoxyCodeLine{938       }
\DoxyCodeLine{939       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row <= dim\_target; ++row) \{}
\DoxyCodeLine{940          num\_total\_elements += num\_row\_element[row];}
\DoxyCodeLine{941       \}}
\DoxyCodeLine{942       }
\DoxyCodeLine{943       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{944          num\_row\_element[row + 1] += num\_row\_element[row];}
\DoxyCodeLine{945       \}}
\DoxyCodeLine{946       }
\DoxyCodeLine{947       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.resize(dim\_target + 1);}
\DoxyCodeLine{948       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.resize(num\_total\_elements);}
\DoxyCodeLine{949       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.resize(num\_total\_elements);}
\DoxyCodeLine{950       }
\DoxyCodeLine{951       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{952          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components, basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{953          \textcolor{keyword}{const} std::size\_t size = components.basis\_affected.size();}
\DoxyCodeLine{954          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{955             \textcolor{keyword}{const} std::int64\_t a\_basis = components.basis\_affected[i];}
\DoxyCodeLine{956             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components.val[i];}
\DoxyCodeLine{957             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{958                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{959                \textcolor{keywordflow}{if} ((inv <= row \&\& std::abs(val) > components.zero\_precision) || inv == row) \{}
\DoxyCodeLine{960                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[num\_row\_element[row]] = inv;}
\DoxyCodeLine{961                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[num\_row\_element[row]] = val;}
\DoxyCodeLine{962                   num\_row\_element[row]++;}
\DoxyCodeLine{963                \}}
\DoxyCodeLine{964             \}}
\DoxyCodeLine{965          \}}
\DoxyCodeLine{966          ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = num\_row\_element[row];}
\DoxyCodeLine{967          components.val.clear();}
\DoxyCodeLine{968          components.basis\_affected.clear();}
\DoxyCodeLine{969          components.inv\_basis\_affected.clear();}
\DoxyCodeLine{970       \}}
\DoxyCodeLine{971 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{972       }
\DoxyCodeLine{973       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} = dim\_target;}
\DoxyCodeLine{974       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} = dim\_target;}
\DoxyCodeLine{975       }
\DoxyCodeLine{976       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_1 = (ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[dim\_target] != num\_total\_elements);}
\DoxyCodeLine{977       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_2 = (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size()) != num\_total\_elements);}
\DoxyCodeLine{978       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_3 = (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size()) != num\_total\_elements);}
\DoxyCodeLine{979       }
\DoxyCodeLine{980       \textcolor{keywordflow}{if} (flag\_check\_1 || flag\_check\_2 || flag\_check\_3) \{}
\DoxyCodeLine{981          std::stringstream ss;}
\DoxyCodeLine{982          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_  << std::endl;}
\DoxyCodeLine{983          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{984       \}}
\DoxyCodeLine{985       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a461f3df023c6215768aca60b9743fe0c}{SortCol}}();}
\DoxyCodeLine{986       }
\DoxyCodeLine{987       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{988       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{sparse\_matrix::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{989       std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating Hamiltonian:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{990       }
\DoxyCodeLine{991    \}}
\DoxyCodeLine{992       }
\DoxyCodeLine{993    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{994                                  \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{995                                  \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d}{model::Hubbard\_1D<RealType>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{996       }
\DoxyCodeLine{997       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&nc            = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ae4807dc416a3b14a3a6eddfcfa155463}{GetOnsiteOperatorNC}}();}
\DoxyCodeLine{998       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up          = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a15fe38d996c2d23748a2eb254807b882}{GetOnsiteOperatorCUp}}();}
\DoxyCodeLine{999       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up\_dagger   = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7a2de63620d20978d0d2d39c722222fd}{GetOnsiteOperatorCUpDagger}}();}
\DoxyCodeLine{1000       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down        = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4dfc489bed6324d3d4092e3ae215c224}{GetOnsiteOperatorCDown}}();}
\DoxyCodeLine{1001       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down\_dagger = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4892fdee7d5a231b434a6b0335c0cedd}{GetOnsiteOperatorCDownDagger}}();}
\DoxyCodeLine{1002       }
\DoxyCodeLine{1003       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1004          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af85f0a2c8d11d5fc5df37fab13068222}{GetDimOnsite}}());}
\DoxyCodeLine{1005       \}}
\DoxyCodeLine{1006       }
\DoxyCodeLine{1007       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{1008       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1009          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a36690ef3139f372438941e9ea951ced5}{GetOnsiteOperatorHam}}(), 1.0);}
\DoxyCodeLine{1010       \}}
\DoxyCodeLine{1011       }
\DoxyCodeLine{1012       \textcolor{comment}{//Intersite Coulomb}}
\DoxyCodeLine{1013       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}().size()); ++distance) \{}
\DoxyCodeLine{1014          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{1015             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, nc, site + distance, nc, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}(distance -\/ 1));}
\DoxyCodeLine{1016          \}}
\DoxyCodeLine{1017       \}}
\DoxyCodeLine{1018       }
\DoxyCodeLine{1019       \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{1020       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{1021          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{1022             \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{1023             \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{1024             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = site; s < site + distance; ++s) \{}
\DoxyCodeLine{1025                n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a465e32e606632a760db7e21c8c1c3e72}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[s]);}
\DoxyCodeLine{1026             \}}
\DoxyCodeLine{1027             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up\_dagger  , site + distance, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1028             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up         , site + distance, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1029             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down\_dagger, site + distance, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1030             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down       , site + distance, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1031          \}}
\DoxyCodeLine{1032       \}}
\DoxyCodeLine{1033       }
\DoxyCodeLine{1034       \textcolor{keywordflow}{if} (model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a2b552c2cb6d887c1112ef431c22ed508}{GetBoundaryCondition}}() == \mbox{\hyperlink{namespacecompnal_1_1model_a472b79d22175004cb119fcc099cdd49ba971a9be4942bbf28af21cd78bd5e6c15}{model::BoundaryCondition::PBC}}) \{}
\DoxyCodeLine{1035          \textcolor{comment}{//Intersite Coulomb}}
\DoxyCodeLine{1036          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}().size()); ++distance) \{}
\DoxyCodeLine{1037             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{1038                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{1039                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{1040                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, nc, d2, nc, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}(distance -\/ 1));}
\DoxyCodeLine{1041             \}}
\DoxyCodeLine{1042          \}}
\DoxyCodeLine{1043          }
\DoxyCodeLine{1044          \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{1045          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{1046             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{1047                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{1048                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{1049                \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{1050                \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{1051                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = d2; s < d2 + d1; ++s) \{}
\DoxyCodeLine{1052                   n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a465e32e606632a760db7e21c8c1c3e72}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[s]);}
\DoxyCodeLine{1053                \}}
\DoxyCodeLine{1054                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_up\_dagger  , d2, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1055                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_up         , d2, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1056                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_down\_dagger, d2, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1057                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_down       , d2, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1058             \}}
\DoxyCodeLine{1059          \}}
\DoxyCodeLine{1060       \}}
\DoxyCodeLine{1061       }
\DoxyCodeLine{1062       \textcolor{comment}{//Fill zero in the diagonal elements for symmetric matrix vector product calculation.}}
\DoxyCodeLine{1063       \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(basis) == 0) \{}
\DoxyCodeLine{1064          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{1065          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(0.0);}
\DoxyCodeLine{1066          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(basis);}
\DoxyCodeLine{1067       \}}
\DoxyCodeLine{1068       }
\DoxyCodeLine{1069    \}}
\DoxyCodeLine{1070    }
\DoxyCodeLine{1071    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af1da3592e5e6c2d00903c2f411987233}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{1072                                  \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{1073                                  \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d}{model::KondoLattice\_1D<RealType>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1074       }
\DoxyCodeLine{1075       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up          = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a65f4321d5d41b8898b4dcf17dd83329d}{GetOnsiteOperatorCUp}}();}
\DoxyCodeLine{1076       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up\_dagger   = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a3686b4987cd45b9524faa073e1834cbb}{GetOnsiteOperatorCUpDagger}}();}
\DoxyCodeLine{1077       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down        = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a114ca4b0dec996f77b7f85c7f846f1b4}{GetOnsiteOperatorCDown}}();}
\DoxyCodeLine{1078       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down\_dagger = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a4698ebcfbb9c957bb2edef2eccfdcd24}{GetOnsiteOperatorCDownDagger}}();}
\DoxyCodeLine{1079       }
\DoxyCodeLine{1080       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1081          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_af509aa69f9a132afbfafd86974317f3a}{GetDimOnsite}}());}
\DoxyCodeLine{1082       \}}
\DoxyCodeLine{1083       }
\DoxyCodeLine{1084       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{1085       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1086          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aef91160bc62bb058ea4dbb943bb60b0c}{GetOnsiteOperatorHam}}(), 1.0);}
\DoxyCodeLine{1087       \}}
\DoxyCodeLine{1088       }
\DoxyCodeLine{1089       \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{1090       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aa896770fcaa6a044e9083b8fbb8db3b3}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{1091          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{1092             \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aa896770fcaa6a044e9083b8fbb8db3b3}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{1093             \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{1094             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = site; s < site + distance; ++s) \{}
\DoxyCodeLine{1095                n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a66a72d066c290e214f6407b0eb746c42}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[s]);}
\DoxyCodeLine{1096             \}}
\DoxyCodeLine{1097             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up\_dagger  , site + distance, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1098             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up         , site + distance, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1099             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down\_dagger, site + distance, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1100             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down       , site + distance, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1101          \}}
\DoxyCodeLine{1102       \}}
\DoxyCodeLine{1103       }
\DoxyCodeLine{1104    \}}
\DoxyCodeLine{1105    }
\DoxyCodeLine{1106    \textcolor{keyword}{template}<\textcolor{keyword}{class} BaseClass>}
\DoxyCodeLine{1107    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a259b4ea5e04a394742135d8182a1f46e}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{1108                                  \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{1109                                  \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d}{model::GeneralModel\_1D<BaseClass>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1110       }
\DoxyCodeLine{1111       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.GetSystemSize(); ++site) \{}
\DoxyCodeLine{1112          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.GetDimOnsite());}
\DoxyCodeLine{1113       \}}
\DoxyCodeLine{1114       }
\DoxyCodeLine{1115       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{1116       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a06a053ae83790d126cb115b5559682f5}{GetOnsiteOperatorList}}()) \{}
\DoxyCodeLine{1117          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(edmc, basis, it.first, it.second, 1.0);}
\DoxyCodeLine{1118       \}}
\DoxyCodeLine{1119       }
\DoxyCodeLine{1120       \textcolor{comment}{//Intersite elements}}
\DoxyCodeLine{1121       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it1: \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetIntersiteOperatorList()) \{}
\DoxyCodeLine{1122          \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1 = it1.first;}
\DoxyCodeLine{1123          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it2: it1.second) \{}
\DoxyCodeLine{1124             \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2 = it2.first;}
\DoxyCodeLine{1125             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it3: it2.second) \{}
\DoxyCodeLine{1126                \textcolor{keyword}{const} \textcolor{keyword}{auto} \&m\_1 = it3.first;}
\DoxyCodeLine{1127                \textcolor{keyword}{const} \textcolor{keyword}{auto} \&m\_2 = it3.second;}
\DoxyCodeLine{1128                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site\_1, m\_1, site\_2, m\_2, 1.0);}
\DoxyCodeLine{1129             \}}
\DoxyCodeLine{1130          \}}
\DoxyCodeLine{1131       \}}
\DoxyCodeLine{1132       }
\DoxyCodeLine{1133       \textcolor{comment}{//Fill zero in the diagonal elements for symmetric matrix vector product calculation.}}
\DoxyCodeLine{1134       \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(basis) == 0) \{}
\DoxyCodeLine{1135          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{1136          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(0.0);}
\DoxyCodeLine{1137          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(basis);}
\DoxyCodeLine{1138       \}}
\DoxyCodeLine{1139       }
\DoxyCodeLine{1140    \}}
\DoxyCodeLine{1141    }
\DoxyCodeLine{1142    }
\DoxyCodeLine{1143    }
\DoxyCodeLine{1144 \};}
\DoxyCodeLine{1145 }
\DoxyCodeLine{1146 \}}
\DoxyCodeLine{1147 \}}
\DoxyCodeLine{1148 }
\DoxyCodeLine{1149 }
\DoxyCodeLine{1150 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
