\hypertarget{exact__diag_8hpp_source}{}\doxysection{exact\+\_\+diag.\+hpp}
\label{exact__diag_8hpp_source}\index{src/solver/exact\_diag.hpp@{src/solver/exact\_diag.hpp}}
\mbox{\hyperlink{exact__diag_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/07.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../model/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}./utility.hpp"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{26 \textcolor{keyword}{namespace }solver \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{30 \textcolor{keyword}{template}<\textcolor{keyword}{class} ModelClass>}
\DoxyCodeLine{31 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag}{ExactDiag}} \{}
\DoxyCodeLine{32    }
\DoxyCodeLine{34    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} = \textcolor{keyword}{typename} ModelClass::ValueType;}
\DoxyCodeLine{35    }
\DoxyCodeLine{37    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{38    }
\DoxyCodeLine{40    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{sparse\_matrix::BraketVector<RealType>}};}
\DoxyCodeLine{41    }
\DoxyCodeLine{43    \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} \{}
\DoxyCodeLine{44       }
\DoxyCodeLine{46       std::vector<RealType> \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}};}
\DoxyCodeLine{47       }
\DoxyCodeLine{49       std::vector<std::int64\_t>  \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}};}
\DoxyCodeLine{50       }
\DoxyCodeLine{52       std::vector<int> \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}};}
\DoxyCodeLine{53       }
\DoxyCodeLine{55       std::vector<std::int64\_t> \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a24e24b66e5cceb045bf3a8b5f3a35398}{site\_constant}};}
\DoxyCodeLine{56       }
\DoxyCodeLine{58       std::unordered\_map<std::int64\_t, std::int64\_t> \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}};}
\DoxyCodeLine{59       }
\DoxyCodeLine{61       \textcolor{keywordtype}{double} \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a318fc7257796f0900c15e0b4fcfcd2da}{zero\_precision}} = std::pow(10, -\/15);}
\DoxyCodeLine{62    \};}
\DoxyCodeLine{63    }
\DoxyCodeLine{64 \textcolor{keyword}{public}:}
\DoxyCodeLine{65    }
\DoxyCodeLine{66    ModelClass \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}};}
\DoxyCodeLine{67    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all}{sparse\_matrix::ParametersAll}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}};}
\DoxyCodeLine{68       }
\DoxyCodeLine{69    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a535e85ef2697a25abb2e128542d65c68}{ExactDiag}}(\textcolor{keyword}{const} ModelClass \&model\_input): \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}(model\_input) \{}
\DoxyCodeLine{70       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}} = \textcolor{keyword}{true};}
\DoxyCodeLine{71       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{ii}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{cg}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{flag\_symmetric\_crs}}   = \textcolor{keyword}{true};}
\DoxyCodeLine{72    \}}
\DoxyCodeLine{73    }
\DoxyCodeLine{74    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cdd5d5e73ad0ff77578a0dca66fc565}{ExactDiag}}(\textcolor{keyword}{const} ModelClass \&model\_input,}
\DoxyCodeLine{75              \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all}{sparse\_matrix::ParametersAll}} \&params\_input): \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag}{ExactDiag}}(model\_input) \{}
\DoxyCodeLine{76       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}} = params\_input;}
\DoxyCodeLine{77    \}}
\DoxyCodeLine{78    }
\DoxyCodeLine{79    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aed585bff140cd36887ffd247d681ca89}{SetDiagonalizationMethod}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522}{DiagMethod}} diag\_method) \{}
\DoxyCodeLine{80       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} = diag\_method;}
\DoxyCodeLine{81    \}}
\DoxyCodeLine{82    }
\DoxyCodeLine{83    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a65480d7568c98d230c50e6c9d3731341}{CalculateGroundState}}() \{}
\DoxyCodeLine{84       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetCalculatedEigenvectorSet().count(0) != 0) \{}
\DoxyCodeLine{85          \textcolor{keywordflow}{return};}
\DoxyCodeLine{86       \}}
\DoxyCodeLine{87       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis();}
\DoxyCodeLine{88       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} ham;}
\DoxyCodeLine{89       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\&ham);}
\DoxyCodeLine{90       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.size() == 0) \{}
\DoxyCodeLine{91          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.emplace\_back();}
\DoxyCodeLine{92       \}}
\DoxyCodeLine{93       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size() == 0) \{}
\DoxyCodeLine{94          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.emplace\_back();}
\DoxyCodeLine{95       \}}
\DoxyCodeLine{96       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}}) \{}
\DoxyCodeLine{97          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{sparse\_matrix::EigenvalueDecompositionLanczos}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], ham, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}});}
\DoxyCodeLine{98       \}}
\DoxyCodeLine{99       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522a779f87f3b11a08240fd9da58d90071fe}{DiagMethod::LOBPCG}}) \{}
\DoxyCodeLine{100          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086}{sparse\_matrix::EigenvalueDecompositionLOBPCG}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], ham, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}});}
\DoxyCodeLine{101       \}}
\DoxyCodeLine{102       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{103          std::stringstream ss;}
\DoxyCodeLine{104          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{105          ss << \textcolor{stringliteral}{"{}Invalid diagonalization method detected."{}} << std::endl;}
\DoxyCodeLine{106          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{107       \}}
\DoxyCodeLine{108       }
\DoxyCodeLine{109       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61}{sparse\_matrix::InverseIteration}}(\&ham, \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{ii}});}
\DoxyCodeLine{110       }
\DoxyCodeLine{111       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.SetCalculatedEigenvectorSet(0);}
\DoxyCodeLine{112    \}}
\DoxyCodeLine{113    }
\DoxyCodeLine{114    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a22420e816fb2c86f9e710312e8f346e2}{CalculateTargetState}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_sector) \{}
\DoxyCodeLine{115       \textcolor{keywordflow}{if} (target\_sector < 0) \{}
\DoxyCodeLine{116          std::stringstream ss;}
\DoxyCodeLine{117          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{118          ss << \textcolor{stringliteral}{"{}Invalid target\_sector: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{119          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{120       \}}
\DoxyCodeLine{121       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a65480d7568c98d230c50e6c9d3731341}{CalculateGroundState}}();}
\DoxyCodeLine{122       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetCalculatedEigenvectorSet().count(target\_sector) != 0) \{}
\DoxyCodeLine{123          \textcolor{keywordflow}{return};}
\DoxyCodeLine{124       \}}
\DoxyCodeLine{125       }
\DoxyCodeLine{126       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis();}
\DoxyCodeLine{127       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} ham;}
\DoxyCodeLine{128       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\&ham);}
\DoxyCodeLine{129       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}}) \{}
\DoxyCodeLine{130          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} sector = 1; sector <= target\_sector; ++sector) \{}
\DoxyCodeLine{131             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetCalculatedEigenvectorSet().count(sector) == 0) \{}
\DoxyCodeLine{132                \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size()) != sector) \{}
\DoxyCodeLine{133                   std::stringstream ss;}
\DoxyCodeLine{134                   ss << \textcolor{stringliteral}{"{}Unknown Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{135                   ss << \textcolor{stringliteral}{"{}sector: "{}} << sector << \textcolor{stringliteral}{"{}, size: "{}} << \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size() << std::endl;}
\DoxyCodeLine{136                   \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{137                \}}
\DoxyCodeLine{138                \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} temp\_vector(ham.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{139                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_value = 0.0;}
\DoxyCodeLine{140                \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{sparse\_matrix::EigenvalueDecompositionLanczos}}(\&temp\_value, \&temp\_vector, ham, sector, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}});}
\DoxyCodeLine{141                \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61}{sparse\_matrix::InverseIteration}}(\&ham, \&temp\_vector, temp\_value, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3df51c8ae6b33c3736a291cc5fd1f439}{params}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{ii}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}});}
\DoxyCodeLine{142                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.push\_back(temp\_value);}
\DoxyCodeLine{143                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.push\_back(temp\_vector);}
\DoxyCodeLine{144                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.SetCalculatedEigenvectorSet(sector);}
\DoxyCodeLine{145             \}}
\DoxyCodeLine{146          \}}
\DoxyCodeLine{147       \}}
\DoxyCodeLine{148       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522a779f87f3b11a08240fd9da58d90071fe}{DiagMethod::LOBPCG}}) \{}
\DoxyCodeLine{149          std::stringstream ss;}
\DoxyCodeLine{150          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{151          ss << \textcolor{stringliteral}{"{}LOBPCG is under construction: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{152          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{153       \}}
\DoxyCodeLine{154       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{155          std::stringstream ss;}
\DoxyCodeLine{156          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{157          ss << \textcolor{stringliteral}{"{}Invalid diag\_method: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{158          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{159       \}}
\DoxyCodeLine{160       }
\DoxyCodeLine{161    \}}
\DoxyCodeLine{162    }
\DoxyCodeLine{163    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1aafb57ecb9c2dcc044f4a6828cc93e8}{CalculateExpectationValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} level = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{164       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetCalculatedEigenvectorSet().count(level) == 0) \{}
\DoxyCodeLine{165          std::stringstream ss;}
\DoxyCodeLine{166          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{167          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{168          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{169       \}}
\DoxyCodeLine{170       }
\DoxyCodeLine{171       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis     = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetTargetBasis();}
\DoxyCodeLine{172       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{173       }
\DoxyCodeLine{174       \textcolor{keyword}{const} std::int64\_t dim = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(level).val.size();}
\DoxyCodeLine{175       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size()) != dim || \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_inv.size()) != dim) \{}
\DoxyCodeLine{176          std::stringstream ss;}
\DoxyCodeLine{177          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{178          ss << \textcolor{stringliteral}{"{}Unknown error detected"{}} << std::endl;}
\DoxyCodeLine{179          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{180       \}}
\DoxyCodeLine{181       }
\DoxyCodeLine{182       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{183       \textcolor{keyword}{const} std::int64\_t site\_constant = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site));}
\DoxyCodeLine{184       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(level);}
\DoxyCodeLine{185       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{186       }
\DoxyCodeLine{187 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: val)}}
\DoxyCodeLine{188       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{189          \textcolor{keyword}{const} std::int64\_t global\_basis = basis[i];}
\DoxyCodeLine{190          \textcolor{keyword}{const} \textcolor{keywordtype}{int}          local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite);}
\DoxyCodeLine{191          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{192          \textcolor{keywordflow}{for} (std::int64\_t j = m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{193             \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant;}
\DoxyCodeLine{194             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{195                temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_inv.at(a\_basis)]*m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{196             \}}
\DoxyCodeLine{197          \}}
\DoxyCodeLine{198          val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*temp\_val;}
\DoxyCodeLine{199       \}}
\DoxyCodeLine{200       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{201    \}}
\DoxyCodeLine{202    }
\DoxyCodeLine{203    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{204       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1aafb57ecb9c2dcc044f4a6828cc93e8}{CalculateExpectationValue}}(m, site, target\_level);}
\DoxyCodeLine{205    \}}
\DoxyCodeLine{206    }
\DoxyCodeLine{207    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a490b6895fcfb239a483be3dd2f10134a}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{208       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{209          std::stringstream ss;}
\DoxyCodeLine{210          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{211          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{212          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{213       \}}
\DoxyCodeLine{214       }
\DoxyCodeLine{215       \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} || m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} || m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{216          std::stringstream ss;}
\DoxyCodeLine{217          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{218          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{219          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{220       \}}
\DoxyCodeLine{221       }
\DoxyCodeLine{222       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} m1\_dagger = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{223       }
\DoxyCodeLine{224       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors  = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateTargetSector(m1\_dagger, m\_2);}
\DoxyCodeLine{225       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{226       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{227       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{228       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{229       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{230       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m1;}
\DoxyCodeLine{231       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m2;}
\DoxyCodeLine{232       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{233       }
\DoxyCodeLine{234       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&sector: target\_sectors) \{}
\DoxyCodeLine{235          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis(sector);}
\DoxyCodeLine{236          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasis(sector);}
\DoxyCodeLine{237          \textcolor{keyword}{const} std::int64\_t dim\_target = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size());}
\DoxyCodeLine{238          vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target);}
\DoxyCodeLine{239          vector\_work\_m2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target);}
\DoxyCodeLine{240 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{241          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target; ++i) \{}
\DoxyCodeLine{242             \textcolor{keyword}{const} std::int64\_t global\_basis = basis[i];}
\DoxyCodeLine{243             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{244             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{245             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m1 = 0.0;}
\DoxyCodeLine{246             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m2 = 0.0;}
\DoxyCodeLine{247             }
\DoxyCodeLine{248             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{249             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{250                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{251                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{252                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{253                \}}
\DoxyCodeLine{254                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{255                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{256                \}}
\DoxyCodeLine{257             \}}
\DoxyCodeLine{258             }
\DoxyCodeLine{259             \textcolor{keywordflow}{for} (std::int64\_t j = m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1]; j < m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1 + 1]; ++j)\{}
\DoxyCodeLine{260                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m1 -\/ m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{261                \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{262                   temp\_val\_m1 += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_inv.at(a\_basis)]*m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{263                \}}
\DoxyCodeLine{264             \}}
\DoxyCodeLine{265             vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m1*fermion\_sign\_m1;}
\DoxyCodeLine{266             }
\DoxyCodeLine{267             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{268             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{269                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{270                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_2; site++) \{}
\DoxyCodeLine{271                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{272                \}}
\DoxyCodeLine{273                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{274                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{275                \}}
\DoxyCodeLine{276             \}}
\DoxyCodeLine{277             }
\DoxyCodeLine{278             \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{279                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{280                \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{281                   temp\_val\_m2 += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_inv.at(a\_basis)]*m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{282                \}}
\DoxyCodeLine{283             \}}
\DoxyCodeLine{284             vector\_work\_m2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m2*fermion\_sign\_m2;}
\DoxyCodeLine{285          \}}
\DoxyCodeLine{286          val += \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{sparse\_matrix::CalculateInnerProduct}}(vector\_work\_m1, vector\_work\_m2);}
\DoxyCodeLine{287       \}}
\DoxyCodeLine{288       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{289    \}}
\DoxyCodeLine{290    }
\DoxyCodeLine{291    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ae5779b9d1389557e8dcf81b91e978507}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{292                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{293                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_3,}
\DoxyCodeLine{294                                          \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{295       }
\DoxyCodeLine{296       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{297          std::stringstream ss;}
\DoxyCodeLine{298          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{299          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{300          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{301       \}}
\DoxyCodeLine{302       }
\DoxyCodeLine{303       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{304       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{305       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{306       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c4 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} \&\& m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{307       }
\DoxyCodeLine{308       \textcolor{keywordflow}{if} (!(c1 \&\& c2 \&\& c3 \&\& c4)) \{}
\DoxyCodeLine{309          std::stringstream ss;}
\DoxyCodeLine{310          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{311          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{312          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{313       \}}
\DoxyCodeLine{314       }
\DoxyCodeLine{315       \textcolor{keywordflow}{if} (site\_1 == site\_2) \{}
\DoxyCodeLine{316          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1*m\_2, site\_1, m\_3, site\_3, target\_level);}
\DoxyCodeLine{317       \}}
\DoxyCodeLine{318       \textcolor{keywordflow}{if} (site\_2 == site\_3) \{}
\DoxyCodeLine{319          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2*m\_3, site\_3, target\_level);}
\DoxyCodeLine{320       \}}
\DoxyCodeLine{321       }
\DoxyCodeLine{322       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}  m1\_dagger      = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{323       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateTargetSector(m1\_dagger, m\_2, m\_3);}
\DoxyCodeLine{324       }
\DoxyCodeLine{325       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_gs\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{326       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{327       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{328       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{329       \textcolor{keyword}{const} std::int64\_t site\_constant\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_3));}
\DoxyCodeLine{330       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{331       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_a;}
\DoxyCodeLine{332       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_b;}
\DoxyCodeLine{333       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_c;}
\DoxyCodeLine{334       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{335       }
\DoxyCodeLine{336       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: target\_sectors) \{}
\DoxyCodeLine{337          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_m1 = std::get<0>(it);}
\DoxyCodeLine{338          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_m3 = std::get<1>(it);}
\DoxyCodeLine{339          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis(sector\_m1);}
\DoxyCodeLine{340          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis(sector\_m3);}
\DoxyCodeLine{341          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasis(sector\_m1);}
\DoxyCodeLine{342          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m3 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasis(sector\_m3);}
\DoxyCodeLine{343          \textcolor{keyword}{const} std::int64\_t dim\_target\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_m1.size());}
\DoxyCodeLine{344          \textcolor{keyword}{const} std::int64\_t dim\_target\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_m3.size());}
\DoxyCodeLine{345          }
\DoxyCodeLine{346          \textcolor{comment}{//m3|gs>}}
\DoxyCodeLine{347          vector\_work\_a.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_m3);}
\DoxyCodeLine{348 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{349          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_m3; ++i) \{}
\DoxyCodeLine{350             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_m3[i];}
\DoxyCodeLine{351             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_3, dim\_onsite);}
\DoxyCodeLine{352             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{353             }
\DoxyCodeLine{354             \textcolor{keywordtype}{int} fermion\_sign\_m3 = 1;}
\DoxyCodeLine{355             \textcolor{keywordflow}{if} (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{356                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{357                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{358                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{359                \}}
\DoxyCodeLine{360                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{361                   fermion\_sign\_m3 = -\/1;}
\DoxyCodeLine{362                \}}
\DoxyCodeLine{363             \}}
\DoxyCodeLine{364             }
\DoxyCodeLine{365             \textcolor{keywordflow}{for} (std::int64\_t j = m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{366                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m3;}
\DoxyCodeLine{367                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{368                   temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{369                \}}
\DoxyCodeLine{370             \}}
\DoxyCodeLine{371             vector\_work\_a.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m3;}
\DoxyCodeLine{372          \}}
\DoxyCodeLine{373          }
\DoxyCodeLine{374          \textcolor{comment}{//m2 * m3|gs> and m1\_dag|gs>}}
\DoxyCodeLine{375          vector\_work\_b.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_m1);}
\DoxyCodeLine{376          vector\_work\_c.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_m1);}
\DoxyCodeLine{377          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m3\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasisInv(sector\_m3);}
\DoxyCodeLine{378 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{379          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_m1; ++i) \{}
\DoxyCodeLine{380             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_m1[i];}
\DoxyCodeLine{381             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{382             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{383             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m1 = 0.0;}
\DoxyCodeLine{384             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m2 = 0.0;}
\DoxyCodeLine{385             }
\DoxyCodeLine{386             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{387             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{388                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{389                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{390                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{391                \}}
\DoxyCodeLine{392                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{393                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{394                \}}
\DoxyCodeLine{395             \}}
\DoxyCodeLine{396             }
\DoxyCodeLine{397             \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{398                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{399                \textcolor{keywordflow}{if} (basis\_m3\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{400                   temp\_val\_m2 += vector\_work\_a.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_m3\_sector\_inv.at(a\_basis)]*m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{401                \}}
\DoxyCodeLine{402             \}}
\DoxyCodeLine{403             vector\_work\_b.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m2*fermion\_sign\_m2;}
\DoxyCodeLine{404             }
\DoxyCodeLine{405             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{406             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{407                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{408                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{409                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{410                \}}
\DoxyCodeLine{411                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{412                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{413                \}}
\DoxyCodeLine{414             \}}
\DoxyCodeLine{415             }
\DoxyCodeLine{416             \textcolor{keywordflow}{for} (std::int64\_t j = m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1]; j < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m1 + 1]; ++j)\{}
\DoxyCodeLine{417                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m1 -\/ m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{418                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{419                   temp\_val\_m1 += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{420                \}}
\DoxyCodeLine{421             \}}
\DoxyCodeLine{422             vector\_work\_c.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val\_m1*fermion\_sign\_m1;}
\DoxyCodeLine{423          \}}
\DoxyCodeLine{424          val += \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{sparse\_matrix::CalculateInnerProduct}}(vector\_work\_b, vector\_work\_c);}
\DoxyCodeLine{425       \}}
\DoxyCodeLine{426       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{427    \}}
\DoxyCodeLine{428    }
\DoxyCodeLine{429    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7c3c205f875f049444abaa9f17d2faeb}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{430                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{431                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_3,}
\DoxyCodeLine{432                                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_4, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_4,}
\DoxyCodeLine{433                                          \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{434       }
\DoxyCodeLine{435       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{436          std::stringstream ss;}
\DoxyCodeLine{437          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{438          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{439          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{440       \}}
\DoxyCodeLine{441       }
\DoxyCodeLine{442       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{443       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{444       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{445       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c4 = (m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{446       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c5 = (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} \&\& m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} \&\& m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{447       }
\DoxyCodeLine{448       \textcolor{keywordflow}{if} (!(c1 \&\& c2 \&\& c3 \&\& c4 \&\& c5)) \{}
\DoxyCodeLine{449          std::stringstream ss;}
\DoxyCodeLine{450          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{451          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{452          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{453       \}}
\DoxyCodeLine{454       }
\DoxyCodeLine{455       \textcolor{keywordflow}{if} (site\_1 == site\_2) \{}
\DoxyCodeLine{456          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1*m\_2, site\_1, m\_3, site\_3, m\_4, site\_4);}
\DoxyCodeLine{457       \}}
\DoxyCodeLine{458       \textcolor{keywordflow}{if} (site\_2 == site\_3) \{}
\DoxyCodeLine{459          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2*m\_3, site\_2, m\_4, site\_4);}
\DoxyCodeLine{460       \}}
\DoxyCodeLine{461       \textcolor{keywordflow}{if} (site\_3 == site\_4) \{}
\DoxyCodeLine{462          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2, site\_2, m\_3*m\_4, site\_3);}
\DoxyCodeLine{463       \}}
\DoxyCodeLine{464       }
\DoxyCodeLine{465       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}  m1\_dagger = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{466       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}  m2\_dagger = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(m\_2);}
\DoxyCodeLine{467       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateTargetSector(m1\_dagger, m2\_dagger, m\_3, m\_4);}
\DoxyCodeLine{468       }
\DoxyCodeLine{469       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_gs\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{470       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{471       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{472       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{473       \textcolor{keyword}{const} std::int64\_t site\_constant\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_3));}
\DoxyCodeLine{474       \textcolor{keyword}{const} std::int64\_t site\_constant\_m4 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_4));}
\DoxyCodeLine{475       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{476       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m1;}
\DoxyCodeLine{477       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m2m1;}
\DoxyCodeLine{478       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m4;}
\DoxyCodeLine{479       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} vector\_work\_m3m4;}
\DoxyCodeLine{480       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{481       }
\DoxyCodeLine{482       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: target\_sectors) \{}
\DoxyCodeLine{483          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_bra\_change\_1 = std::get<0>(it);}
\DoxyCodeLine{484          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_bra\_change\_2 = std::get<1>(it);}
\DoxyCodeLine{485          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_ket\_change\_1 = std::get<2>(it);}
\DoxyCodeLine{486          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis(sector\_bra\_change\_1);}
\DoxyCodeLine{487          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis(sector\_bra\_change\_2);}
\DoxyCodeLine{488          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GenerateBasis(sector\_ket\_change\_1);}
\DoxyCodeLine{489          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasis(sector\_bra\_change\_1);}
\DoxyCodeLine{490          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasis(sector\_bra\_change\_2);}
\DoxyCodeLine{491          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_ket\_1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasis(sector\_ket\_change\_1);}
\DoxyCodeLine{492          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_ket\_1\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasisInv(sector\_ket\_change\_1);}
\DoxyCodeLine{493          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_1\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetBasisInv(sector\_bra\_change\_1);}
\DoxyCodeLine{494          \textcolor{keyword}{const} std::int64\_t dim\_target\_bra\_1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_bra\_1.size());}
\DoxyCodeLine{495          \textcolor{keyword}{const} std::int64\_t dim\_target\_bra\_2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_bra\_2.size());}
\DoxyCodeLine{496          \textcolor{keyword}{const} std::int64\_t dim\_target\_ket\_1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_ket\_1.size());}
\DoxyCodeLine{497          }
\DoxyCodeLine{498          \textcolor{comment}{//m4|gs>}}
\DoxyCodeLine{499          vector\_work\_m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_ket\_1);}
\DoxyCodeLine{500 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{501          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_ket\_1; ++i) \{}
\DoxyCodeLine{502             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_ket\_1[i];}
\DoxyCodeLine{503             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_4, dim\_onsite);}
\DoxyCodeLine{504             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{505             }
\DoxyCodeLine{506             \textcolor{keywordtype}{int} fermion\_sign\_m4 = 1;}
\DoxyCodeLine{507             \textcolor{keywordflow}{if} (m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{508                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{509                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{510                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{511                \}}
\DoxyCodeLine{512                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{513                   fermion\_sign\_m4 = -\/1;}
\DoxyCodeLine{514                \}}
\DoxyCodeLine{515             \}}
\DoxyCodeLine{516             }
\DoxyCodeLine{517             \textcolor{keywordflow}{for} (std::int64\_t j = m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{518                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m4;}
\DoxyCodeLine{519                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{520                   temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m\_4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{521                \}}
\DoxyCodeLine{522             \}}
\DoxyCodeLine{523             vector\_work\_m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m4;}
\DoxyCodeLine{524          \}}
\DoxyCodeLine{525          }
\DoxyCodeLine{526          \textcolor{comment}{//m1\_dag|gs>}}
\DoxyCodeLine{527          vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_bra\_1);}
\DoxyCodeLine{528 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{529          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_bra\_1; ++i) \{}
\DoxyCodeLine{530             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_bra\_1[i];}
\DoxyCodeLine{531             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{532             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{533             }
\DoxyCodeLine{534             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{535             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{536                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{537                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{538                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{539                \}}
\DoxyCodeLine{540                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{541                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{542                \}}
\DoxyCodeLine{543             \}}
\DoxyCodeLine{544             }
\DoxyCodeLine{545             \textcolor{keywordflow}{for} (std::int64\_t j = m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis]; j < m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{546                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{547                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{548                   temp\_val += eigenvector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_gs\_sector\_inv.at(a\_basis)]*m1\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{549                \}}
\DoxyCodeLine{550             \}}
\DoxyCodeLine{551             vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m1;}
\DoxyCodeLine{552          \}}
\DoxyCodeLine{553          }
\DoxyCodeLine{554          \textcolor{comment}{//m3 * m4|gs> and m2\_dag * m1\_dag|gs>}}
\DoxyCodeLine{555          vector\_work\_m3m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_bra\_2);}
\DoxyCodeLine{556          vector\_work\_m2m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim\_target\_bra\_2);}
\DoxyCodeLine{557          }
\DoxyCodeLine{558 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{559          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_bra\_2; ++i) \{}
\DoxyCodeLine{560             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_bra\_2[i];}
\DoxyCodeLine{561             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{562             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m3 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_3, dim\_onsite);}
\DoxyCodeLine{563             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{564             }
\DoxyCodeLine{565             \textcolor{keywordtype}{int} fermion\_sign\_m3 = 1;}
\DoxyCodeLine{566             \textcolor{keywordflow}{if} (m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{567                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{568                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{569                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{570                \}}
\DoxyCodeLine{571                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{572                   fermion\_sign\_m3 = -\/1;}
\DoxyCodeLine{573                \}}
\DoxyCodeLine{574             \}}
\DoxyCodeLine{575             }
\DoxyCodeLine{576             \textcolor{keywordflow}{for} (std::int64\_t j = m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m3]; j < m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m3 + 1]; ++j)\{}
\DoxyCodeLine{577                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m3 -\/ m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m3;}
\DoxyCodeLine{578                \textcolor{keywordflow}{if} (basis\_ket\_1\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{579                   temp\_val += vector\_work\_m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_ket\_1\_inv.at(a\_basis)]*m\_3.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{580                \}}
\DoxyCodeLine{581             \}}
\DoxyCodeLine{582             vector\_work\_m3m4.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m3;}
\DoxyCodeLine{583             }
\DoxyCodeLine{584             temp\_val = 0.0;}
\DoxyCodeLine{585             }
\DoxyCodeLine{586             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{587             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}}) \{}
\DoxyCodeLine{588                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{589                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{590                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{591                \}}
\DoxyCodeLine{592                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{593                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{594                \}}
\DoxyCodeLine{595             \}}
\DoxyCodeLine{596             }
\DoxyCodeLine{597             \textcolor{keywordflow}{for} (std::int64\_t j = m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2]; j < m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{598                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{599                \textcolor{keywordflow}{if} (basis\_bra\_1\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{600                   temp\_val += vector\_work\_m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[basis\_bra\_1\_inv.at(a\_basis)]*m2\_dagger.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{601                \}}
\DoxyCodeLine{602             \}}
\DoxyCodeLine{603             vector\_work\_m2m1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*fermion\_sign\_m2;}
\DoxyCodeLine{604          \}}
\DoxyCodeLine{605          val += \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{sparse\_matrix::CalculateInnerProduct}}(vector\_work\_m2m1, vector\_work\_m3m4);}
\DoxyCodeLine{606       \}}
\DoxyCodeLine{607       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{608    \}}
\DoxyCodeLine{609    }
\DoxyCodeLine{610    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<BraketVector> \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3998505c06a97dc70312e94409ac1770}{GetEigenvectors}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}; \}}
\DoxyCodeLine{611    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<RealType>     \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acaaec962f1fe4e3fcddc0b1e2ecebfc6}{GetEigenvalues}}()\textcolor{keyword}{  const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}; \}}
\DoxyCodeLine{612    }
\DoxyCodeLine{613 \textcolor{keyword}{private}:}
\DoxyCodeLine{614    std::vector<BraketVector> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}};}
\DoxyCodeLine{615    std::vector<RealType>     \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}};}
\DoxyCodeLine{616    \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522}{DiagMethod}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} = \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}};}
\DoxyCodeLine{617    }
\DoxyCodeLine{618    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(std::int64\_t global\_basis, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{619       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < site; ++i) \{}
\DoxyCodeLine{620          global\_basis = global\_basis/dim\_onsite;}
\DoxyCodeLine{621       \}}
\DoxyCodeLine{622       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(global\_basis\%dim\_onsite);}
\DoxyCodeLine{623    \}}
\DoxyCodeLine{624    }
\DoxyCodeLine{625    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2bb4b34128d7fee7583bbe8b34f7fd35}{GenerateMatrixComponentsOnsite}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} *edmc,}
\DoxyCodeLine{626                                        \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{627                                        \textcolor{keyword}{const} \textcolor{keywordtype}{int} site,}
\DoxyCodeLine{628                                        \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix\_onsite,}
\DoxyCodeLine{629                                        \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} coeef)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{630       }
\DoxyCodeLine{631       \textcolor{keywordflow}{if} (std::abs(coeef) <= edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a318fc7257796f0900c15e0b4fcfcd2da}{zero\_precision}}) \{}
\DoxyCodeLine{632          \textcolor{keywordflow}{return};}
\DoxyCodeLine{633       \}}
\DoxyCodeLine{634       }
\DoxyCodeLine{635       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[site];}
\DoxyCodeLine{636       \textcolor{keyword}{const} std::int64\_t site\_constant = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a24e24b66e5cceb045bf3a8b5f3a35398}{site\_constant}}[site];}
\DoxyCodeLine{637       }
\DoxyCodeLine{638       \textcolor{keywordflow}{for} (std::int64\_t i = matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite]; i < matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite + 1]; ++i) \{}
\DoxyCodeLine{639          \textcolor{keyword}{const} std::int64\_t a\_basis = basis + (matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i] -\/ basis\_onsite)*site\_constant;}
\DoxyCodeLine{640          \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}.count(a\_basis) == 0) \{}
\DoxyCodeLine{641             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}[a\_basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.size();}
\DoxyCodeLine{642             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}}.push\_back(coeef*matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i]);}
\DoxyCodeLine{643             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.push\_back(a\_basis);}
\DoxyCodeLine{644          \}}
\DoxyCodeLine{645          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{646             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}}[edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}.at(a\_basis)] += coeef*matrix\_onsite.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i];}
\DoxyCodeLine{647          \}}
\DoxyCodeLine{648       \}}
\DoxyCodeLine{649    \}}
\DoxyCodeLine{650    }
\DoxyCodeLine{651    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} *edmc,}
\DoxyCodeLine{652                                           \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{653                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{654                                           \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix\_onsite\_1,}
\DoxyCodeLine{655                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{656                                           \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix\_onsite\_2,}
\DoxyCodeLine{657                                           \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} coeef,}
\DoxyCodeLine{658                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} fermion\_sign = 1.0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{659       }
\DoxyCodeLine{660       \textcolor{keywordflow}{if} (std::abs(coeef) <= edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a318fc7257796f0900c15e0b4fcfcd2da}{zero\_precision}}) \{}
\DoxyCodeLine{661          \textcolor{keywordflow}{return};}
\DoxyCodeLine{662       \}}
\DoxyCodeLine{663       }
\DoxyCodeLine{664       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite\_1  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[site\_1];}
\DoxyCodeLine{665       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite\_2  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[site\_2];}
\DoxyCodeLine{666       \textcolor{keyword}{const} std::int64\_t site\_constant\_1 = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a24e24b66e5cceb045bf3a8b5f3a35398}{site\_constant}}[site\_1];}
\DoxyCodeLine{667       \textcolor{keyword}{const} std::int64\_t site\_constant\_2 = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a24e24b66e5cceb045bf3a8b5f3a35398}{site\_constant}}[site\_2];}
\DoxyCodeLine{668       }
\DoxyCodeLine{669       \textcolor{keywordflow}{for} (std::int64\_t i1 = matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_1]; i1 < matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_1 + 1]; ++i1) \{}
\DoxyCodeLine{670          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val\_1 = matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i1];}
\DoxyCodeLine{671          \textcolor{keyword}{const} std::int64\_t col\_1 = matrix\_onsite\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i1];}
\DoxyCodeLine{672          \textcolor{keywordflow}{for} (std::int64\_t i2 = matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_2]; i2 < matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[basis\_onsite\_2 + 1]; ++i2) \{}
\DoxyCodeLine{673             \textcolor{keyword}{const} std::int64\_t a\_basis = basis + (col\_1 -\/ basis\_onsite\_1)*site\_constant\_1 + (matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i2] -\/ basis\_onsite\_2)*site\_constant\_2;}
\DoxyCodeLine{674             \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}.count(a\_basis) == 0) \{}
\DoxyCodeLine{675                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}[a\_basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.size();}
\DoxyCodeLine{676                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}}.push\_back(fermion\_sign*coeef*val\_1*matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i2]);}
\DoxyCodeLine{677                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.push\_back(a\_basis);}
\DoxyCodeLine{678             \}}
\DoxyCodeLine{679             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{680                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}}[edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}.at(a\_basis)] += fermion\_sign*coeef*val\_1*matrix\_onsite\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i2];}
\DoxyCodeLine{681             \}}
\DoxyCodeLine{682          \}}
\DoxyCodeLine{683       \}}
\DoxyCodeLine{684    \}}
\DoxyCodeLine{685    }
\DoxyCodeLine{686    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} *ham)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{687       \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{688       std::cout << \textcolor{stringliteral}{"{}Generating Hamiltonian..."{}} << std::flush;}
\DoxyCodeLine{689       }
\DoxyCodeLine{690       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis     = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetTargetBasis();}
\DoxyCodeLine{691       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{692       }
\DoxyCodeLine{693       \textcolor{keyword}{const} std::int64\_t dim\_target = basis.size();}
\DoxyCodeLine{694       std::int64\_t num\_total\_elements = 0;}
\DoxyCodeLine{695       }
\DoxyCodeLine{696 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{697       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{698       std::vector<ExactDiagMatrixComponents> components(num\_threads);}
\DoxyCodeLine{699       }
\DoxyCodeLine{700       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} thread\_num = 0; thread\_num < num\_threads; ++thread\_num) \{}
\DoxyCodeLine{701          components[thread\_num].site\_constant.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetSystemSize());}
\DoxyCodeLine{702          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetSystemSize(); ++site) \{}
\DoxyCodeLine{703             components[thread\_num].site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetDimOnsite(), site));}
\DoxyCodeLine{704          \}}
\DoxyCodeLine{705          components[thread\_num].basis\_onsite.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetSystemSize());}
\DoxyCodeLine{706       \}}
\DoxyCodeLine{707       }
\DoxyCodeLine{708       std::vector<std::int64\_t> num\_row\_element(dim\_target + 1);}
\DoxyCodeLine{709       }
\DoxyCodeLine{710 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{711       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{712          \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{713          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a83023c48b79025c582483ff440b81ab2}{GenerateMatrixComponents}}(\&components[thread\_num], basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}});}
\DoxyCodeLine{714          \textcolor{keyword}{const} std::size\_t size = components[thread\_num].basis\_affected.size();}
\DoxyCodeLine{715          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{716             \textcolor{keyword}{const} std::int64\_t a\_basis = components[thread\_num].basis\_affected[i];}
\DoxyCodeLine{717             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components[thread\_num].val[i];}
\DoxyCodeLine{718             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{719                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{720                \textcolor{keywordflow}{if} ((inv < row \&\& std::abs(val) > components[thread\_num].zero\_precision) || inv == row) \{}
\DoxyCodeLine{721                   num\_row\_element[row + 1]++;}
\DoxyCodeLine{722                \}}
\DoxyCodeLine{723             \}}
\DoxyCodeLine{724             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) == 0 \&\& std::abs(val) > components[thread\_num].zero\_precision) \{}
\DoxyCodeLine{725                \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Matrix elements are not in the target space"{}});}
\DoxyCodeLine{726             \}}
\DoxyCodeLine{727          \}}
\DoxyCodeLine{728          components[thread\_num].val.clear();}
\DoxyCodeLine{729          components[thread\_num].basis\_affected.clear();}
\DoxyCodeLine{730          components[thread\_num].inv\_basis\_affected.clear();}
\DoxyCodeLine{731       \}}
\DoxyCodeLine{732       }
\DoxyCodeLine{733 \textcolor{preprocessor}{\#pragma omp parallel for reduction(+:num\_total\_elements)}}
\DoxyCodeLine{734       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row <= dim\_target; ++row) \{}
\DoxyCodeLine{735          num\_total\_elements += num\_row\_element[row];}
\DoxyCodeLine{736       \}}
\DoxyCodeLine{737       }
\DoxyCodeLine{738       \textcolor{comment}{//Do not use openmp here}}
\DoxyCodeLine{739       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{740          num\_row\_element[row + 1] += num\_row\_element[row];}
\DoxyCodeLine{741       \}}
\DoxyCodeLine{742       }
\DoxyCodeLine{743       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.resize(dim\_target + 1);}
\DoxyCodeLine{744       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.resize(num\_total\_elements);}
\DoxyCodeLine{745       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.resize(num\_total\_elements);}
\DoxyCodeLine{746       }
\DoxyCodeLine{747 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{748       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{749          \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{750          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a83023c48b79025c582483ff440b81ab2}{GenerateMatrixComponents}}(\&components[thread\_num], basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}});}
\DoxyCodeLine{751          \textcolor{keyword}{const} std::size\_t size = components[thread\_num].basis\_affected.size();}
\DoxyCodeLine{752          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{753             \textcolor{keyword}{const} std::int64\_t a\_basis = components[thread\_num].basis\_affected[i];}
\DoxyCodeLine{754             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components[thread\_num].val[i];}
\DoxyCodeLine{755             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{756                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{757                \textcolor{keywordflow}{if} ((inv < row \&\& std::abs(val) > components[thread\_num].zero\_precision) || inv == row) \{}
\DoxyCodeLine{758                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[num\_row\_element[row]] = inv;}
\DoxyCodeLine{759                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[num\_row\_element[row]] = val;}
\DoxyCodeLine{760                   num\_row\_element[row]++;}
\DoxyCodeLine{761                \}}
\DoxyCodeLine{762             \}}
\DoxyCodeLine{763          \}}
\DoxyCodeLine{764          ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = num\_row\_element[row];}
\DoxyCodeLine{765          components[thread\_num].val.clear();}
\DoxyCodeLine{766          components[thread\_num].basis\_affected.clear();}
\DoxyCodeLine{767          components[thread\_num].inv\_basis\_affected.clear();}
\DoxyCodeLine{768       \}}
\DoxyCodeLine{769 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{770       \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} components;}
\DoxyCodeLine{771       components.\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a24e24b66e5cceb045bf3a8b5f3a35398}{site\_constant}}.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetSystemSize());}
\DoxyCodeLine{772       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetSystemSize(); ++site) \{}
\DoxyCodeLine{773          components.site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetDimOnsite(), site));}
\DoxyCodeLine{774       \}}
\DoxyCodeLine{775       components.basis\_onsite.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetSystemSize());}
\DoxyCodeLine{776       }
\DoxyCodeLine{777       std::vector<std::int64\_t> num\_row\_element(dim\_target + 1);}
\DoxyCodeLine{778       }
\DoxyCodeLine{779       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{780          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a83023c48b79025c582483ff440b81ab2}{GenerateMatrixComponents}}(\&components, basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}});}
\DoxyCodeLine{781          \textcolor{keyword}{const} std::size\_t size = components.basis\_affected.size();}
\DoxyCodeLine{782          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{783             \textcolor{keyword}{const} std::int64\_t a\_basis = components.basis\_affected[i];}
\DoxyCodeLine{784             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components.val[i];}
\DoxyCodeLine{785             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{786                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{787                \textcolor{keywordflow}{if} ((inv <= row \&\& std::abs(val) > components.zero\_precision) || inv == row) \{}
\DoxyCodeLine{788                   num\_row\_element[row + 1]++;}
\DoxyCodeLine{789                \}}
\DoxyCodeLine{790             \}}
\DoxyCodeLine{791             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) == 0 \&\& std::abs(val) > components.zero\_precision) \{}
\DoxyCodeLine{792                \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Matrix elements are not in the target space"{}});}
\DoxyCodeLine{793             \}}
\DoxyCodeLine{794          \}}
\DoxyCodeLine{795          components.val.clear();}
\DoxyCodeLine{796          components.basis\_affected.clear();}
\DoxyCodeLine{797          components.inv\_basis\_affected.clear();}
\DoxyCodeLine{798       \}}
\DoxyCodeLine{799       }
\DoxyCodeLine{800       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row <= dim\_target; ++row) \{}
\DoxyCodeLine{801          num\_total\_elements += num\_row\_element[row];}
\DoxyCodeLine{802       \}}
\DoxyCodeLine{803       }
\DoxyCodeLine{804       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{805          num\_row\_element[row + 1] += num\_row\_element[row];}
\DoxyCodeLine{806       \}}
\DoxyCodeLine{807       }
\DoxyCodeLine{808       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.resize(dim\_target + 1);}
\DoxyCodeLine{809       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.resize(num\_total\_elements);}
\DoxyCodeLine{810       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.resize(num\_total\_elements);}
\DoxyCodeLine{811       }
\DoxyCodeLine{812       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{813          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a83023c48b79025c582483ff440b81ab2}{GenerateMatrixComponents}}(\&components, basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}});}
\DoxyCodeLine{814          \textcolor{keyword}{const} std::size\_t size = components.basis\_affected.size();}
\DoxyCodeLine{815          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{816             \textcolor{keyword}{const} std::int64\_t a\_basis = components.basis\_affected[i];}
\DoxyCodeLine{817             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components.val[i];}
\DoxyCodeLine{818             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{819                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{820                \textcolor{keywordflow}{if} ((inv <= row \&\& std::abs(val) > components.zero\_precision) || inv == row) \{}
\DoxyCodeLine{821                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[num\_row\_element[row]] = inv;}
\DoxyCodeLine{822                   ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[num\_row\_element[row]] = val;}
\DoxyCodeLine{823                   num\_row\_element[row]++;}
\DoxyCodeLine{824                \}}
\DoxyCodeLine{825             \}}
\DoxyCodeLine{826          \}}
\DoxyCodeLine{827          ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = num\_row\_element[row];}
\DoxyCodeLine{828          components.val.clear();}
\DoxyCodeLine{829          components.basis\_affected.clear();}
\DoxyCodeLine{830          components.inv\_basis\_affected.clear();}
\DoxyCodeLine{831       \}}
\DoxyCodeLine{832 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{833       }
\DoxyCodeLine{834       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} = dim\_target;}
\DoxyCodeLine{835       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} = dim\_target;}
\DoxyCodeLine{836       }
\DoxyCodeLine{837       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_1 = (ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[dim\_target] != num\_total\_elements);}
\DoxyCodeLine{838       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_2 = (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size()) != num\_total\_elements);}
\DoxyCodeLine{839       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_3 = (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size()) != num\_total\_elements);}
\DoxyCodeLine{840       }
\DoxyCodeLine{841       \textcolor{keywordflow}{if} (flag\_check\_1 || flag\_check\_2 || flag\_check\_3) \{}
\DoxyCodeLine{842          std::stringstream ss;}
\DoxyCodeLine{843          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_  << std::endl;}
\DoxyCodeLine{844          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{845       \}}
\DoxyCodeLine{846       ham-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a461f3df023c6215768aca60b9743fe0c}{SortCol}}();}
\DoxyCodeLine{847       }
\DoxyCodeLine{848       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{849       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{sparse\_matrix::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{850       std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating Hamiltonian:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{851       }
\DoxyCodeLine{852    \}}
\DoxyCodeLine{853    }
\DoxyCodeLine{854    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a83023c48b79025c582483ff440b81ab2}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} *edmc, \textcolor{keyword}{const} std::int64\_t basis, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d}{model::XXZ\_1D<RealType>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{855       }
\DoxyCodeLine{856       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{857          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ac08fdfaf7f9574d95c5a450b67104dd2}{GetDimOnsite}}());}
\DoxyCodeLine{858       \}}
\DoxyCodeLine{859       }
\DoxyCodeLine{860       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{861       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{862          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2bb4b34128d7fee7583bbe8b34f7fd35}{GenerateMatrixComponentsOnsite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_a7c3fcd38df94b39b391da41ea03b8627}{GetOnsiteOperatorHam}}(), 1.0);}
\DoxyCodeLine{863       \}}
\DoxyCodeLine{864       }
\DoxyCodeLine{865       \textcolor{comment}{//Intersite elements SzSz}}
\DoxyCodeLine{866       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_a71c1c6125825d9e1f5140a98acbb89d9}{GetJz}}().size()); ++distance) \{}
\DoxyCodeLine{867          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{868             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a506fddc0454a4008ed2cda1315b59f1e}{GetOnsiteOperatorSz}}(), site + distance, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a506fddc0454a4008ed2cda1315b59f1e}{GetOnsiteOperatorSz}}(), model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_a71c1c6125825d9e1f5140a98acbb89d9}{GetJz}}(distance -\/ 1));}
\DoxyCodeLine{869          \}}
\DoxyCodeLine{870       \}}
\DoxyCodeLine{871       }
\DoxyCodeLine{872       \textcolor{comment}{//Intersite elements 0.5*(SpSm + SmSp) = SxSx + SySy}}
\DoxyCodeLine{873       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_ae2e059e92df952abb4a4965bf294bcd3}{GetJxy}}().size()); ++distance) \{}
\DoxyCodeLine{874          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{875             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af28691e881c5f8b981c8e6712b29283b}{GetOnsiteOperatorSp}}(), site + distance, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a66ad7be43af97b8162f2aadeda0512ad}{GetOnsiteOperatorSm}}(), 0.5*model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_ae2e059e92df952abb4a4965bf294bcd3}{GetJxy}}(distance -\/ 1));}
\DoxyCodeLine{876             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a66ad7be43af97b8162f2aadeda0512ad}{GetOnsiteOperatorSm}}(), site + distance, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af28691e881c5f8b981c8e6712b29283b}{GetOnsiteOperatorSp}}(), 0.5*model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_ae2e059e92df952abb4a4965bf294bcd3}{GetJxy}}(distance -\/ 1));}
\DoxyCodeLine{877          \}}
\DoxyCodeLine{878       \}}
\DoxyCodeLine{879       }
\DoxyCodeLine{880       \textcolor{keywordflow}{if} (model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_a31bd18cad182ab3e56e1160803dc2de4}{GetBoundaryCondition}}() == \mbox{\hyperlink{namespacecompnal_1_1model_a472b79d22175004cb119fcc099cdd49ba971a9be4942bbf28af21cd78bd5e6c15}{model::BoundaryCondition::PBC}}) \{}
\DoxyCodeLine{881          \textcolor{comment}{//Intersite elements SzSz}}
\DoxyCodeLine{882          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_a71c1c6125825d9e1f5140a98acbb89d9}{GetJz}}().size()); ++distance) \{}
\DoxyCodeLine{883             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{884                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{885                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{886                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a506fddc0454a4008ed2cda1315b59f1e}{GetOnsiteOperatorSz}}(), d2, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a506fddc0454a4008ed2cda1315b59f1e}{GetOnsiteOperatorSz}}(), model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_a71c1c6125825d9e1f5140a98acbb89d9}{GetJz}}(distance -\/ 1));}
\DoxyCodeLine{887             \}}
\DoxyCodeLine{888          \}}
\DoxyCodeLine{889          }
\DoxyCodeLine{890          \textcolor{comment}{//Intersite elements 0.5*(SpSm + SmSp) = SxSx + SySy}}
\DoxyCodeLine{891          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_ae2e059e92df952abb4a4965bf294bcd3}{GetJxy}}().size()); ++distance) \{}
\DoxyCodeLine{892             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{893                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{894                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{895                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af28691e881c5f8b981c8e6712b29283b}{GetOnsiteOperatorSp}}(), d2, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a66ad7be43af97b8162f2aadeda0512ad}{GetOnsiteOperatorSm}}(), 0.5*model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_x_x_z__1_d_ae2e059e92df952abb4a4965bf294bcd3}{GetJxy}}(distance -\/ 1));}
\DoxyCodeLine{896                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a66ad7be43af97b8162f2aadeda0512ad}{GetOnsiteOperatorSm}}(), d2, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af28691e881c5f8b981c8e6712b29283b}{GetOnsiteOperatorSp}}(), 0.5*\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetJxy(distance -\/ 1));}
\DoxyCodeLine{897             \}}
\DoxyCodeLine{898          \}}
\DoxyCodeLine{899       \}}
\DoxyCodeLine{900       }
\DoxyCodeLine{901       \textcolor{comment}{//Fill zero in the diagonal elements for symmetric matrix vector product calculation.}}
\DoxyCodeLine{902       \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}.count(basis) == 0) \{}
\DoxyCodeLine{903          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}[basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.size();}
\DoxyCodeLine{904          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}}.push\_back(0.0);}
\DoxyCodeLine{905          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.push\_back(basis);}
\DoxyCodeLine{906       \}}
\DoxyCodeLine{907       }
\DoxyCodeLine{908    \}}
\DoxyCodeLine{909    }
\DoxyCodeLine{910    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8dabf30e73ba8859c27d9bb5fdb60e42}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} *edmc, \textcolor{keyword}{const} std::int64\_t basis, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d}{model::Hubbard\_1D<RealType>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{911       }
\DoxyCodeLine{912       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&nc            = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ae4807dc416a3b14a3a6eddfcfa155463}{GetOnsiteOperatorNC}}();}
\DoxyCodeLine{913       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up          = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a15fe38d996c2d23748a2eb254807b882}{GetOnsiteOperatorCUp}}();}
\DoxyCodeLine{914       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up\_dagger   = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7a2de63620d20978d0d2d39c722222fd}{GetOnsiteOperatorCUpDagger}}();}
\DoxyCodeLine{915       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down        = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4dfc489bed6324d3d4092e3ae215c224}{GetOnsiteOperatorCDown}}();}
\DoxyCodeLine{916       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down\_dagger = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4892fdee7d5a231b434a6b0335c0cedd}{GetOnsiteOperatorCDownDagger}}();}
\DoxyCodeLine{917       }
\DoxyCodeLine{918       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{919          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af85f0a2c8d11d5fc5df37fab13068222}{GetDimOnsite}}());}
\DoxyCodeLine{920       \}}
\DoxyCodeLine{921       }
\DoxyCodeLine{922       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{923       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{924          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2bb4b34128d7fee7583bbe8b34f7fd35}{GenerateMatrixComponentsOnsite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a36690ef3139f372438941e9ea951ced5}{GetOnsiteOperatorHam}}(), 1.0);}
\DoxyCodeLine{925       \}}
\DoxyCodeLine{926       }
\DoxyCodeLine{927       \textcolor{comment}{//Intersite Coulomb}}
\DoxyCodeLine{928       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}().size()); ++distance) \{}
\DoxyCodeLine{929          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{930             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, nc, site + distance, nc, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}(distance -\/ 1));}
\DoxyCodeLine{931          \}}
\DoxyCodeLine{932       \}}
\DoxyCodeLine{933       }
\DoxyCodeLine{934       \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{935       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{936          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{937             \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{938             \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{939             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = site; s < site + distance; ++s) \{}
\DoxyCodeLine{940                n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a465e32e606632a760db7e21c8c1c3e72}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[s]);}
\DoxyCodeLine{941             \}}
\DoxyCodeLine{942             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up\_dagger  , site + distance, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{943             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up         , site + distance, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{944             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down\_dagger, site + distance, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{945             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down       , site + distance, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{946          \}}
\DoxyCodeLine{947       \}}
\DoxyCodeLine{948       }
\DoxyCodeLine{949       \textcolor{keywordflow}{if} (model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a2b552c2cb6d887c1112ef431c22ed508}{GetBoundaryCondition}}() == \mbox{\hyperlink{namespacecompnal_1_1model_a472b79d22175004cb119fcc099cdd49ba971a9be4942bbf28af21cd78bd5e6c15}{model::BoundaryCondition::PBC}}) \{}
\DoxyCodeLine{950          \textcolor{comment}{//Intersite Coulomb}}
\DoxyCodeLine{951          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}().size()); ++distance) \{}
\DoxyCodeLine{952             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{953                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{954                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{955                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, nc, d2, nc, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}(distance -\/ 1));}
\DoxyCodeLine{956             \}}
\DoxyCodeLine{957          \}}
\DoxyCodeLine{958          }
\DoxyCodeLine{959          \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{960          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{961             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{962                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{963                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{964                \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{965                \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{966                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = d2; s < d2 + d1; ++s) \{}
\DoxyCodeLine{967                   n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a465e32e606632a760db7e21c8c1c3e72}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[s]);}
\DoxyCodeLine{968                \}}
\DoxyCodeLine{969                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_up\_dagger  , d2, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{970                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_up         , d2, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{971                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_down\_dagger, d2, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{972                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_down       , d2, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{973             \}}
\DoxyCodeLine{974          \}}
\DoxyCodeLine{975       \}}
\DoxyCodeLine{976       }
\DoxyCodeLine{977       \textcolor{comment}{//Fill zero in the diagonal elements for symmetric matrix vector product calculation.}}
\DoxyCodeLine{978       \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}.count(basis) == 0) \{}
\DoxyCodeLine{979          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}[basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.size();}
\DoxyCodeLine{980          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}}.push\_back(0.0);}
\DoxyCodeLine{981          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.push\_back(basis);}
\DoxyCodeLine{982       \}}
\DoxyCodeLine{983       }
\DoxyCodeLine{984    \}}
\DoxyCodeLine{985    }
\DoxyCodeLine{986    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0c8a65304f1bcd6df1a47f84d4eb7ebc}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} *edmc, \textcolor{keyword}{const} std::int64\_t basis, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d}{model::KondoLattice\_1D<RealType>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{987       }
\DoxyCodeLine{988       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up          = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a65f4321d5d41b8898b4dcf17dd83329d}{GetOnsiteOperatorCUp}}();}
\DoxyCodeLine{989       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up\_dagger   = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a3686b4987cd45b9524faa073e1834cbb}{GetOnsiteOperatorCUpDagger}}();}
\DoxyCodeLine{990       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down        = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a114ca4b0dec996f77b7f85c7f846f1b4}{GetOnsiteOperatorCDown}}();}
\DoxyCodeLine{991       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down\_dagger = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a4698ebcfbb9c957bb2edef2eccfdcd24}{GetOnsiteOperatorCDownDagger}}();}
\DoxyCodeLine{992       }
\DoxyCodeLine{993       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{994          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_af509aa69f9a132afbfafd86974317f3a}{GetDimOnsite}}());}
\DoxyCodeLine{995       \}}
\DoxyCodeLine{996       }
\DoxyCodeLine{997       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{998       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{999          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2bb4b34128d7fee7583bbe8b34f7fd35}{GenerateMatrixComponentsOnsite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aef91160bc62bb058ea4dbb943bb60b0c}{GetOnsiteOperatorHam}}(), 1.0);}
\DoxyCodeLine{1000       \}}
\DoxyCodeLine{1001       }
\DoxyCodeLine{1002       \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{1003       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aa896770fcaa6a044e9083b8fbb8db3b3}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{1004          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{1005             \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aa896770fcaa6a044e9083b8fbb8db3b3}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{1006             \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{1007             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = site; s < site + distance; ++s) \{}
\DoxyCodeLine{1008                n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a66a72d066c290e214f6407b0eb746c42}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[s]);}
\DoxyCodeLine{1009             \}}
\DoxyCodeLine{1010             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up\_dagger  , site + distance, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1011             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up         , site + distance, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1012             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down\_dagger, site + distance, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1013             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down       , site + distance, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1014          \}}
\DoxyCodeLine{1015       \}}
\DoxyCodeLine{1016       }
\DoxyCodeLine{1017    \}}
\DoxyCodeLine{1018    }
\DoxyCodeLine{1019    \textcolor{keyword}{template}<\textcolor{keyword}{class} BaseClass>}
\DoxyCodeLine{1020    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a744f7c1dff42c287169945e102506b66}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} *edmc, \textcolor{keyword}{const} std::int64\_t basis, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d}{model::GeneralModel\_1D<BaseClass>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1021       }
\DoxyCodeLine{1022       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.GetSystemSize(); ++site) \{}
\DoxyCodeLine{1023          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_aab1fdd812e21f80ec19c59449d44d3f4}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.GetDimOnsite());}
\DoxyCodeLine{1024       \}}
\DoxyCodeLine{1025       }
\DoxyCodeLine{1026       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{1027       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a06a053ae83790d126cb115b5559682f5}{GetOnsiteOperatorList}}()) \{}
\DoxyCodeLine{1028          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2bb4b34128d7fee7583bbe8b34f7fd35}{GenerateMatrixComponentsOnsite}}(edmc, basis, it.first, it.second, 1.0);}
\DoxyCodeLine{1029       \}}
\DoxyCodeLine{1030       }
\DoxyCodeLine{1031       \textcolor{comment}{//Intersite elements}}
\DoxyCodeLine{1032       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it1: \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1c927aeeccff28853123195f26af3b70}{model}}.GetIntersiteOperatorList()) \{}
\DoxyCodeLine{1033          \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1 = it1.first;}
\DoxyCodeLine{1034          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it2: it1.second) \{}
\DoxyCodeLine{1035             \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2 = it2.first;}
\DoxyCodeLine{1036             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it3: it2.second) \{}
\DoxyCodeLine{1037                \textcolor{keyword}{const} \textcolor{keyword}{auto} \&m\_1 = it3.first;}
\DoxyCodeLine{1038                \textcolor{keyword}{const} \textcolor{keyword}{auto} \&m\_2 = it3.second;}
\DoxyCodeLine{1039                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a2cd86bb67301046df80995ca04081b5b}{GenerateMatrixComponentsIntersite}}(edmc, basis, site\_1, m\_1, site\_2, m\_2, 1.0);}
\DoxyCodeLine{1040             \}}
\DoxyCodeLine{1041          \}}
\DoxyCodeLine{1042       \}}
\DoxyCodeLine{1043       }
\DoxyCodeLine{1044       \textcolor{comment}{//Fill zero in the diagonal elements for symmetric matrix vector product calculation.}}
\DoxyCodeLine{1045       \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}.count(basis) == 0) \{}
\DoxyCodeLine{1046          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_ae48f0132ba0ef391399cb84af62f0b33}{inv\_basis\_affected}}[basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.size();}
\DoxyCodeLine{1047          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a3963d8c56d40d8e574e8e19f4be25a4f}{val}}.push\_back(0.0);}
\DoxyCodeLine{1048          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_1_1_exact_diag_matrix_components_a490b72a66dc12c5d5a12c6ec86b82bc0}{basis\_affected}}.push\_back(basis);}
\DoxyCodeLine{1049       \}}
\DoxyCodeLine{1050       }
\DoxyCodeLine{1051    \}}
\DoxyCodeLine{1052    }
\DoxyCodeLine{1053    }
\DoxyCodeLine{1054    }
\DoxyCodeLine{1055 \};}
\DoxyCodeLine{1056 }
\DoxyCodeLine{1057 \}}
\DoxyCodeLine{1058 \}}
\DoxyCodeLine{1059 }
\DoxyCodeLine{1060 }
\DoxyCodeLine{1061 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
