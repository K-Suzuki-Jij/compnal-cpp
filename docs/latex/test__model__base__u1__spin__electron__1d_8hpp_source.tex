\hypertarget{test__model__base__u1__spin__electron__1d_8hpp_source}{}\doxysection{test\+\_\+model\+\_\+base\+\_\+u1\+\_\+spin\+\_\+electron\+\_\+1d.\+hpp}
\label{test__model__base__u1__spin__electron__1d_8hpp_source}\index{tests/model/test\_model\_base\_u1\_spin\_electron\_1d.hpp@{tests/model/test\_model\_base\_u1\_spin\_electron\_1d.hpp}}
\mbox{\hyperlink{test__model__base__u1__spin__electron__1d_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2022/01/23.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_TEST\_MODEL\_BASE\_U1\_SPIN\_ELECTRON\_1D\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_TEST\_MODEL\_BASE\_U1\_SPIN\_ELECTRON\_1D\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../../src/model/base\_u1\_spin\_electron\_1d.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <gtest/gtest.h>}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{26 \textcolor{keyword}{namespace }test \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{29 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1test_a509bbadfc5694354e3dea10aae9f8aa1}{TestSpinOneHalf}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d}{BaseU1SpinElectron\_1D<RealType>}} \&model) \{}
\DoxyCodeLine{30    }
\DoxyCodeLine{31    \textcolor{keyword}{const} \textcolor{keywordtype}{double} threshold = std::pow(10, -\/15);}
\DoxyCodeLine{32    }
\DoxyCodeLine{33    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_af509aa69f9a132afbfafd86974317f3a}{GetDimOnsite}}(), 4*2);}
\DoxyCodeLine{34    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_aa2be4c9a16a9bdf108c81d1d8a5b0b5d}{GetMagnitudeLSpin}}(), 0.5);}
\DoxyCodeLine{35    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a68f81fec3ed5602021fd778ee5a6b58e}{GetDimOnsiteELectron}}(), 4);}
\DoxyCodeLine{36    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a553ad65a9860714f3a582516f68e942c}{GetDimOnsiteLSpin}}(), 2);}
\DoxyCodeLine{37 }
\DoxyCodeLine{38    \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} ref\_c\_up (\{}
\DoxyCodeLine{39       \{0, 0, 1, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{40       \{0, 0, 0, 1, 0, 0, 0, 0\},}
\DoxyCodeLine{41       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{42       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{43       \{0, 0, 0, 0, 0, 0, 1, 0\},}
\DoxyCodeLine{44       \{0, 0, 0, 0, 0, 0, 0, 1\},}
\DoxyCodeLine{45       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{46       \{0, 0, 0, 0, 0, 0, 0, 0\}}
\DoxyCodeLine{47    \}, \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}});}
\DoxyCodeLine{48    }
\DoxyCodeLine{49    \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} ref\_c\_up\_d (\{}
\DoxyCodeLine{50       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{51       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{52       \{1, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{53       \{0, 1, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{54       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{55       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{56       \{0, 0, 0, 0, 1, 0, 0, 0\},}
\DoxyCodeLine{57       \{0, 0, 0, 0, 0, 1, 0, 0\}}
\DoxyCodeLine{58    \}, \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}});}
\DoxyCodeLine{59    }
\DoxyCodeLine{60    \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} ref\_c\_down (\{}
\DoxyCodeLine{61       \{0, 0, 0, 0, 1, 0, 0, 0\},}
\DoxyCodeLine{62       \{0, 0, 0, 0, 0, 1, 0, 0\},}
\DoxyCodeLine{63       \{0, 0, 0, 0, 0, 0, -\/1, 0\},}
\DoxyCodeLine{64       \{0, 0, 0, 0, 0, 0, 0, -\/1\},}
\DoxyCodeLine{65       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{66       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{67       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{68       \{0, 0, 0, 0, 0, 0, 0, 0\}}
\DoxyCodeLine{69    \}, \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}});}
\DoxyCodeLine{70    }
\DoxyCodeLine{71    \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} ref\_c\_down\_d (\{}
\DoxyCodeLine{72       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{73       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{74       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{75       \{0, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{76       \{1, 0, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{77       \{0, 1, 0, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{78       \{0, 0, -\/1, 0, 0, 0, 0, 0\},}
\DoxyCodeLine{79       \{0, 0, 0, -\/1, 0, 0, 0, 0\}}
\DoxyCodeLine{80    \}, \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}});}
\DoxyCodeLine{81  }
\DoxyCodeLine{82    \mbox{\hyperlink{namespacecompnal_1_1test_ae1279c7fc79a6110087f16a3fbe9258f}{ExpectNear}}(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a65f4321d5d41b8898b4dcf17dd83329d}{GetOnsiteOperatorCUp}}()        , ref\_c\_up    , threshold);}
\DoxyCodeLine{83    \mbox{\hyperlink{namespacecompnal_1_1test_ae1279c7fc79a6110087f16a3fbe9258f}{ExpectNear}}(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a3686b4987cd45b9524faa073e1834cbb}{GetOnsiteOperatorCUpDagger}}()  , ref\_c\_up\_d  , threshold);}
\DoxyCodeLine{84    \mbox{\hyperlink{namespacecompnal_1_1test_ae1279c7fc79a6110087f16a3fbe9258f}{ExpectNear}}(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a114ca4b0dec996f77b7f85c7f846f1b4}{GetOnsiteOperatorCDown}}()      , ref\_c\_down  , threshold);}
\DoxyCodeLine{85    \mbox{\hyperlink{namespacecompnal_1_1test_ae1279c7fc79a6110087f16a3fbe9258f}{ExpectNear}}(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a4698ebcfbb9c957bb2edef2eccfdcd24}{GetOnsiteOperatorCDownDagger}}(), ref\_c\_down\_d, threshold);}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \mbox{\hyperlink{namespacecompnal_1_1test_a82eafcd38e9b0aa92d1a93d917ce3936}{TEST}}(ModelBaseU1SpinElectron1D, ConstructorDefault) \{}
\DoxyCodeLine{90    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d}{BaseU1SpinElectron\_1D<double>}} model;}
\DoxyCodeLine{91    \mbox{\hyperlink{namespacecompnal_1_1test_a509bbadfc5694354e3dea10aae9f8aa1}{TestSpinOneHalf}}(model);}
\DoxyCodeLine{92    }
\DoxyCodeLine{93    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}()    , 0  );}
\DoxyCodeLine{94    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_af7a37dd26cb6d71c393ee4233fdaf538}{GetTotalSz}}()       , 0.0);}
\DoxyCodeLine{95    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a8c872bc8a2fec3e5a0ea25438d5146a3}{GetTotalElectron}}() , 0  );}
\DoxyCodeLine{96    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_aa2be4c9a16a9bdf108c81d1d8a5b0b5d}{GetMagnitudeLSpin}}(), 0.5);}
\DoxyCodeLine{97    EXPECT\_EQ(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a270bfe077404d46a09f77c4c41284c08}{GetCalculatedEigenvectorSet}}(), std::unordered\_set<int>());}
\DoxyCodeLine{98    }
\DoxyCodeLine{99    \mbox{\hyperlink{namespacecompnal_1_1test_ac10a748d750a721db72cc022511fc7e0}{ExpectEQ}}(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_adafb772a2c848f5686ec9b6802e9c9dc}{GetBases}}(), std::unordered\_map<std::pair<int, int>, std::vector<std::int64\_t>, \mbox{\hyperlink{structcompnal_1_1utility_1_1_pair_hash}{compnal::utility::PairHash}}>\{\});}
\DoxyCodeLine{100    \mbox{\hyperlink{namespacecompnal_1_1test_ac10a748d750a721db72cc022511fc7e0}{ExpectEQ}}(model.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a2c50c4b17a99ef75c381eb13da0d2fd2}{GetBasesInv}}(), std::unordered\_map<std::pair<int, int>, std::unordered\_map<std::int64\_t, std::int64\_t>, \mbox{\hyperlink{structcompnal_1_1utility_1_1_pair_hash}{compnal::utility::PairHash}}>\{\});}
\DoxyCodeLine{101    }
\DoxyCodeLine{102 \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104 \}}
\DoxyCodeLine{105 \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_TEST\_MODEL\_BASE\_U1\_SPIN\_1D\_HPP\_ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{108    }

\end{DoxyCode}
