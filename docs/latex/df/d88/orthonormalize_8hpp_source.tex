\hypertarget{orthonormalize_8hpp_source}{}\doxysection{orthonormalize.\+hpp}
\label{orthonormalize_8hpp_source}\index{src/blas/orthonormalize.hpp@{src/blas/orthonormalize.hpp}}
\mbox{\hyperlink{orthonormalize_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00001}00001 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00002}00002 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00003}00003 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00004}00004 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00005}00005 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00006}00006 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00007}00007 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00008}00008 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00009}00009 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00010}00010 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00011}00011 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00012}00012 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00013}00013 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00014}00014 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00015}00015 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/12/09.}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00016}00016 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00017}00017 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00018}00018 \textcolor{preprocessor}{\#ifndef COMPNAL\_BLAS\_ORTHONORMALIZE\_HPP\_}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00019}00019 \textcolor{preprocessor}{\#define COMPNAL\_BLAS\_ORTHONORMALIZE\_HPP\_}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00021}00021 \textcolor{preprocessor}{\#include "{}../type/braket\_vector.hpp"{}}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00022}00022 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00024}00024 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00025}00025 \textcolor{keyword}{namespace }blas \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00027}00027 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00028}\mbox{\hyperlink{namespacecompnal_1_1blas_ae30f924effa78f04d9e973b3525ed4b7}{00028}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1blas_ae30f924effa78f04d9e973b3525ed4b7}{Orthonormalize}}(std::vector<\mbox{\hyperlink{classcompnal_1_1type_1_1_braket_vector}{type::BraketVector<RealType>}}> *vectors) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00029}00029    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vectors-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00030}00030       \textcolor{keyword}{const} std::int64\_t dim = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vectors[i]-\/>size());}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00031}00031       \textcolor{keywordflow}{for} (std::size\_t j = 0; j < i; ++j) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00032}00032          \textcolor{keyword}{const} RealType inner\_product = -\/1.0*CalculateInnerProduct(*vectors[i], (*vectors)[j]);}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00033}00033 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00034}00034          \textcolor{keywordflow}{for} (std::int64\_t k = 0; k < dim; ++k) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00035}00035             vectors[i]-\/>val[k] += inner\_product*vectors[j]-\/>val[k];}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00036}00036          \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00037}00037       \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00038}00038    \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00039}00039 \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00041}00041 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00042}\mbox{\hyperlink{namespacecompnal_1_1blas_ae84dc5fa7300de09e82132e364928b7c}{00042}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1blas_ae30f924effa78f04d9e973b3525ed4b7}{Orthonormalize}}(\mbox{\hyperlink{classcompnal_1_1type_1_1_braket_vector}{type::BraketVector<RealType>}} *target\_vector, \textcolor{keyword}{const} std::vector<\mbox{\hyperlink{classcompnal_1_1type_1_1_braket_vector}{type::BraketVector<RealType>}}> \&vectors) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00043}00043    \textcolor{keyword}{const} std::int64\_t dim = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(target\_vector-\/>val.size());}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00044}00044    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vectors.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00045}00045       \textcolor{keyword}{const} RealType inner\_product = -\/1.0*CalculateInnerProduct(*target\_vector, vectors[i]);}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00046}00046 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00047}00047       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < dim; ++j) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00048}00048          target\_vector-\/>val[j] += inner\_product*vectors[i].val[j];}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00049}00049       \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00050}00050    \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00051}00051 \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00053}00053 \}  \textcolor{comment}{// namespace sparse\_matrix}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00054}00054 \}  \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00056}00056 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00057}00057 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_BLAS\_ORTHONORMALIZE\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
