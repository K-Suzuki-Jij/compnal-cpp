\hypertarget{base__u1__spin_8hpp_source}{}\doxysection{base\+\_\+u1\+\_\+spin.\+hpp}
\label{base__u1__spin_8hpp_source}\index{src/model/base\_u1\_spin.hpp@{src/model/base\_u1\_spin.hpp}}
\mbox{\hyperlink{base__u1__spin_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/18.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_MODEL\_BASE\_U1SPIN\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_MODEL\_BASE\_U1SPIN\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}../type/all.hpp"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{30 \textcolor{keyword}{namespace }model \{}
\DoxyCodeLine{31 }
\DoxyCodeLine{36 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{37 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin}{BaseU1Spin}} \{}
\DoxyCodeLine{38    }
\DoxyCodeLine{39    \textcolor{keyword}{static\_assert}(std::is\_floating\_point<RealType>::value, \textcolor{stringliteral}{"{}Template parameter RealType must be floating point type"{}});}
\DoxyCodeLine{40    }
\DoxyCodeLine{41    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{42    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Type Alias-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{43    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{45 \textcolor{comment}{}   \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} = \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{type::HalfInt}};}
\DoxyCodeLine{46    }
\DoxyCodeLine{48    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{49    }
\DoxyCodeLine{50 \textcolor{keyword}{public}:}
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{52    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Type Alias-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{53    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{55 \textcolor{comment}{}   \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a536e8998eb12f94692d460def94be51c}{HalfInt}};}
\DoxyCodeLine{56    }
\DoxyCodeLine{58    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1utility_1_1_half_int_hash}{QHash}} = \mbox{\hyperlink{structcompnal_1_1utility_1_1_half_int_hash}{utility::HalfIntHash}};}
\DoxyCodeLine{59    }
\DoxyCodeLine{61    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ac1d00aef742d651d7443f69fe6aa35d7}{ValueType}} = RealType;}
\DoxyCodeLine{62    }
\DoxyCodeLine{63    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{64    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{65    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{67 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a99932d800811ad7bacbdd124620e97a2}{BaseU1Spin}}() \{}
\DoxyCodeLine{68       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a55509590c0fe917c47ba022acbabcb2c}{SetOnsiteOperator}}();}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70    }
\DoxyCodeLine{73    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a90d8388c7feec9f08bcf9253583e222b}{BaseU1Spin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{74       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a569a6978dc3b834ff3875534cf4761ab}{SetMagnitudeSpin}}(magnitude\_spin);}
\DoxyCodeLine{75    \}}
\DoxyCodeLine{76    }
\DoxyCodeLine{80    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_abb7b959eecaa06a005093bcfd4040a37}{BaseU1Spin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{81       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a569a6978dc3b834ff3875534cf4761ab}{SetMagnitudeSpin}}(magnitude\_spin);}
\DoxyCodeLine{82       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a3583b5848b9c60b746d003ab243fb3df}{SetTotalSz}}(total\_sz);}
\DoxyCodeLine{83    \}}
\DoxyCodeLine{84    }
\DoxyCodeLine{85    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{86    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{87    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{90 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a569a6978dc3b834ff3875534cf4761ab}{SetMagnitudeSpin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{91       \textcolor{keywordflow}{if} (magnitude\_spin <= 0) \{}
\DoxyCodeLine{92          std::stringstream ss;}
\DoxyCodeLine{93          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_ << std::endl;}
\DoxyCodeLine{94          ss << \textcolor{stringliteral}{"{}Please set magnitude\_spin > 0"{}} << std::endl;}
\DoxyCodeLine{95          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{96       \}}
\DoxyCodeLine{97       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} = magnitude\_spin;}
\DoxyCodeLine{98       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}     = 2*magnitude\_spin + 1;}
\DoxyCodeLine{99       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a55509590c0fe917c47ba022acbabcb2c}{SetOnsiteOperator}}();}
\DoxyCodeLine{100    \}}
\DoxyCodeLine{101    }
\DoxyCodeLine{104    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a3583b5848b9c60b746d003ab243fb3df}{SetTotalSz}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{105       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}} = total\_sz;}
\DoxyCodeLine{106    \}}
\DoxyCodeLine{107       }
\DoxyCodeLine{111    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a088f30223f8b6655b1d8e452c04ee015}{CalculateNumElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{112       \textcolor{keywordflow}{if} (0 <= basis\_onsite \&\& basis\_onsite < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}) \{}
\DoxyCodeLine{113          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{114       \}}
\DoxyCodeLine{115       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{116          std::stringstream ss;}
\DoxyCodeLine{117          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_  << std::endl;}
\DoxyCodeLine{118          ss << \textcolor{stringliteral}{"{}Invalid onsite basis"{}} << std::endl;}
\DoxyCodeLine{119          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{120       \}}
\DoxyCodeLine{121    \}}
\DoxyCodeLine{122    }
\DoxyCodeLine{124    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a698b2dee724a4d739751bb0e1435bd56}{PrintBasisOnsite}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{125       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}; ++row) \{}
\DoxyCodeLine{126          std::cout << \textcolor{stringliteral}{"{}row "{}} << row << \textcolor{stringliteral}{"{}: |Sz="{}} << \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} -\/ row << \textcolor{stringliteral}{"{}>"{}} << std::endl;}
\DoxyCodeLine{127       \}}
\DoxyCodeLine{128    \}}
\DoxyCodeLine{129    }
\DoxyCodeLine{134    \textcolor{keyword}{template}<\textcolor{keyword}{typename} IntegerType>}
\DoxyCodeLine{135    \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_acf3cff2c5d33d19781a142d1705d68f3}{CalculateQNumber}}(\textcolor{keyword}{const} IntegerType row, \textcolor{keyword}{const} IntegerType col) \{}
\DoxyCodeLine{136       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}}\textcolor{keyword}{>}(col -\/ row + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}});}
\DoxyCodeLine{137    \}}
\DoxyCodeLine{138    }
\DoxyCodeLine{146    std::vector<std::int64\_t> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ae922d2e4aefb5457a485d6433318ed16}{GenerateBasis}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size,}
\DoxyCodeLine{147                                            \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} total\_sz,}
\DoxyCodeLine{148                                            \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_display\_info = \textcolor{keyword}{true})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{149       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}, total\_sz) || system\_size <= 0) \{}
\DoxyCodeLine{150          std::stringstream ss;}
\DoxyCodeLine{151          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_ << std::endl;}
\DoxyCodeLine{152          ss << \textcolor{stringliteral}{"{}Invalid parameters (system\_size or magnitude\_spin or total\_sz)"{}} << std::endl;}
\DoxyCodeLine{153          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{154       \}}
\DoxyCodeLine{155       }
\DoxyCodeLine{156       \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{157       }
\DoxyCodeLine{158       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 2*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} + 1;}
\DoxyCodeLine{159       std::vector<std::int64\_t> basis;}
\DoxyCodeLine{160       }
\DoxyCodeLine{161       \textcolor{keywordflow}{if} (flag\_display\_info) \{}
\DoxyCodeLine{162          std::cout << \textcolor{stringliteral}{"{}Generating Basis..."{}} << std::flush;}
\DoxyCodeLine{163       \}}
\DoxyCodeLine{164       }
\DoxyCodeLine{165       \textcolor{keyword}{const} \textcolor{keywordtype}{int} shifted\_2sz = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(2*(system\_size*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} -\/ total\_sz));}
\DoxyCodeLine{166       \textcolor{keyword}{const} std::int64\_t dim\_target = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2d55d47c1494ea84e91892b1a5d94aac}{CalculateTargetDim}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}, total\_sz);}
\DoxyCodeLine{167       std::vector<std::vector<int>> partition\_integers;}
\DoxyCodeLine{168       \mbox{\hyperlink{namespacecompnal_1_1utility_a2580357fcc88b1c7bac5627e5b47925f}{utility::GenerateIntegerPartition}}(\&partition\_integers, shifted\_2sz, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{169       }
\DoxyCodeLine{170       std::vector<std::int64\_t> site\_constant(system\_size);}
\DoxyCodeLine{171       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < system\_size; ++site) \{}
\DoxyCodeLine{172          site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site));}
\DoxyCodeLine{173       \}}
\DoxyCodeLine{174       }
\DoxyCodeLine{175 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{176       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{177       std::vector<std::vector<std::int64\_t>> temp\_basis(num\_threads);}
\DoxyCodeLine{178       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&integer\_list: partition\_integers) \{}
\DoxyCodeLine{179          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition1 = (0 < integer\_list.size()) \&\& (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()) <= system\_size);}
\DoxyCodeLine{180          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition2 = (integer\_list.size() == 0) \&\& (shifted\_2sz  == 0);}
\DoxyCodeLine{181          \textcolor{keywordflow}{if} (condition1 || condition2) \{}
\DoxyCodeLine{182             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()); j < system\_size; ++j) \{}
\DoxyCodeLine{183                integer\_list.push\_back(0);}
\DoxyCodeLine{184             \}}
\DoxyCodeLine{185             }
\DoxyCodeLine{186             \textcolor{keyword}{const} std::int64\_t size = \mbox{\hyperlink{namespacecompnal_1_1utility_a31be084029ddf129959d1682fd54cdf5}{utility::CalculateNumCombination}}(integer\_list);}
\DoxyCodeLine{187             std::vector<std::vector<int>> temp\_partition\_integer(num\_threads);}
\DoxyCodeLine{188             }
\DoxyCodeLine{189 \textcolor{preprocessor}{\#pragma omp parallel num\_threads (num\_threads)}}
\DoxyCodeLine{190             \{}
\DoxyCodeLine{191                \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{192                \textcolor{keyword}{const} std::int64\_t loop\_begin = thread\_num*size/num\_threads;}
\DoxyCodeLine{193                \textcolor{keyword}{const} std::int64\_t loop\_end   = (thread\_num + 1)*size/num\_threads;}
\DoxyCodeLine{194                temp\_partition\_integer[thread\_num] = integer\_list;}
\DoxyCodeLine{195                \mbox{\hyperlink{namespacecompnal_1_1utility_a6d7737688a03ef322d62fc96017af67a}{utility::CalculateNthPermutation}}(\&temp\_partition\_integer[thread\_num], loop\_begin);}
\DoxyCodeLine{196                }
\DoxyCodeLine{197                \textcolor{keywordflow}{for} (std::int64\_t j = loop\_begin; j < loop\_end; ++j) \{}
\DoxyCodeLine{198                   std::int64\_t basis\_global = 0;}
\DoxyCodeLine{199                   \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_begin = temp\_partition\_integer[thread\_num].begin();}
\DoxyCodeLine{200                   \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_end   = temp\_partition\_integer[thread\_num].end();}
\DoxyCodeLine{201                   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} itr = iter\_begin; itr != iter\_end; ++itr) \{}
\DoxyCodeLine{202                      basis\_global += *itr*site\_constant[std::distance(iter\_begin, itr)];}
\DoxyCodeLine{203                   \}}
\DoxyCodeLine{204                   temp\_basis[thread\_num].push\_back(basis\_global);}
\DoxyCodeLine{205                   std::next\_permutation(temp\_partition\_integer[thread\_num].begin(), temp\_partition\_integer[thread\_num].end());}
\DoxyCodeLine{206                \}}
\DoxyCodeLine{207             \}}
\DoxyCodeLine{208          \}}
\DoxyCodeLine{209       \}}
\DoxyCodeLine{210       }
\DoxyCodeLine{211       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&it: temp\_basis) \{}
\DoxyCodeLine{212          basis.insert(basis.end(), it.begin(), it.end());}
\DoxyCodeLine{213          std::vector<std::int64\_t>().swap(it);}
\DoxyCodeLine{214       \}}
\DoxyCodeLine{215       }
\DoxyCodeLine{216 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{217       basis.reserve(dim\_target);}
\DoxyCodeLine{218       }
\DoxyCodeLine{219       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&integer\_list: partition\_integers) \{}
\DoxyCodeLine{220          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition1 = (0 < integer\_list.size()) \&\& (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()) <= system\_size\_);}
\DoxyCodeLine{221          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition2 = (integer\_list.size() == 0) \&\& (shifted\_2sz  == 0);}
\DoxyCodeLine{222          \textcolor{keywordflow}{if} (condition1 || condition2) \{}
\DoxyCodeLine{223             }
\DoxyCodeLine{224             \textcolor{keywordflow}{for} (std::int64\_t j = integer\_list.size(); j < system\_size\_; ++j) \{}
\DoxyCodeLine{225                integer\_list.push\_back(0);}
\DoxyCodeLine{226             \}}
\DoxyCodeLine{227             }
\DoxyCodeLine{228             std::sort(integer\_list.begin(), integer\_list.end());}
\DoxyCodeLine{229             }
\DoxyCodeLine{230             \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{231                std::int64\_t basis\_global = 0;}
\DoxyCodeLine{232                \textcolor{keywordflow}{for} (std::size\_t j = 0; j < integer\_list.size(); ++j) \{}
\DoxyCodeLine{233                   basis\_global += integer\_list[j]*site\_constant[j];}
\DoxyCodeLine{234                \}}
\DoxyCodeLine{235                basis.push\_back(basis\_global);}
\DoxyCodeLine{236             \} \textcolor{keywordflow}{while} (std::next\_permutation(integer\_list.begin(), integer\_list.end()));}
\DoxyCodeLine{237          \}}
\DoxyCodeLine{238       \}}
\DoxyCodeLine{239       }
\DoxyCodeLine{240 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{241       }
\DoxyCodeLine{242       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size()) != dim\_target) \{}
\DoxyCodeLine{243          std::stringstream ss;}
\DoxyCodeLine{244          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_ << std::endl;}
\DoxyCodeLine{245          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{246       \}}
\DoxyCodeLine{247       }
\DoxyCodeLine{248       std::sort(basis.begin(), basis.end());}
\DoxyCodeLine{249       }
\DoxyCodeLine{250       \textcolor{keywordflow}{if} (flag\_display\_info) \{}
\DoxyCodeLine{251          \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{252          \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{sparse\_matrix::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{253          std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating basis:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{254       \}}
\DoxyCodeLine{255       \textcolor{keywordflow}{return} basis;}
\DoxyCodeLine{256    \}}
\DoxyCodeLine{257    }
\DoxyCodeLine{262    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{263       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} ,total\_sz);}
\DoxyCodeLine{264    \}}
\DoxyCodeLine{265    }
\DoxyCodeLine{271    std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2d55d47c1494ea84e91892b1a5d94aac}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{272       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2d55d47c1494ea84e91892b1a5d94aac}{CalculateTargetDim}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}, total\_sz);}
\DoxyCodeLine{273    \}}
\DoxyCodeLine{274       }
\DoxyCodeLine{275    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{276    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Static Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{277    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{283 \textcolor{comment}{}   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ace7f8cf7db6d6c88b06bb2372941c5f6}{ValidateQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{284       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz       = 2*total\_sz;}
\DoxyCodeLine{285       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = 2*magnitude\_spin;}
\DoxyCodeLine{286       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = ((system\_size*magnitude\_2spin -\/ total\_2sz)\%2 == 0);}
\DoxyCodeLine{287       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (-\/system\_size*magnitude\_2spin <= total\_2sz);}
\DoxyCodeLine{288       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (total\_2sz <= system\_size*magnitude\_2spin);}
\DoxyCodeLine{289       \textcolor{keywordflow}{if} (c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{290          \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{291       \}}
\DoxyCodeLine{292       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{293          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{294       \}}
\DoxyCodeLine{295    \}}
\DoxyCodeLine{296    }
\DoxyCodeLine{303    \textcolor{keyword}{static} std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_abbb5256ebd88f752641627074e1b42af}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{304       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(system\_size, magnitude\_spin, total\_sz)) \{}
\DoxyCodeLine{305          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{306       \}}
\DoxyCodeLine{307       \textcolor{keywordflow}{if} (system\_size <= 0) \{}
\DoxyCodeLine{308          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{309       \}}
\DoxyCodeLine{310       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = 2*magnitude\_spin;}
\DoxyCodeLine{311       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz       = 2*total\_sz;}
\DoxyCodeLine{312       \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_total\_2sz   = system\_size*magnitude\_2spin;}
\DoxyCodeLine{313       std::vector<std::vector<std::int64\_t>> dim(system\_size, std::vector<std::int64\_t>(max\_total\_2sz + 1));}
\DoxyCodeLine{314       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{315          dim[0][(s + magnitude\_2spin)/2] = 1;}
\DoxyCodeLine{316       \}}
\DoxyCodeLine{317       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 1; site < system\_size; site++) \{}
\DoxyCodeLine{318          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{319             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s\_prev = -\/magnitude\_2spin*site; s\_prev <= magnitude\_2spin*site; s\_prev += 2) \{}
\DoxyCodeLine{320                \textcolor{keyword}{const} std::int64\_t a = dim[site    ][(s + s\_prev + magnitude\_2spin*(site + 1))/2];}
\DoxyCodeLine{321                \textcolor{keyword}{const} std::int64\_t b = dim[site -\/ 1][(s\_prev + magnitude\_2spin*site)/2];}
\DoxyCodeLine{322                \textcolor{keywordflow}{if} (a >= INT64\_MAX -\/ b) \{}
\DoxyCodeLine{323                   \textcolor{keywordflow}{throw} std::overflow\_error(\textcolor{stringliteral}{"{}Overflow detected for sumation using uint64\_t"{}});}
\DoxyCodeLine{324                \}}
\DoxyCodeLine{325                dim[site][(s + s\_prev + magnitude\_2spin*(site + 1))/2] = a + b;}
\DoxyCodeLine{326             \}}
\DoxyCodeLine{327          \}}
\DoxyCodeLine{328       \}}
\DoxyCodeLine{329       \textcolor{keywordflow}{return} dim[system\_size -\/ 1][(total\_2sz + max\_total\_2sz)/2];}
\DoxyCodeLine{330    \}}
\DoxyCodeLine{331    }
\DoxyCodeLine{335    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6cf484f066492e0865296e842b23bcfb}{CreateOnsiteOperatorSx}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{336       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(0.5)*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}}(magnitude\_spin) + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}}(magnitude\_spin));}
\DoxyCodeLine{337    \}}
\DoxyCodeLine{338    }
\DoxyCodeLine{343    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0ad8ed9859946ad665f469f200278188}{CreateOnsiteOperatoriSy}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{344       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(0.5)*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}}(magnitude\_spin) -\/ \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}}(magnitude\_spin));}
\DoxyCodeLine{345    \}}
\DoxyCodeLine{346    }
\DoxyCodeLine{350    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a63d1f180fc4be983c436d9e5251c927d}{CreateOnsiteOperatorSz}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{351       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 2*magnitude\_spin + 1;}
\DoxyCodeLine{352       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{353       }
\DoxyCodeLine{354       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{355          \textcolor{keyword}{const} RealType val = magnitude\_spin -\/ row;}
\DoxyCodeLine{356          \textcolor{keywordflow}{if} (val != 0.0) \{}
\DoxyCodeLine{357             matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(val);}
\DoxyCodeLine{358             matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(row);}
\DoxyCodeLine{359          \}}
\DoxyCodeLine{360          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{361       \}}
\DoxyCodeLine{362       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{363    \}}
\DoxyCodeLine{364    }
\DoxyCodeLine{368    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{369       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 2*magnitude\_spin + 1;}
\DoxyCodeLine{370       \textcolor{keyword}{const} RealType constant = 2.0;}
\DoxyCodeLine{371       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{372       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{373          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*constant*row -\/ row*(row + 1)));}
\DoxyCodeLine{374          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(row);}
\DoxyCodeLine{375          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{376       \}}
\DoxyCodeLine{377       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{378       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{379    \}}
\DoxyCodeLine{380    }
\DoxyCodeLine{384    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{385       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 2*magnitude\_spin + 1;}
\DoxyCodeLine{386       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{387       \textcolor{keyword}{const} RealType constant = 2.0;}
\DoxyCodeLine{388       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{389          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*constant*row -\/ row*(row + 1)));}
\DoxyCodeLine{390          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(row -\/ 1);}
\DoxyCodeLine{391          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{392       \}}
\DoxyCodeLine{393       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{394    \}}
\DoxyCodeLine{395    }
\DoxyCodeLine{396    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{397    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Access Member variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{398    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{401 \textcolor{comment}{}   \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_afaabb5a037faa01bbce5ab49395da0d7}{GetDimOnsite}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}; \}}
\DoxyCodeLine{402    }
\DoxyCodeLine{405    \textcolor{keyword}{inline} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_aedd60e2f33ce829d43c64ce92152e3a8}{GetTotalSz}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}}; \}}
\DoxyCodeLine{406       }
\DoxyCodeLine{409    \textcolor{keyword}{inline} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a3d16f2c2a1878069b990b3113193b357}{GetMagnitudeSpin}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}; \}}
\DoxyCodeLine{410    }
\DoxyCodeLine{413    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a4d537383db9e0f46cd59f5b924414b85}{GetOnsiteOperatorSx}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ab613ccb8b87eee4bee36a14e12a3a0b9}{onsite\_operator\_sx\_}}; \}}
\DoxyCodeLine{414    }
\DoxyCodeLine{417    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_aed78042369da66f16b1f867e47724417}{GetOnsiteOperatoriSy}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0babc32412530971a3768aa746f22ee5}{onsite\_operator\_isy\_}}; \}}
\DoxyCodeLine{418    }
\DoxyCodeLine{421    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_acf36ca8ae0fc2eabdfd6369ffd1b66ab}{GetOnsiteOperatorSz}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9de3f6eb120e22b725ec926eaa3ee5ec}{onsite\_operator\_sz\_}}; \}}
\DoxyCodeLine{422    }
\DoxyCodeLine{425    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a29becac997032c3519495727feefc942}{GetOnsiteOperatorSp}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a89292c6449728fc422a26454e4c0d0e3}{onsite\_operator\_sp\_}}; \}}
\DoxyCodeLine{426    }
\DoxyCodeLine{429    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a8e6b4ebc2469fbb5f79f6be88227acdd}{GetOnsiteOperatorSm}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9dd5b896bc5afcc4ead4750f5399191e}{onsite\_operator\_sm\_}}; \}}
\DoxyCodeLine{430    }
\DoxyCodeLine{431 \textcolor{keyword}{private}:}
\DoxyCodeLine{432    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{433    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{434    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{436 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}} = 0;}
\DoxyCodeLine{437    }
\DoxyCodeLine{439    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}} = 2;}
\DoxyCodeLine{440    }
\DoxyCodeLine{442    \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} = 0.5;}
\DoxyCodeLine{443    }
\DoxyCodeLine{445    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ab613ccb8b87eee4bee36a14e12a3a0b9}{onsite\_operator\_sx\_}};}
\DoxyCodeLine{446    }
\DoxyCodeLine{448    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0babc32412530971a3768aa746f22ee5}{onsite\_operator\_isy\_}};}
\DoxyCodeLine{449    }
\DoxyCodeLine{451    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9de3f6eb120e22b725ec926eaa3ee5ec}{onsite\_operator\_sz\_}};}
\DoxyCodeLine{452    }
\DoxyCodeLine{454    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a89292c6449728fc422a26454e4c0d0e3}{onsite\_operator\_sp\_}};}
\DoxyCodeLine{455    }
\DoxyCodeLine{457    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9dd5b896bc5afcc4ead4750f5399191e}{onsite\_operator\_sm\_}};}
\DoxyCodeLine{458    }
\DoxyCodeLine{459    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{460    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{461    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{463 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a55509590c0fe917c47ba022acbabcb2c}{SetOnsiteOperator}}() \{}
\DoxyCodeLine{464       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ab613ccb8b87eee4bee36a14e12a3a0b9}{onsite\_operator\_sx\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6cf484f066492e0865296e842b23bcfb}{CreateOnsiteOperatorSx}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{465       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0babc32412530971a3768aa746f22ee5}{onsite\_operator\_isy\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0ad8ed9859946ad665f469f200278188}{CreateOnsiteOperatoriSy}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{466       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9de3f6eb120e22b725ec926eaa3ee5ec}{onsite\_operator\_sz\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a63d1f180fc4be983c436d9e5251c927d}{CreateOnsiteOperatorSz}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{467       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a89292c6449728fc422a26454e4c0d0e3}{onsite\_operator\_sp\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{468       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9dd5b896bc5afcc4ead4750f5399191e}{onsite\_operator\_sm\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{469    \}}
\DoxyCodeLine{470    }
\DoxyCodeLine{471 \};}
\DoxyCodeLine{472 }
\DoxyCodeLine{473 \} \textcolor{comment}{//namespace model}}
\DoxyCodeLine{474 \} \textcolor{comment}{//namespace compnal}}
\DoxyCodeLine{475 }
\DoxyCodeLine{476 }
\DoxyCodeLine{477 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_BASE\_U1SPIN\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
