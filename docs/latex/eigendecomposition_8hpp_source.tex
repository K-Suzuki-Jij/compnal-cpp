\hypertarget{eigendecomposition_8hpp_source}{}\doxysection{eigendecomposition.\+hpp}
\label{eigendecomposition_8hpp_source}\index{src/sparse\_matrix/eigendecomposition.hpp@{src/sparse\_matrix/eigendecomposition.hpp}}
\mbox{\hyperlink{eigendecomposition_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00002}00002 \textcolor{comment}{//  eigendecomposition.hpp}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00003}00003 \textcolor{comment}{//  compnal}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00005}00005 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/05/23.}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00006}00006 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00008}00008 \textcolor{preprocessor}{\#ifndef COMPNAL\_SPARSE\_MATRIX\_EIGENDECOMPOSITION\_HPP\_}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00009}00009 \textcolor{preprocessor}{\#define COMPNAL\_SPARSE\_MATRIX\_EIGENDECOMPOSITION\_HPP\_}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00011}00011 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00012}00012 \textcolor{preprocessor}{\#include <random>}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00014}00014 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{lapack_8hpp}{lapack.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00015}00015 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{compressed__row__storage_8hpp}{compressed\_row\_storage.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00016}00016 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{braket__vector_8hpp}{braket\_vector.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00017}00017 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{orthonormalize_8hpp}{orthonormalize.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00019}00019 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00020}00020 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00021}00021 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00024}00024 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00025}00025 \textcolor{keyword}{namespace }sparse\_matrix \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00027}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{00027}} \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}} = 1000*1000;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00029}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{00029}} \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00030}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a7ef7b43a9660fc136be725620fbeaf6f}{00030}}    \textcolor{keywordtype}{int}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a7ef7b43a9660fc136be725620fbeaf6f}{min\_step}} = 0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00031}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_adc7f6d768228c64cbdb1d33b12c9de09}{00031}}    \textcolor{keywordtype}{int}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_adc7f6d768228c64cbdb1d33b12c9de09}{max\_step}} = 1000;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00032}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a4df305aa854596ff50f61b7d3c707830}{00032}}    \textcolor{keywordtype}{double} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a4df305aa854596ff50f61b7d3c707830}{acc}}      = std::pow(10, -\/14);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00033}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a49d60a22784ad109c4f66d8548603de9}{00033}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a49d60a22784ad109c4f66d8548603de9}{flag\_use\_initial\_vec}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00034}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{00034}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{flag\_store\_vec}}       = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00035}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ab5874cbc827cbeafcd626b43189e0e13}{00035}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ab5874cbc827cbeafcd626b43189e0e13}{flag\_output\_info}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00036}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{00036}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}   = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00037}00037 \};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00039}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{00039}} \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{ParametersCG}} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00040}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a10b4190e1585c5e57c378165d72ddb69}{00040}}    \textcolor{keywordtype}{int}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a10b4190e1585c5e57c378165d72ddb69}{max\_step}} = 1000;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00041}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a17e4642941049d302a36a65c89eb222c}{00041}}    \textcolor{keywordtype}{double} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a17e4642941049d302a36a65c89eb222c}{acc}}      = std::pow(10, -\/7);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00042}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_ab77ae3ceff61132bd26ae14cd43c5f44}{00042}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_ab77ae3ceff61132bd26ae14cd43c5f44}{flag\_use\_initial\_vec}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00043}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a866af8027ccba21859411e381a3dd618}{00043}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a866af8027ccba21859411e381a3dd618}{flag\_output\_info}}     = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00044}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{00044}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{flag\_symmetric\_crs}}   = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00045}00045 \};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00047}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{00047}} \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{ParametersII}} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00048}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a0e2cb2102f014f5bef3245b274505e02}{00048}}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a0e2cb2102f014f5bef3245b274505e02}{ParametersII}}() \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00049}00049       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{cg}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_ab77ae3ceff61132bd26ae14cd43c5f44}{flag\_use\_initial\_vec}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00050}00050    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00051}00051    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00052}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a5d2bc4ffc7ce3c90b24acf47b0f164f8}{00052}}    \textcolor{keywordtype}{int}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a5d2bc4ffc7ce3c90b24acf47b0f164f8}{max\_step}} = 3;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00053}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adc36eda90cdf668f8efa3ed2f9fb4afe}{00053}}    \textcolor{keywordtype}{double} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adc36eda90cdf668f8efa3ed2f9fb4afe}{acc}}      = std::pow(10, -\/7);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00054}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a41b46226c3df3aaeb6c400a90a6b0c83}{00054}}    \textcolor{keywordtype}{double} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a41b46226c3df3aaeb6c400a90a6b0c83}{diag\_add}} = std::pow(10, -\/11);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00055}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a8570010c2aa9695d6126827a945bee15}{00055}}    \textcolor{keywordtype}{bool}   \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a8570010c2aa9695d6126827a945bee15}{flag\_output\_info}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00056}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{00056}}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{ParametersCG}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{cg}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00057}00057 \};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00059}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all}{00059}} \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all}{ParametersAll}} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00060}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{00060}}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_a784b841d78c62a54161ab569519b2d99}{lanczos}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00061}\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{00061}}    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{ParametersII}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all_abdff80529ad29e3797baaf430a2f651f}{ii}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00062}00062 \};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00064}00064 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00065}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{00065}} std::pair<int, double> \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{EigenvalueDecompositionLanczos}}(RealType                *target\_value\_out,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00066}00066                                                       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}}  *target\_vector\_out,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00067}00067                                                       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}}     \&matrix\_in,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00068}00068                                                       \textcolor{keyword}{const} \textcolor{keywordtype}{int}               target\_level,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00069}00069                                                       \textcolor{keyword}{const} std::vector<\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}}> \&subspace\_vectors,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00070}00070                                                       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}} \&params = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}}()}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00071}00071                                                       ) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00072}00072    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00073}00073    \textcolor{keywordflow}{if} (target\_level == 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00074}00074       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{EigenvalueDecompositionLanczos}}(target\_value\_out, target\_vector\_out, matrix\_in, params);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00075}00075    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00076}00076    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00077}00077    \textcolor{keywordflow}{if} (target\_level < 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00078}00078       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00079}00079       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00080}00080       ss << \textcolor{stringliteral}{"{}Invalid target\_level"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00081}00081       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00082}00082    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00083}00083    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00084}00084    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00085}00085    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00086}00086    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00087}00087       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00088}00088       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00089}00089       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00090}00090       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00091}00091       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00092}00092    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00093}00093    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00094}00094    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00095}00095       *target\_value\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00096}00096       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aea9a7595862adf9c7e98138aaf0806e1}{Clear}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00097}00097       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00098}00098       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00099}00099       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00100}00100    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00101}00101    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00102}00102    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} <= 1000) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00103}00103       std::vector<RealType> temp\_gs\_vector\_out;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00104}00104       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{LapackDsyev}}(target\_value\_out, \&temp\_gs\_vector\_out, matrix\_in, target\_level);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00105}00105       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(temp\_gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00106}00106       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00107}00107       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00108}00108       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00109}00109    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00110}00110    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00111}00111    \textcolor{keywordflow}{if} (target\_level != \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(subspace\_vectors.size())) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00112}00112       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00113}00113       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00114}00114       ss << \textcolor{stringliteral}{"{}Invalid size of subspace\_vectors"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00115}00115       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00116}00116    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00117}00117    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00118}00118    \textcolor{keywordtype}{int} converge\_step\_number = 0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00119}00119    \textcolor{keyword}{const} std::int64\_t dim = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00120}00120    RealType residual\_error\_final = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00121}00121    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_0(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00122}00122    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_1(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00123}00123    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_2(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00125}00125    std::vector<std::vector<RealType>> rits\_vector;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00126}00126    std::vector<RealType> krylov\_eigen\_vector;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00127}00127    std::vector<RealType> krylov\_eigen\_value(params.max\_step + 1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00128}00128    std::vector<RealType> diagonal\_value;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00129}00129    std::vector<RealType> off\_diagonal\_value;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00130}00130    std::vector<std::vector<RealType>> vectors\_work;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00131}00131    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00132}00132    \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00133}00133 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00134}00134       vectors\_work = std::vector<std::vector<RealType>>(omp\_get\_max\_threads(), std::vector<RealType>(dim));}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00135}00135 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00136}00136    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00137}00137    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00138}00138    std::uniform\_real\_distribution<RealType> uniform\_rand(-\/1, 1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00139}00139    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = std::random\_device()();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00140}00140    std::mt19937 random\_number\_engine;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00141}00141    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00142}00142    \textcolor{keywordflow}{if} (params.flag\_use\_initial\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00143}00143       vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(*target\_vector\_out);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00144}00144    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00145}00145    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00146}00146       random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00147}00147       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00148}00148          vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00149}00149       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00150}00150    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00151}00151    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_0, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00152}00152    vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00153}00153    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00154}00154    \textcolor{keywordflow}{if} (params.flag\_store\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00155}00155       rits\_vector.push\_back(vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}});}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00156}00156    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00157}00157    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00158}00158    \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00159}00159       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00160}00160    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00161}00161    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00162}00162       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00163}00163    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00164}00164    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00165}00165    diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_0, vector\_1));}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00166}00166    krylov\_eigen\_value[0] = diagonal\_value[0];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00167}00167    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00168}00168    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00169}00169    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.max\_step; ++step) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00170}00170       vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(vector\_1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00171}00171       off\_diagonal\_value.push\_back(vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a86a86a5b08913d8b9262e3b7c27d68cf}{L2Norm}}());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00172}00172       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_2, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00173}00173       vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00174}00174       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00175}00175       \textcolor{keywordflow}{if} (params.flag\_store\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00176}00176          rits\_vector.push\_back(vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}});}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00177}00177       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00178}00178       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00179}00179       \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00180}00180          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00181}00181       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00182}00182       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00183}00183          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00184}00184       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00185}00185       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00186}00186       diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_1, vector\_2));}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00187}00187       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00188}00188       \textcolor{keywordflow}{if} (step >= params.min\_step) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00189}00189          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}{LapackDstev}}(\&krylov\_eigen\_value[step + 1], \&krylov\_eigen\_vector, diagonal\_value, off\_diagonal\_value);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00190}00190          \textcolor{keyword}{const} RealType residual\_error = std::abs(krylov\_eigen\_value[step + 1] -\/ krylov\_eigen\_value[step]);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00191}00191          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00192}00192          \textcolor{keywordflow}{if} (params.flag\_output\_info) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00193}00193             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Step["{}} << step + 1 << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00194}00194             std::cout << residual\_error << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00195}00195          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00196}00196          \textcolor{keywordflow}{if} (residual\_error < params.acc) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00197}00197             *target\_value\_out    = krylov\_eigen\_value[step + 1];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00198}00198             converge\_step\_number = step + 1;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00199}00199             residual\_error\_final = residual\_error;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00200}00200             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00201}00201          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00202}00202       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00203}00203 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00204}00204       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00205}00205          vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] -\/= diagonal\_value[step + 1]*vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + off\_diagonal\_value[step]*vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00206}00206          vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]  = vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00207}00207       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00208}00208    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00209}00209    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00210}00210    \textcolor{keywordflow}{if} (converge\_step\_number <= 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00211}00211       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00212}00212       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00213}00213       ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00214}00214       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00215}00215    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00216}00216    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00217}00217    target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00218}00218    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00219}00219    \textcolor{keywordflow}{if} (params.flag\_store\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00220}00220 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00221}00221       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00222}00222          RealType temp\_val = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00223}00223          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j <= converge\_step\_number; ++j) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00224}00224             temp\_val += krylov\_eigen\_vector[j]*rits\_vector[j][i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00225}00225          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00226}00226          target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00227}00227       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00228}00228       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00229}00229    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00230}00230    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00231}00231       \textcolor{keywordflow}{if} (params.flag\_use\_initial\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00232}00232 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00233}00233          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00234}00234             vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00235}00235             target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00236}00236          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00237}00237       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00238}00238       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00239}00239          random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00240}00240          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00241}00241             vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00242}00242          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00243}00243       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00244}00244       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00245}00245       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_0, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00246}00246       vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00248}00248       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(target\_vector\_out, 1.0, *target\_vector\_out, krylov\_eigen\_vector[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00249}00249       \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00250}00250          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00251}00251       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00252}00252       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00253}00253          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00254}00254       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00255}00255       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00256}00256       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00257}00257       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00258}00258       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 1; step <= converge\_step\_number; ++step) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00259}00259          vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(vector\_1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00260}00260          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_2, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00261}00261          vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00262}00262          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(target\_vector\_out, 1.0, *target\_vector\_out, krylov\_eigen\_vector[step], vector\_2);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00263}00263          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00264}00264          \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00265}00265             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00266}00266          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00267}00267          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00268}00268             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00269}00269          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00270}00270          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00271}00271 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00272}00272          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00273}00273             vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] -\/= diagonal\_value[step]*vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + off\_diagonal\_value[step -\/ 1]*vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00274}00274             vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]  = vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00275}00275          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00276}00276          \textcolor{keywordflow}{if} (params.flag\_output\_info) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00277}00277             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Vec\_Step:"{}} << step << \textcolor{stringliteral}{"{}/"{}} << converge\_step\_number << std::string(5, \textcolor{charliteral}{' '}) << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00278}00278          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00279}00279       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00280}00280       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00281}00281    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00282}00282    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00283}00283    \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00284}00284    \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00285}00285    std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of diagonalization:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00286}00286    std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error\_final << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00287}00287    std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00288}00288    \textcolor{keywordflow}{return} \{converge\_step\_number, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00289}00289    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00290}00290 \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00292}00292 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00293}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a785dabd2915fe57f77fa60259958a92c}{00293}} std::pair<int, double> \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{EigenvalueDecompositionLanczos}}(RealType                *gs\_value\_out,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00294}00294                                                       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}}  *gs\_vector\_out,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00295}00295                                                       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}}     \&matrix\_in,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00296}00296                                                       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}} \&params = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}}()}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00297}00297                                                       ) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00298}00298    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00299}00299    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00300}00300       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00301}00301       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00302}00302       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00303}00303       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00304}00304       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00305}00305    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00306}00306    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00307}00307    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00308}00308    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00309}00309    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00310}00310       *gs\_value\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00311}00311       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aea9a7595862adf9c7e98138aaf0806e1}{Clear}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00312}00312       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00313}00313       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00314}00314       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00315}00315    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00316}00316    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00317}00317    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 1) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00318}00318       *gs\_value\_out = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[0];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00319}00319       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00320}00320       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00321}00321       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00322}00322       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00323}00323       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00324}00324    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00325}00325    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00326}00326    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} <= 1000) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00327}00327       std::vector<RealType> temp\_gs\_vector\_out;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00328}00328       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{LapackDsyev}}(gs\_value\_out, \&temp\_gs\_vector\_out, matrix\_in);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00329}00329       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(temp\_gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00330}00330       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00331}00331       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00332}00332       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00333}00333    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00334}00334    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00335}00335    \textcolor{keywordtype}{int} converge\_step\_number = 0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00336}00336    \textcolor{keyword}{const} std::int64\_t dim = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00337}00337    RealType residual\_error\_final = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00338}00338    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_0(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00339}00339    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_1(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00340}00340    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_2(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00341}00341 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00342}00342    std::vector<std::vector<RealType>> rits\_vector;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00343}00343    std::vector<RealType> krylov\_eigen\_vector;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00344}00344    std::vector<RealType> krylov\_eigen\_value(params.max\_step + 1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00345}00345    std::vector<RealType> diagonal\_value;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00346}00346    std::vector<RealType> off\_diagonal\_value;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00347}00347    std::vector<std::vector<RealType>> vectors\_work;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00348}00348    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00349}00349    \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00350}00350 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00351}00351       vectors\_work = std::vector<std::vector<RealType>>(omp\_get\_max\_threads(), std::vector<RealType>(dim));}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00352}00352 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00353}00353    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00354}00354 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00355}00355       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00356}00356    std::uniform\_real\_distribution<RealType> uniform\_rand(-\/1, 1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00357}00357    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = std::random\_device()();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00358}00358    std::mt19937 random\_number\_engine;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00359}00359    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00360}00360    \textcolor{keywordflow}{if} (params.flag\_use\_initial\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00361}00361       vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(*gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00362}00362    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00363}00363    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00364}00364       random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00365}00365       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00366}00366          vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00367}00367       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00368}00368    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00369}00369    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00370}00370    vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00371}00371    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00372}00372    \textcolor{keywordflow}{if} (params.flag\_store\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00373}00373       rits\_vector.push\_back(vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}});}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00374}00374    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00375}00375    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00376}00376    \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00377}00377       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00378}00378    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00379}00379    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00380}00380       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00381}00381    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00382}00382    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00383}00383    diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_0, vector\_1));}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00384}00384    krylov\_eigen\_value[0] = diagonal\_value[0];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00385}00385    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00386}00386       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00387}00387    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.max\_step; ++step) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00388}00388       vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(vector\_1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00389}00389       off\_diagonal\_value.push\_back(vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a86a86a5b08913d8b9262e3b7c27d68cf}{L2Norm}}());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00390}00390       vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00391}00391       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00392}00392       \textcolor{keywordflow}{if} (params.flag\_store\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00393}00393          rits\_vector.push\_back(vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}});}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00394}00394       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00395}00395       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00396}00396       \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00397}00397          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00398}00398       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00399}00399       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00400}00400          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00401}00401       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00402}00402       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00403}00403       diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_1, vector\_2));}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00404}00404       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00405}00405       \textcolor{keywordflow}{if} (step >= params.min\_step) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00406}00406          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}{LapackDstev}}(\&krylov\_eigen\_value[step + 1], \&krylov\_eigen\_vector, diagonal\_value, off\_diagonal\_value);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00407}00407          \textcolor{keyword}{const} RealType residual\_error = std::abs(krylov\_eigen\_value[step + 1] -\/ krylov\_eigen\_value[step]);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00408}00408          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00409}00409          \textcolor{keywordflow}{if} (params.flag\_output\_info) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00410}00410             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Step["{}} << step + 1 << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00411}00411             std::cout << residual\_error << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00412}00412          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00413}00413          \textcolor{keywordflow}{if} (residual\_error < params.acc) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00414}00414             *gs\_value\_out = krylov\_eigen\_value[step + 1];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00415}00415             converge\_step\_number = step + 1;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00416}00416             residual\_error\_final = residual\_error;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00417}00417             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00418}00418          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00419}00419       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00420}00420 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00421}00421       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00422}00422          vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] -\/= diagonal\_value[step + 1]*vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + off\_diagonal\_value[step]*vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00423}00423          vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]  = vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00424}00424       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00425}00425    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00426}00426    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00427}00427    \textcolor{keywordflow}{if} (converge\_step\_number <= 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00428}00428       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00429}00429       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00430}00430       ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00431}00431       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00432}00432    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00433}00433    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00434}00434    gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00435}00435    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00436}00436    \textcolor{keywordflow}{if} (params.flag\_store\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00437}00437 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00438}00438       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00439}00439          RealType temp\_val = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00440}00440          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j <= converge\_step\_number; ++j) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00441}00441             temp\_val += krylov\_eigen\_vector[j]*rits\_vector[j][i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00442}00442          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00443}00443          gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00444}00444       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00445}00445       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00446}00446    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00447}00447    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00448}00448       \textcolor{keywordflow}{if} (params.flag\_use\_initial\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00449}00449 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00450}00450          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00451}00451             vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00452}00452             gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00453}00453          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00454}00454       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00455}00455       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00456}00456          random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00457}00457          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00458}00458             vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00459}00459          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00460}00460       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00461}00461       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00462}00462       vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00463}00463       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(gs\_vector\_out, 1.0, *gs\_vector\_out, krylov\_eigen\_vector[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00464}00464       \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00465}00465          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00466}00466       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00467}00467       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00468}00468          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00469}00469       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00470}00470       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00471}00471       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00472}00472       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00473}00473       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 1; step <= converge\_step\_number; ++step) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00474}00474          vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(vector\_1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00475}00475          vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00476}00476          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(gs\_vector\_out, 1.0, *gs\_vector\_out, krylov\_eigen\_vector[step], vector\_2);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00477}00477          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00478}00478          \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00479}00479             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00480}00480          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00481}00481          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00482}00482             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00483}00483          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00484}00484          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00485}00485 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00486}00486          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00487}00487             vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] -\/= diagonal\_value[step]*vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + off\_diagonal\_value[step -\/ 1]*vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00488}00488             vector\_0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]  = vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00489}00489          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00490}00490          \textcolor{keywordflow}{if} (params.flag\_output\_info) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00491}00491             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Vec\_Step:"{}} << step << \textcolor{stringliteral}{"{}/"{}} << converge\_step\_number << std::string(5, \textcolor{charliteral}{' '}) << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00492}00492          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00493}00493       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00494}00494       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00495}00495    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00496}00496    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00497}00497    \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00498}00498    \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00499}00499    std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of diagonalization:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00500}00500    std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error\_final << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00501}00501    std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00502}00502    \textcolor{keywordflow}{return} \{converge\_step\_number, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00503}00503 \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00504}00504 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00505}00505 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00506}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086}{00506}} std::pair<int, double> \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086}{EigenvalueDecompositionLOBPCG}}(RealType                *gs\_value\_out,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00507}00507                                                      \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}}  *gs\_vector\_out,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00508}00508                                                      \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}}     \&matrix\_in,}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00509}00509                                                      \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}} \&params = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{ParametersLanczos}}()) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00510}00510    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00511}00511    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00512}00512       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00513}00513       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00514}00514       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00515}00515       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00516}00516       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00517}00517    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00518}00518    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00519}00519    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00520}00520    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00521}00521    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00522}00522       *gs\_value\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00523}00523       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aea9a7595862adf9c7e98138aaf0806e1}{Clear}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00524}00524       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00525}00525       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00526}00526       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00527}00527    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00528}00528    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00529}00529    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 1) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00530}00530       *gs\_value\_out = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[0];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00531}00531       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00532}00532       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00533}00533       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00534}00534       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00535}00535       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00536}00536    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00537}00537    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00538}00538    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} <= 1000) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00539}00539       std::vector<RealType> temp\_gs\_vector\_out;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00540}00540       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{LapackDsyev}}(gs\_value\_out, \&temp\_gs\_vector\_out, matrix\_in);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00541}00541       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(temp\_gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00542}00542       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00543}00543       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00544}00544       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00545}00545    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00546}00546    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00547}00547    \textcolor{keyword}{const} std::int64\_t dim = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00548}00548    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} v0(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00549}00549    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} v1(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00550}00550    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} v2(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00551}00551    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} w0(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00552}00552    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} w1(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00553}00553    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} w2(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00554}00554    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} r (dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00555}00555    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00556}00556    std::vector<std::vector<RealType>> vectors\_work;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00557}00557 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00558}00558    \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00559}00559 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00560}00560       vectors\_work = std::vector<std::vector<RealType>>(omp\_get\_max\_threads(), std::vector<RealType>(dim));}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00561}00561 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00562}00562    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00563}00563    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00564}00564    \textcolor{keywordflow}{if} (params.flag\_use\_initial\_vec) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00565}00565       v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(*gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00566}00566    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00567}00567    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00568}00568       std::uniform\_real\_distribution<RealType> uniform\_rand(-\/1, 1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00569}00569       std::mt19937 random\_number\_engine;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00570}00570       random\_number\_engine.seed(std::random\_device()());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00571}00571       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00572}00572          v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00573}00573       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00574}00574    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00575}00575    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00576}00576    v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00577}00577    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00578}00578    \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00579}00579       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&w0, 1.0, matrix\_in, v0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00580}00580    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00581}00581    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00582}00582       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&w0, 1.0, matrix\_in, v0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00583}00583    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00584}00584    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00585}00585    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.max\_step; ++step) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00586}00586       RealType a0 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00587}00587       RealType a1 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00588}00588       RealType a2 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00589}00589       RealType a3 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00590}00590       RealType a4 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00591}00591       RealType a5 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00592}00592       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00593}00593       RealType b0 = 1.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00594}00594       RealType b1 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00595}00595       RealType b2 = 1.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00596}00596       RealType b3 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00597}00597       RealType b4 = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00598}00598       RealType b5 = 1.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00599}00599 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00600}00600 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: a0, a1, a2, a3, a4, a5, b1, b3, b4)}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00601}00601       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00602}00602          a0 += v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*w0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00603}00603          a1 += v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*w1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00604}00604          a2 += v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*w1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00605}00605          a3 += v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00606}00606          a4 += v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00607}00607          a5 += v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00608}00608          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00609}00609          b1 += v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00610}00610          b3 += v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00611}00611          b4 += v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00612}00612       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00613}00613             }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00614}00614       std::vector<RealType> k\_e\_val(3);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00615}00615       std::vector<RealType> k\_e\_vec(9);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00616}00616       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00617}00617       \textcolor{keywordtype}{int} krylov\_dim = 3;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00618}00618       std::vector<RealType> mat\_a = \{a0, a1, a2, a3, a4, a5\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00619}00619       std::vector<RealType> mat\_b = \{b0, b1, b2, b3, b4, b5\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00620}00620 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00621}00621       \textcolor{keywordflow}{if} (step <= 1) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00622}00622          krylov\_dim = step + 1;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00623}00623       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00624}00624 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00625}00625       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78}{LapackDspgv}}(\&k\_e\_val, \&k\_e\_vec, 1, krylov\_dim, mat\_a, mat\_b);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00626}00626          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00627}00627       RealType residual\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00628}00628       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00629}00629 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: residual\_error)}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00630}00630       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00631}00631          r.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = k\_e\_vec[0]*w0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[1]*w1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[2]*w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00632}00632                   -\/ k\_e\_val[0]*(k\_e\_vec[0]*v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[1]*v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[2]*v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00633}00633          residual\_error += r.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*r.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00634}00634       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00635}00635       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00636}00636       \textcolor{keywordflow}{if} (params.flag\_output\_info) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00637}00637          std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLOBPCG\_Step["{}} << step + 1 << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00638}00638          std::cout << residual\_error << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00639}00639       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00640}00640       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00641}00641       \textcolor{keywordflow}{if} (residual\_error < params.acc) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00642}00642          *gs\_value\_out = k\_e\_val[0];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00643}00643          gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00644}00644          }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00645}00645 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00646}00646          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00647}00647             gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = k\_e\_vec[0]*w0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[1]*w1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[2]*w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00648}00648          \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00649}00649          gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00650}00650          \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00651}00651          \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00652}00652          std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of diagonalization:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00653}00653          std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00654}00654          std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00655}00655          \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00656}00656       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00657}00657 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00658}00658 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00659}00659       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00660}00660          v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = k\_e\_vec[0]*v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[1]*v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[2]*v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00661}00661          v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = k\_e\_vec[1]*v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[2]*v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00662}00662          v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = r.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00663}00663       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00664}00664       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00665}00665       RealType alpha = 1.0/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(v0, v0);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00666}00666       RealType beta  = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(v2, v2);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00667}00667             }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00668}00668       v0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00669}00669       v1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00670}00670       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00671}00671       \textcolor{keywordflow}{if} (beta > 0) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00672}00672          beta = 1.0/std::sqrt(beta);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00673}00673          v2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00674}00674       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00675}00675       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00676}00676          beta = 0.0;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00677}00677       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00678}00678       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00679}00679 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00680}00680       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00681}00681          w0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = alpha*(k\_e\_vec[0]*w0.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[1]*w1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[2]*w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00682}00682          w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = beta*(k\_e\_vec[1]*w1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + k\_e\_vec[2]*w2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00683}00683       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00684}00684       }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00685}00685       \textcolor{keywordflow}{if} (params.flag\_symmetric\_crs) \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00686}00686          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&w1, 1.0, matrix\_in, v1, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00687}00687       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00688}00688       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00689}00689          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&w1, 1.0, matrix\_in, v1);}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00690}00690       \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00691}00691    \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00692}00692    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00693}00693    std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00694}00694    ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00695}00695    ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00696}00696    \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00697}00697    }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00698}00698 \}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00699}00699 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00700}00700 \} \textcolor{comment}{// namespace sparse\_matrix}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00701}00701 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00702}00702 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00703}00703 }
\DoxyCodeLine{\Hypertarget{eigendecomposition_8hpp_source_l00704}00704 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* eigendecomposition\_hpp */}\textcolor{preprocessor}{}}

\end{DoxyCode}
