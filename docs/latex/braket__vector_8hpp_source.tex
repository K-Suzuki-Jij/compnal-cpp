\hypertarget{braket__vector_8hpp_source}{}\doxysection{braket\+\_\+vector.\+hpp}
\label{braket__vector_8hpp_source}\index{src/sparse\_matrix/braket\_vector.hpp@{src/sparse\_matrix/braket\_vector.hpp}}
\mbox{\hyperlink{braket__vector_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/05/22.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SPARSE\_MATRIX\_BRAKET\_VECTOR\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SPARSE\_MATRIX\_BRAKET\_VECTOR\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../type.hpp"{}}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{33 \textcolor{keyword}{namespace }sparse\_matrix \{}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{36 \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \{}
\DoxyCodeLine{37    }
\DoxyCodeLine{38    std::vector<RealType> \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}};}
\DoxyCodeLine{39    }
\DoxyCodeLine{40    \textcolor{keyword}{explicit} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a6b8f2f566ab0343feb65f63711f7653b}{BraketVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} dim = 0) \{}
\DoxyCodeLine{41       this-\/>val.resize(dim);}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{43       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < dim; ++i) \{}
\DoxyCodeLine{44          this-\/>val[i] = 0.0;}
\DoxyCodeLine{45       \}}
\DoxyCodeLine{46    \}}
\DoxyCodeLine{47    }
\DoxyCodeLine{48    \textcolor{keyword}{explicit} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aa3a2db3bdb374fc1bc3b0b7d39fba345}{BraketVector}}(\textcolor{keyword}{const} std::vector<RealType> \&vector) \{}
\DoxyCodeLine{49       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(vector);}
\DoxyCodeLine{50    \}}
\DoxyCodeLine{51    }
\DoxyCodeLine{52    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afc6811b78fadbcf84fea85b2dcae01e9}{BraketVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&vector) \{}
\DoxyCodeLine{53       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(vector);}
\DoxyCodeLine{54    \}}
\DoxyCodeLine{55    }
\DoxyCodeLine{56    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_af436a236c13a190b1d91475319dab215}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&vector) \& \{}
\DoxyCodeLine{57       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(vector);}
\DoxyCodeLine{58       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{59    \}}
\DoxyCodeLine{60    }
\DoxyCodeLine{61    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_abce9f7ffdc98fd45a75f29c76bfb2fcb}{Fill}}(\textcolor{keyword}{const} RealType val\_in) \{}
\DoxyCodeLine{62 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{63       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>val.size(); ++i) \{}
\DoxyCodeLine{64          this-\/>val[i] = val\_in;}
\DoxyCodeLine{65       \}}
\DoxyCodeLine{66    \}}
\DoxyCodeLine{67    }
\DoxyCodeLine{68    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_abfb93aceef563dc171c807f0fe8391d3}{Free}}() \{}
\DoxyCodeLine{69       std::vector<RealType>().swap(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}});}
\DoxyCodeLine{70    \}}
\DoxyCodeLine{71    }
\DoxyCodeLine{72    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aea9a7595862adf9c7e98138aaf0806e1}{Clear}}() \{}
\DoxyCodeLine{73       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.clear();}
\DoxyCodeLine{74    \}}
\DoxyCodeLine{75    }
\DoxyCodeLine{76    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector}} \&vector) \{}
\DoxyCodeLine{77       this-\/>val.resize(vector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size());}
\DoxyCodeLine{78 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{79       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size(); ++i) \{}
\DoxyCodeLine{80          this-\/>val[i] = vector.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{81       \}}
\DoxyCodeLine{82    \}}
\DoxyCodeLine{83    }
\DoxyCodeLine{84    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aa0adc0cdf252f0cf68a02f7147678d37}{Assign}}(\textcolor{keyword}{const} std::vector<RealType> \&vector) \{}
\DoxyCodeLine{85       this-\/>val.resize(vector.size());}
\DoxyCodeLine{86 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{87       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vector.size(); ++i) \{}
\DoxyCodeLine{88          this-\/>val[i] = vector[i];}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90    \}}
\DoxyCodeLine{91    }
\DoxyCodeLine{92    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}(\textcolor{keyword}{const} RealType normalization\_factor = 1.0) \{}
\DoxyCodeLine{93       \textcolor{keyword}{const} RealType norm = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a86a86a5b08913d8b9262e3b7c27d68cf}{L2Norm}}();}
\DoxyCodeLine{94       \textcolor{keywordflow}{if} (norm == 0.0) \{}
\DoxyCodeLine{95          std::stringstream ss;}
\DoxyCodeLine{96          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{97          ss << \textcolor{stringliteral}{"{}All the elements are zero"{}} << std::endl;}
\DoxyCodeLine{98          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{99       \}}
\DoxyCodeLine{100       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a84f352668f31818b5b947ca932d3b18f}{MultiplyByScalar}}(normalization\_factor/norm);}
\DoxyCodeLine{101    \}}
\DoxyCodeLine{102    }
\DoxyCodeLine{103    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a84f352668f31818b5b947ca932d3b18f}{MultiplyByScalar}}(\textcolor{keyword}{const} RealType coeef) \{}
\DoxyCodeLine{104 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{105       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>val.size(); ++i) \{}
\DoxyCodeLine{106          this-\/>val[i] *= coeef;}
\DoxyCodeLine{107       \}}
\DoxyCodeLine{108    \}}
\DoxyCodeLine{109    }
\DoxyCodeLine{110    RealType \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a827fce19bf033d6317537d3f15ecca48}{L1Norm}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{111       RealType norm = 0.0;}
\DoxyCodeLine{112 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+:norm)}}
\DoxyCodeLine{113       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < this-\/>val.size(); ++i) \{}
\DoxyCodeLine{114          norm += std::abs(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]);}
\DoxyCodeLine{115       \}}
\DoxyCodeLine{116       \textcolor{keywordflow}{return} norm;}
\DoxyCodeLine{117    \}}
\DoxyCodeLine{118    }
\DoxyCodeLine{119    }
\DoxyCodeLine{120    RealType \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a86a86a5b08913d8b9262e3b7c27d68cf}{L2Norm}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{121       RealType inner\_product = 0.0;}
\DoxyCodeLine{122 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+:inner\_product)}}
\DoxyCodeLine{123       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>val.size(); ++i) \{}
\DoxyCodeLine{124          inner\_product += \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{125       \}}
\DoxyCodeLine{126       \textcolor{keywordflow}{return} std::sqrt(inner\_product);}
\DoxyCodeLine{127    \}}
\DoxyCodeLine{128    }
\DoxyCodeLine{129    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_a78473574eb1916f76d473a6de08f8040}{Print}}(\textcolor{keyword}{const} std::string display\_name = \textcolor{stringliteral}{"{}BraketVector"{}})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{130       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>val.size(); i++) \{}
\DoxyCodeLine{131          std::cout << display\_name << \textcolor{stringliteral}{"{}["{}} << i << \textcolor{stringliteral}{"{}]="{}} << this-\/>val[i] << std::endl;}
\DoxyCodeLine{132       \}}
\DoxyCodeLine{133    \}}
\DoxyCodeLine{134    }
\DoxyCodeLine{135 \};}
\DoxyCodeLine{136 }
\DoxyCodeLine{137 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{138 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} *vector\_out,}
\DoxyCodeLine{139                         \textcolor{keyword}{const} RealType coeef\_1,}
\DoxyCodeLine{140                         \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_1,}
\DoxyCodeLine{141                         \textcolor{keyword}{const} RealType coeef\_2,}
\DoxyCodeLine{142                         \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_2) \{}
\DoxyCodeLine{143    \textcolor{keywordflow}{if} (braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() != braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) \{}
\DoxyCodeLine{144       std::stringstream ss;}
\DoxyCodeLine{145       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{146       ss << \textcolor{stringliteral}{"{}BraketVector types do not match each other"{}} << std::endl;}
\DoxyCodeLine{147       ss << \textcolor{stringliteral}{"{}dim\_1 = "{}} << braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << \textcolor{stringliteral}{"{}, dim\_2 = "{}} << braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{148       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{149    \}}
\DoxyCodeLine{150    vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size());}
\DoxyCodeLine{151 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{152    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size(); ++i) \{}
\DoxyCodeLine{153       vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = coeef\_1*braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + coeef\_2*braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{154    \}}
\DoxyCodeLine{155 \}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{158 RealType \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a1a9993418bced60b2ec89ed57b48c665}{CalculateL1Norm}}(\textcolor{keyword}{const} RealType coeef\_1,}
\DoxyCodeLine{159                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_1,}
\DoxyCodeLine{160                          \textcolor{keyword}{const} RealType coeef\_2,}
\DoxyCodeLine{161                          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_2}
\DoxyCodeLine{162                          ) \{}
\DoxyCodeLine{163    }
\DoxyCodeLine{164    \textcolor{keywordflow}{if} (braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() != braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) \{}
\DoxyCodeLine{165       std::stringstream ss;}
\DoxyCodeLine{166       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{167       ss << \textcolor{stringliteral}{"{}BraketVector types do not match each other"{}} << std::endl;}
\DoxyCodeLine{168       ss << \textcolor{stringliteral}{"{}dim\_1 = "{}} << braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << \textcolor{stringliteral}{"{}, dim\_2 = "{}} << braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{169       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{170    \}}
\DoxyCodeLine{171    }
\DoxyCodeLine{172    RealType val\_out = 0.0;}
\DoxyCodeLine{173 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: val\_out)}}
\DoxyCodeLine{174    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size(); ++i) \{}
\DoxyCodeLine{175       val\_out += std::abs(coeef\_1*braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] -\/ coeef\_2*braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]);}
\DoxyCodeLine{176    \}}
\DoxyCodeLine{177    \textcolor{keywordflow}{return} val\_out;}
\DoxyCodeLine{178 \}}
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{181 RealType \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_1,}
\DoxyCodeLine{182                                \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_2) \{}
\DoxyCodeLine{183    \textcolor{keywordflow}{if} (braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() != braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) \{}
\DoxyCodeLine{184       std::stringstream ss;}
\DoxyCodeLine{185       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{186       ss << \textcolor{stringliteral}{"{}BraketVector types do not match each other"{}} << std::endl;}
\DoxyCodeLine{187       ss << \textcolor{stringliteral}{"{}dim\_1 = "{}} << braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << \textcolor{stringliteral}{"{}, dim\_2 = "{}} << braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{188       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{189    \}}
\DoxyCodeLine{190    RealType val\_out = 0.0;}
\DoxyCodeLine{191 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: val\_out)}}
\DoxyCodeLine{192    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size(); ++i) \{}
\DoxyCodeLine{193       val\_out += braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{194    \}}
\DoxyCodeLine{195    \textcolor{keywordflow}{return} val\_out;}
\DoxyCodeLine{196 \}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{199 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\textcolor{keyword}{const} RealType coeef\_1,}
\DoxyCodeLine{200                                           \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_1,}
\DoxyCodeLine{201                                           \textcolor{keyword}{const} RealType coeef\_2,}
\DoxyCodeLine{202                                           \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} \&braket\_vector\_2) \{}
\DoxyCodeLine{203    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_out;}
\DoxyCodeLine{204    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_out, coeef\_1, braket\_vector\_1, coeef\_2, braket\_vector\_2);}
\DoxyCodeLine{205    \textcolor{keywordflow}{return} vector\_out;}
\DoxyCodeLine{206 \}}
\DoxyCodeLine{207 }
\DoxyCodeLine{208 \} \textcolor{comment}{// namespace sparse\_matrix}}
\DoxyCodeLine{209 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{210 }
\DoxyCodeLine{211 }
\DoxyCodeLine{212 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SPARSE\_MATRIX\_BRAKET\_VECTOR\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
