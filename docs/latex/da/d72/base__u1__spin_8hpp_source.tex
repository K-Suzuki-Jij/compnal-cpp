\hypertarget{base__u1__spin_8hpp_source}{}\doxysection{base\+\_\+u1\+\_\+spin.\+hpp}
\label{base__u1__spin_8hpp_source}\index{src/model/base\_u1\_spin.hpp@{src/model/base\_u1\_spin.hpp}}
\mbox{\hyperlink{base__u1__spin_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/18.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_MODEL\_BASE\_U1SPIN\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_MODEL\_BASE\_U1SPIN\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../blas/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}../type/all.hpp"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{30 \textcolor{keyword}{namespace }model \{}
\DoxyCodeLine{31 }
\DoxyCodeLine{36 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{37 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin}{BaseU1Spin}} \{}
\DoxyCodeLine{38    }
\DoxyCodeLine{39    \textcolor{keyword}{static\_assert}(std::is\_floating\_point<RealType>::value, \textcolor{stringliteral}{"{}Template parameter RealType must be floating point type"{}});}
\DoxyCodeLine{40    }
\DoxyCodeLine{41    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{42    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Type Alias-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{43    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{45 \textcolor{comment}{}   \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} = \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{type::HalfInt}};}
\DoxyCodeLine{46    }
\DoxyCodeLine{48    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{type::CRS<RealType>}};}
\DoxyCodeLine{49    }
\DoxyCodeLine{50 \textcolor{keyword}{public}:}
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{52    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Type Alias-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{53    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{55 \textcolor{comment}{}   \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a536e8998eb12f94692d460def94be51c}{HalfInt}};}
\DoxyCodeLine{56    }
\DoxyCodeLine{58    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1utility_1_1_half_int_hash}{QHash}} = \mbox{\hyperlink{structcompnal_1_1utility_1_1_half_int_hash}{utility::HalfIntHash}};}
\DoxyCodeLine{59    }
\DoxyCodeLine{61    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ac1d00aef742d651d7443f69fe6aa35d7}{ValueType}} = RealType;}
\DoxyCodeLine{62    }
\DoxyCodeLine{63    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{64    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{65    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{67 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a99932d800811ad7bacbdd124620e97a2}{BaseU1Spin}}() \{}
\DoxyCodeLine{68       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a55509590c0fe917c47ba022acbabcb2c}{SetOnsiteOperator}}();}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70    }
\DoxyCodeLine{73    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a90d8388c7feec9f08bcf9253583e222b}{BaseU1Spin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{74       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a569a6978dc3b834ff3875534cf4761ab}{SetMagnitudeSpin}}(magnitude\_spin);}
\DoxyCodeLine{75    \}}
\DoxyCodeLine{76    }
\DoxyCodeLine{80    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_abb7b959eecaa06a005093bcfd4040a37}{BaseU1Spin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{81       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a569a6978dc3b834ff3875534cf4761ab}{SetMagnitudeSpin}}(magnitude\_spin);}
\DoxyCodeLine{82       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a3583b5848b9c60b746d003ab243fb3df}{SetTotalSz}}(total\_sz);}
\DoxyCodeLine{83    \}}
\DoxyCodeLine{84    }
\DoxyCodeLine{85    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{86    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{87    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{90 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a569a6978dc3b834ff3875534cf4761ab}{SetMagnitudeSpin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{91       \textcolor{keywordflow}{if} (magnitude\_spin <= 0) \{}
\DoxyCodeLine{92          std::stringstream ss;}
\DoxyCodeLine{93          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{94          ss << \textcolor{stringliteral}{"{}Please set magnitude\_spin > 0"{}} << std::endl;}
\DoxyCodeLine{95          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{96       \}}
\DoxyCodeLine{97       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} = magnitude\_spin;}
\DoxyCodeLine{98       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}     = 2*magnitude\_spin + 1;}
\DoxyCodeLine{99       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a55509590c0fe917c47ba022acbabcb2c}{SetOnsiteOperator}}();}
\DoxyCodeLine{100    \}}
\DoxyCodeLine{101    }
\DoxyCodeLine{104    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a3583b5848b9c60b746d003ab243fb3df}{SetTotalSz}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{105       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}} = total\_sz;}
\DoxyCodeLine{106    \}}
\DoxyCodeLine{107       }
\DoxyCodeLine{111    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a088f30223f8b6655b1d8e452c04ee015}{CalculateNumElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{112       \textcolor{keywordflow}{if} (0 <= basis\_onsite \&\& basis\_onsite < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}) \{}
\DoxyCodeLine{113          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{114       \}}
\DoxyCodeLine{115       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{116          std::stringstream ss;}
\DoxyCodeLine{117          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{118          ss << \textcolor{stringliteral}{"{}Invalid onsite basis"{}} << std::endl;}
\DoxyCodeLine{119          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{120       \}}
\DoxyCodeLine{121    \}}
\DoxyCodeLine{122    }
\DoxyCodeLine{124    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a698b2dee724a4d739751bb0e1435bd56}{PrintBasisOnsite}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{125       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}; ++row) \{}
\DoxyCodeLine{126          std::cout << \textcolor{stringliteral}{"{}row "{}} << row << \textcolor{stringliteral}{"{}: |Sz="{}} << \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} -\/ row << \textcolor{stringliteral}{"{}>"{}} << std::endl;}
\DoxyCodeLine{127       \}}
\DoxyCodeLine{128    \}}
\DoxyCodeLine{129    }
\DoxyCodeLine{135    \textcolor{keyword}{template}<\textcolor{keyword}{typename} IntegerType>}
\DoxyCodeLine{136    \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a02014031ca360e919ebd48e451e3d9e3}{CalculateQNumber}}(\textcolor{keyword}{const} IntegerType row, \textcolor{keyword}{const} IntegerType col)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{137       \textcolor{keyword}{static\_assert}(std::is\_integral<IntegerType>::value, \textcolor{stringliteral}{"{}Template parameter IntegerType must be integer type"{}});}
\DoxyCodeLine{138       \textcolor{keywordflow}{if} (row < 0 || col < 0 || \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}} <= row || \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}} <= col) \{}
\DoxyCodeLine{139          std::stringstream ss;}
\DoxyCodeLine{140          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{141          ss << \textcolor{stringliteral}{"{}Invalid parameters"{}} << std::endl;}
\DoxyCodeLine{142          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{143       \}}
\DoxyCodeLine{144       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}}\textcolor{keyword}{>}(col -\/ row + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}});}
\DoxyCodeLine{145    \}}
\DoxyCodeLine{146    }
\DoxyCodeLine{154    std::vector<std::int64\_t> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ae922d2e4aefb5457a485d6433318ed16}{GenerateBasis}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size,}
\DoxyCodeLine{155                                            \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} total\_sz,}
\DoxyCodeLine{156                                            \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_display\_info = \textcolor{keyword}{true})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{157       }
\DoxyCodeLine{158       \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{159 }
\DoxyCodeLine{160       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}, total\_sz)) \{}
\DoxyCodeLine{161          std::stringstream ss;}
\DoxyCodeLine{162          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{163          ss << \textcolor{stringliteral}{"{}Invalid parameters (system\_size or magnitude\_spin or total\_sz)"{}} << std::endl;}
\DoxyCodeLine{164          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{165       \}}
\DoxyCodeLine{166             }
\DoxyCodeLine{167       \textcolor{keywordflow}{if} (flag\_display\_info) \{}
\DoxyCodeLine{168          std::cout << \textcolor{stringliteral}{"{}Generating Basis..."{}} << std::flush;}
\DoxyCodeLine{169       \}}
\DoxyCodeLine{170             }
\DoxyCodeLine{171       \textcolor{keyword}{auto} partition\_integers = \mbox{\hyperlink{namespacecompnal_1_1utility_a19f7e6247e080cfaf331019133ae80cd}{utility::GenerateIntegerPartition}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(system\_size*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} -\/ total\_sz),}
\DoxyCodeLine{172                                                                   \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(2*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}),}
\DoxyCodeLine{173                                                                   system\_size);}
\DoxyCodeLine{174       }
\DoxyCodeLine{175       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&it: partition\_integers) \{}
\DoxyCodeLine{176          it.resize(system\_size, 0);}
\DoxyCodeLine{177       \}}
\DoxyCodeLine{178       }
\DoxyCodeLine{179       std::vector<std::int64\_t> site\_constant(system\_size);}
\DoxyCodeLine{180       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < system\_size; ++site) \{}
\DoxyCodeLine{181          site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}, site));}
\DoxyCodeLine{182       \}}
\DoxyCodeLine{183       }
\DoxyCodeLine{184       \textcolor{keyword}{const} std::int64\_t dim\_target = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2d55d47c1494ea84e91892b1a5d94aac}{CalculateTargetDim}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}, total\_sz);}
\DoxyCodeLine{185       std::vector<std::int64\_t> basis;}
\DoxyCodeLine{186       basis.reserve(dim\_target);}
\DoxyCodeLine{187       }
\DoxyCodeLine{188 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{189       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{190       std::vector<std::vector<std::int64\_t>> temp\_basis(num\_threads);}
\DoxyCodeLine{191       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&integer\_list: partition\_integers) \{}
\DoxyCodeLine{192          \textcolor{keyword}{const} std::int64\_t size = \mbox{\hyperlink{namespacecompnal_1_1utility_aee9ff806431adb586e95bc9d77516915}{utility::CalculateNumPermutation}}(integer\_list);}
\DoxyCodeLine{193 \textcolor{preprocessor}{\#pragma omp parallel num\_threads (num\_threads)}}
\DoxyCodeLine{194          \{}
\DoxyCodeLine{195             \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{196             \textcolor{keyword}{const} std::int64\_t loop\_begin = thread\_num*size/num\_threads;}
\DoxyCodeLine{197             \textcolor{keyword}{const} std::int64\_t loop\_end   = (thread\_num + 1)*size/num\_threads;}
\DoxyCodeLine{198             std::vector<int> n\_th\_integer\_list = \mbox{\hyperlink{namespacecompnal_1_1utility_a7e59d7a03bcbd9fb222fd52300d29fd7}{utility::GenerateNthPermutation}}(integer\_list, loop\_begin);}
\DoxyCodeLine{199             \textcolor{keywordflow}{for} (std::int64\_t j = loop\_begin; j < loop\_end; ++j) \{}
\DoxyCodeLine{200                std::int64\_t basis\_global = 0;}
\DoxyCodeLine{201                \textcolor{keywordflow}{for} (std::size\_t k = 0; k < n\_th\_integer\_list.size(); ++k) \{}
\DoxyCodeLine{202                   basis\_global += n\_th\_integer\_list[k]*site\_constant[k];}
\DoxyCodeLine{203                \}}
\DoxyCodeLine{204                temp\_basis[thread\_num].push\_back(basis\_global);}
\DoxyCodeLine{205                std::next\_permutation(n\_th\_integer\_list.begin(), n\_th\_integer\_list.end());}
\DoxyCodeLine{206             \}}
\DoxyCodeLine{207          \}}
\DoxyCodeLine{208       \}}
\DoxyCodeLine{209       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&it: temp\_basis) \{}
\DoxyCodeLine{210          basis.insert(basis.end(), it.begin(), it.end());}
\DoxyCodeLine{211          std::vector<std::int64\_t>().swap(it);}
\DoxyCodeLine{212       \}}
\DoxyCodeLine{213 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{214       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < partition\_integers.size(); ++i) \{}
\DoxyCodeLine{215          \textcolor{keyword}{auto} \&integer\_list = partition\_integers[i];}
\DoxyCodeLine{216          std::sort(integer\_list.begin(), integer\_list.end());}
\DoxyCodeLine{217          \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{218             std::int64\_t basis\_global = 0;}
\DoxyCodeLine{219             \textcolor{keywordflow}{for} (std::size\_t j = 0; j < integer\_list.size(); ++j) \{}
\DoxyCodeLine{220                basis\_global += integer\_list[j]*site\_constant[j];}
\DoxyCodeLine{221             \}}
\DoxyCodeLine{222             basis.push\_back(basis\_global);}
\DoxyCodeLine{223          \} \textcolor{keywordflow}{while} (std::next\_permutation(integer\_list.begin(), integer\_list.end()));}
\DoxyCodeLine{224       \}}
\DoxyCodeLine{225 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{226       basis.shrink\_to\_fit();}
\DoxyCodeLine{227       }
\DoxyCodeLine{228       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size()) != dim\_target) \{}
\DoxyCodeLine{229          std::stringstream ss;}
\DoxyCodeLine{230          ss << \textcolor{stringliteral}{"{}Unknown error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{231          ss << \textcolor{stringliteral}{"{}basis.size()="{}} << basis.size() << \textcolor{stringliteral}{"{}, but dim\_target="{}} << dim\_target << std::endl;}
\DoxyCodeLine{232          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{233       \}}
\DoxyCodeLine{234       }
\DoxyCodeLine{235       std::sort(basis.begin(), basis.end());}
\DoxyCodeLine{236       }
\DoxyCodeLine{237       \textcolor{keywordflow}{if} (flag\_display\_info) \{}
\DoxyCodeLine{238          \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{239          \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1blas_aa1196aeb106e923cc2ad6c17fea58f26}{blas::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{240          std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating basis:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{241       \}}
\DoxyCodeLine{242       \textcolor{keywordflow}{return} basis;}
\DoxyCodeLine{243    \}}
\DoxyCodeLine{244    }
\DoxyCodeLine{249    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{250       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} ,total\_sz);}
\DoxyCodeLine{251    \}}
\DoxyCodeLine{252    }
\DoxyCodeLine{258    std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2d55d47c1494ea84e91892b1a5d94aac}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{QType}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{259       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2d55d47c1494ea84e91892b1a5d94aac}{CalculateTargetDim}}(system\_size, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}, total\_sz);}
\DoxyCodeLine{260    \}}
\DoxyCodeLine{261       }
\DoxyCodeLine{262    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{263    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Static Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{264    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{270 \textcolor{comment}{}   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ace7f8cf7db6d6c88b06bb2372941c5f6}{ValidateQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{271       \textcolor{keywordflow}{if} (system\_size <= 0 || magnitude\_spin <= 0) \{}
\DoxyCodeLine{272          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{273       \}}
\DoxyCodeLine{274       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz       = 2*total\_sz;}
\DoxyCodeLine{275       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = 2*magnitude\_spin;}
\DoxyCodeLine{276       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = ((system\_size*magnitude\_2spin -\/ total\_2sz)\%2 == 0);}
\DoxyCodeLine{277       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (-\/system\_size*magnitude\_2spin <= total\_2sz);}
\DoxyCodeLine{278       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (total\_2sz <= system\_size*magnitude\_2spin);}
\DoxyCodeLine{279       \textcolor{keywordflow}{if} (c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{280          \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{281       \}}
\DoxyCodeLine{282       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{283          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{284       \}}
\DoxyCodeLine{285    \}}
\DoxyCodeLine{286    }
\DoxyCodeLine{293    \textcolor{keyword}{static} std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_abbb5256ebd88f752641627074e1b42af}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{294       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_af88354bb24146bcdde2372acb6fefa77}{ValidateQNumber}}(system\_size, magnitude\_spin, total\_sz)) \{}
\DoxyCodeLine{295          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{296       \}}
\DoxyCodeLine{297       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = 2*magnitude\_spin;}
\DoxyCodeLine{298       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz       = 2*total\_sz;}
\DoxyCodeLine{299       \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_total\_2sz   = system\_size*magnitude\_2spin;}
\DoxyCodeLine{300       std::vector<std::vector<std::int64\_t>> dim(system\_size, std::vector<std::int64\_t>(max\_total\_2sz + 1));}
\DoxyCodeLine{301       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{302          dim[0][(s + magnitude\_2spin)/2] = 1;}
\DoxyCodeLine{303       \}}
\DoxyCodeLine{304       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 1; site < system\_size; site++) \{}
\DoxyCodeLine{305          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{306             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s\_prev = -\/magnitude\_2spin*site; s\_prev <= magnitude\_2spin*site; s\_prev += 2) \{}
\DoxyCodeLine{307                \textcolor{keyword}{const} std::int64\_t a = dim[site    ][(s + s\_prev + magnitude\_2spin*(site + 1))/2];}
\DoxyCodeLine{308                \textcolor{keyword}{const} std::int64\_t b = dim[site -\/ 1][(s\_prev + magnitude\_2spin*site)/2];}
\DoxyCodeLine{309                \textcolor{keywordflow}{if} (a >= INT64\_MAX -\/ b) \{}
\DoxyCodeLine{310                   \textcolor{keywordflow}{throw} std::overflow\_error(\textcolor{stringliteral}{"{}Overflow detected for sumation using uint64\_t"{}});}
\DoxyCodeLine{311                \}}
\DoxyCodeLine{312                dim[site][(s + s\_prev + magnitude\_2spin*(site + 1))/2] = a + b;}
\DoxyCodeLine{313             \}}
\DoxyCodeLine{314          \}}
\DoxyCodeLine{315       \}}
\DoxyCodeLine{316       \textcolor{keywordflow}{return} dim[system\_size -\/ 1][(total\_2sz + max\_total\_2sz)/2];}
\DoxyCodeLine{317    \}}
\DoxyCodeLine{318    }
\DoxyCodeLine{322    \textcolor{keyword}{static} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6cf484f066492e0865296e842b23bcfb}{CreateOnsiteOperatorSx}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{323       \textcolor{keywordflow}{return} RealType\{0.5\}*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}}(magnitude\_spin) + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}}(magnitude\_spin));}
\DoxyCodeLine{324    \}}
\DoxyCodeLine{325    }
\DoxyCodeLine{330    \textcolor{keyword}{static} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0ad8ed9859946ad665f469f200278188}{CreateOnsiteOperatoriSy}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{331       \textcolor{keywordflow}{return} RealType\{0.5\}*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}}(magnitude\_spin) -\/ \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}}(magnitude\_spin));}
\DoxyCodeLine{332    \}}
\DoxyCodeLine{333    }
\DoxyCodeLine{337    \textcolor{keyword}{static} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a63d1f180fc4be983c436d9e5251c927d}{CreateOnsiteOperatorSz}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{338       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 2*magnitude\_spin + 1;}
\DoxyCodeLine{339       \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{340       }
\DoxyCodeLine{341       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{342          \textcolor{keyword}{const} RealType val = magnitude\_spin -\/ row;}
\DoxyCodeLine{343          \textcolor{keywordflow}{if} (val != 0.0) \{}
\DoxyCodeLine{344             matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(val);}
\DoxyCodeLine{345             matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(row);}
\DoxyCodeLine{346          \}}
\DoxyCodeLine{347          matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[row + 1] = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size();}
\DoxyCodeLine{348       \}}
\DoxyCodeLine{349       matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{type::CRSTag::BOSON}};}
\DoxyCodeLine{350       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{351    \}}
\DoxyCodeLine{352    }
\DoxyCodeLine{356    \textcolor{keyword}{static} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{357       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 2*magnitude\_spin + 1;}
\DoxyCodeLine{358       \textcolor{keyword}{const} RealType constant = 2.0;}
\DoxyCodeLine{359       \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{360       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{361          matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*constant*row -\/ row*(row + 1)));}
\DoxyCodeLine{362          matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(row);}
\DoxyCodeLine{363          matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[row] = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size();}
\DoxyCodeLine{364       \}}
\DoxyCodeLine{365       matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size();}
\DoxyCodeLine{366       matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{type::CRSTag::BOSON}};}
\DoxyCodeLine{367       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{368    \}}
\DoxyCodeLine{369    }
\DoxyCodeLine{373    \textcolor{keyword}{static} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{374       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 2*magnitude\_spin + 1;}
\DoxyCodeLine{375       \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{376       \textcolor{keyword}{const} RealType constant = 2.0;}
\DoxyCodeLine{377       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{378          matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*constant*row -\/ row*(row + 1)));}
\DoxyCodeLine{379          matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(row -\/ 1);}
\DoxyCodeLine{380          matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[row + 1] = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size();}
\DoxyCodeLine{381       \}}
\DoxyCodeLine{382       matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{type::CRSTag::BOSON}};}
\DoxyCodeLine{383       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{384    \}}
\DoxyCodeLine{385    }
\DoxyCodeLine{386    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{387    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Access Member variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{388    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{391 \textcolor{comment}{}   \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_afaabb5a037faa01bbce5ab49395da0d7}{GetDimOnsite}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}}; \}}
\DoxyCodeLine{392    }
\DoxyCodeLine{395    \textcolor{keyword}{inline} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_aedd60e2f33ce829d43c64ce92152e3a8}{GetTotalSz}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}}; \}}
\DoxyCodeLine{396       }
\DoxyCodeLine{399    \textcolor{keyword}{inline} \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a3d16f2c2a1878069b990b3113193b357}{GetMagnitudeSpin}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}}; \}}
\DoxyCodeLine{400    }
\DoxyCodeLine{403    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a4d537383db9e0f46cd59f5b924414b85}{GetOnsiteOperatorSx}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ab613ccb8b87eee4bee36a14e12a3a0b9}{onsite\_operator\_sx\_}}; \}}
\DoxyCodeLine{404    }
\DoxyCodeLine{407    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_aed78042369da66f16b1f867e47724417}{GetOnsiteOperatoriSy}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0babc32412530971a3768aa746f22ee5}{onsite\_operator\_isy\_}}; \}}
\DoxyCodeLine{408    }
\DoxyCodeLine{411    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_acf36ca8ae0fc2eabdfd6369ffd1b66ab}{GetOnsiteOperatorSz}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9de3f6eb120e22b725ec926eaa3ee5ec}{onsite\_operator\_sz\_}}; \}}
\DoxyCodeLine{412    }
\DoxyCodeLine{415    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a29becac997032c3519495727feefc942}{GetOnsiteOperatorSp}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a89292c6449728fc422a26454e4c0d0e3}{onsite\_operator\_sp\_}}; \}}
\DoxyCodeLine{416    }
\DoxyCodeLine{419    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a8e6b4ebc2469fbb5f79f6be88227acdd}{GetOnsiteOperatorSm}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9dd5b896bc5afcc4ead4750f5399191e}{onsite\_operator\_sm\_}}; \}}
\DoxyCodeLine{420    }
\DoxyCodeLine{421 \textcolor{keyword}{private}:}
\DoxyCodeLine{422    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{423    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{424    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{426 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a002376a8a964023d697f01bf674197c1}{total\_sz\_}} = 0;}
\DoxyCodeLine{427    }
\DoxyCodeLine{429    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0e18f2a9e9c9245f1d87dfdf63f9a5ba}{dim\_onsite\_}} = 2;}
\DoxyCodeLine{430    }
\DoxyCodeLine{432    \mbox{\hyperlink{classcompnal_1_1type_1_1_half_int}{HalfInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}} = 0.5;}
\DoxyCodeLine{433    }
\DoxyCodeLine{435    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ab613ccb8b87eee4bee36a14e12a3a0b9}{onsite\_operator\_sx\_}};}
\DoxyCodeLine{436    }
\DoxyCodeLine{438    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0babc32412530971a3768aa746f22ee5}{onsite\_operator\_isy\_}};}
\DoxyCodeLine{439    }
\DoxyCodeLine{441    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9de3f6eb120e22b725ec926eaa3ee5ec}{onsite\_operator\_sz\_}};}
\DoxyCodeLine{442    }
\DoxyCodeLine{444    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a89292c6449728fc422a26454e4c0d0e3}{onsite\_operator\_sp\_}};}
\DoxyCodeLine{445    }
\DoxyCodeLine{447    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9dd5b896bc5afcc4ead4750f5399191e}{onsite\_operator\_sm\_}};}
\DoxyCodeLine{448    }
\DoxyCodeLine{449    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{450    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{451    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{453 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a55509590c0fe917c47ba022acbabcb2c}{SetOnsiteOperator}}() \{}
\DoxyCodeLine{454       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_ab613ccb8b87eee4bee36a14e12a3a0b9}{onsite\_operator\_sx\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6cf484f066492e0865296e842b23bcfb}{CreateOnsiteOperatorSx}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{455       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0babc32412530971a3768aa746f22ee5}{onsite\_operator\_isy\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a0ad8ed9859946ad665f469f200278188}{CreateOnsiteOperatoriSy}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{456       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9de3f6eb120e22b725ec926eaa3ee5ec}{onsite\_operator\_sz\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a63d1f180fc4be983c436d9e5251c927d}{CreateOnsiteOperatorSz}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{457       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a89292c6449728fc422a26454e4c0d0e3}{onsite\_operator\_sp\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a30faf4a11241d28449058113368c827c}{CreateOnsiteOperatorSp}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{458       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a9dd5b896bc5afcc4ead4750f5399191e}{onsite\_operator\_sm\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a6b9d0ff1ab79def96b6aa4b5620d39a6}{CreateOnsiteOperatorSm}} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_a2bf05396c6509a436316ad9d09750bff}{magnitude\_spin\_}});}
\DoxyCodeLine{459    \}}
\DoxyCodeLine{460    }
\DoxyCodeLine{461 \};}
\DoxyCodeLine{462 }
\DoxyCodeLine{463 \} \textcolor{comment}{//namespace model}}
\DoxyCodeLine{464 \} \textcolor{comment}{//namespace compnal}}
\DoxyCodeLine{465 }
\DoxyCodeLine{466 }
\DoxyCodeLine{467 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_BASE\_U1SPIN\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
