\hypertarget{base__u1__spin__multi__electrons__1d_8hpp_source}{}\doxysection{base\+\_\+u1\+\_\+spin\+\_\+multi\+\_\+electrons\+\_\+1d.\+hpp}
\label{base__u1__spin__multi__electrons__1d_8hpp_source}\index{src/model/base\_u1\_spin\_multi\_electrons\_1d.hpp@{src/model/base\_u1\_spin\_multi\_electrons\_1d.hpp}}
\mbox{\hyperlink{base__u1__spin__multi__electrons__1d_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/12/20.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_MODEL\_BASE\_U1\_SPIN\_MULTI\_ELECTRONS\_1D\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_MODEL\_BASE\_U1\_SPIN\_MULTI\_ELECTRONS\_1D\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}../type.hpp"{}}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{base__u1__spin__1d_8hpp}{base\_u1\_spin\_1d.hpp}}"{}}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{base__u1__electron__1d_8hpp}{base\_u1\_electron\_1d.hpp}}"{}}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <unordered\_set>}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{31 \textcolor{keyword}{namespace }model \{}
\DoxyCodeLine{32 }
\DoxyCodeLine{35 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{36 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d}{BaseU1SpinMultiElectrons\_1D}} \{}
\DoxyCodeLine{37    }
\DoxyCodeLine{39    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{40    }
\DoxyCodeLine{42    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} = std::pair<std::vector<int>, \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}}>;}
\DoxyCodeLine{43    }
\DoxyCodeLine{44 \textcolor{keyword}{public}:}
\DoxyCodeLine{45    }
\DoxyCodeLine{47    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a07fbb9d33fc515f51fa240a05575c255}{ValueType}} = RealType;}
\DoxyCodeLine{48    }
\DoxyCodeLine{49    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{50    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{53 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4359dad8dd513b330165945751b9661e}{BaseU1SpinMultiElectrons\_1D}}() \{}
\DoxyCodeLine{54       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4e56bb2b6493a742b5b06b3bfd8986a1}{SetOnsiteOperator}}();}
\DoxyCodeLine{55    \}}
\DoxyCodeLine{56    }
\DoxyCodeLine{59    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae027c08fe8c89c546c6aaa1f0c81d2d8}{BaseU1SpinMultiElectrons\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d}{BaseU1SpinMultiElectrons\_1D}}() \{}
\DoxyCodeLine{60       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4df21863fbc3dd8967fc91f6da50be7f}{SetSystemSize}}(system\_size);}
\DoxyCodeLine{61    \}}
\DoxyCodeLine{62    }
\DoxyCodeLine{66    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afec1a80671086e386dd41a19d489587c}{BaseU1SpinMultiElectrons\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d}{BaseU1SpinMultiElectrons\_1D}}(system\_size) \{}
\DoxyCodeLine{67       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac248b166cb19c735a8f4f1ea2f0e4283}{SetMagnitudeLSpin}}(magnitude\_lspin);}
\DoxyCodeLine{68    \}}
\DoxyCodeLine{69    }
\DoxyCodeLine{73    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a0e733e395381b4ef97ca3ec9eb26105a}{BaseU1SpinMultiElectrons\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size,}
\DoxyCodeLine{74                                \textcolor{keyword}{const} std::vector<int> \&total\_electron): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d}{BaseU1SpinMultiElectrons\_1D}}(system\_size) \{}
\DoxyCodeLine{75       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa8de474777ff3fd902d18820dad5ff12}{SetTotalElectron}}(total\_electron);}
\DoxyCodeLine{76    \}}
\DoxyCodeLine{77    }
\DoxyCodeLine{82    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aed7e4c8ec2c07b8d11e22173ee08bf90}{BaseU1SpinMultiElectrons\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size,}
\DoxyCodeLine{83                                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin,}
\DoxyCodeLine{84                                \textcolor{keyword}{const} std::vector<int> \&total\_electron): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d}{BaseU1SpinMultiElectrons\_1D}}(system\_size, magnitude\_lspin) \{}
\DoxyCodeLine{85       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa8de474777ff3fd902d18820dad5ff12}{SetTotalElectron}}(total\_electron);}
\DoxyCodeLine{86    \}}
\DoxyCodeLine{87    }
\DoxyCodeLine{95    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a2cc7edc60e16a1de0817e58421898c3b}{BaseU1SpinMultiElectrons\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size,}
\DoxyCodeLine{96                                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin,}
\DoxyCodeLine{97                                \textcolor{keyword}{const} std::vector<int> \&total\_electron,}
\DoxyCodeLine{98                                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d}{BaseU1SpinMultiElectrons\_1D}}(system\_size, magnitude\_lspin, total\_electron) \{}
\DoxyCodeLine{99       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe32e445d3d11f5f73f7bde983159fbb}{SetTotalSz}}(total\_sz);}
\DoxyCodeLine{100    \}}
\DoxyCodeLine{101    }
\DoxyCodeLine{102    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{103    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{104    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{107 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4df21863fbc3dd8967fc91f6da50be7f}{SetSystemSize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size) \{}
\DoxyCodeLine{108       \textcolor{keywordflow}{if} (system\_size <= 0) \{}
\DoxyCodeLine{109          std::stringstream ss;}
\DoxyCodeLine{110          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{111          ss << \textcolor{stringliteral}{"{}system\_size must be a non-\/negative integer"{}} << std::endl;}
\DoxyCodeLine{112          ss << \textcolor{stringliteral}{"{}system\_size="{}} << system\_size << \textcolor{stringliteral}{"{}is not allowed"{}} << std::endl;}
\DoxyCodeLine{113          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{114       \}}
\DoxyCodeLine{115       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}} != system\_size) \{}
\DoxyCodeLine{116          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}} = system\_size;}
\DoxyCodeLine{117          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}.clear();}
\DoxyCodeLine{118          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a658ab85ccc6d2d8abe911d27e727cafa}{bases\_inv\_}}.clear();}
\DoxyCodeLine{119          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{120       \}}
\DoxyCodeLine{121    \}}
\DoxyCodeLine{122    }
\DoxyCodeLine{127    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe32e445d3d11f5f73f7bde983159fbb}{SetTotalSz}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{128       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{129       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}} != total\_2sz) \{}
\DoxyCodeLine{130          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}} = total\_2sz;}
\DoxyCodeLine{131          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{132       \}}
\DoxyCodeLine{133    \}}
\DoxyCodeLine{134    }
\DoxyCodeLine{137    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa8de474777ff3fd902d18820dad5ff12}{SetTotalElectron}}(\textcolor{keyword}{const} std::vector<int> \&total\_electron) \{}
\DoxyCodeLine{138       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}} != \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(total\_electron.size())) \{}
\DoxyCodeLine{139          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}} = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(total\_electron.size());}
\DoxyCodeLine{140          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1a6de3078e6c329c68e8ef821bdedafe}{dim\_onsite\_all\_electrons\_}} = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa0c1648165b632ae0ca7f7da5a967f8e}{dim\_onsite\_electron\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}}));}
\DoxyCodeLine{141          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9b72902b16e25d9a0e9d4eb3520596ee}{dim\_onsite\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}}*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1a6de3078e6c329c68e8ef821bdedafe}{dim\_onsite\_all\_electrons\_}};}
\DoxyCodeLine{142          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4e56bb2b6493a742b5b06b3bfd8986a1}{SetOnsiteOperator}}();}
\DoxyCodeLine{143       \}}
\DoxyCodeLine{144       }
\DoxyCodeLine{145       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.size() < total\_electron.size()) \{}
\DoxyCodeLine{146          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.size(); ++i) \{}
\DoxyCodeLine{147             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.at(i) != total\_electron.at(i)) \{}
\DoxyCodeLine{148                \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.at(i) = total\_electron.at(i);}
\DoxyCodeLine{149             \}}
\DoxyCodeLine{150          \}}
\DoxyCodeLine{151          \textcolor{keywordflow}{for} (std::size\_t i = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.size(); i < total\_electron.size(); ++i) \{}
\DoxyCodeLine{152             \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.push\_back(total\_electron.at(i));}
\DoxyCodeLine{153          \}}
\DoxyCodeLine{154          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{155       \}}
\DoxyCodeLine{156       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{157          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < total\_electron.size(); ++i) \{}
\DoxyCodeLine{158             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.at(i) != total\_electron.at(i)) \{}
\DoxyCodeLine{159                \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.at(i) = total\_electron.at(i);}
\DoxyCodeLine{160                \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{161             \}}
\DoxyCodeLine{162          \}}
\DoxyCodeLine{163       \}}
\DoxyCodeLine{164    \}}
\DoxyCodeLine{165    }
\DoxyCodeLine{168    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac248b166cb19c735a8f4f1ea2f0e4283}{SetMagnitudeLSpin}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin) \{}
\DoxyCodeLine{169       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2lspin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin);}
\DoxyCodeLine{170       \textcolor{keywordflow}{if} (magnitude\_2lspin <= 0) \{}
\DoxyCodeLine{171          std::stringstream ss;}
\DoxyCodeLine{172          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{173          ss << \textcolor{stringliteral}{"{}Please set magnitude\_2lspin > 0"{}} << std::endl;}
\DoxyCodeLine{174          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{175       \}}
\DoxyCodeLine{176       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}} != magnitude\_2lspin) \{}
\DoxyCodeLine{177          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}} = magnitude\_2lspin;}
\DoxyCodeLine{178          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}} = magnitude\_2lspin + 1;}
\DoxyCodeLine{179          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9b72902b16e25d9a0e9d4eb3520596ee}{dim\_onsite\_}}       = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}}*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1a6de3078e6c329c68e8ef821bdedafe}{dim\_onsite\_all\_electrons\_}};}
\DoxyCodeLine{180          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4e56bb2b6493a742b5b06b3bfd8986a1}{SetOnsiteOperator}}();}
\DoxyCodeLine{181          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}.clear();}
\DoxyCodeLine{182          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a658ab85ccc6d2d8abe911d27e727cafa}{bases\_inv\_}}.clear();}
\DoxyCodeLine{183          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{184       \}}
\DoxyCodeLine{185    \}}
\DoxyCodeLine{186    }
\DoxyCodeLine{189    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9f2ce1110f21411fd86e2b4f9de8ec54}{SetCalculatedEigenvectorSet}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} level) \{}
\DoxyCodeLine{190       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}}.emplace(level);}
\DoxyCodeLine{191    \}}
\DoxyCodeLine{192    }
\DoxyCodeLine{196    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aab431a42c4dcffac38a9ab8bad24de87}{CalculateNumElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{197       \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{198       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}}; ++o) \{}
\DoxyCodeLine{199          \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_electron\_onsite = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(basis\_onsite, o);}
\DoxyCodeLine{200          \textcolor{keywordflow}{if} (basis\_electron\_onsite == 0) \{}
\DoxyCodeLine{201             num\_electron += 0;}
\DoxyCodeLine{202          \}}
\DoxyCodeLine{203          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_electron\_onsite == 1 || basis\_electron\_onsite == 2) \{}
\DoxyCodeLine{204             num\_electron += 1;}
\DoxyCodeLine{205          \}}
\DoxyCodeLine{206          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_electron\_onsite == 3) \{}
\DoxyCodeLine{207             num\_electron += 2;}
\DoxyCodeLine{208          \}}
\DoxyCodeLine{209          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{210             std::stringstream ss;}
\DoxyCodeLine{211             ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{212             \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{213          \}}
\DoxyCodeLine{214       \}}
\DoxyCodeLine{215       \textcolor{keywordflow}{return} num\_electron;}
\DoxyCodeLine{216    \}}
\DoxyCodeLine{217    }
\DoxyCodeLine{219    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a88ed76b9d7bc9696bbb28ba1a522ba9b}{PrintBasisOnsite}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{220       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}/2.0;}
\DoxyCodeLine{221       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9b72902b16e25d9a0e9d4eb3520596ee}{dim\_onsite\_}}; ++row) \{}
\DoxyCodeLine{222          std::vector<std::string> b\_ele;}
\DoxyCodeLine{223          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}}; ++o) \{}
\DoxyCodeLine{224             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, o) == 0) \{}
\DoxyCodeLine{225                b\_ele.push\_back(\textcolor{stringliteral}{"{}|vac>"{}});}
\DoxyCodeLine{226             \}}
\DoxyCodeLine{227             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, o) == 1) \{}
\DoxyCodeLine{228                b\_ele.push\_back(\textcolor{stringliteral}{"{}| ↑ >"{}});}
\DoxyCodeLine{229             \}}
\DoxyCodeLine{230             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, o) == 2) \{}
\DoxyCodeLine{231                b\_ele.push\_back(\textcolor{stringliteral}{"{}| ↓ >"{}});}
\DoxyCodeLine{232             \}}
\DoxyCodeLine{233             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, o) == 3) \{}
\DoxyCodeLine{234                b\_ele.push\_back(\textcolor{stringliteral}{"{}|↑↓ >"{}});}
\DoxyCodeLine{235             \}}
\DoxyCodeLine{236             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{237                std::stringstream ss;}
\DoxyCodeLine{238                ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{239                \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{240             \}}
\DoxyCodeLine{241          \}}
\DoxyCodeLine{242          std::cout << \textcolor{stringliteral}{"{}row "{}} << std::setw(2) << row << \textcolor{stringliteral}{"{}: "{}};}
\DoxyCodeLine{243          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: b\_ele) \{}
\DoxyCodeLine{244             std::cout << it;}
\DoxyCodeLine{245          \}}
\DoxyCodeLine{246          std::cout << \textcolor{stringliteral}{"{}|Sz="{}} << std::showpos << magnitude\_lspin -\/ \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4ff7b328710f62f5351dd482950ac5db}{CalculateBasisOnsiteLSpin}}(row) << \textcolor{stringliteral}{"{}>"{}} << std::noshowpos << std::endl;}
\DoxyCodeLine{247       \}}
\DoxyCodeLine{248    \}}
\DoxyCodeLine{249    }
\DoxyCodeLine{253    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} \&quantum\_number)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{254       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, quantum\_number.first, quantum\_number.second);}
\DoxyCodeLine{255    \}}
\DoxyCodeLine{256    }
\DoxyCodeLine{261    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1f673490ad12c03d84162dde72f68292}{isValidQNumber}}(\textcolor{keyword}{const} std::vector<int> \&total\_electron, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{262       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, total\_electron, total\_sz);}
\DoxyCodeLine{263    \}}
\DoxyCodeLine{264    }
\DoxyCodeLine{268    \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5d8b229497c66b714dcf3062a8b7fbab}{CalculateTargetDim}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{269       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5d8b229497c66b714dcf3062a8b7fbab}{CalculateTargetDim}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}});}
\DoxyCodeLine{270    \}}
\DoxyCodeLine{271    }
\DoxyCodeLine{276    \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_acb4187e412dd951d0d7b89ff0c18a61d}{CalculateTargetDim}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{277       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5d8b229497c66b714dcf3062a8b7fbab}{CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}, total\_sz);}
\DoxyCodeLine{278    \}}
\DoxyCodeLine{279    }
\DoxyCodeLine{285    \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac037aee9c656da4587289705e690b277}{CalculateTargetDim}}(\textcolor{keyword}{const} std::vector<int> \&total\_electron, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{286       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5d8b229497c66b714dcf3062a8b7fbab}{CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, total\_electron, total\_sz);}
\DoxyCodeLine{287    \}}
\DoxyCodeLine{288    }
\DoxyCodeLine{293    std::vector<QType> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a814f38dd5ba9890697f536042c56a9e9}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{294       \textcolor{comment}{// TODO: Check input matrics}}
\DoxyCodeLine{295       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m1;}
\DoxyCodeLine{296       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m2;}
\DoxyCodeLine{297       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{298          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{299             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{300                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{301             \}}
\DoxyCodeLine{302          \}}
\DoxyCodeLine{303       \}}
\DoxyCodeLine{304       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{305          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{306             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{307                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{308             \}}
\DoxyCodeLine{309          \}}
\DoxyCodeLine{310       \}}
\DoxyCodeLine{311       std::vector<QType> target\_sector\_set;}
\DoxyCodeLine{312       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{313          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{314             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(del\_sec\_m1.first, del\_sec\_m1.second);}
\DoxyCodeLine{315             \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2 \&\& c1) \{}
\DoxyCodeLine{316                target\_sector\_set.push\_back(del\_sec\_m1);}
\DoxyCodeLine{317             \}}
\DoxyCodeLine{318          \}}
\DoxyCodeLine{319       \}}
\DoxyCodeLine{320       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{321       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{322       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{323    \}}
\DoxyCodeLine{324    }
\DoxyCodeLine{330    std::vector<std::pair<QType, QType>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a430bb6b23e43d1cff8c60a8a2dcc2b76}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{331       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m1;}
\DoxyCodeLine{332       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m2;}
\DoxyCodeLine{333       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m3;}
\DoxyCodeLine{334       }
\DoxyCodeLine{335       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{336          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{337             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{338                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{339             \}}
\DoxyCodeLine{340          \}}
\DoxyCodeLine{341       \}}
\DoxyCodeLine{342       }
\DoxyCodeLine{343       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{344          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{345             \textcolor{keywordflow}{if} (m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{346                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{347             \}}
\DoxyCodeLine{348          \}}
\DoxyCodeLine{349       \}}
\DoxyCodeLine{350       }
\DoxyCodeLine{351       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{352          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{353             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{354                delta\_sector\_set\_m3.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{355             \}}
\DoxyCodeLine{356          \}}
\DoxyCodeLine{357       \}}
\DoxyCodeLine{358       }
\DoxyCodeLine{359       std::vector<std::pair<QType, QType>> target\_sector\_set;}
\DoxyCodeLine{360       }
\DoxyCodeLine{361       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{362          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{363             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{364                \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} del\_sec\_m2\_m3;}
\DoxyCodeLine{365                \textcolor{keywordflow}{for} (std::size\_t i = 0; i < del\_sec\_m2.first.size(); ++i) \{}
\DoxyCodeLine{366                   del\_sec\_m2\_m3.first.push\_back(del\_sec\_m2.first[i] + del\_sec\_m3.first[i]);}
\DoxyCodeLine{367                \}}
\DoxyCodeLine{368                del\_sec\_m2\_m3.second = del\_sec\_m2.second + del\_sec\_m3.second;}
\DoxyCodeLine{369                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(del\_sec\_m1.first, del\_sec\_m1.second);}
\DoxyCodeLine{370                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(del\_sec\_m3.first, del\_sec\_m3.second);}
\DoxyCodeLine{371                \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2\_m3 \&\& c1 \&\& c2) \{}
\DoxyCodeLine{372                   target\_sector\_set.push\_back(\{del\_sec\_m1, del\_sec\_m3\});}
\DoxyCodeLine{373                \}}
\DoxyCodeLine{374             \}}
\DoxyCodeLine{375          \}}
\DoxyCodeLine{376       \}}
\DoxyCodeLine{377       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{378       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{379       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{380    \}}
\DoxyCodeLine{381    }
\DoxyCodeLine{388    std::vector<std::tuple<QType, QType, QType>>}
\DoxyCodeLine{389    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a830ca44fe856aad2dd33980af32ab695}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_4\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{390       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m1;}
\DoxyCodeLine{391       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m2;}
\DoxyCodeLine{392       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m3;}
\DoxyCodeLine{393       std::unordered\_set<QType, VecIntHash> delta\_sector\_set\_m4;}
\DoxyCodeLine{394       }
\DoxyCodeLine{395       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{396          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{397             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{398                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{399             \}}
\DoxyCodeLine{400          \}}
\DoxyCodeLine{401       \}}
\DoxyCodeLine{402       }
\DoxyCodeLine{403       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{404          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{405             \textcolor{keywordflow}{if} (m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{406                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{407             \}}
\DoxyCodeLine{408          \}}
\DoxyCodeLine{409       \}}
\DoxyCodeLine{410       }
\DoxyCodeLine{411       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{412          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{413             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{414                delta\_sector\_set\_m3.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{415             \}}
\DoxyCodeLine{416          \}}
\DoxyCodeLine{417       \}}
\DoxyCodeLine{418       }
\DoxyCodeLine{419       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{420          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{421             \textcolor{keywordflow}{if} (m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{422                delta\_sector\_set\_m4.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(i, m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]));}
\DoxyCodeLine{423             \}}
\DoxyCodeLine{424          \}}
\DoxyCodeLine{425       \}}
\DoxyCodeLine{426       }
\DoxyCodeLine{427       std::vector<std::tuple<QType, QType, QType>> target\_sector\_set;}
\DoxyCodeLine{428       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{429          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{430             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{431                \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m4: delta\_sector\_set\_m4) \{}
\DoxyCodeLine{432                   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} del\_sec\_m1\_m2;}
\DoxyCodeLine{433                   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} del\_sec\_m3\_m4;}
\DoxyCodeLine{434                   \textcolor{keywordflow}{for} (std::size\_t i = 0; i < del\_sec\_m1.first.size(); ++i) \{}
\DoxyCodeLine{435                      del\_sec\_m1\_m2.first.push\_back(del\_sec\_m1.first[i] + del\_sec\_m2.first[i]);}
\DoxyCodeLine{436                      del\_sec\_m3\_m4.first.push\_back(del\_sec\_m3.first[i] + del\_sec\_m4.first[i]);}
\DoxyCodeLine{437                   \}}
\DoxyCodeLine{438                   del\_sec\_m1\_m2.second = del\_sec\_m1.second + del\_sec\_m2.second;}
\DoxyCodeLine{439                   del\_sec\_m3\_m4.second = del\_sec\_m3.second + del\_sec\_m4.second;}
\DoxyCodeLine{440                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(del\_sec\_m1.first   , del\_sec\_m1.second   );}
\DoxyCodeLine{441                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(del\_sec\_m1\_m2.first, del\_sec\_m1\_m2.second);}
\DoxyCodeLine{442                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d952c07e25f4eef01ef9d2a9530a3da}{isValidQNumber}}(del\_sec\_m4.first   , del\_sec\_m4.second   );}
\DoxyCodeLine{443                   \textcolor{keywordflow}{if} (del\_sec\_m1\_m2 == del\_sec\_m3\_m4 \&\& c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{444                      target\_sector\_set.push\_back(\{del\_sec\_m1, del\_sec\_m1\_m2, del\_sec\_m4\});}
\DoxyCodeLine{445                   \}}
\DoxyCodeLine{446                \}}
\DoxyCodeLine{447             \}}
\DoxyCodeLine{448          \}}
\DoxyCodeLine{449       \}}
\DoxyCodeLine{450       }
\DoxyCodeLine{451       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{452       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{453       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{454    \}}
\DoxyCodeLine{455    }
\DoxyCodeLine{460    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a484aaf1153f9a0c2cef801eeb9543439}{GenerateBasis}}() \{}
\DoxyCodeLine{461       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a484aaf1153f9a0c2cef801eeb9543439}{GenerateBasis}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}});}
\DoxyCodeLine{462    \}}
\DoxyCodeLine{463    }
\DoxyCodeLine{469    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1aabd19a93def8d0f31c4254334d9108}{GenerateBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} \&quantum\_number) \{}
\DoxyCodeLine{470       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a484aaf1153f9a0c2cef801eeb9543439}{GenerateBasis}}(quantum\_number.first, quantum\_number.second);}
\DoxyCodeLine{471    \}}
\DoxyCodeLine{472    }
\DoxyCodeLine{479    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3735bb1ed1bdad0637c0ac7ee79b9a15}{GenerateBasis}}(\textcolor{keyword}{const} std::vector<int> \&total\_electron, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{480       \textcolor{keyword}{const} \textcolor{keyword}{auto} start     = std::chrono::system\_clock::now();}
\DoxyCodeLine{481       \textcolor{keyword}{const} \textcolor{keywordtype}{int}  total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{482       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}.count(\{total\_electron, total\_2sz\}) != 0) \{}
\DoxyCodeLine{483          \textcolor{keywordflow}{return};}
\DoxyCodeLine{484       \}}
\DoxyCodeLine{485       std::cout << \textcolor{stringliteral}{"{}Generating Basis..."{}} << std::flush;}
\DoxyCodeLine{486             }
\DoxyCodeLine{487       std::vector<std::vector<std::vector<int>>> electron\_configuration\_list;}
\DoxyCodeLine{488       std::vector<int> length\_list;}
\DoxyCodeLine{489       \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} length = 1;}
\DoxyCodeLine{490       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} num\_electron: total\_electron) \{}
\DoxyCodeLine{491          \textcolor{keyword}{const} \textcolor{keyword}{auto} electron\_configuration = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9ea3a542efc8659172ea383f9e5b6b5d}{GenerateElectronConfigurations}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, num\_electron);}
\DoxyCodeLine{492          electron\_configuration\_list.push\_back(electron\_configuration);}
\DoxyCodeLine{493          length\_list.push\_back(electron\_configuration[0].size());}
\DoxyCodeLine{494          length *= electron\_configuration[0].size();}
\DoxyCodeLine{495       \}}
\DoxyCodeLine{496       \textcolor{keyword}{const} std::vector<std::vector<LInt>> binom = \mbox{\hyperlink{namespacecompnal_1_1utility_ab4bbef4ed33eaa05489524e9f226e901}{utility::CalculateBinomialTable}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}});}
\DoxyCodeLine{497       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} dim\_target\_global = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5d8b229497c66b714dcf3062a8b7fbab}{CalculateTargetDim}}(total\_electron, total\_sz);}
\DoxyCodeLine{498 }
\DoxyCodeLine{499       std::vector<std::vector<int>> q\_number\_n\_up\_down;}
\DoxyCodeLine{500       std::vector<std::vector<int>> q\_number\_n\_up;}
\DoxyCodeLine{501       std::vector<std::vector<int>> q\_number\_n\_down;}
\DoxyCodeLine{502       std::vector<std::vector<int>> q\_number\_n\_vac;}
\DoxyCodeLine{503       std::vector<std::vector<int>> q\_number\_ele\_list;}
\DoxyCodeLine{504       std::vector<int> q\_number\_spin\_vec;}
\DoxyCodeLine{505       std::vector<LInt> total\_electron\_dim\_list;}
\DoxyCodeLine{506       std::vector<std::vector<LInt>> each\_electron\_basis\_dim\_prod;}
\DoxyCodeLine{507       std::vector<std::vector<LInt>> each\_electron\_basis\_dim;}
\DoxyCodeLine{508       std::vector<LInt> bias\_basis;}
\DoxyCodeLine{509       bias\_basis.push\_back(0);}
\DoxyCodeLine{510       }
\DoxyCodeLine{511       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < length; ++i) \{}
\DoxyCodeLine{512          \textcolor{keywordtype}{int} electron\_2sz = 0;}
\DoxyCodeLine{513          std::vector<int> temp\_n\_up\_down;}
\DoxyCodeLine{514          std::vector<int> temp\_n\_up;}
\DoxyCodeLine{515          std::vector<int> temp\_n\_down;}
\DoxyCodeLine{516          std::vector<int> temp\_n\_vac;}
\DoxyCodeLine{517          \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} electron\_dim = 1;}
\DoxyCodeLine{518          \textcolor{keywordflow}{for} (std::size\_t j = 0; j < length\_list.size(); ++j) \{}
\DoxyCodeLine{519             \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} prod = 1;}
\DoxyCodeLine{520             \textcolor{keywordflow}{for} (std::size\_t k = j + 1; k < length\_list.size(); ++k) \{}
\DoxyCodeLine{521                prod *= length\_list[k];}
\DoxyCodeLine{522             \}}
\DoxyCodeLine{523             \textcolor{keyword}{const} std::size\_t index = (i/prod)\%length\_list[j];}
\DoxyCodeLine{524             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up\_down = electron\_configuration\_list[j][0][index];}
\DoxyCodeLine{525             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up      = electron\_configuration\_list[j][1][index];}
\DoxyCodeLine{526             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down    = electron\_configuration\_list[j][2][index];}
\DoxyCodeLine{527             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_vac     = electron\_configuration\_list[j][3][index];}
\DoxyCodeLine{528             electron\_2sz += n\_up -\/ n\_down;}
\DoxyCodeLine{529             temp\_n\_up\_down.push\_back(n\_up\_down);}
\DoxyCodeLine{530             temp\_n\_up     .push\_back(n\_up     );}
\DoxyCodeLine{531             temp\_n\_down   .push\_back(n\_down   );}
\DoxyCodeLine{532             temp\_n\_vac    .push\_back(n\_vac    );}
\DoxyCodeLine{533             electron\_dim *= binom[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}][n\_up]*binom[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}} -\/ n\_up][n\_down]*binom[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}} -\/ n\_up -\/ n\_down][n\_up\_down];}
\DoxyCodeLine{534          \}}
\DoxyCodeLine{535          \textcolor{keyword}{const} \textcolor{keywordtype}{int} spin\_2sz = total\_2sz -\/ electron\_2sz;}
\DoxyCodeLine{536          \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D<RealType>::isValidQNumber}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, 0.5*spin\_2sz)) \{}
\DoxyCodeLine{537             q\_number\_n\_up\_down.push\_back(temp\_n\_up\_down);}
\DoxyCodeLine{538             q\_number\_n\_up     .push\_back(temp\_n\_up     );}
\DoxyCodeLine{539             q\_number\_n\_down   .push\_back(temp\_n\_down   );}
\DoxyCodeLine{540             q\_number\_n\_vac    .push\_back(temp\_n\_vac    );}
\DoxyCodeLine{541             q\_number\_spin\_vec .push\_back(spin\_2sz);}
\DoxyCodeLine{542             total\_electron\_dim\_list.push\_back(electron\_dim);}
\DoxyCodeLine{543             each\_electron\_basis\_dim.emplace\_back();}
\DoxyCodeLine{544             bias\_basis.push\_back(electron\_dim*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D<RealType>::CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, 0.5*spin\_2sz));}
\DoxyCodeLine{545             \textcolor{keywordflow}{for} (std::size\_t j = 0; j < length\_list.size(); ++j) \{}
\DoxyCodeLine{546                q\_number\_ele\_list.push\_back(\{temp\_n\_up\_down[j], temp\_n\_up[j], temp\_n\_down[j], temp\_n\_vac[j]\});}
\DoxyCodeLine{547                each\_electron\_basis\_dim.back().push\_back(binom[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}][temp\_n\_up[j]]*}
\DoxyCodeLine{548                                                         binom[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}} -\/ temp\_n\_up[j]][temp\_n\_down[j]]*}
\DoxyCodeLine{549                                                         binom[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}} -\/ temp\_n\_up[j] -\/ temp\_n\_down[j]][temp\_n\_up\_down[j]]);}
\DoxyCodeLine{550                }
\DoxyCodeLine{551             \}}
\DoxyCodeLine{552          \}}
\DoxyCodeLine{553       \}}
\DoxyCodeLine{554       }
\DoxyCodeLine{555       each\_electron\_basis\_dim\_prod.resize(each\_electron\_basis\_dim.size());}
\DoxyCodeLine{556       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < each\_electron\_basis\_dim\_prod.size(); ++i) \{}
\DoxyCodeLine{557          each\_electron\_basis\_dim\_prod[i].resize(total\_electron.size());}
\DoxyCodeLine{558          \textcolor{keywordflow}{for} (std::size\_t j = 0; j < total\_electron.size(); ++j) \{}
\DoxyCodeLine{559             \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} prod = 1;}
\DoxyCodeLine{560             \textcolor{keywordflow}{for} (std::size\_t k = j + 1; k < total\_electron.size(); ++k) \{}
\DoxyCodeLine{561                prod *= each\_electron\_basis\_dim[i][k];}
\DoxyCodeLine{562             \}}
\DoxyCodeLine{563             each\_electron\_basis\_dim\_prod[i][j] = prod;}
\DoxyCodeLine{564          \}}
\DoxyCodeLine{565       \}}
\DoxyCodeLine{566       }
\DoxyCodeLine{567       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < bias\_basis.size(); ++i) \{}
\DoxyCodeLine{568          bias\_basis[i+1] += bias\_basis[i];}
\DoxyCodeLine{569       \}}
\DoxyCodeLine{570       }
\DoxyCodeLine{571       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(bias\_basis[bias\_basis.size()]) != dim\_target\_global) \{}
\DoxyCodeLine{572          std::stringstream ss;}
\DoxyCodeLine{573          ss << \textcolor{stringliteral}{"{}Unknown error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{574          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{575       \}}
\DoxyCodeLine{576       }
\DoxyCodeLine{577       std::vector<LInt> site\_constant\_global(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}});}
\DoxyCodeLine{578       std::vector<LInt> ele\_constant\_global(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}});}
\DoxyCodeLine{579 }
\DoxyCodeLine{580       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}; ++site) \{}
\DoxyCodeLine{581          site\_constant\_global[site] = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9b72902b16e25d9a0e9d4eb3520596ee}{dim\_onsite\_}}, site));}
\DoxyCodeLine{582       \}}
\DoxyCodeLine{583       }
\DoxyCodeLine{584       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < static\_cast<int>(total\_electron.size()); ++o) \{}
\DoxyCodeLine{585          ele\_constant\_global[o] = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa0c1648165b632ae0ca7f7da5a967f8e}{dim\_onsite\_electron\_}}, o));}
\DoxyCodeLine{586       \}}
\DoxyCodeLine{587       }
\DoxyCodeLine{588       \textcolor{comment}{//Generate spin bases}}
\DoxyCodeLine{589       std::vector<int> temp\_q\_number\_spin\_vec = q\_number\_spin\_vec;}
\DoxyCodeLine{590       std::sort(temp\_q\_number\_spin\_vec.begin(), temp\_q\_number\_spin\_vec.end());}
\DoxyCodeLine{591       temp\_q\_number\_spin\_vec.erase(std::unique(temp\_q\_number\_spin\_vec.begin(), temp\_q\_number\_spin\_vec.end()), temp\_q\_number\_spin\_vec.end());}
\DoxyCodeLine{592       \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<int, std::vector<LInt>}}> spin\_bases;}
\DoxyCodeLine{593 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{594       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < static\_cast<LInt>(temp\_q\_number\_spin\_vec.size()); ++i) \{}
\DoxyCodeLine{595          \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2\_sz\_lspin = temp\_q\_number\_spin\_vec[i];}
\DoxyCodeLine{596          \textcolor{keyword}{const} \textcolor{keywordtype}{int} shifted\_2sz      = (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}} -\/ total\_2\_sz\_lspin)/2;}
\DoxyCodeLine{597          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} dim\_target\_lspin = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af1a2181378f1722f4bcbff01e07f8060}{BaseU1Spin\_1D<RealType>::CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, 0.5*total\_2\_sz\_lspin);}
\DoxyCodeLine{598          std::vector<std::vector<int>> partition\_integers;}
\DoxyCodeLine{599          \mbox{\hyperlink{namespacecompnal_1_1utility_a2580357fcc88b1c7bac5627e5b47925f}{utility::GenerateIntegerPartition}}(\&partition\_integers, shifted\_2sz, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}});}
\DoxyCodeLine{600          \textcolor{keyword}{auto} \&spin\_basis = spin\_bases[total\_2\_sz\_lspin];}
\DoxyCodeLine{601          spin\_basis.reserve(dim\_target\_lspin);}
\DoxyCodeLine{602          \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&integer\_list: partition\_integers) \{}
\DoxyCodeLine{603             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition1 = (0 < integer\_list.size()) \&\& (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()) <= \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}});}
\DoxyCodeLine{604             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition2 = (integer\_list.size() == 0) \&\& (shifted\_2sz  == 0);}
\DoxyCodeLine{605             \textcolor{keywordflow}{if} (condition1 || condition2) \{}
\DoxyCodeLine{606                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()); j < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}; ++j) \{}
\DoxyCodeLine{607                   integer\_list.push\_back(0);}
\DoxyCodeLine{608                \}}
\DoxyCodeLine{609                std::sort(integer\_list.begin(), integer\_list.end());}
\DoxyCodeLine{610                \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{611                   \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} basis\_global = 0;}
\DoxyCodeLine{612                   \textcolor{keywordflow}{for} (std::size\_t j = 0; j < integer\_list.size(); ++j) \{}
\DoxyCodeLine{613                      basis\_global += integer\_list[j]*site\_constant\_global[j];}
\DoxyCodeLine{614                   \}}
\DoxyCodeLine{615                   spin\_basis.push\_back(basis\_global);}
\DoxyCodeLine{616                \} \textcolor{keywordflow}{while} (std::next\_permutation(integer\_list.begin(), integer\_list.end()));}
\DoxyCodeLine{617             \}}
\DoxyCodeLine{618          \}}
\DoxyCodeLine{619          \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(spin\_basis.size()) != dim\_target\_lspin) \{}
\DoxyCodeLine{620             std::stringstream ss;}
\DoxyCodeLine{621             ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{622             \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{623          \}}
\DoxyCodeLine{624          std::sort(spin\_basis.begin(), spin\_basis.end());}
\DoxyCodeLine{625       \}}
\DoxyCodeLine{626       }
\DoxyCodeLine{627       \textcolor{comment}{//Generate electron bases}}
\DoxyCodeLine{628       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} loop\_size = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(q\_number\_spin\_vec.size());}
\DoxyCodeLine{629       \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<std::vector<int>}}, std::vector<LInt>, \mbox{\hyperlink{structcompnal_1_1_vec_hash}{VecHash}}> electron\_bases;}
\DoxyCodeLine{630       std::vector<std::vector<int>> temp\_q\_number\_ele\_list = q\_number\_ele\_list;}
\DoxyCodeLine{631       std::sort(temp\_q\_number\_ele\_list.begin(), temp\_q\_number\_ele\_list.end());}
\DoxyCodeLine{632       temp\_q\_number\_ele\_list.erase(std::unique(temp\_q\_number\_ele\_list.begin(), temp\_q\_number\_ele\_list.end()), temp\_q\_number\_ele\_list.end());}
\DoxyCodeLine{633       }
\DoxyCodeLine{634 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{635       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < temp\_q\_number\_ele\_list.size(); ++i) \{}
\DoxyCodeLine{636          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up\_down = temp\_q\_number\_ele\_list[i][0];}
\DoxyCodeLine{637          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down    = temp\_q\_number\_ele\_list[i][1];}
\DoxyCodeLine{638          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up      = temp\_q\_number\_ele\_list[i][2];}
\DoxyCodeLine{639          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_vac     = temp\_q\_number\_ele\_list[i][3];}
\DoxyCodeLine{640          std::vector<int> basis\_list\_electron(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}});}
\DoxyCodeLine{641          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_vac; ++s) \{}
\DoxyCodeLine{642             basis\_list\_electron[s] = 0;}
\DoxyCodeLine{643          \}}
\DoxyCodeLine{644          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_up; ++s) \{}
\DoxyCodeLine{645             basis\_list\_electron[s + n\_vac] = 1;}
\DoxyCodeLine{646          \}}
\DoxyCodeLine{647          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_down; ++s) \{}
\DoxyCodeLine{648             basis\_list\_electron[s + n\_vac + n\_up] = 2;}
\DoxyCodeLine{649          \}}
\DoxyCodeLine{650          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_up\_down; ++s) \{}
\DoxyCodeLine{651             basis\_list\_electron[s + n\_vac + n\_up + n\_down] = 3;}
\DoxyCodeLine{652          \}}
\DoxyCodeLine{653          \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{654             \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} basis\_global\_electron = 0;}
\DoxyCodeLine{655             \textcolor{keywordflow}{for} (std::size\_t j = 0; j < basis\_list\_electron.size(); ++j) \{}
\DoxyCodeLine{656                basis\_global\_electron += basis\_list\_electron[j]*site\_constant\_global[j]*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}};}
\DoxyCodeLine{657             \}}
\DoxyCodeLine{658          \} \textcolor{keywordflow}{while} (std::next\_permutation(basis\_list\_electron.begin(), basis\_list\_electron.end()));}
\DoxyCodeLine{659       \}}
\DoxyCodeLine{660       }
\DoxyCodeLine{661       \textcolor{comment}{//Generate global bases}}
\DoxyCodeLine{662       std::vector<LInt>().swap(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}[\{total\_electron, total\_2sz\}]);}
\DoxyCodeLine{663       \textcolor{keyword}{auto} \&global\_basis\_ref = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}.at(\{total\_electron, total\_2sz\});}
\DoxyCodeLine{664       global\_basis\_ref.resize(dim\_target\_global);}
\DoxyCodeLine{665       }
\DoxyCodeLine{666 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{667       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < loop\_size; ++i) \{}
\DoxyCodeLine{668          \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} count = bias\_basis[i];}
\DoxyCodeLine{669          \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz\_lspin = q\_number\_spin\_vec[i];}
\DoxyCodeLine{670          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} total\_electron\_dim = total\_electron\_dim\_list[i];}
\DoxyCodeLine{671          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&spin\_basis: spin\_bases.at(total\_2sz\_lspin)) \{}
\DoxyCodeLine{672             }
\DoxyCodeLine{673             \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = 0; j < total\_electron\_dim; ++j) \{}
\DoxyCodeLine{674                \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} global\_basis = spin\_basis;}
\DoxyCodeLine{675                \textcolor{keywordflow}{for} (std::size\_t k = 0; k < total\_electron.size(); ++k) \{}
\DoxyCodeLine{676                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up\_down = q\_number\_n\_up\_down[i][k];}
\DoxyCodeLine{677                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up      = q\_number\_n\_up     [i][k];}
\DoxyCodeLine{678                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down    = q\_number\_n\_down   [i][k];}
\DoxyCodeLine{679                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_vac     = q\_number\_n\_vac    [i][k];}
\DoxyCodeLine{680                   std::size\_t index = (j/each\_electron\_basis\_dim\_prod[i][k])\%each\_electron\_basis\_dim[i][k];}
\DoxyCodeLine{681                   global\_basis += electron\_bases.at(\{n\_up\_down, n\_up, n\_down, n\_vac\})[index];}
\DoxyCodeLine{682                \}}
\DoxyCodeLine{683                global\_basis\_ref[count++] = global\_basis;}
\DoxyCodeLine{684             \}}
\DoxyCodeLine{685          \}}
\DoxyCodeLine{686       \}}
\DoxyCodeLine{687       }
\DoxyCodeLine{688       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}.at(\{total\_electron, total\_2sz\}).size()) != dim\_target\_global) \{}
\DoxyCodeLine{689          std::stringstream ss;}
\DoxyCodeLine{690          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{691          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{692       \}}
\DoxyCodeLine{693       }
\DoxyCodeLine{694       std::sort(global\_basis\_ref.begin(), global\_basis\_ref.end());}
\DoxyCodeLine{695       }
\DoxyCodeLine{696       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a658ab85ccc6d2d8abe911d27e727cafa}{bases\_inv\_}}[\{total\_electron, total\_2sz\}].clear();}
\DoxyCodeLine{697       }
\DoxyCodeLine{698       \textcolor{keyword}{auto} \&basis\_inv\_ref = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a658ab85ccc6d2d8abe911d27e727cafa}{bases\_inv\_}}.at(\{total\_electron, total\_2sz\});}
\DoxyCodeLine{699       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < dim\_target\_global; ++i) \{}
\DoxyCodeLine{700          basis\_inv\_ref[global\_basis\_ref[i]] = i;}
\DoxyCodeLine{701       \}}
\DoxyCodeLine{702       }
\DoxyCodeLine{703       \textcolor{keywordflow}{if} (basis\_inv\_ref.size() != global\_basis\_ref.size()) \{}
\DoxyCodeLine{704          std::stringstream ss;}
\DoxyCodeLine{705          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{706          ss << \textcolor{stringliteral}{"{}The same basis has been detected"{}} << std::endl;}
\DoxyCodeLine{707          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{708       \}}
\DoxyCodeLine{709       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{710       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{sparse\_matrix::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{711       std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating basis:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{712       }
\DoxyCodeLine{713    \}}
\DoxyCodeLine{714    }
\DoxyCodeLine{724    \textcolor{keyword}{static} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a92286db2a0f7da7d476396bc8fdef5f3}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size,}
\DoxyCodeLine{725                                           \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin,}
\DoxyCodeLine{726                                           \textcolor{keyword}{const} std::vector<int> \&total\_electron,}
\DoxyCodeLine{727                                           \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{728       std::vector<std::vector<std::vector<int>>> electron\_configuration\_list;}
\DoxyCodeLine{729       std::vector<int> length\_list;}
\DoxyCodeLine{730       \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} length = 1;}
\DoxyCodeLine{731       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} num\_electron: total\_electron) \{}
\DoxyCodeLine{732          \textcolor{keyword}{const} \textcolor{keyword}{auto} electron\_configuration = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9ea3a542efc8659172ea383f9e5b6b5d}{GenerateElectronConfigurations}}(system\_size, num\_electron);}
\DoxyCodeLine{733          electron\_configuration\_list.push\_back(electron\_configuration);}
\DoxyCodeLine{734          length\_list.push\_back(electron\_configuration[0].size());}
\DoxyCodeLine{735          length *= electron\_configuration[0].size();}
\DoxyCodeLine{736       \}}
\DoxyCodeLine{737       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{738       \textcolor{keyword}{const} std::vector<std::vector<LInt>> binom = \mbox{\hyperlink{namespacecompnal_1_1utility_ab4bbef4ed33eaa05489524e9f226e901}{utility::CalculateBinomialTable}}(system\_size);}
\DoxyCodeLine{739       \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} dim = 0;}
\DoxyCodeLine{740       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < length; ++i) \{}
\DoxyCodeLine{741          \textcolor{keywordtype}{int} electron\_2sz = 0;}
\DoxyCodeLine{742          \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} electron\_dim = 1;}
\DoxyCodeLine{743          \textcolor{keywordflow}{for} (std::size\_t j = 0; j < length\_list.size(); ++j) \{}
\DoxyCodeLine{744             \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} prod = 1;}
\DoxyCodeLine{745             \textcolor{keywordflow}{for} (std::size\_t k = j + 1; k < length\_list.size(); ++k) \{}
\DoxyCodeLine{746                prod *= length\_list[k];}
\DoxyCodeLine{747             \}}
\DoxyCodeLine{748             \textcolor{keyword}{const} std::size\_t index = (i/prod)\%length\_list[j];}
\DoxyCodeLine{749             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up\_down = electron\_configuration\_list[j][0][index];}
\DoxyCodeLine{750             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up      = electron\_configuration\_list[j][1][index];}
\DoxyCodeLine{751             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down    = electron\_configuration\_list[j][2][index];}
\DoxyCodeLine{752             electron\_2sz += n\_up -\/ n\_down;}
\DoxyCodeLine{753             electron\_dim *= binom[system\_size][n\_up]*binom[system\_size -\/ n\_up][n\_down]*binom[system\_size -\/ n\_up -\/ n\_down][n\_up\_down];}
\DoxyCodeLine{754          \}}
\DoxyCodeLine{755          \textcolor{keyword}{const} \textcolor{keywordtype}{int} spin\_2sz = total\_2sz -\/ electron\_2sz;}
\DoxyCodeLine{756          \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D<RealType>::isValidQNumber}}(system\_size, magnitude\_lspin, 0.5*spin\_2sz)) \{}
\DoxyCodeLine{757             dim += electron\_dim*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af1a2181378f1722f4bcbff01e07f8060}{BaseU1Spin\_1D<RealType>::CalculateTargetDim}}(system\_size, magnitude\_lspin, 0.5*spin\_2sz);}
\DoxyCodeLine{758          \}}
\DoxyCodeLine{759       \}}
\DoxyCodeLine{760       \textcolor{keywordflow}{return} dim;}
\DoxyCodeLine{761    \}}
\DoxyCodeLine{762       }
\DoxyCodeLine{768    \textcolor{keyword}{inline} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a37055055afea88867025e7287eb048d7}{CalculateTargetQuantumNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} row, \textcolor{keyword}{const} \textcolor{keywordtype}{int} col)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{769       std::vector<int> diff\_electron\_list;}
\DoxyCodeLine{770       \textcolor{keywordtype}{int} target\_total\_sz = 0;}
\DoxyCodeLine{771       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}}; ++o) \{}
\DoxyCodeLine{772          \textcolor{keyword}{const} \textcolor{keywordtype}{int} row\_electron   = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, o);}
\DoxyCodeLine{773          \textcolor{keyword}{const} \textcolor{keywordtype}{int} col\_electron   = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(col, o);}
\DoxyCodeLine{774          \textcolor{keyword}{const} \textcolor{keyword}{auto} diff\_electron = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7eeaeb64c183a9be7d49d2dea7ade5ef}{BaseU1Electron\_1D<RealType>::CalculateQuntumNumberDifference}}(row\_electron, col\_electron);}
\DoxyCodeLine{775          diff\_electron\_list.push\_back(diff\_electron.first + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}[o]);}
\DoxyCodeLine{776          target\_total\_sz += diff\_electron.second;}
\DoxyCodeLine{777       \}}
\DoxyCodeLine{778       \textcolor{keyword}{const} \textcolor{keywordtype}{int} row\_lspin = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4ff7b328710f62f5351dd482950ac5db}{CalculateBasisOnsiteLSpin}}(row);}
\DoxyCodeLine{779       \textcolor{keyword}{const} \textcolor{keywordtype}{int} col\_lspin = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4ff7b328710f62f5351dd482950ac5db}{CalculateBasisOnsiteLSpin}}(col);}
\DoxyCodeLine{780       target\_total\_sz += \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{BaseU1Spin\_1D<RealType>::CalculateQuntumNumberDifference}}(row\_lspin, col\_lspin) + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}};}
\DoxyCodeLine{781       }
\DoxyCodeLine{782       \textcolor{keywordflow}{return} \{diff\_electron\_list, target\_total\_sz\};}
\DoxyCodeLine{783    \}}
\DoxyCodeLine{784    }
\DoxyCodeLine{791    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a81121d01de3f87008e470fc780ade437}{CreateOnsiteOperatorCUp}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{792       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2lspin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin);}
\DoxyCodeLine{793       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite\_lspin = magnitude\_2lspin + 1;}
\DoxyCodeLine{794       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = dim\_onsite\_lspin*\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(std::pow(4, num\_orbital));}
\DoxyCodeLine{795       }
\DoxyCodeLine{796       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{797       \textcolor{comment}{// \# <-\/>  [Cherge  ] -\/-\/ (N,  2*sz)}}
\DoxyCodeLine{798       \textcolor{comment}{// 0 <-\/>  [        ] -\/-\/ (0,  0   )}}
\DoxyCodeLine{799       \textcolor{comment}{// 1 <-\/>  [up      ] -\/-\/ (1,  1   )}}
\DoxyCodeLine{800       \textcolor{comment}{// 2 <-\/>  [down    ] -\/-\/ (1, -\/1   )}}
\DoxyCodeLine{801       \textcolor{comment}{// 3 <-\/>  [up\&down ] -\/-\/ (2,  0   )}}
\DoxyCodeLine{802       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{803       }
\DoxyCodeLine{804       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{805       }
\DoxyCodeLine{806       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{807          \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{808          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < orbital; ++o) \{}
\DoxyCodeLine{809             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_electron\_onsite = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{810             num\_electron += \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad94f55ffb42f8e61248a2e611366b124}{CalculateNumElectronFromElectronBasis}}(basis\_electron\_onsite);}
\DoxyCodeLine{811          \}}
\DoxyCodeLine{812          \textcolor{keywordtype}{int} sign = 1;}
\DoxyCodeLine{813          \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{814             sign = -\/1;}
\DoxyCodeLine{815          \}}
\DoxyCodeLine{816          }
\DoxyCodeLine{817          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} col = 0; col < dim\_onsite; col++) \{}
\DoxyCodeLine{818             \textcolor{keywordtype}{bool} c\_1 = \textcolor{keyword}{true};}
\DoxyCodeLine{819             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < num\_orbital; ++o) \{}
\DoxyCodeLine{820                \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{821                \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(col, magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{822                \textcolor{keywordflow}{if} (o != orbital \&\& basis\_1 != basis\_2) \{}
\DoxyCodeLine{823                   c\_1 = \textcolor{keyword}{false};}
\DoxyCodeLine{824                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{825                \}}
\DoxyCodeLine{826             \}}
\DoxyCodeLine{827             }
\DoxyCodeLine{828             \textcolor{keywordtype}{int} basis\_row\_electron = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{829             \textcolor{keywordtype}{int} basis\_col\_electron = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(col, magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{830             }
\DoxyCodeLine{831             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c\_2 = (basis\_row\_electron == 0 \&\& basis\_col\_electron == 1);}
\DoxyCodeLine{832             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c\_3 = (basis\_row\_electron == 2 \&\& basis\_col\_electron == 3);}
\DoxyCodeLine{833             }
\DoxyCodeLine{834             \textcolor{keywordflow}{if} (c\_1 \&\& row\%dim\_onsite\_lspin == col\%dim\_onsite\_lspin \&\& (c\_2 || c\_3)) \{}
\DoxyCodeLine{835                matrix.val.push\_back(sign);}
\DoxyCodeLine{836                matrix.col.push\_back(col);}
\DoxyCodeLine{837             \}}
\DoxyCodeLine{838       }
\DoxyCodeLine{839          \}}
\DoxyCodeLine{840          matrix.row[row + 1] = matrix.col.size();}
\DoxyCodeLine{841       \}}
\DoxyCodeLine{842       matrix.tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}};}
\DoxyCodeLine{843       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{844    \}}
\DoxyCodeLine{845    }
\DoxyCodeLine{852    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1668c793b6257fff9eb55980a72b5e59}{CreateOnsiteOperatorCDown}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{853       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2lspin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin);}
\DoxyCodeLine{854       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite\_lspin = magnitude\_2lspin + 1;}
\DoxyCodeLine{855       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = dim\_onsite\_lspin*\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(std::pow(4, num\_orbital));}
\DoxyCodeLine{856       }
\DoxyCodeLine{857       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{858       \textcolor{comment}{// \# <-\/>  [Cherge  ] -\/-\/ (N,  2*sz)}}
\DoxyCodeLine{859       \textcolor{comment}{// 0 <-\/>  [        ] -\/-\/ (0,  0   )}}
\DoxyCodeLine{860       \textcolor{comment}{// 1 <-\/>  [up      ] -\/-\/ (1,  1   )}}
\DoxyCodeLine{861       \textcolor{comment}{// 2 <-\/>  [down    ] -\/-\/ (1, -\/1   )}}
\DoxyCodeLine{862       \textcolor{comment}{// 3 <-\/>  [up\&down ] -\/-\/ (2,  0   )}}
\DoxyCodeLine{863       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{864       }
\DoxyCodeLine{865       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{866       }
\DoxyCodeLine{867       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{868          \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{869          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < orbital; ++o) \{}
\DoxyCodeLine{870             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_electron\_onsite = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{871             num\_electron += \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad94f55ffb42f8e61248a2e611366b124}{CalculateNumElectronFromElectronBasis}}(basis\_electron\_onsite);}
\DoxyCodeLine{872          \}}
\DoxyCodeLine{873          \textcolor{keywordtype}{int} sign\_1 = 1;}
\DoxyCodeLine{874          \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{875             sign\_1 = -\/1;}
\DoxyCodeLine{876          \}}
\DoxyCodeLine{877          }
\DoxyCodeLine{878          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} col = 0; col < dim\_onsite; col++) \{}
\DoxyCodeLine{879             \textcolor{keywordtype}{bool} c\_1 = \textcolor{keyword}{true};}
\DoxyCodeLine{880             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < num\_orbital; ++o) \{}
\DoxyCodeLine{881                \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{882                \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(col, magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{883                \textcolor{keywordflow}{if} (o != orbital \&\& basis\_1 != basis\_2) \{}
\DoxyCodeLine{884                   c\_1 = \textcolor{keyword}{false};}
\DoxyCodeLine{885                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{886                \}}
\DoxyCodeLine{887             \}}
\DoxyCodeLine{888             }
\DoxyCodeLine{889             \textcolor{keywordtype}{int} basis\_row\_electron = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(row, magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{890             \textcolor{keywordtype}{int} basis\_col\_electron = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(col, magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{891             }
\DoxyCodeLine{892             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c\_2 = (basis\_row\_electron == 0 \&\& basis\_col\_electron == 2);}
\DoxyCodeLine{893             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c\_3 = (basis\_row\_electron == 1 \&\& basis\_col\_electron == 3);}
\DoxyCodeLine{894             }
\DoxyCodeLine{895             \textcolor{keywordtype}{int} sign\_2 = 1;}
\DoxyCodeLine{896             \textcolor{keywordflow}{if} (c\_3) \{}
\DoxyCodeLine{897                sign\_2 = -\/1;}
\DoxyCodeLine{898             \}}
\DoxyCodeLine{899             }
\DoxyCodeLine{900             \textcolor{keywordflow}{if} (c\_1 \&\& row\%dim\_onsite\_lspin == col\%dim\_onsite\_lspin \&\& (c\_2 || c\_3)) \{}
\DoxyCodeLine{901                matrix.val.push\_back(sign\_1*sign\_2);}
\DoxyCodeLine{902                matrix.col.push\_back(col);}
\DoxyCodeLine{903             \}}
\DoxyCodeLine{904       }
\DoxyCodeLine{905          \}}
\DoxyCodeLine{906          matrix.row[row + 1] = matrix.col.size();}
\DoxyCodeLine{907       \}}
\DoxyCodeLine{908       matrix.tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}};}
\DoxyCodeLine{909       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{910    \}}
\DoxyCodeLine{911    }
\DoxyCodeLine{916    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78254cae08d7c8f32a949c6f362f5671}{CreateOnsiteOperatorSzL}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{917       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2lspin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin);}
\DoxyCodeLine{918       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite\_lspin = magnitude\_2lspin + 1;}
\DoxyCodeLine{919       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = dim\_onsite\_lspin*\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(std::pow(4, num\_orbital));}
\DoxyCodeLine{920       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{921       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{922          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} col = 0; col < dim\_onsite; ++col) \{}
\DoxyCodeLine{923             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_row\_lspin = row\%dim\_onsite\_lspin;}
\DoxyCodeLine{924             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_col\_lspin = col\%dim\_onsite\_lspin;}
\DoxyCodeLine{925             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_row\_total\_electron = row/dim\_onsite\_lspin;}
\DoxyCodeLine{926             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_col\_total\_electron = col/dim\_onsite\_lspin;}
\DoxyCodeLine{927             \textcolor{keywordflow}{if} (basis\_row\_total\_electron == basis\_col\_total\_electron \&\& basis\_row\_lspin == basis\_col\_lspin) \{}
\DoxyCodeLine{928                matrix.val.push\_back(magnitude\_lspin -\/ basis\_row\_lspin);}
\DoxyCodeLine{929                matrix.col.push\_back(col);}
\DoxyCodeLine{930             \}}
\DoxyCodeLine{931          \}}
\DoxyCodeLine{932          matrix.row.push\_back(matrix.col.size());}
\DoxyCodeLine{933       \}}
\DoxyCodeLine{934       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{935    \}}
\DoxyCodeLine{936    }
\DoxyCodeLine{941    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a17a6cf9982ffac83950f77b752e551cc}{CreateOnsiteOperatorSpL}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{942       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2lspin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin);}
\DoxyCodeLine{943       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite\_lspin = magnitude\_2lspin + 1;}
\DoxyCodeLine{944       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = dim\_onsite\_lspin*\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(std::pow(4, num\_orbital));}
\DoxyCodeLine{945       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{946       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{947          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} col = 0; col < dim\_onsite; ++col) \{}
\DoxyCodeLine{948             \textcolor{keyword}{const} \textcolor{keywordtype}{int} a = row\%dim\_onsite\_lspin + 1;}
\DoxyCodeLine{949             \textcolor{keyword}{const} \textcolor{keywordtype}{int} b = col\%dim\_onsite\_lspin + 1;}
\DoxyCodeLine{950             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_row\_total\_electron = row/dim\_onsite\_lspin;}
\DoxyCodeLine{951             \textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_col\_total\_electron = col/dim\_onsite\_lspin;}
\DoxyCodeLine{952             \textcolor{keywordflow}{if} (basis\_row\_total\_electron == basis\_col\_total\_electron \&\& a + 1 == b) \{}
\DoxyCodeLine{953                matrix.val.push\_back(std::sqrt( (magnitude\_lspin + 1.0)*(a + b -\/ 1) -\/ a*b ) );}
\DoxyCodeLine{954                matrix.col.push\_back(col);}
\DoxyCodeLine{955             \}}
\DoxyCodeLine{956          \}}
\DoxyCodeLine{957          matrix.row.push\_back(matrix.col.size());}
\DoxyCodeLine{958       \}}
\DoxyCodeLine{959       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{960    \}}
\DoxyCodeLine{961    }
\DoxyCodeLine{968    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a53b54db3c6fd7d566d6f66c8d1ccac82}{CreateOnsiteOperatorCUpDagger}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{969       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a81121d01de3f87008e470fc780ade437}{CreateOnsiteOperatorCUp}}(magnitude\_lspin, orbital, num\_orbital));}
\DoxyCodeLine{970    \}}
\DoxyCodeLine{971    }
\DoxyCodeLine{978    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3e02f811ba1732fd2f46f7e1a7515715}{CreateOnsiteOperatorCDownDagger}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{979       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1668c793b6257fff9eb55980a72b5e59}{CreateOnsiteOperatorCDown}}(magnitude\_lspin, orbital, num\_orbital));}
\DoxyCodeLine{980    \}}
\DoxyCodeLine{981    }
\DoxyCodeLine{989    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5c8a082c4911ec89b93b132d8717901d}{CreateOnsiteOperatorNCUp}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{990       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a53b54db3c6fd7d566d6f66c8d1ccac82}{CreateOnsiteOperatorCUpDagger}}(magnitude\_lspin, orbital, num\_orbital)*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a81121d01de3f87008e470fc780ade437}{CreateOnsiteOperatorCUp}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{991    \}}
\DoxyCodeLine{992    }
\DoxyCodeLine{1000    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a7d4f7a75cf5f3995bff11df2d636b3f7}{CreateOnsiteOperatorNCDown}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1001       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3e02f811ba1732fd2f46f7e1a7515715}{CreateOnsiteOperatorCDownDagger}}(magnitude\_lspin, orbital, num\_orbital)*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1668c793b6257fff9eb55980a72b5e59}{CreateOnsiteOperatorCDown}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{1002    \}}
\DoxyCodeLine{1003    }
\DoxyCodeLine{1010    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a0dd2bde40826d4936a3fc4fd5e4ab023}{CreateOnsiteOperatorNC}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1011       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5c8a082c4911ec89b93b132d8717901d}{CreateOnsiteOperatorNCUp}}(magnitude\_lspin, orbital, num\_orbital) + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a7d4f7a75cf5f3995bff11df2d636b3f7}{CreateOnsiteOperatorNCDown}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{1012    \}}
\DoxyCodeLine{1013    }
\DoxyCodeLine{1019    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af3a3998b4dc60c8ca6a2b2a68cb2db27}{CreateOnsiteOperatorNCTot}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1020       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim = (\mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin) + 1)*\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(std::pow(4, num\_orbital));}
\DoxyCodeLine{1021       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} out(dim, dim);}
\DoxyCodeLine{1022       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < num\_orbital; ++o) \{}
\DoxyCodeLine{1023          out = out + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a0dd2bde40826d4936a3fc4fd5e4ab023}{CreateOnsiteOperatorNC}}(magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{1024       \}}
\DoxyCodeLine{1025       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1026    \}}
\DoxyCodeLine{1027    }
\DoxyCodeLine{1035    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a259cc01b3a682e40fdaaa04997b1357b}{CreateOnsiteOperatorSxC}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1036       \textcolor{keywordflow}{return} 0.5*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a919a11f3a57373111da1cef23a756f38}{CreateOnsiteOperatorSpC}}(magnitude\_lspin, orbital, num\_orbital) + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78e1fb183f6b2401c27e8c02c50fddc3}{CreateOnsiteOperatorSmC}}(magnitude\_lspin, orbital, num\_orbital));}
\DoxyCodeLine{1037    \}}
\DoxyCodeLine{1038    }
\DoxyCodeLine{1047    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a0433b40126795f85effc65c3dbebdb10}{CreateOnsiteOperatoriSyC}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1048       \textcolor{keywordflow}{return} 0.5*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a919a11f3a57373111da1cef23a756f38}{CreateOnsiteOperatorSpC}}(magnitude\_lspin, orbital, num\_orbital) -\/ \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78e1fb183f6b2401c27e8c02c50fddc3}{CreateOnsiteOperatorSmC}}(magnitude\_lspin, orbital, num\_orbital));}
\DoxyCodeLine{1049    \}}
\DoxyCodeLine{1050    }
\DoxyCodeLine{1058    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a429b254b0bd47556aadd8ec2ca73958b}{CreateOnsiteOperatorSzC}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1059       \textcolor{keywordflow}{return} 0.5*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5c8a082c4911ec89b93b132d8717901d}{CreateOnsiteOperatorNCUp}}(magnitude\_lspin, orbital, num\_orbital) -\/ \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a7d4f7a75cf5f3995bff11df2d636b3f7}{CreateOnsiteOperatorNCDown}}(magnitude\_lspin, orbital, num\_orbital));}
\DoxyCodeLine{1060    \}}
\DoxyCodeLine{1061    }
\DoxyCodeLine{1068    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a919a11f3a57373111da1cef23a756f38}{CreateOnsiteOperatorSpC}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1069       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a53b54db3c6fd7d566d6f66c8d1ccac82}{CreateOnsiteOperatorCUpDagger}}(magnitude\_lspin, orbital, num\_orbital)*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1668c793b6257fff9eb55980a72b5e59}{CreateOnsiteOperatorCDown}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{1070    \}}
\DoxyCodeLine{1071    }
\DoxyCodeLine{1078    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78e1fb183f6b2401c27e8c02c50fddc3}{CreateOnsiteOperatorSmC}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1079       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3e02f811ba1732fd2f46f7e1a7515715}{CreateOnsiteOperatorCDownDagger}}(magnitude\_lspin, orbital, num\_orbital)*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a81121d01de3f87008e470fc780ade437}{CreateOnsiteOperatorCUp}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{1080    \}}
\DoxyCodeLine{1081    }
\DoxyCodeLine{1086    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe2ebc639500b8c2a6375c7ef0be2167}{CreateOnsiteOperatorSmL}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1087       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a17a6cf9982ffac83950f77b752e551cc}{CreateOnsiteOperatorSpL}}(magnitude\_lspin, num\_orbital));}
\DoxyCodeLine{1088    \}}
\DoxyCodeLine{1089    }
\DoxyCodeLine{1094    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a6688b056b5ff8d818c4e17f45b7df882}{CreateOnsiteOperatorSxL}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1095       \textcolor{keywordflow}{return} 0.5*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a17a6cf9982ffac83950f77b752e551cc}{CreateOnsiteOperatorSpL}}(magnitude\_lspin, num\_orbital) + \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe2ebc639500b8c2a6375c7ef0be2167}{CreateOnsiteOperatorSmL}}(magnitude\_lspin, num\_orbital));}
\DoxyCodeLine{1096    \}}
\DoxyCodeLine{1097    }
\DoxyCodeLine{1103    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af27e7c190c2578e745e3c24c7a5c3c5a}{CreateOnsiteOperatoriSyL}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1104       \textcolor{keywordflow}{return} 0.5*(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a17a6cf9982ffac83950f77b752e551cc}{CreateOnsiteOperatorSpL}}(magnitude\_lspin, num\_orbital) -\/ \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe2ebc639500b8c2a6375c7ef0be2167}{CreateOnsiteOperatorSmL}}(magnitude\_lspin, num\_orbital));}
\DoxyCodeLine{1105    \}}
\DoxyCodeLine{1106    }
\DoxyCodeLine{1113    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a122912a358c24377d0aed4ec2235e86d}{CreateOnsiteOperatorSCSL}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1114       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} spc = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a919a11f3a57373111da1cef23a756f38}{CreateOnsiteOperatorSpC}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{1115       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} smc = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78e1fb183f6b2401c27e8c02c50fddc3}{CreateOnsiteOperatorSmC}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{1116       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} szc = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a429b254b0bd47556aadd8ec2ca73958b}{CreateOnsiteOperatorSzC}}(magnitude\_lspin, orbital, num\_orbital);}
\DoxyCodeLine{1117       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} spl = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a17a6cf9982ffac83950f77b752e551cc}{CreateOnsiteOperatorSpL}}(magnitude\_lspin, num\_orbital);}
\DoxyCodeLine{1118       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} sml = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe2ebc639500b8c2a6375c7ef0be2167}{CreateOnsiteOperatorSmL}}(magnitude\_lspin, num\_orbital);}
\DoxyCodeLine{1119       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} szl = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78254cae08d7c8f32a949c6f362f5671}{CreateOnsiteOperatorSzL}}(magnitude\_lspin, num\_orbital);}
\DoxyCodeLine{1120       \textcolor{keywordflow}{return} szc*szl + 0.5*(spc*sml + smc*spl);}
\DoxyCodeLine{1121    \}}
\DoxyCodeLine{1122    }
\DoxyCodeLine{1129    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a232eead839e828334a264679d8dd5492}{CreateOnsiteOperatorSCSLTot}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1130       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} spl = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a17a6cf9982ffac83950f77b752e551cc}{CreateOnsiteOperatorSpL}}(magnitude\_lspin, num\_orbital);}
\DoxyCodeLine{1131       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} sml = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe2ebc639500b8c2a6375c7ef0be2167}{CreateOnsiteOperatorSmL}}(magnitude\_lspin, num\_orbital);}
\DoxyCodeLine{1132       \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} szl = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78254cae08d7c8f32a949c6f362f5671}{CreateOnsiteOperatorSzL}}(magnitude\_lspin, num\_orbital);}
\DoxyCodeLine{1133       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} out(szl.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}, szl.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}});}
\DoxyCodeLine{1134       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < num\_orbital; ++o) \{}
\DoxyCodeLine{1135          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} spc = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a919a11f3a57373111da1cef23a756f38}{CreateOnsiteOperatorSpC}}(magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{1136          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} smc = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78e1fb183f6b2401c27e8c02c50fddc3}{CreateOnsiteOperatorSmC}}(magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{1137          \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} szc = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a429b254b0bd47556aadd8ec2ca73958b}{CreateOnsiteOperatorSzC}}(magnitude\_lspin, o, num\_orbital);}
\DoxyCodeLine{1138          out = out + szc*szl + 0.5*(spc*sml + smc*spl);}
\DoxyCodeLine{1139       \}}
\DoxyCodeLine{1140       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1141    \}}
\DoxyCodeLine{1142    }
\DoxyCodeLine{1143    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Access Private Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1144    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a99d239a294e73a555df201f0918db9b7}{GetOnsiteOperatorCUp}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aee5456ef719458abd885f28cdeb8b48b}{onsite\_operator\_c\_up\_}}; \}}
\DoxyCodeLine{1145    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a8a54e2bd0487fcaa5f3f727c601e837a}{GetOnsiteOperatorCDown}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5dd311f2b3cbc774303647c01ae0d77a}{onsite\_operator\_c\_down\_}}; \}}
\DoxyCodeLine{1146    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a59e8d727631f3fa5c3a3f9ba1da668c9}{GetOnsiteOperatorCUpDagger}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa7df622178ee244bfa5d6407843e60af}{onsite\_operator\_c\_up\_dagger\_}}; \}}
\DoxyCodeLine{1147    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af0008870991c7aadc241beb223daaa68}{GetOnsiteOperatorCDownDagger}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac216fa16d421f5b75d7a62e7c2948f22}{onsite\_operator\_c\_down\_dagger\_}}; \}}
\DoxyCodeLine{1148    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a243117ae46e52aa84fdb4507b77b4532}{GetOnsiteOperatorNCUp}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a561bcff85556fe1dde7093217722bd9e}{onsite\_operator\_nc\_up\_}}; \}}
\DoxyCodeLine{1149    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ab5bc493d369afa790b504f6c57302142}{GetOnsiteOperatorNCDown}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a561bcff85556fe1dde7093217722bd9e}{onsite\_operator\_nc\_up\_}}; \}}
\DoxyCodeLine{1150    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a312eee8f46ac943619a1cfe7395bff1c}{GetOnsiteOperatorNC}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_acf5411311f76e9f84ed67be2d8ab13a2}{onsite\_operator\_nc\_}}; \}}
\DoxyCodeLine{1151    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a6a426b25368fef5c50f8165438e1a0f6}{GetOnsiteOperatorSxC}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac28a20bceda0539987011c5ab184deeb}{onsite\_operator\_sxc\_}}; \}}
\DoxyCodeLine{1152    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae2b6878e8172a0e94d3581af8d2c6554}{GetOnsiteOperatoriSyC}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a09f3be9d4a71133b95706a6dfb876e1e}{onsite\_operator\_isyc\_}}; \}}
\DoxyCodeLine{1153    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5cf5b90e993fd07e60cb39faddf5f3ae}{GetOnsiteOperatorSzC}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abf6ffb8ddccae72ca86be88d1dd17ac8}{onsite\_operator\_szc\_}}; \}}
\DoxyCodeLine{1154    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a29e69885d0537a6ae3fedc9a3c8f2aac}{GetOnsiteOperatorSpC}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af99cfad55fcbb3402a0f452726f659dc}{onsite\_operator\_spc\_}}; \}}
\DoxyCodeLine{1155    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad5fc92a7320dc19aaaee31690bd5a0fd}{GetOnsiteOperatorSmC}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a56cdd1b894a9baab7bb52cc1cdbd503b}{onsite\_operator\_smc\_}}; \}}
\DoxyCodeLine{1156    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a576c62e21e89cf74bf34b0d1fee278b1}{GetOnsiteOperatorSCSL}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae42cc437666ff47f9b04c7ba318000eb}{onsite\_operator\_scsl\_}};\}}
\DoxyCodeLine{1157 }
\DoxyCodeLine{1158    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ade0bec816c99ea8763fb209753dec77a}{GetOnsiteOperatorNCTot}}() \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad40c29285f5707337a2bea07ecd9bbc6}{onsite\_operator\_nc\_tot\_}}; \}}
\DoxyCodeLine{1159    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae6bcfb5c3d56eaf078ac2acae0d28595}{GetOnsiteOperatorCUp}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aee5456ef719458abd885f28cdeb8b48b}{onsite\_operator\_c\_up\_}}.at(orbital); \}}
\DoxyCodeLine{1160    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4c568306a57d525c3c342977f27dddd8}{GetOnsiteOperatorCDown}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5dd311f2b3cbc774303647c01ae0d77a}{onsite\_operator\_c\_down\_}}.at(orbital); \}}
\DoxyCodeLine{1161    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4eb686df8df2939d8027cf0d1a12aa0e}{GetOnsiteOperatorCUpDagger}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa7df622178ee244bfa5d6407843e60af}{onsite\_operator\_c\_up\_dagger\_}}.at(orbital); \}}
\DoxyCodeLine{1162    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af026cf0072dba1ae66e46f91d7e3b3d3}{GetOnsiteOperatorCDownDagger}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac216fa16d421f5b75d7a62e7c2948f22}{onsite\_operator\_c\_down\_dagger\_}}.at(orbital); \}}
\DoxyCodeLine{1163    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a8b5e1bcb8527c68b22301e9528629d8c}{GetOnsiteOperatorNCUp}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a561bcff85556fe1dde7093217722bd9e}{onsite\_operator\_nc\_up\_}}.at(orbital); \}}
\DoxyCodeLine{1164    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a789d332323d713ce75ddd59d1aa505b7}{GetOnsiteOperatorNCDown}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a561bcff85556fe1dde7093217722bd9e}{onsite\_operator\_nc\_up\_}}.at(orbital); \}}
\DoxyCodeLine{1165    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe415ed9d383486d6eb06ddf4cf52de4}{GetOnsiteOperatorNC}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_acf5411311f76e9f84ed67be2d8ab13a2}{onsite\_operator\_nc\_}}.at(orbital); \}}
\DoxyCodeLine{1166    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abeb13eb3c535189c88f608f1e61691e9}{GetOnsiteOperatorSxC}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac28a20bceda0539987011c5ab184deeb}{onsite\_operator\_sxc\_}}.at(orbital); \}}
\DoxyCodeLine{1167    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae176458d92d870ab31ab8b53c5007f7f}{GetOnsiteOperatoriSyC}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a09f3be9d4a71133b95706a6dfb876e1e}{onsite\_operator\_isyc\_}}.at(orbital); \}}
\DoxyCodeLine{1168    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa6e0ff75812d22ed39bc64856d834ed2}{GetOnsiteOperatorSzC}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abf6ffb8ddccae72ca86be88d1dd17ac8}{onsite\_operator\_szc\_}}.at(orbital); \}}
\DoxyCodeLine{1169    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_acd4cc34fead7a41d18bbfdbeddcc67dc}{GetOnsiteOperatorSpC}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af99cfad55fcbb3402a0f452726f659dc}{onsite\_operator\_spc\_}}.at(orbital); \}}
\DoxyCodeLine{1170    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a50caf8479a0ae845bce5b06aca814de6}{GetOnsiteOperatorSmC}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a56cdd1b894a9baab7bb52cc1cdbd503b}{onsite\_operator\_smc\_}}.at(orbital); \}}
\DoxyCodeLine{1171    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa4f1c90f4a0354c89b58691cb2ce2548}{GetOnsiteOperatorSCSL}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae42cc437666ff47f9b04c7ba318000eb}{onsite\_operator\_scsl\_}}.at(orbital);\}}
\DoxyCodeLine{1172    }
\DoxyCodeLine{1175    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a489580f0553dc4de180c0a5ca0e093c0}{GetOnsiteOperatorSxL}}()\textcolor{keyword}{  const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aede6cf79398fb3e8c5693b971dfd99ad}{onsite\_operator\_sxl\_}}; \}}
\DoxyCodeLine{1176    }
\DoxyCodeLine{1179    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a172ed34aef5de3f60df7c5f8690f8944}{GetOnsiteOperatoriSyL}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae6365d3c8797be7f355767f1e389cf86}{onsite\_operator\_isyl\_}}; \}}
\DoxyCodeLine{1180    }
\DoxyCodeLine{1183    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a7eaa08a6c432e2ebf3eb106b7bdb825d}{GetOnsiteOperatorSzL}}()\textcolor{keyword}{  const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9a1a099bd402df24ff062a486a82c9dd}{onsite\_operator\_szl\_}}; \}}
\DoxyCodeLine{1184    }
\DoxyCodeLine{1187    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a096dddc6e4fe7450b8db68e86369efc0}{GetOnsiteOperatorSpL}}()\textcolor{keyword}{  const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aba0cdb7f86b96d25ce980e5cfc51ab32}{onsite\_operator\_spl\_}}; \}}
\DoxyCodeLine{1188    }
\DoxyCodeLine{1191    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abb2f580f9b0bf279b0587dc69721f3e8}{GetOnsiteOperatorSmL}}()\textcolor{keyword}{  const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a01aee3febef5dd125382f8e0ac9d895f}{onsite\_operator\_sml\_}}; \}}
\DoxyCodeLine{1192    }
\DoxyCodeLine{1193    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a766bdca012beb6cb8672cd86a67ce200}{GetDimOnsiteElectron}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa0c1648165b632ae0ca7f7da5a967f8e}{dim\_onsite\_electron\_}}; \}}
\DoxyCodeLine{1194    }
\DoxyCodeLine{1195    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<int> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aab47ed513eeccfefd34a657aafeb7b75}{GetTotalElectron}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}; \}}
\DoxyCodeLine{1196    }
\DoxyCodeLine{1197    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1aebb0ea10dca65eeb2ba6f7d77b5326}{GetTotalElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.at(orbital); \}}
\DoxyCodeLine{1198 }
\DoxyCodeLine{1199    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9fee2c97e4ab5da8fe137f738c100d52}{GetNumElectronOrbital}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}}; \}}
\DoxyCodeLine{1200    }
\DoxyCodeLine{1201    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af363e5c9e27db10327b83c62f0736497}{GetDimOnsiteAllElectrons}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1a6de3078e6c329c68e8ef821bdedafe}{dim\_onsite\_all\_electrons\_}}; \}}
\DoxyCodeLine{1202    }
\DoxyCodeLine{1205    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ab432b58714de1e342265984faddf6721}{GetSystemSize}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}}; \}}
\DoxyCodeLine{1206    }
\DoxyCodeLine{1209    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1a0eec13366170c91e4a17d68e9cfa92}{GetTotalSz}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}}; \}}
\DoxyCodeLine{1210    }
\DoxyCodeLine{1213    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a59cc445d0fb9900e85b5b5237a4179d7}{GetMagnitudeLSpin}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}; \}}
\DoxyCodeLine{1214    }
\DoxyCodeLine{1215    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a61163aa8f07d9e9627d063b60534f831}{GetDimOnsiteLSpin}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}} + 1; \}}
\DoxyCodeLine{1216    }
\DoxyCodeLine{1219    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48e2955cf4342d6c71279ea7fb0ed77c}{GetDimOnsite}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9b72902b16e25d9a0e9d4eb3520596ee}{dim\_onsite\_}}; \}}
\DoxyCodeLine{1220    }
\DoxyCodeLine{1223    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_set<int> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a2cfd5a47f99ecf073272213342b4fdcc}{GetCalculatedEigenvectorSet}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1224       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{1225    \}}
\DoxyCodeLine{1226    }
\DoxyCodeLine{1233    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<LInt> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a218bfb127e80ac4c03d1e3ad8b93b9a5}{GetBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} \&quantum\_number)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1234       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}.at(\{quantum\_number.first, \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(quantum\_number.second)\});}
\DoxyCodeLine{1235    \}}
\DoxyCodeLine{1236    }
\DoxyCodeLine{1243    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<LInt, LInt>}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a59193e328b0467880c27708ca5566ca6}{GetBasisInv}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4d0edec477502ebc45aa6367dedb1224}{QType}} \&quantum\_number)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1244       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a658ab85ccc6d2d8abe911d27e727cafa}{bases\_inv\_}}.at(\{quantum\_number.first, \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(quantum\_number.second)\});}
\DoxyCodeLine{1245    \}}
\DoxyCodeLine{1246    }
\DoxyCodeLine{1252    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<LInt> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3b2e6a1fb279edb1597a919996fffa24}{GetTargetBasis}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1253       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}}.at(\{\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}}\});}
\DoxyCodeLine{1254    \}}
\DoxyCodeLine{1255    }
\DoxyCodeLine{1261    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<LInt, LInt>}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a02dd186df329a8a2aa063428d4a54384}{GetTargetBasisInv}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1262       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a658ab85ccc6d2d8abe911d27e727cafa}{bases\_inv\_}}.at(\{\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}}\});}
\DoxyCodeLine{1263    \}}
\DoxyCodeLine{1264    }
\DoxyCodeLine{1265 \textcolor{keyword}{protected}:}
\DoxyCodeLine{1268    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aee5456ef719458abd885f28cdeb8b48b}{onsite\_operator\_c\_up\_}};}
\DoxyCodeLine{1269    }
\DoxyCodeLine{1272    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5dd311f2b3cbc774303647c01ae0d77a}{onsite\_operator\_c\_down\_}};}
\DoxyCodeLine{1273    }
\DoxyCodeLine{1276    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa7df622178ee244bfa5d6407843e60af}{onsite\_operator\_c\_up\_dagger\_}};}
\DoxyCodeLine{1277    }
\DoxyCodeLine{1280    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac216fa16d421f5b75d7a62e7c2948f22}{onsite\_operator\_c\_down\_dagger\_}};}
\DoxyCodeLine{1281    }
\DoxyCodeLine{1285    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a561bcff85556fe1dde7093217722bd9e}{onsite\_operator\_nc\_up\_}};}
\DoxyCodeLine{1286    }
\DoxyCodeLine{1290    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa1c151c8f51cfa24eb3aeaa05c48efc4}{onsite\_operator\_nc\_down\_}};}
\DoxyCodeLine{1291    }
\DoxyCodeLine{1294    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_acf5411311f76e9f84ed67be2d8ab13a2}{onsite\_operator\_nc\_}};}
\DoxyCodeLine{1295    }
\DoxyCodeLine{1298    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad40c29285f5707337a2bea07ecd9bbc6}{onsite\_operator\_nc\_tot\_}};}
\DoxyCodeLine{1299    }
\DoxyCodeLine{1303    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac28a20bceda0539987011c5ab184deeb}{onsite\_operator\_sxc\_}};}
\DoxyCodeLine{1304    }
\DoxyCodeLine{1309    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a09f3be9d4a71133b95706a6dfb876e1e}{onsite\_operator\_isyc\_}};}
\DoxyCodeLine{1310    }
\DoxyCodeLine{1314    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abf6ffb8ddccae72ca86be88d1dd17ac8}{onsite\_operator\_szc\_}};}
\DoxyCodeLine{1315    }
\DoxyCodeLine{1318    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af99cfad55fcbb3402a0f452726f659dc}{onsite\_operator\_spc\_}};}
\DoxyCodeLine{1319    }
\DoxyCodeLine{1322    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a56cdd1b894a9baab7bb52cc1cdbd503b}{onsite\_operator\_smc\_}};}
\DoxyCodeLine{1323    }
\DoxyCodeLine{1325    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aede6cf79398fb3e8c5693b971dfd99ad}{onsite\_operator\_sxl\_}};}
\DoxyCodeLine{1326    }
\DoxyCodeLine{1328    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae6365d3c8797be7f355767f1e389cf86}{onsite\_operator\_isyl\_}};}
\DoxyCodeLine{1329    }
\DoxyCodeLine{1331    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9a1a099bd402df24ff062a486a82c9dd}{onsite\_operator\_szl\_}};}
\DoxyCodeLine{1332    }
\DoxyCodeLine{1334    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aba0cdb7f86b96d25ce980e5cfc51ab32}{onsite\_operator\_spl\_}};}
\DoxyCodeLine{1335    }
\DoxyCodeLine{1337    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a01aee3febef5dd125382f8e0ac9d895f}{onsite\_operator\_sml\_}};}
\DoxyCodeLine{1338    }
\DoxyCodeLine{1342    std::vector<CRS> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae42cc437666ff47f9b04c7ba318000eb}{onsite\_operator\_scsl\_}};}
\DoxyCodeLine{1343    }
\DoxyCodeLine{1345    \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa0c1648165b632ae0ca7f7da5a967f8e}{dim\_onsite\_electron\_}} = 4;}
\DoxyCodeLine{1346    }
\DoxyCodeLine{1348    std::vector<int> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}} = \{0\};}
\DoxyCodeLine{1349    }
\DoxyCodeLine{1351    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}} = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abe176d44790bbf9b3ad7aa530ff8852b}{total\_electron\_}}.size());}
\DoxyCodeLine{1352    }
\DoxyCodeLine{1354    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1a6de3078e6c329c68e8ef821bdedafe}{dim\_onsite\_all\_electrons\_}} = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa0c1648165b632ae0ca7f7da5a967f8e}{dim\_onsite\_electron\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}}));}
\DoxyCodeLine{1355    }
\DoxyCodeLine{1357    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aaa4e6a0a26b31814a2c17303455dbd67}{system\_size\_}} = 0;}
\DoxyCodeLine{1358    }
\DoxyCodeLine{1362    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a70d04f95b8f51b13f866ae7d388127a6}{total\_2sz\_}} = 0;}
\DoxyCodeLine{1363    }
\DoxyCodeLine{1365    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}} = 1;}
\DoxyCodeLine{1366    }
\DoxyCodeLine{1368    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}} + 1;}
\DoxyCodeLine{1369    }
\DoxyCodeLine{1371    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9b72902b16e25d9a0e9d4eb3520596ee}{dim\_onsite\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1a6de3078e6c329c68e8ef821bdedafe}{dim\_onsite\_all\_electrons\_}}*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}};}
\DoxyCodeLine{1372    }
\DoxyCodeLine{1374    std::unordered\_set<int> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad6ae6b65e82fe64291bc54a2437dbf4b}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{1375    }
\DoxyCodeLine{1381    \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<VecIntPair, std::vector<LInt>}}, \mbox{\hyperlink{structcompnal_1_1_vec_int_hash}{VecIntHash}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4fff5b042b3132cfbbe1f50f4654f496}{bases\_}};}
\DoxyCodeLine{1382    }
\DoxyCodeLine{1388    \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<VecIntPair, Map<LInt, LInt>}}, \mbox{\hyperlink{structcompnal_1_1_vec_int_hash}{VecIntHash}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a658ab85ccc6d2d8abe911d27e727cafa}{bases\_inv\_}};}
\DoxyCodeLine{1389    }
\DoxyCodeLine{1391    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4e56bb2b6493a742b5b06b3bfd8986a1}{SetOnsiteOperator}}() \{}
\DoxyCodeLine{1392       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aee5456ef719458abd885f28cdeb8b48b}{onsite\_operator\_c\_up\_}}         .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1393       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5dd311f2b3cbc774303647c01ae0d77a}{onsite\_operator\_c\_down\_}}       .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1394       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa7df622178ee244bfa5d6407843e60af}{onsite\_operator\_c\_up\_dagger\_}}  .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1395       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac216fa16d421f5b75d7a62e7c2948f22}{onsite\_operator\_c\_down\_dagger\_}}.resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1396       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a561bcff85556fe1dde7093217722bd9e}{onsite\_operator\_nc\_up\_}}        .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1397       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa1c151c8f51cfa24eb3aeaa05c48efc4}{onsite\_operator\_nc\_down\_}}      .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1398       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_acf5411311f76e9f84ed67be2d8ab13a2}{onsite\_operator\_nc\_}}           .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1399       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac28a20bceda0539987011c5ab184deeb}{onsite\_operator\_sxc\_}}          .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1400       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a09f3be9d4a71133b95706a6dfb876e1e}{onsite\_operator\_isyc\_}}         .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1401       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abf6ffb8ddccae72ca86be88d1dd17ac8}{onsite\_operator\_szc\_}}          .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1402       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af99cfad55fcbb3402a0f452726f659dc}{onsite\_operator\_spc\_}}          .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1403       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a56cdd1b894a9baab7bb52cc1cdbd503b}{onsite\_operator\_smc\_}}          .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1404       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae42cc437666ff47f9b04c7ba318000eb}{onsite\_operator\_scsl\_}}         .resize(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1405       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} o = 0; o < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}}; ++o) \{}
\DoxyCodeLine{1406          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aee5456ef719458abd885f28cdeb8b48b}{onsite\_operator\_c\_up\_}}[o]          = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a81121d01de3f87008e470fc780ade437}{CreateOnsiteOperatorCUp}}        (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1407          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5dd311f2b3cbc774303647c01ae0d77a}{onsite\_operator\_c\_down\_}}[o]        = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a1668c793b6257fff9eb55980a72b5e59}{CreateOnsiteOperatorCDown}}      (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1408          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa7df622178ee244bfa5d6407843e60af}{onsite\_operator\_c\_up\_dagger\_}}[o]   = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a53b54db3c6fd7d566d6f66c8d1ccac82}{CreateOnsiteOperatorCUpDagger}}  (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1409          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac216fa16d421f5b75d7a62e7c2948f22}{onsite\_operator\_c\_down\_dagger\_}}[o] = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3e02f811ba1732fd2f46f7e1a7515715}{CreateOnsiteOperatorCDownDagger}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1410          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a561bcff85556fe1dde7093217722bd9e}{onsite\_operator\_nc\_up\_}}[o]         = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5c8a082c4911ec89b93b132d8717901d}{CreateOnsiteOperatorNCUp}}       (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1411          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa1c151c8f51cfa24eb3aeaa05c48efc4}{onsite\_operator\_nc\_down\_}}[o]       = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a7d4f7a75cf5f3995bff11df2d636b3f7}{CreateOnsiteOperatorNCDown}}     (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1412          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_acf5411311f76e9f84ed67be2d8ab13a2}{onsite\_operator\_nc\_}}[o]            = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a0dd2bde40826d4936a3fc4fd5e4ab023}{CreateOnsiteOperatorNC}}         (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1413          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ac28a20bceda0539987011c5ab184deeb}{onsite\_operator\_sxc\_}}[o]           = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a259cc01b3a682e40fdaaa04997b1357b}{CreateOnsiteOperatorSxC}}        (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1414          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a09f3be9d4a71133b95706a6dfb876e1e}{onsite\_operator\_isyc\_}}[o]          = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a0433b40126795f85effc65c3dbebdb10}{CreateOnsiteOperatoriSyC}}       (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1415          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_abf6ffb8ddccae72ca86be88d1dd17ac8}{onsite\_operator\_szc\_}}[o]           = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a429b254b0bd47556aadd8ec2ca73958b}{CreateOnsiteOperatorSzC}}        (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1416          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af99cfad55fcbb3402a0f452726f659dc}{onsite\_operator\_spc\_}}[o]           = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a919a11f3a57373111da1cef23a756f38}{CreateOnsiteOperatorSpC}}        (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1417          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a56cdd1b894a9baab7bb52cc1cdbd503b}{onsite\_operator\_smc\_}}[o]           = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78e1fb183f6b2401c27e8c02c50fddc3}{CreateOnsiteOperatorSmC}}        (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1418          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae42cc437666ff47f9b04c7ba318000eb}{onsite\_operator\_scsl\_}}[o]          = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a122912a358c24377d0aed4ec2235e86d}{CreateOnsiteOperatorSCSL}}       (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, o, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1419       \}}
\DoxyCodeLine{1420       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad40c29285f5707337a2bea07ecd9bbc6}{onsite\_operator\_nc\_tot\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af3a3998b4dc60c8ca6a2b2a68cb2db27}{CreateOnsiteOperatorNCTot}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1421       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aede6cf79398fb3e8c5693b971dfd99ad}{onsite\_operator\_sxl\_}}    = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a6688b056b5ff8d818c4e17f45b7df882}{CreateOnsiteOperatorSxL}}  (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1422       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ae6365d3c8797be7f355767f1e389cf86}{onsite\_operator\_isyl\_}}   = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_af27e7c190c2578e745e3c24c7a5c3c5a}{CreateOnsiteOperatoriSyL}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1423       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9a1a099bd402df24ff062a486a82c9dd}{onsite\_operator\_szl\_}}    = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a78254cae08d7c8f32a949c6f362f5671}{CreateOnsiteOperatorSzL}}  (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1424       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aba0cdb7f86b96d25ce980e5cfc51ab32}{onsite\_operator\_spl\_}}    = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a17a6cf9982ffac83950f77b752e551cc}{CreateOnsiteOperatorSpL}}  (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1425       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a01aee3febef5dd125382f8e0ac9d895f}{onsite\_operator\_sml\_}}    = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_afe2ebc639500b8c2a6375c7ef0be2167}{CreateOnsiteOperatorSmL}}  (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a63fe1f6ba99bd29ab2b50e24371fbaed}{magnitude\_2lspin\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}});}
\DoxyCodeLine{1426    \}}
\DoxyCodeLine{1427       }
\DoxyCodeLine{1432    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a3d5150384f28ce59aa15473581322e96}{CalculateBasisOnsiteElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite, \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1433       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_inner\_electron = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a67736771e3b7bbdb84283e821d1412f9}{num\_electron\_orbital\_}} -\/ orbital -\/ 1;}
\DoxyCodeLine{1434       \textcolor{keywordtype}{int} basis\_electron\_onsite = basis\_onsite/\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}};}
\DoxyCodeLine{1435       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < num\_inner\_electron; ++i) \{}
\DoxyCodeLine{1436          basis\_electron\_onsite /= \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa0c1648165b632ae0ca7f7da5a967f8e}{dim\_onsite\_electron\_}};}
\DoxyCodeLine{1437       \}}
\DoxyCodeLine{1438       \textcolor{keywordflow}{return} basis\_electron\_onsite\%\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_aa0c1648165b632ae0ca7f7da5a967f8e}{dim\_onsite\_electron\_}};}
\DoxyCodeLine{1439    \}}
\DoxyCodeLine{1440    }
\DoxyCodeLine{1447    \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a5c3b01802f811895ab46e17085b9905c}{CalculateBasisOnsiteElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite,}
\DoxyCodeLine{1448                                                   \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin,}
\DoxyCodeLine{1449                                                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} orbital,}
\DoxyCodeLine{1450                                                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_orbital) \{}
\DoxyCodeLine{1451       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite\_lspin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin) + 1;}
\DoxyCodeLine{1452       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_inner\_electron = num\_orbital -\/ orbital -\/ 1;}
\DoxyCodeLine{1453       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite\_electron = 4;}
\DoxyCodeLine{1454       \textcolor{keywordtype}{int} basis\_electron\_onsite = basis\_onsite/dim\_onsite\_lspin;}
\DoxyCodeLine{1455       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < num\_inner\_electron; ++i) \{}
\DoxyCodeLine{1456          basis\_electron\_onsite /= dim\_onsite\_electron;}
\DoxyCodeLine{1457       \}}
\DoxyCodeLine{1458       \textcolor{keywordflow}{return} basis\_electron\_onsite\%dim\_onsite\_electron;}
\DoxyCodeLine{1459    \}}
\DoxyCodeLine{1460    }
\DoxyCodeLine{1464    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a4ff7b328710f62f5351dd482950ac5db}{CalculateBasisOnsiteLSpin}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1465       \textcolor{keywordflow}{return} basis\_onsite\%\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a48fa20a398bf67c557a07f2b1b837b1c}{dim\_onsite\_lspin\_}};}
\DoxyCodeLine{1466    \}}
\DoxyCodeLine{1467    }
\DoxyCodeLine{1471    \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_ad94f55ffb42f8e61248a2e611366b124}{CalculateNumElectronFromElectronBasis}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_electron\_onsite) \{}
\DoxyCodeLine{1472       \textcolor{keywordflow}{if} (basis\_electron\_onsite == 0) \{}
\DoxyCodeLine{1473          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1474       \}}
\DoxyCodeLine{1475       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_electron\_onsite == 1 || basis\_electron\_onsite == 2) \{}
\DoxyCodeLine{1476          \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1477       \}}
\DoxyCodeLine{1478       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_electron\_onsite == 3) \{}
\DoxyCodeLine{1479          \textcolor{keywordflow}{return} 2;}
\DoxyCodeLine{1480       \}}
\DoxyCodeLine{1481       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1482          std::stringstream ss;}
\DoxyCodeLine{1483          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{1484          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{1485       \}}
\DoxyCodeLine{1486    \}}
\DoxyCodeLine{1487    }
\DoxyCodeLine{1488    \textcolor{keyword}{static} std::vector<std::vector<int>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a9ea3a542efc8659172ea383f9e5b6b5d}{GenerateElectronConfigurations}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron) \{}
\DoxyCodeLine{1489       \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_n\_up\_down = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(total\_electron/2);}
\DoxyCodeLine{1490       std::vector<std::vector<int>> ele\_configurations(4);}
\DoxyCodeLine{1491       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n\_up\_down = 0; n\_up\_down <= max\_n\_up\_down; ++n\_up\_down) \{}
\DoxyCodeLine{1492          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n\_up = 0; n\_up <= total\_electron -\/ 2*n\_up\_down; ++n\_up) \{}
\DoxyCodeLine{1493             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down = total\_electron -\/ 2*n\_up\_down -\/ n\_up;}
\DoxyCodeLine{1494             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_vac  = system\_size -\/ n\_up -\/ n\_down -\/ n\_up\_down;}
\DoxyCodeLine{1495             \textcolor{keywordflow}{if} (0 <= n\_up \&\& 0 <= n\_down \&\& 0 <= n\_vac) \{}
\DoxyCodeLine{1496                ele\_configurations[0].push\_back(n\_up\_down);}
\DoxyCodeLine{1497                ele\_configurations[1].push\_back(n\_up     );}
\DoxyCodeLine{1498                ele\_configurations[2].push\_back(n\_down   );}
\DoxyCodeLine{1499                ele\_configurations[3].push\_back(n\_vac    );}
\DoxyCodeLine{1500             \}}
\DoxyCodeLine{1501          \}}
\DoxyCodeLine{1502       \}}
\DoxyCodeLine{1503       \textcolor{keywordflow}{return} ele\_configurations;}
\DoxyCodeLine{1504    \}}
\DoxyCodeLine{1505    }
\DoxyCodeLine{1512    \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_multi_electrons__1_d_a366930d1037d58b11062eec884a9d644}{isValidQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_lspin, \textcolor{keyword}{const} std::vector<int> \&total\_electron, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{1513       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz            = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{1514       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2lspin     = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_lspin);}
\DoxyCodeLine{1515       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_total\_electron = std::accumulate(total\_electron.begin(), total\_electron.end(), 0);}
\DoxyCodeLine{1516       }
\DoxyCodeLine{1517       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&electron: total\_electron) \{}
\DoxyCodeLine{1518          \textcolor{keywordflow}{if} (electron < 0 || 2*system\_size < electron) \{}
\DoxyCodeLine{1519             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{1520          \}}
\DoxyCodeLine{1521       \}}
\DoxyCodeLine{1522       }
\DoxyCodeLine{1523       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = ((total\_total\_electron + system\_size*magnitude\_2lspin -\/ total\_2sz)\%2 == 0);}
\DoxyCodeLine{1524       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (-\/(total\_total\_electron + system\_size*magnitude\_2lspin) <= total\_2sz);}
\DoxyCodeLine{1525       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (total\_2sz <= total\_total\_electron + system\_size*magnitude\_2lspin);}
\DoxyCodeLine{1526       }
\DoxyCodeLine{1527       \textcolor{keywordflow}{if} (!c1 \&\& !c2 \&\& !c3) \{}
\DoxyCodeLine{1528          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{1529       \}}
\DoxyCodeLine{1530       }
\DoxyCodeLine{1531       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{1532       }
\DoxyCodeLine{1533    \}}
\DoxyCodeLine{1534    }
\DoxyCodeLine{1535 \};}
\DoxyCodeLine{1536 }
\DoxyCodeLine{1537 \}}
\DoxyCodeLine{1538 \}}
\DoxyCodeLine{1539 }
\DoxyCodeLine{1540 }
\DoxyCodeLine{1541 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_BASE\_U1\_SPIN\_MULTI\_ELECTRONS\_1D\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
