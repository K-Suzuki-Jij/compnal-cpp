\hypertarget{exact__diag_8hpp_source}{}\doxysection{exact\+\_\+diag.\+hpp}
\label{exact__diag_8hpp_source}\index{src/solver/exact\_diag.hpp@{src/solver/exact\_diag.hpp}}
\mbox{\hyperlink{exact__diag_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/07.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../model/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{solver_2utility_8hpp}{./utility.hpp}}"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{26 \textcolor{keyword}{namespace }solver \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{30 \textcolor{keyword}{template}<\textcolor{keyword}{class} ModelClass>}
\DoxyCodeLine{31 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag}{ExactDiag}} \{}
\DoxyCodeLine{32    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{33    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Type Alias-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{34    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{36 \textcolor{comment}{}   \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} = \textcolor{keyword}{typename} ModelClass::ValueType;}
\DoxyCodeLine{37    }
\DoxyCodeLine{39    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef6fb4a525be81943447384b6170f3ef}{QType}} = \textcolor{keyword}{typename} ModelClass::QType;}
\DoxyCodeLine{40    }
\DoxyCodeLine{42    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}} = \textcolor{keyword}{typename} ModelClass::QHash;}
\DoxyCodeLine{43    }
\DoxyCodeLine{45    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{type::CRS<RealType>}};}
\DoxyCodeLine{46    }
\DoxyCodeLine{48    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} = blas::BraketVector<RealType>;}
\DoxyCodeLine{49       }
\DoxyCodeLine{50 \textcolor{keyword}{public}:}
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{52    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{53    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{55 \textcolor{comment}{}   \textcolor{keyword}{const} ModelClass \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}};}
\DoxyCodeLine{56    }
\DoxyCodeLine{58    \mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all}{blas::ParametersAll}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}};}
\DoxyCodeLine{59    }
\DoxyCodeLine{61    \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522}{DiagMethod}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} = \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}};}
\DoxyCodeLine{62 }
\DoxyCodeLine{63    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{64    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{65    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{68 \textcolor{comment}{}   \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a535e85ef2697a25abb2e128542d65c68}{ExactDiag}}(\textcolor{keyword}{const} ModelClass \&model\_input): \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}(model\_input) \{}
\DoxyCodeLine{69       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all_a55cc7b329133683ae92fe75cb26502b3}{lanczos}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_lanczos_a967885f43c2e3aba37d695e225397c0a}{flag\_symmetric\_crs}} = \textcolor{keyword}{true};}
\DoxyCodeLine{70       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all_a52361ce96147b9392c76e5181008c29b}{ii}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_i_i_ae54889fa8be63420b5203905b846f794}{cg}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_c_g_a09bab3575cbf9e8d9895bbb46fe01a7b}{flag\_symmetric\_crs}}   = \textcolor{keyword}{true};}
\DoxyCodeLine{71    \}}
\DoxyCodeLine{72    }
\DoxyCodeLine{76    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0ee709663871546f51f358face6c6c7c}{ExactDiag}}(\textcolor{keyword}{const} ModelClass \&model\_input,}
\DoxyCodeLine{77              \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all}{blas::ParametersAll}} \&params\_input): \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag}{ExactDiag}}(model\_input) \{}
\DoxyCodeLine{78       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}} = params\_input;}
\DoxyCodeLine{79    \}}
\DoxyCodeLine{80     }
\DoxyCodeLine{81    }
\DoxyCodeLine{82    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{83    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{84    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{87 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0e57f30ab281b750b7ebbb24ade22afd}{CalculateGroundState}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_display\_info = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{88       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_affb70f954c79af21f543b0797daba72e}{calculated\_eigenvector\_set\_}}.count(0) != 0) \{}
\DoxyCodeLine{89          \textcolor{keywordflow}{return};}
\DoxyCodeLine{90       \}}
\DoxyCodeLine{91       }
\DoxyCodeLine{92       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef9f604139cf2607458c7e5d14afae5c}{GenerateBasis}}(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetQNumber(), flag\_display\_info);}
\DoxyCodeLine{93       }
\DoxyCodeLine{94       \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} ham;}
\DoxyCodeLine{95       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\&ham);}
\DoxyCodeLine{96       }
\DoxyCodeLine{97       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.size() == 0) \{}
\DoxyCodeLine{98          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.emplace\_back();}
\DoxyCodeLine{99       \}}
\DoxyCodeLine{100       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size() == 0) \{}
\DoxyCodeLine{101          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.emplace\_back();}
\DoxyCodeLine{102       \}}
\DoxyCodeLine{103       }
\DoxyCodeLine{104       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}}) \{}
\DoxyCodeLine{105          \mbox{\hyperlink{namespacecompnal_1_1blas_a41a8fbd0adade2a6702b987c653abf7b}{blas::EigenvalueDecompositionLanczos}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], ham, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all_a55cc7b329133683ae92fe75cb26502b3}{lanczos}});}
\DoxyCodeLine{106       \}}
\DoxyCodeLine{107       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522a779f87f3b11a08240fd9da58d90071fe}{DiagMethod::LOBPCG}}) \{}
\DoxyCodeLine{108          \mbox{\hyperlink{namespacecompnal_1_1blas_a1f728907b3675c8558f09749abf793af}{blas::EigenvalueDecompositionLOBPCG}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], ham, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all_a55cc7b329133683ae92fe75cb26502b3}{lanczos}});}
\DoxyCodeLine{109       \}}
\DoxyCodeLine{110       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{111          std::stringstream ss;}
\DoxyCodeLine{112          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{113          ss << \textcolor{stringliteral}{"{}Invalid diagonalization method detected."{}} << std::endl;}
\DoxyCodeLine{114          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{115       \}}
\DoxyCodeLine{116       }
\DoxyCodeLine{117       \mbox{\hyperlink{namespacecompnal_1_1blas_a145ac10a26aba079daa9fba3af245f89}{blas::InverseIteration}}(\&ham, \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}[0], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}[0], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all_a52361ce96147b9392c76e5181008c29b}{ii}});}
\DoxyCodeLine{118       }
\DoxyCodeLine{119       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_affb70f954c79af21f543b0797daba72e}{calculated\_eigenvector\_set\_}}.emplace(0);}
\DoxyCodeLine{120    \}}
\DoxyCodeLine{121    }
\DoxyCodeLine{122    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a22420e816fb2c86f9e710312e8f346e2}{CalculateTargetState}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_sector) \{}
\DoxyCodeLine{123       \textcolor{keywordflow}{if} (target\_sector < 0) \{}
\DoxyCodeLine{124          std::stringstream ss;}
\DoxyCodeLine{125          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{126          ss << \textcolor{stringliteral}{"{}Invalid target\_sector: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{127          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{128       \}}
\DoxyCodeLine{129       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0e57f30ab281b750b7ebbb24ade22afd}{CalculateGroundState}}();}
\DoxyCodeLine{130       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_sector) != 0) \{}
\DoxyCodeLine{131          \textcolor{keywordflow}{return};}
\DoxyCodeLine{132       \}}
\DoxyCodeLine{133       }
\DoxyCodeLine{134       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis();}
\DoxyCodeLine{135       \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} ham;}
\DoxyCodeLine{136       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\&ham);}
\DoxyCodeLine{137       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522ac766432e40c81daf2b8104603413196b}{DiagMethod::LANCZOS}}) \{}
\DoxyCodeLine{138          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} sector = 1; sector <= target\_sector; ++sector) \{}
\DoxyCodeLine{139             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(sector) == 0) \{}
\DoxyCodeLine{140                \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size()) != sector) \{}
\DoxyCodeLine{141                   std::stringstream ss;}
\DoxyCodeLine{142                   ss << \textcolor{stringliteral}{"{}Unknown Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{143                   ss << \textcolor{stringliteral}{"{}sector: "{}} << sector << \textcolor{stringliteral}{"{}, size: "{}} << \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.size() << std::endl;}
\DoxyCodeLine{144                   \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{145                \}}
\DoxyCodeLine{146                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} temp\_vector(ham.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{147                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_value = 0.0;}
\DoxyCodeLine{148                \mbox{\hyperlink{namespacecompnal_1_1blas_a41a8fbd0adade2a6702b987c653abf7b}{blas::EigenvalueDecompositionLanczos}}(\&temp\_value, \&temp\_vector, ham, sector, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all_a55cc7b329133683ae92fe75cb26502b3}{lanczos}});}
\DoxyCodeLine{149                \mbox{\hyperlink{namespacecompnal_1_1blas_a145ac10a26aba079daa9fba3af245f89}{blas::InverseIteration}}(\&ham, \&temp\_vector, temp\_value, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a994630e33087810daa87da6b66925127}{params}}.\mbox{\hyperlink{structcompnal_1_1blas_1_1_parameters_all_a52361ce96147b9392c76e5181008c29b}{ii}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}});}
\DoxyCodeLine{150                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}.push\_back(temp\_value);}
\DoxyCodeLine{151                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.push\_back(temp\_vector);}
\DoxyCodeLine{152                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.SetCalculatedEigenvectorSet(sector);}
\DoxyCodeLine{153             \}}
\DoxyCodeLine{154          \}}
\DoxyCodeLine{155       \}}
\DoxyCodeLine{156       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7ebf7d0143bbc123c0cb826ece9e2bf9}{diag\_method\_}} == \mbox{\hyperlink{namespacecompnal_1_1solver_aea9ed4356b9eb3f1e01e43d336026522a779f87f3b11a08240fd9da58d90071fe}{DiagMethod::LOBPCG}}) \{}
\DoxyCodeLine{157          std::stringstream ss;}
\DoxyCodeLine{158          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{159          ss << \textcolor{stringliteral}{"{}LOBPCG is under construction: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{160          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{161       \}}
\DoxyCodeLine{162       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{163          std::stringstream ss;}
\DoxyCodeLine{164          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{165          ss << \textcolor{stringliteral}{"{}Invalid diag\_method: "{}} << target\_sector << std::endl;}
\DoxyCodeLine{166          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{167       \}}
\DoxyCodeLine{168       }
\DoxyCodeLine{169    \}}
\DoxyCodeLine{170    }
\DoxyCodeLine{171    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1aafb57ecb9c2dcc044f4a6828cc93e8}{CalculateExpectationValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} level = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{172       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(level) == 0) \{}
\DoxyCodeLine{173          std::stringstream ss;}
\DoxyCodeLine{174          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{175          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{176          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{177       \}}
\DoxyCodeLine{178       }
\DoxyCodeLine{179       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis     = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasis();}
\DoxyCodeLine{180       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{181       }
\DoxyCodeLine{182       \textcolor{keyword}{const} std::int64\_t dim = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(level).val.size();}
\DoxyCodeLine{183       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size()) != dim || \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_inv.size()) != dim) \{}
\DoxyCodeLine{184          std::stringstream ss;}
\DoxyCodeLine{185          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{186          ss << \textcolor{stringliteral}{"{}Unknown error detected"{}} << std::endl;}
\DoxyCodeLine{187          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{188       \}}
\DoxyCodeLine{189       }
\DoxyCodeLine{190       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{191       \textcolor{keyword}{const} std::int64\_t site\_constant = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site));}
\DoxyCodeLine{192       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(level);}
\DoxyCodeLine{193       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{194       }
\DoxyCodeLine{195 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: val)}}
\DoxyCodeLine{196       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{197          \textcolor{keyword}{const} std::int64\_t global\_basis = basis[i];}
\DoxyCodeLine{198          \textcolor{keyword}{const} \textcolor{keywordtype}{int}          local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite);}
\DoxyCodeLine{199          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{200          \textcolor{keywordflow}{for} (std::int64\_t j = m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis]; j < m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{201             \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant;}
\DoxyCodeLine{202             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{203                temp\_val += eigenvector.val[basis\_inv.at(a\_basis)]*m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{204             \}}
\DoxyCodeLine{205          \}}
\DoxyCodeLine{206          val += eigenvector.val[i]*temp\_val;}
\DoxyCodeLine{207       \}}
\DoxyCodeLine{208       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{209    \}}
\DoxyCodeLine{210    }
\DoxyCodeLine{211    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{212       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1aafb57ecb9c2dcc044f4a6828cc93e8}{CalculateExpectationValue}}(m, site, target\_level);}
\DoxyCodeLine{213    \}}
\DoxyCodeLine{214    }
\DoxyCodeLine{215    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a490b6895fcfb239a483be3dd2f10134a}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{216       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{217          std::stringstream ss;}
\DoxyCodeLine{218          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{219          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{220          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{221       \}}
\DoxyCodeLine{222       }
\DoxyCodeLine{223       \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} != m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} || m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} != m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}} || m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} != m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}}) \{}
\DoxyCodeLine{224          std::stringstream ss;}
\DoxyCodeLine{225          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{226          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{227          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{228       \}}
\DoxyCodeLine{229       }
\DoxyCodeLine{230       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} m1\_dagger = \mbox{\hyperlink{namespacecompnal_1_1type_a59fb41af50a085e7de7640b31b6fd240}{blas::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{231       }
\DoxyCodeLine{232       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors  = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateTargetSector(m1\_dagger, m\_2);}
\DoxyCodeLine{233       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{234       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{235       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{236       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{237       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{238       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_m1;}
\DoxyCodeLine{239       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_m2;}
\DoxyCodeLine{240       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{241       }
\DoxyCodeLine{242       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&sector: target\_sectors) \{}
\DoxyCodeLine{243          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector);}
\DoxyCodeLine{244          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector);}
\DoxyCodeLine{245          \textcolor{keyword}{const} std::int64\_t dim\_target = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis.size());}
\DoxyCodeLine{246          vector\_work\_m1.val.resize(dim\_target);}
\DoxyCodeLine{247          vector\_work\_m2.val.resize(dim\_target);}
\DoxyCodeLine{248 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{249          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target; ++i) \{}
\DoxyCodeLine{250             \textcolor{keyword}{const} std::int64\_t global\_basis = basis[i];}
\DoxyCodeLine{251             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{252             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{253             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m1 = 0.0;}
\DoxyCodeLine{254             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m2 = 0.0;}
\DoxyCodeLine{255             }
\DoxyCodeLine{256             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{257             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{258                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{259                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{260                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{261                \}}
\DoxyCodeLine{262                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{263                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{264                \}}
\DoxyCodeLine{265             \}}
\DoxyCodeLine{266             }
\DoxyCodeLine{267             \textcolor{keywordflow}{for} (std::int64\_t j = m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m1]; j < m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m1 + 1]; ++j)\{}
\DoxyCodeLine{268                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m1 -\/ m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{269                \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{270                   temp\_val\_m1 += eigenvector.val[basis\_inv.at(a\_basis)]*m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{271                \}}
\DoxyCodeLine{272             \}}
\DoxyCodeLine{273             vector\_work\_m1.val[i] = temp\_val\_m1*fermion\_sign\_m1;}
\DoxyCodeLine{274             }
\DoxyCodeLine{275             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{276             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{277                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{278                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_2; site++) \{}
\DoxyCodeLine{279                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{280                \}}
\DoxyCodeLine{281                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{282                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{283                \}}
\DoxyCodeLine{284             \}}
\DoxyCodeLine{285             }
\DoxyCodeLine{286             \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m2]; j < m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{287                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{288                \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{289                   temp\_val\_m2 += eigenvector.val[basis\_inv.at(a\_basis)]*m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{290                \}}
\DoxyCodeLine{291             \}}
\DoxyCodeLine{292             vector\_work\_m2.val[i] = temp\_val\_m2*fermion\_sign\_m2;}
\DoxyCodeLine{293          \}}
\DoxyCodeLine{294          val += blas::CalculateInnerProduct(vector\_work\_m1, vector\_work\_m2);}
\DoxyCodeLine{295       \}}
\DoxyCodeLine{296       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{297    \}}
\DoxyCodeLine{298    }
\DoxyCodeLine{299    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ae5779b9d1389557e8dcf81b91e978507}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{300                                          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{301                                          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_3, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_3,}
\DoxyCodeLine{302                                          \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{303       }
\DoxyCodeLine{304       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{305          std::stringstream ss;}
\DoxyCodeLine{306          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{307          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{308          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{309       \}}
\DoxyCodeLine{310       }
\DoxyCodeLine{311       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}});}
\DoxyCodeLine{312       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}});}
\DoxyCodeLine{313       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}});}
\DoxyCodeLine{314       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c4 = (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} \&\& m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{315       }
\DoxyCodeLine{316       \textcolor{keywordflow}{if} (!(c1 \&\& c2 \&\& c3 \&\& c4)) \{}
\DoxyCodeLine{317          std::stringstream ss;}
\DoxyCodeLine{318          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{319          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{320          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{321       \}}
\DoxyCodeLine{322       }
\DoxyCodeLine{323       \textcolor{keywordflow}{if} (site\_1 == site\_2) \{}
\DoxyCodeLine{324          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1*m\_2, site\_1, m\_3, site\_3, target\_level);}
\DoxyCodeLine{325       \}}
\DoxyCodeLine{326       \textcolor{keywordflow}{if} (site\_2 == site\_3) \{}
\DoxyCodeLine{327          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2*m\_3, site\_3, target\_level);}
\DoxyCodeLine{328       \}}
\DoxyCodeLine{329       }
\DoxyCodeLine{330       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}}  m1\_dagger      = \mbox{\hyperlink{namespacecompnal_1_1type_a59fb41af50a085e7de7640b31b6fd240}{blas::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{331       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateTargetSector(m1\_dagger, m\_2, m\_3);}
\DoxyCodeLine{332       }
\DoxyCodeLine{333       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_gs\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{334       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{335       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{336       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{337       \textcolor{keyword}{const} std::int64\_t site\_constant\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_3));}
\DoxyCodeLine{338       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{339       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_a;}
\DoxyCodeLine{340       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_b;}
\DoxyCodeLine{341       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_c;}
\DoxyCodeLine{342       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{343       }
\DoxyCodeLine{344       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: target\_sectors) \{}
\DoxyCodeLine{345          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_m1 = std::get<0>(it);}
\DoxyCodeLine{346          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_m3 = std::get<1>(it);}
\DoxyCodeLine{347          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_m1);}
\DoxyCodeLine{348          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_m3);}
\DoxyCodeLine{349          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_m1);}
\DoxyCodeLine{350          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m3 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_m3);}
\DoxyCodeLine{351          \textcolor{keyword}{const} std::int64\_t dim\_target\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_m1.size());}
\DoxyCodeLine{352          \textcolor{keyword}{const} std::int64\_t dim\_target\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_m3.size());}
\DoxyCodeLine{353          }
\DoxyCodeLine{354          \textcolor{comment}{//m3|gs>}}
\DoxyCodeLine{355          vector\_work\_a.val.resize(dim\_target\_m3);}
\DoxyCodeLine{356 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{357          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_m3; ++i) \{}
\DoxyCodeLine{358             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_m3[i];}
\DoxyCodeLine{359             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_3, dim\_onsite);}
\DoxyCodeLine{360             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{361             }
\DoxyCodeLine{362             \textcolor{keywordtype}{int} fermion\_sign\_m3 = 1;}
\DoxyCodeLine{363             \textcolor{keywordflow}{if} (m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{364                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{365                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{366                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{367                \}}
\DoxyCodeLine{368                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{369                   fermion\_sign\_m3 = -\/1;}
\DoxyCodeLine{370                \}}
\DoxyCodeLine{371             \}}
\DoxyCodeLine{372             }
\DoxyCodeLine{373             \textcolor{keywordflow}{for} (std::int64\_t j = m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis]; j < m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{374                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m3;}
\DoxyCodeLine{375                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{376                   temp\_val += eigenvector.val[basis\_gs\_sector\_inv.at(a\_basis)]*m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{377                \}}
\DoxyCodeLine{378             \}}
\DoxyCodeLine{379             vector\_work\_a.val[i] = temp\_val*fermion\_sign\_m3;}
\DoxyCodeLine{380          \}}
\DoxyCodeLine{381          }
\DoxyCodeLine{382          \textcolor{comment}{//m2 * m3|gs> and m1\_dag|gs>}}
\DoxyCodeLine{383          vector\_work\_b.val.resize(dim\_target\_m1);}
\DoxyCodeLine{384          vector\_work\_c.val.resize(dim\_target\_m1);}
\DoxyCodeLine{385          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_m3\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasisInv(sector\_m3);}
\DoxyCodeLine{386 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{387          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_m1; ++i) \{}
\DoxyCodeLine{388             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_m1[i];}
\DoxyCodeLine{389             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{390             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{391             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m1 = 0.0;}
\DoxyCodeLine{392             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val\_m2 = 0.0;}
\DoxyCodeLine{393             }
\DoxyCodeLine{394             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{395             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{396                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{397                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{398                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{399                \}}
\DoxyCodeLine{400                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{401                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{402                \}}
\DoxyCodeLine{403             \}}
\DoxyCodeLine{404             }
\DoxyCodeLine{405             \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m2]; j < m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{406                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{407                \textcolor{keywordflow}{if} (basis\_m3\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{408                   temp\_val\_m2 += vector\_work\_a.val[basis\_m3\_sector\_inv.at(a\_basis)]*m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{409                \}}
\DoxyCodeLine{410             \}}
\DoxyCodeLine{411             vector\_work\_b.val[i] = temp\_val\_m2*fermion\_sign\_m2;}
\DoxyCodeLine{412             }
\DoxyCodeLine{413             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{414             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{415                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{416                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{417                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{418                \}}
\DoxyCodeLine{419                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{420                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{421                \}}
\DoxyCodeLine{422             \}}
\DoxyCodeLine{423             }
\DoxyCodeLine{424             \textcolor{keywordflow}{for} (std::int64\_t j = m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m1]; j < m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m1 + 1]; ++j)\{}
\DoxyCodeLine{425                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m1 -\/ m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{426                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{427                   temp\_val\_m1 += eigenvector.val[basis\_gs\_sector\_inv.at(a\_basis)]*m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{428                \}}
\DoxyCodeLine{429             \}}
\DoxyCodeLine{430             vector\_work\_c.val[i] = temp\_val\_m1*fermion\_sign\_m1;}
\DoxyCodeLine{431          \}}
\DoxyCodeLine{432          val += blas::CalculateInnerProduct(vector\_work\_b, vector\_work\_c);}
\DoxyCodeLine{433       \}}
\DoxyCodeLine{434       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{435    \}}
\DoxyCodeLine{436    }
\DoxyCodeLine{437    \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a7c3c205f875f049444abaa9f17d2faeb}{CalculateCorrelationFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{438                                          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{439                                          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_3, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_3,}
\DoxyCodeLine{440                                          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_4, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_4,}
\DoxyCodeLine{441                                          \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0) \{}
\DoxyCodeLine{442       }
\DoxyCodeLine{443       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetCalculatedEigenvectorSet().count(target\_level) == 0) \{}
\DoxyCodeLine{444          std::stringstream ss;}
\DoxyCodeLine{445          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{446          ss << \textcolor{stringliteral}{"{}An eigenvector of the energy level: "{}} << target\_level << \textcolor{stringliteral}{"{} has not been calculated"{}} << std::endl;}
\DoxyCodeLine{447          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{448       \}}
\DoxyCodeLine{449       }
\DoxyCodeLine{450       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}});}
\DoxyCodeLine{451       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}});}
\DoxyCodeLine{452       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}});}
\DoxyCodeLine{453       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c4 = (m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}});}
\DoxyCodeLine{454       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c5 = (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} \&\& m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} \&\& m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} == m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{455       }
\DoxyCodeLine{456       \textcolor{keywordflow}{if} (!(c1 \&\& c2 \&\& c3 \&\& c4 \&\& c5)) \{}
\DoxyCodeLine{457          std::stringstream ss;}
\DoxyCodeLine{458          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{459          ss << \textcolor{stringliteral}{"{}Invalid input of the local operators"{}} << std::endl;}
\DoxyCodeLine{460          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{461       \}}
\DoxyCodeLine{462       }
\DoxyCodeLine{463       \textcolor{keywordflow}{if} (site\_1 == site\_2) \{}
\DoxyCodeLine{464          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1*m\_2, site\_1, m\_3, site\_3, m\_4, site\_4);}
\DoxyCodeLine{465       \}}
\DoxyCodeLine{466       \textcolor{keywordflow}{if} (site\_2 == site\_3) \{}
\DoxyCodeLine{467          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2*m\_3, site\_2, m\_4, site\_4);}
\DoxyCodeLine{468       \}}
\DoxyCodeLine{469       \textcolor{keywordflow}{if} (site\_3 == site\_4) \{}
\DoxyCodeLine{470          \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acd281c111110b09eeeea7a456f5220b5}{CalculateCorrelationFunction}}(m\_1, site\_1, m\_2, site\_2, m\_3*m\_4, site\_3);}
\DoxyCodeLine{471       \}}
\DoxyCodeLine{472       }
\DoxyCodeLine{473       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}}  m1\_dagger = \mbox{\hyperlink{namespacecompnal_1_1type_a59fb41af50a085e7de7640b31b6fd240}{blas::CalculateTransposedMatrix}}(m\_1);}
\DoxyCodeLine{474       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}}  m2\_dagger = \mbox{\hyperlink{namespacecompnal_1_1type_a59fb41af50a085e7de7640b31b6fd240}{blas::CalculateTransposedMatrix}}(m\_2);}
\DoxyCodeLine{475       \textcolor{keyword}{const} \textcolor{keyword}{auto} target\_sectors = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateTargetSector(m1\_dagger, m2\_dagger, m\_3, m\_4);}
\DoxyCodeLine{476       }
\DoxyCodeLine{477       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_gs\_sector\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{478       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{479       \textcolor{keyword}{const} std::int64\_t site\_constant\_m1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_1));}
\DoxyCodeLine{480       \textcolor{keyword}{const} std::int64\_t site\_constant\_m2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_2));}
\DoxyCodeLine{481       \textcolor{keyword}{const} std::int64\_t site\_constant\_m3 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_3));}
\DoxyCodeLine{482       \textcolor{keyword}{const} std::int64\_t site\_constant\_m4 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(dim\_onsite, site\_4));}
\DoxyCodeLine{483       \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} \&eigenvector = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}.at(target\_level);}
\DoxyCodeLine{484       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_m1;}
\DoxyCodeLine{485       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_m2m1;}
\DoxyCodeLine{486       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_m4;}
\DoxyCodeLine{487       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab57d9fc86716f8ad693128211d32a698}{BraketVector}} vector\_work\_m3m4;}
\DoxyCodeLine{488       \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} val = 0.0;}
\DoxyCodeLine{489       }
\DoxyCodeLine{490       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: target\_sectors) \{}
\DoxyCodeLine{491          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_bra\_change\_1 = std::get<0>(it);}
\DoxyCodeLine{492          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_bra\_change\_2 = std::get<1>(it);}
\DoxyCodeLine{493          \textcolor{keyword}{const} \textcolor{keyword}{auto} sector\_ket\_change\_1 = std::get<2>(it);}
\DoxyCodeLine{494          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_bra\_change\_1);}
\DoxyCodeLine{495          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_bra\_change\_2);}
\DoxyCodeLine{496          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(sector\_ket\_change\_1);}
\DoxyCodeLine{497          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_bra\_change\_1);}
\DoxyCodeLine{498          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_bra\_change\_2);}
\DoxyCodeLine{499          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_ket\_1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasis(sector\_ket\_change\_1);}
\DoxyCodeLine{500          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_ket\_1\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasisInv(sector\_ket\_change\_1);}
\DoxyCodeLine{501          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_bra\_1\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetBasisInv(sector\_bra\_change\_1);}
\DoxyCodeLine{502          \textcolor{keyword}{const} std::int64\_t dim\_target\_bra\_1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_bra\_1.size());}
\DoxyCodeLine{503          \textcolor{keyword}{const} std::int64\_t dim\_target\_bra\_2 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_bra\_2.size());}
\DoxyCodeLine{504          \textcolor{keyword}{const} std::int64\_t dim\_target\_ket\_1 = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(basis\_ket\_1.size());}
\DoxyCodeLine{505          }
\DoxyCodeLine{506          \textcolor{comment}{//m4|gs>}}
\DoxyCodeLine{507          vector\_work\_m4.val.resize(dim\_target\_ket\_1);}
\DoxyCodeLine{508 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{509          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_ket\_1; ++i) \{}
\DoxyCodeLine{510             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_ket\_1[i];}
\DoxyCodeLine{511             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_4, dim\_onsite);}
\DoxyCodeLine{512             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{513             }
\DoxyCodeLine{514             \textcolor{keywordtype}{int} fermion\_sign\_m4 = 1;}
\DoxyCodeLine{515             \textcolor{keywordflow}{if} (m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{516                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{517                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{518                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{519                \}}
\DoxyCodeLine{520                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{521                   fermion\_sign\_m4 = -\/1;}
\DoxyCodeLine{522                \}}
\DoxyCodeLine{523             \}}
\DoxyCodeLine{524             }
\DoxyCodeLine{525             \textcolor{keywordflow}{for} (std::int64\_t j = m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis]; j < m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{526                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m4;}
\DoxyCodeLine{527                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{528                   temp\_val += eigenvector.val[basis\_gs\_sector\_inv.at(a\_basis)]*m\_4.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{529                \}}
\DoxyCodeLine{530             \}}
\DoxyCodeLine{531             vector\_work\_m4.val[i] = temp\_val*fermion\_sign\_m4;}
\DoxyCodeLine{532          \}}
\DoxyCodeLine{533          }
\DoxyCodeLine{534          \textcolor{comment}{//m1\_dag|gs>}}
\DoxyCodeLine{535          vector\_work\_m1.val.resize(dim\_target\_bra\_1);}
\DoxyCodeLine{536 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{537          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_bra\_1; ++i) \{}
\DoxyCodeLine{538             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_bra\_1[i];}
\DoxyCodeLine{539             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_1, dim\_onsite);}
\DoxyCodeLine{540             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{541             }
\DoxyCodeLine{542             \textcolor{keywordtype}{int} fermion\_sign\_m1 = 1;}
\DoxyCodeLine{543             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{544                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{545                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{546                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{547                \}}
\DoxyCodeLine{548                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{549                   fermion\_sign\_m1 = -\/1;}
\DoxyCodeLine{550                \}}
\DoxyCodeLine{551             \}}
\DoxyCodeLine{552             }
\DoxyCodeLine{553             \textcolor{keywordflow}{for} (std::int64\_t j = m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis]; j < m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis + 1]; ++j)\{}
\DoxyCodeLine{554                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis -\/ m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m1;}
\DoxyCodeLine{555                \textcolor{keywordflow}{if} (basis\_gs\_sector\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{556                   temp\_val += eigenvector.val[basis\_gs\_sector\_inv.at(a\_basis)]*m1\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{557                \}}
\DoxyCodeLine{558             \}}
\DoxyCodeLine{559             vector\_work\_m1.val[i] = temp\_val*fermion\_sign\_m1;}
\DoxyCodeLine{560          \}}
\DoxyCodeLine{561          }
\DoxyCodeLine{562          \textcolor{comment}{//m3 * m4|gs> and m2\_dag * m1\_dag|gs>}}
\DoxyCodeLine{563          vector\_work\_m3m4.val.resize(dim\_target\_bra\_2);}
\DoxyCodeLine{564          vector\_work\_m2m1.val.resize(dim\_target\_bra\_2);}
\DoxyCodeLine{565          }
\DoxyCodeLine{566 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{567          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target\_bra\_2; ++i) \{}
\DoxyCodeLine{568             \textcolor{keyword}{const} std::int64\_t global\_basis = basis\_bra\_2[i];}
\DoxyCodeLine{569             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_2, dim\_onsite);}
\DoxyCodeLine{570             \textcolor{keyword}{const} \textcolor{keywordtype}{int} local\_basis\_m3 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site\_3, dim\_onsite);}
\DoxyCodeLine{571             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} temp\_val = 0.0;}
\DoxyCodeLine{572             }
\DoxyCodeLine{573             \textcolor{keywordtype}{int} fermion\_sign\_m3 = 1;}
\DoxyCodeLine{574             \textcolor{keywordflow}{if} (m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{575                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{576                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{577                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{578                \}}
\DoxyCodeLine{579                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{580                   fermion\_sign\_m3 = -\/1;}
\DoxyCodeLine{581                \}}
\DoxyCodeLine{582             \}}
\DoxyCodeLine{583             }
\DoxyCodeLine{584             \textcolor{keywordflow}{for} (std::int64\_t j = m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m3]; j < m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m3 + 1]; ++j)\{}
\DoxyCodeLine{585                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m3 -\/ m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m3;}
\DoxyCodeLine{586                \textcolor{keywordflow}{if} (basis\_ket\_1\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{587                   temp\_val += vector\_work\_m4.val[basis\_ket\_1\_inv.at(a\_basis)]*m\_3.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{588                \}}
\DoxyCodeLine{589             \}}
\DoxyCodeLine{590             vector\_work\_m3m4.val[i] = temp\_val*fermion\_sign\_m3;}
\DoxyCodeLine{591             }
\DoxyCodeLine{592             temp\_val = 0.0;}
\DoxyCodeLine{593             }
\DoxyCodeLine{594             \textcolor{keywordtype}{int} fermion\_sign\_m2 = 1;}
\DoxyCodeLine{595             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{type::CRSTag::FERMION}}) \{}
\DoxyCodeLine{596                \textcolor{keywordtype}{int} num\_electron = 0;}
\DoxyCodeLine{597                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < site\_1; site++) \{}
\DoxyCodeLine{598                   num\_electron += \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateNumElectron(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(global\_basis, site, dim\_onsite));}
\DoxyCodeLine{599                \}}
\DoxyCodeLine{600                \textcolor{keywordflow}{if} (num\_electron\%2 == 1) \{}
\DoxyCodeLine{601                   fermion\_sign\_m2 = -\/1;}
\DoxyCodeLine{602                \}}
\DoxyCodeLine{603             \}}
\DoxyCodeLine{604             }
\DoxyCodeLine{605             \textcolor{keywordflow}{for} (std::int64\_t j = m2\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m2]; j < m2\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[local\_basis\_m2 + 1]; ++j)\{}
\DoxyCodeLine{606                \textcolor{keyword}{const} std::int64\_t a\_basis = global\_basis -\/ (local\_basis\_m2 -\/ m2\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j])*site\_constant\_m2;}
\DoxyCodeLine{607                \textcolor{keywordflow}{if} (basis\_bra\_1\_inv.count(a\_basis) != 0) \{}
\DoxyCodeLine{608                   temp\_val += vector\_work\_m1.val[basis\_bra\_1\_inv.at(a\_basis)]*m2\_dagger.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j];}
\DoxyCodeLine{609                \}}
\DoxyCodeLine{610             \}}
\DoxyCodeLine{611             vector\_work\_m2m1.val[i] = temp\_val*fermion\_sign\_m2;}
\DoxyCodeLine{612          \}}
\DoxyCodeLine{613          val += blas::CalculateInnerProduct(vector\_work\_m2m1, vector\_work\_m3m4);}
\DoxyCodeLine{614       \}}
\DoxyCodeLine{615       \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{616    \}}
\DoxyCodeLine{617    }
\DoxyCodeLine{618    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<BraketVector> \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a3998505c06a97dc70312e94409ac1770}{GetEigenvectors}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}}; \}}
\DoxyCodeLine{619    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<RealType>     \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_acaaec962f1fe4e3fcddc0b1e2ecebfc6}{GetEigenvalues}}()\textcolor{keyword}{  const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}}; \}}
\DoxyCodeLine{620    }
\DoxyCodeLine{621 \textcolor{keyword}{private}:}
\DoxyCodeLine{622    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{623    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{624    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{625    std::vector<BraketVector> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a9792ea70dd7ac9a0ac1b964c60cbba57}{eigenvectors\_}};}
\DoxyCodeLine{626    std::vector<RealType>     \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a08b1c95d031f0b29727039f031480c1d}{eigenvalues\_}};}
\DoxyCodeLine{627    }
\DoxyCodeLine{630    std::unordered\_map<QType, std::vector<std::int64\_t>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}};}
\DoxyCodeLine{631    }
\DoxyCodeLine{634    std::unordered\_map<QType, std::unordered\_map<std::int64\_t, std::int64\_t>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a6a65dea6a239083cf479222a02f546c5}{bases\_inv\_}};}
\DoxyCodeLine{635    }
\DoxyCodeLine{637    std::unordered\_set<int> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_affb70f954c79af21f543b0797daba72e}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{638    }
\DoxyCodeLine{639    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{640    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Private Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{641    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{642    std::unordered\_set<QType> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_1) \{}
\DoxyCodeLine{643       std::unordered\_set<QType> target\_q\_set;}
\DoxyCodeLine{644       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{645          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i]; j < m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{646             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j] != 0.0) \{}
\DoxyCodeLine{647                target\_q\_set.emplace(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.CalculateQNumber(i, m\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j]));}
\DoxyCodeLine{648             \}}
\DoxyCodeLine{649          \}}
\DoxyCodeLine{650       \}}
\DoxyCodeLine{651       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{652    \}}
\DoxyCodeLine{653    }
\DoxyCodeLine{658    std::vector<QType> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a5cc7ea84e576863cd2ab55ef61e75e30}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_2)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{659       std::unordered\_set<QType, QHash> q\_set\_m1 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_1);}
\DoxyCodeLine{660       std::unordered\_set<QType, QHash> q\_set\_m2 = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_2);}
\DoxyCodeLine{661       }
\DoxyCodeLine{662       std::vector<QType> target\_q\_set;}
\DoxyCodeLine{663       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q\_m1: q\_set\_m1) \{}
\DoxyCodeLine{664          \textcolor{keywordflow}{if} (q\_set\_m2.count(q\_m1) > 0 \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q\_m1)) \{}
\DoxyCodeLine{665             target\_q\_set.push\_back(q\_m1);}
\DoxyCodeLine{666          \}}
\DoxyCodeLine{667       \}}
\DoxyCodeLine{668    }
\DoxyCodeLine{669       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{670    \}}
\DoxyCodeLine{671    }
\DoxyCodeLine{677    std::vector<std::vector<QType>> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ac1fd4a4602fcf9af48101c8d8ac46d47}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_2\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_3\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{678       std::unordered\_set<QType, QHash> q\_set\_m1\_bra = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_1\_bra);}
\DoxyCodeLine{679       std::unordered\_set<QType, QHash> q\_set\_m2\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_2\_ket);}
\DoxyCodeLine{680       std::unordered\_set<QType, QHash> q\_set\_m3\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_3\_ket);}
\DoxyCodeLine{681       }
\DoxyCodeLine{682       std::unordered\_map<QType, std::vector<QType>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> q\_list\_m2\_m3\_ket;}
\DoxyCodeLine{683       }
\DoxyCodeLine{684       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q2: q\_set\_m2\_ket) \{}
\DoxyCodeLine{685          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q3: q\_set\_m3\_ket) \{}
\DoxyCodeLine{686             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q2 + q3) \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q3)) \{}
\DoxyCodeLine{687                q\_list\_m2\_m3\_ket[q2 + q3].push\_back(q3);}
\DoxyCodeLine{688             \}}
\DoxyCodeLine{689          \}}
\DoxyCodeLine{690       \}}
\DoxyCodeLine{691       }
\DoxyCodeLine{692       std::vector<std::vector<QType>> target\_q\_set;}
\DoxyCodeLine{693       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q1: q\_set\_m1\_bra) \{}
\DoxyCodeLine{694          \textcolor{keywordflow}{if} (q\_list\_m2\_m3\_ket.count(q1) > 0) \{}
\DoxyCodeLine{695             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q3: q\_list\_m2\_m3\_ket.at(q1)) \{}
\DoxyCodeLine{696                target\_q\_set.push\_back(\{q1, q3\});}
\DoxyCodeLine{697             \}}
\DoxyCodeLine{698          \}}
\DoxyCodeLine{699       \}}
\DoxyCodeLine{700       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{701    \}}
\DoxyCodeLine{702    }
\DoxyCodeLine{709    std::vector<std::vector<QType>> \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a6c393215396e23e56985ad8ca6b5b551}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_1\_bra,}
\DoxyCodeLine{710                                                         \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_2\_bra,}
\DoxyCodeLine{711                                                         \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_3\_ket,}
\DoxyCodeLine{712                                                         \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&m\_4\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{713       std::unordered\_set<QType, QHash> q\_set\_m1\_bra = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_1\_bra);}
\DoxyCodeLine{714       std::unordered\_set<QType, QHash> q\_set\_m2\_bra = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_2\_bra);}
\DoxyCodeLine{715       std::unordered\_set<QType, QHash> q\_set\_m3\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_3\_ket);}
\DoxyCodeLine{716       std::unordered\_set<QType, QHash> q\_set\_m4\_ket = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a4255610b274890174bf7a295e507b4}{GenerateTargetSector}}(m\_4\_ket);}
\DoxyCodeLine{717 }
\DoxyCodeLine{718       std::unordered\_map<QType, std::vector<QType>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> q\_list\_m1\_m2\_bra;}
\DoxyCodeLine{719       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q1: q\_set\_m1\_bra) \{}
\DoxyCodeLine{720          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q2: q\_set\_m2\_bra) \{}
\DoxyCodeLine{721             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumbe(q1 + q2) \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q1)) \{}
\DoxyCodeLine{722                q\_list\_m1\_m2\_bra[q1 + q2].push\_back(q1);}
\DoxyCodeLine{723             \}}
\DoxyCodeLine{724          \}}
\DoxyCodeLine{725       \}}
\DoxyCodeLine{726       }
\DoxyCodeLine{727       std::unordered\_map<QType, std::vector<QType>, \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a8b50861a822124ea37cf63af26235f98}{QHash}}> q\_list\_m3\_m4\_ket;}
\DoxyCodeLine{728       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q3: q\_set\_m3\_ket) \{}
\DoxyCodeLine{729          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&q4: q\_set\_m4\_ket) \{}
\DoxyCodeLine{730             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumbe(q3 + q4) \&\& \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.isValidQNumber(q4)) \{}
\DoxyCodeLine{731                q\_list\_m3\_m4\_ket[q3 + q4].push\_back(q4);}
\DoxyCodeLine{732             \}}
\DoxyCodeLine{733          \}}
\DoxyCodeLine{734       \}}
\DoxyCodeLine{735       }
\DoxyCodeLine{736       std::vector<std::vector<QType>> target\_q\_set;}
\DoxyCodeLine{737       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} it\_q1\_q2: q\_list\_m1\_m2\_bra) \{}
\DoxyCodeLine{738          \textcolor{keywordflow}{if} (q\_list\_m3\_m4\_ket.count(it\_q1\_q2.first) > 0) \{}
\DoxyCodeLine{739             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} q4: q\_list\_m3\_m4\_ket.at(it\_q1\_q2.first)) \{}
\DoxyCodeLine{740                target\_q\_set.push\_back(\{it\_q1\_q2.second, it\_q1\_q2.first, q4\});}
\DoxyCodeLine{741             \}}
\DoxyCodeLine{742          \}}
\DoxyCodeLine{743       \}}
\DoxyCodeLine{744       \textcolor{keywordflow}{return} target\_q\_set;}
\DoxyCodeLine{745    \}}
\DoxyCodeLine{746    }
\DoxyCodeLine{747    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(std::int64\_t global\_basis, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site, \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{748       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < site; ++i) \{}
\DoxyCodeLine{749          global\_basis = global\_basis/dim\_onsite;}
\DoxyCodeLine{750       \}}
\DoxyCodeLine{751       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(global\_basis\%dim\_onsite);}
\DoxyCodeLine{752    \}}
\DoxyCodeLine{753    }
\DoxyCodeLine{754    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef9f604139cf2607458c7e5d14afae5c}{GenerateBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aef6fb4a525be81943447384b6170f3ef}{QType}} \&q\_number, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_display\_info = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{755       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}}.count(q\_number) == 0) \{}
\DoxyCodeLine{756          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}}[q\_number] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GenerateBasis(q\_number, flag\_display\_info);}
\DoxyCodeLine{757          \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af7bfc33699d996c081d223b38edbdca2}{bases\_}}.at(q\_number);}
\DoxyCodeLine{758          \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a6a65dea6a239083cf479222a02f546c5}{bases\_inv\_}}[q\_number];}
\DoxyCodeLine{759          basis\_inv.clear();}
\DoxyCodeLine{760          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < basis.size(); ++i) \{}
\DoxyCodeLine{761             basis\_inv[basis[i]] = i;}
\DoxyCodeLine{762          \}}
\DoxyCodeLine{763       \}}
\DoxyCodeLine{764    \}}
\DoxyCodeLine{765    }
\DoxyCodeLine{766    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{767                                        \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{768                                        \textcolor{keyword}{const} \textcolor{keywordtype}{int} site,}
\DoxyCodeLine{769                                        \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&matrix\_onsite,}
\DoxyCodeLine{770                                        \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} coeef)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{771       }
\DoxyCodeLine{772       \textcolor{keywordflow}{if} (std::abs(coeef) <= edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a4c81b233063eedecf43f9a44c78ee01e}{zero\_precision}}) \{}
\DoxyCodeLine{773          \textcolor{keywordflow}{return};}
\DoxyCodeLine{774       \}}
\DoxyCodeLine{775       }
\DoxyCodeLine{776       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site];}
\DoxyCodeLine{777       \textcolor{keyword}{const} std::int64\_t site\_constant = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}[site];}
\DoxyCodeLine{778       }
\DoxyCodeLine{779       \textcolor{keywordflow}{for} (std::int64\_t i = matrix\_onsite.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[basis\_onsite]; i < matrix\_onsite.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[basis\_onsite + 1]; ++i) \{}
\DoxyCodeLine{780          \textcolor{keyword}{const} std::int64\_t a\_basis = basis + (matrix\_onsite.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[i] -\/ basis\_onsite)*site\_constant;}
\DoxyCodeLine{781          \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(a\_basis) == 0) \{}
\DoxyCodeLine{782             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[a\_basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{783             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(coeef*matrix\_onsite.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i]);}
\DoxyCodeLine{784             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(a\_basis);}
\DoxyCodeLine{785          \}}
\DoxyCodeLine{786          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{787             edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}[edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.at(a\_basis)] += coeef*matrix\_onsite.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i];}
\DoxyCodeLine{788          \}}
\DoxyCodeLine{789       \}}
\DoxyCodeLine{790    \}}
\DoxyCodeLine{791    }
\DoxyCodeLine{792    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{793                                           \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{794                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1,}
\DoxyCodeLine{795                                           \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&matrix\_onsite\_1,}
\DoxyCodeLine{796                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2,}
\DoxyCodeLine{797                                           \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&matrix\_onsite\_2,}
\DoxyCodeLine{798                                           \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}} coeef,}
\DoxyCodeLine{799                                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} fermion\_sign = 1.0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{800       }
\DoxyCodeLine{801       \textcolor{keywordflow}{if} (std::abs(coeef) <= edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a4c81b233063eedecf43f9a44c78ee01e}{zero\_precision}}) \{}
\DoxyCodeLine{802          \textcolor{keywordflow}{return};}
\DoxyCodeLine{803       \}}
\DoxyCodeLine{804       }
\DoxyCodeLine{805       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite\_1  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site\_1];}
\DoxyCodeLine{806       \textcolor{keyword}{const} \textcolor{keywordtype}{int}          basis\_onsite\_2  = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site\_2];}
\DoxyCodeLine{807       \textcolor{keyword}{const} std::int64\_t site\_constant\_1 = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}[site\_1];}
\DoxyCodeLine{808       \textcolor{keyword}{const} std::int64\_t site\_constant\_2 = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}[site\_2];}
\DoxyCodeLine{809       }
\DoxyCodeLine{810       \textcolor{keywordflow}{for} (std::int64\_t i1 = matrix\_onsite\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[basis\_onsite\_1]; i1 < matrix\_onsite\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[basis\_onsite\_1 + 1]; ++i1) \{}
\DoxyCodeLine{811          \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val\_1 = matrix\_onsite\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i1];}
\DoxyCodeLine{812          \textcolor{keyword}{const} std::int64\_t col\_1 = matrix\_onsite\_1.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[i1];}
\DoxyCodeLine{813          \textcolor{keywordflow}{for} (std::int64\_t i2 = matrix\_onsite\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[basis\_onsite\_2]; i2 < matrix\_onsite\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[basis\_onsite\_2 + 1]; ++i2) \{}
\DoxyCodeLine{814             \textcolor{keyword}{const} std::int64\_t a\_basis = basis + (col\_1 -\/ basis\_onsite\_1)*site\_constant\_1 + (matrix\_onsite\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[i2] -\/ basis\_onsite\_2)*site\_constant\_2;}
\DoxyCodeLine{815             \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(a\_basis) == 0) \{}
\DoxyCodeLine{816                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[a\_basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{817                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(fermion\_sign*coeef*val\_1*matrix\_onsite\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i2]);}
\DoxyCodeLine{818                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(a\_basis);}
\DoxyCodeLine{819             \}}
\DoxyCodeLine{820             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{821                edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}[edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.at(a\_basis)] += fermion\_sign*coeef*val\_1*matrix\_onsite\_2.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i2];}
\DoxyCodeLine{822             \}}
\DoxyCodeLine{823          \}}
\DoxyCodeLine{824       \}}
\DoxyCodeLine{825    \}}
\DoxyCodeLine{826    }
\DoxyCodeLine{827    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_afc68d703f3882d48e3c09445db2994c2}{GenerateHamiltonian}}(\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} *ham)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{828       \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{829       std::cout << \textcolor{stringliteral}{"{}Generating Hamiltonian..."{}} << std::flush;}
\DoxyCodeLine{830       }
\DoxyCodeLine{831       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis     = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasis();}
\DoxyCodeLine{832       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&basis\_inv = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetTargetBasisInv();}
\DoxyCodeLine{833       }
\DoxyCodeLine{834       \textcolor{keyword}{const} std::int64\_t dim\_target = basis.size();}
\DoxyCodeLine{835       std::int64\_t num\_total\_elements = 0;}
\DoxyCodeLine{836       }
\DoxyCodeLine{837 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{838       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{839       std::vector<ExactDiagMatrixComponents<RealType>> components(num\_threads);}
\DoxyCodeLine{840       }
\DoxyCodeLine{841       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} thread\_num = 0; thread\_num < num\_threads; ++thread\_num) \{}
\DoxyCodeLine{842          components[thread\_num].site\_constant.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{843          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize(); ++site) \{}
\DoxyCodeLine{844             components[thread\_num].site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetDimOnsite(), site));}
\DoxyCodeLine{845          \}}
\DoxyCodeLine{846          components[thread\_num].basis\_onsite.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{847       \}}
\DoxyCodeLine{848       }
\DoxyCodeLine{849       std::vector<std::int64\_t> num\_row\_element(dim\_target + 1);}
\DoxyCodeLine{850       }
\DoxyCodeLine{851 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{852       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{853          \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{854          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components[thread\_num], basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{855          \textcolor{keyword}{const} std::size\_t size = components[thread\_num].basis\_affected.size();}
\DoxyCodeLine{856          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{857             \textcolor{keyword}{const} std::int64\_t a\_basis = components[thread\_num].basis\_affected[i];}
\DoxyCodeLine{858             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components[thread\_num].val[i];}
\DoxyCodeLine{859             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{860                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{861                \textcolor{keywordflow}{if} ((inv < row \&\& std::abs(val) > components[thread\_num].zero\_precision) || inv == row) \{}
\DoxyCodeLine{862                   num\_row\_element[row + 1]++;}
\DoxyCodeLine{863                \}}
\DoxyCodeLine{864             \}}
\DoxyCodeLine{865             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) == 0 \&\& std::abs(val) > components[thread\_num].zero\_precision) \{}
\DoxyCodeLine{866                \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Matrix elements are not in the target space"{}});}
\DoxyCodeLine{867             \}}
\DoxyCodeLine{868          \}}
\DoxyCodeLine{869          components[thread\_num].val.clear();}
\DoxyCodeLine{870          components[thread\_num].basis\_affected.clear();}
\DoxyCodeLine{871          components[thread\_num].inv\_basis\_affected.clear();}
\DoxyCodeLine{872       \}}
\DoxyCodeLine{873       }
\DoxyCodeLine{874 \textcolor{preprocessor}{\#pragma omp parallel for reduction(+:num\_total\_elements)}}
\DoxyCodeLine{875       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row <= dim\_target; ++row) \{}
\DoxyCodeLine{876          num\_total\_elements += num\_row\_element[row];}
\DoxyCodeLine{877       \}}
\DoxyCodeLine{878       }
\DoxyCodeLine{879       \textcolor{comment}{//Do not use openmp here}}
\DoxyCodeLine{880       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{881          num\_row\_element[row + 1] += num\_row\_element[row];}
\DoxyCodeLine{882       \}}
\DoxyCodeLine{883       }
\DoxyCodeLine{884       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.resize(dim\_target + 1);}
\DoxyCodeLine{885       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.resize(num\_total\_elements);}
\DoxyCodeLine{886       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.resize(num\_total\_elements);}
\DoxyCodeLine{887       }
\DoxyCodeLine{888 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{889       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{890          \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{891          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components[thread\_num], basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{892          \textcolor{keyword}{const} std::size\_t size = components[thread\_num].basis\_affected.size();}
\DoxyCodeLine{893          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{894             \textcolor{keyword}{const} std::int64\_t a\_basis = components[thread\_num].basis\_affected[i];}
\DoxyCodeLine{895             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components[thread\_num].val[i];}
\DoxyCodeLine{896             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{897                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{898                \textcolor{keywordflow}{if} ((inv < row \&\& std::abs(val) > components[thread\_num].zero\_precision) || inv == row) \{}
\DoxyCodeLine{899                   ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[num\_row\_element[row]] = inv;}
\DoxyCodeLine{900                   ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[num\_row\_element[row]] = val;}
\DoxyCodeLine{901                   num\_row\_element[row]++;}
\DoxyCodeLine{902                \}}
\DoxyCodeLine{903             \}}
\DoxyCodeLine{904          \}}
\DoxyCodeLine{905          ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[row + 1] = num\_row\_element[row];}
\DoxyCodeLine{906          components[thread\_num].val.clear();}
\DoxyCodeLine{907          components[thread\_num].basis\_affected.clear();}
\DoxyCodeLine{908          components[thread\_num].inv\_basis\_affected.clear();}
\DoxyCodeLine{909       \}}
\DoxyCodeLine{910 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{911       \mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents}} components;}
\DoxyCodeLine{912       components.\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7fee3db2da4ed6a4d750c3390327b642}{site\_constant}}.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{913       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize(); ++site) \{}
\DoxyCodeLine{914          components.site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetDimOnsite(), site));}
\DoxyCodeLine{915       \}}
\DoxyCodeLine{916       components.basis\_onsite.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetSystemSize());}
\DoxyCodeLine{917       }
\DoxyCodeLine{918       std::vector<std::int64\_t> num\_row\_element(dim\_target + 1);}
\DoxyCodeLine{919       }
\DoxyCodeLine{920       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{921          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components, basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{922          \textcolor{keyword}{const} std::size\_t size = components.basis\_affected.size();}
\DoxyCodeLine{923          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{924             \textcolor{keyword}{const} std::int64\_t a\_basis = components.basis\_affected[i];}
\DoxyCodeLine{925             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components.val[i];}
\DoxyCodeLine{926             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{927                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{928                \textcolor{keywordflow}{if} ((inv <= row \&\& std::abs(val) > components.zero\_precision) || inv == row) \{}
\DoxyCodeLine{929                   num\_row\_element[row + 1]++;}
\DoxyCodeLine{930                \}}
\DoxyCodeLine{931             \}}
\DoxyCodeLine{932             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) == 0 \&\& std::abs(val) > components.zero\_precision) \{}
\DoxyCodeLine{933                \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Matrix elements are not in the target space"{}});}
\DoxyCodeLine{934             \}}
\DoxyCodeLine{935          \}}
\DoxyCodeLine{936          components.val.clear();}
\DoxyCodeLine{937          components.basis\_affected.clear();}
\DoxyCodeLine{938          components.inv\_basis\_affected.clear();}
\DoxyCodeLine{939       \}}
\DoxyCodeLine{940       }
\DoxyCodeLine{941       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row <= dim\_target; ++row) \{}
\DoxyCodeLine{942          num\_total\_elements += num\_row\_element[row];}
\DoxyCodeLine{943       \}}
\DoxyCodeLine{944       }
\DoxyCodeLine{945       \textcolor{keywordflow}{for} (std::int64\_t row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{946          num\_row\_element[row + 1] += num\_row\_element[row];}
\DoxyCodeLine{947       \}}
\DoxyCodeLine{948       }
\DoxyCodeLine{949       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.resize(dim\_target + 1);}
\DoxyCodeLine{950       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.resize(num\_total\_elements);}
\DoxyCodeLine{951       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.resize(num\_total\_elements);}
\DoxyCodeLine{952       }
\DoxyCodeLine{953       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_target; ++row) \{}
\DoxyCodeLine{954          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\&components, basis[row], \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}});}
\DoxyCodeLine{955          \textcolor{keyword}{const} std::size\_t size = components.basis\_affected.size();}
\DoxyCodeLine{956          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < size; ++i) \{}
\DoxyCodeLine{957             \textcolor{keyword}{const} std::int64\_t a\_basis = components.basis\_affected[i];}
\DoxyCodeLine{958             \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ada6514651bff6cb916c47982c1b70ba5}{RealType}}     val     = components.val[i];}
\DoxyCodeLine{959             \textcolor{keywordflow}{if} (basis\_inv.count(a\_basis) > 0) \{}
\DoxyCodeLine{960                \textcolor{keyword}{const} std::int64\_t inv = basis\_inv.at(a\_basis);}
\DoxyCodeLine{961                \textcolor{keywordflow}{if} ((inv <= row \&\& std::abs(val) > components.zero\_precision) || inv == row) \{}
\DoxyCodeLine{962                   ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[num\_row\_element[row]] = inv;}
\DoxyCodeLine{963                   ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[num\_row\_element[row]] = val;}
\DoxyCodeLine{964                   num\_row\_element[row]++;}
\DoxyCodeLine{965                \}}
\DoxyCodeLine{966             \}}
\DoxyCodeLine{967          \}}
\DoxyCodeLine{968          ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[row + 1] = num\_row\_element[row];}
\DoxyCodeLine{969          components.val.clear();}
\DoxyCodeLine{970          components.basis\_affected.clear();}
\DoxyCodeLine{971          components.inv\_basis\_affected.clear();}
\DoxyCodeLine{972       \}}
\DoxyCodeLine{973 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{974       }
\DoxyCodeLine{975       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} = dim\_target;}
\DoxyCodeLine{976       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}} = dim\_target;}
\DoxyCodeLine{977       }
\DoxyCodeLine{978       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_1 = (ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[dim\_target] != num\_total\_elements);}
\DoxyCodeLine{979       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_2 = (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size()) != num\_total\_elements);}
\DoxyCodeLine{980       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_check\_3 = (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.size()) != num\_total\_elements);}
\DoxyCodeLine{981       }
\DoxyCodeLine{982       \textcolor{keywordflow}{if} (flag\_check\_1 || flag\_check\_2 || flag\_check\_3) \{}
\DoxyCodeLine{983          std::stringstream ss;}
\DoxyCodeLine{984          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_  << std::endl;}
\DoxyCodeLine{985          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{986       \}}
\DoxyCodeLine{987       ham-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a7fd21b0a2b0c525b831cf03e896fa525}{SortCol}}();}
\DoxyCodeLine{988       }
\DoxyCodeLine{989       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{990       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1blas_aa1196aeb106e923cc2ad6c17fea58f26}{blas::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{991       std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating Hamiltonian:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{992       }
\DoxyCodeLine{993    \}}
\DoxyCodeLine{994       }
\DoxyCodeLine{995    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_ab88d4c67d3ca70815a43a7961c9080af}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{996                                  \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{997                                  \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d}{model::Hubbard\_1D<RealType>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{998       }
\DoxyCodeLine{999       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&nc            = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ae4807dc416a3b14a3a6eddfcfa155463}{GetOnsiteOperatorNC}}();}
\DoxyCodeLine{1000       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up          = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a15fe38d996c2d23748a2eb254807b882}{GetOnsiteOperatorCUp}}();}
\DoxyCodeLine{1001       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up\_dagger   = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7a2de63620d20978d0d2d39c722222fd}{GetOnsiteOperatorCUpDagger}}();}
\DoxyCodeLine{1002       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down        = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4dfc489bed6324d3d4092e3ae215c224}{GetOnsiteOperatorCDown}}();}
\DoxyCodeLine{1003       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down\_dagger = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4892fdee7d5a231b434a6b0335c0cedd}{GetOnsiteOperatorCDownDagger}}();}
\DoxyCodeLine{1004       }
\DoxyCodeLine{1005       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1006          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af85f0a2c8d11d5fc5df37fab13068222}{GetDimOnsite}}());}
\DoxyCodeLine{1007       \}}
\DoxyCodeLine{1008       }
\DoxyCodeLine{1009       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{1010       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1011          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a36690ef3139f372438941e9ea951ced5}{GetOnsiteOperatorHam}}(), 1.0);}
\DoxyCodeLine{1012       \}}
\DoxyCodeLine{1013       }
\DoxyCodeLine{1014       \textcolor{comment}{//Intersite Coulomb}}
\DoxyCodeLine{1015       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}().size()); ++distance) \{}
\DoxyCodeLine{1016          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{1017             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, nc, site + distance, nc, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}(distance -\/ 1));}
\DoxyCodeLine{1018          \}}
\DoxyCodeLine{1019       \}}
\DoxyCodeLine{1020       }
\DoxyCodeLine{1021       \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{1022       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{1023          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{1024             \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{1025             \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{1026             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = site; s < site + distance; ++s) \{}
\DoxyCodeLine{1027                n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a465e32e606632a760db7e21c8c1c3e72}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[s]);}
\DoxyCodeLine{1028             \}}
\DoxyCodeLine{1029             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up\_dagger  , site + distance, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1030             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up         , site + distance, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1031             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down\_dagger, site + distance, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1032             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down       , site + distance, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1033          \}}
\DoxyCodeLine{1034       \}}
\DoxyCodeLine{1035       }
\DoxyCodeLine{1036       \textcolor{keywordflow}{if} (model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a2b552c2cb6d887c1112ef431c22ed508}{GetBoundaryCondition}}() == \mbox{\hyperlink{namespacecompnal_1_1model_a472b79d22175004cb119fcc099cdd49ba971a9be4942bbf28af21cd78bd5e6c15}{model::BoundaryCondition::PBC}}) \{}
\DoxyCodeLine{1037          \textcolor{comment}{//Intersite Coulomb}}
\DoxyCodeLine{1038          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}().size()); ++distance) \{}
\DoxyCodeLine{1039             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{1040                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{1041                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{1042                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, nc, d2, nc, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_a7255933f15b117c4b40aa4a5816a3b8b}{GetIntersiteCoulomb}}(distance -\/ 1));}
\DoxyCodeLine{1043             \}}
\DoxyCodeLine{1044          \}}
\DoxyCodeLine{1045          }
\DoxyCodeLine{1046          \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{1047          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{1048             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < distance; ++i) \{}
\DoxyCodeLine{1049                \textcolor{keyword}{const} \textcolor{keyword}{auto} d1 = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}() -\/ distance + i;}
\DoxyCodeLine{1050                \textcolor{keyword}{const} \textcolor{keyword}{auto} d2 = i;}
\DoxyCodeLine{1051                \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_hubbard__1_d_ac394b7e36cdd24c59f7b516f13c4582c}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{1052                \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{1053                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = d2; s < d2 + d1; ++s) \{}
\DoxyCodeLine{1054                   n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a465e32e606632a760db7e21c8c1c3e72}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[s]);}
\DoxyCodeLine{1055                \}}
\DoxyCodeLine{1056                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_up\_dagger  , d2, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1057                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_up         , d2, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1058                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_down\_dagger, d2, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1059                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, d1, c\_down       , d2, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1060             \}}
\DoxyCodeLine{1061          \}}
\DoxyCodeLine{1062       \}}
\DoxyCodeLine{1063       }
\DoxyCodeLine{1064       \textcolor{comment}{//Fill zero in the diagonal elements for symmetric matrix vector product calculation.}}
\DoxyCodeLine{1065       \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(basis) == 0) \{}
\DoxyCodeLine{1066          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{1067          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(0.0);}
\DoxyCodeLine{1068          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(basis);}
\DoxyCodeLine{1069       \}}
\DoxyCodeLine{1070       }
\DoxyCodeLine{1071    \}}
\DoxyCodeLine{1072    }
\DoxyCodeLine{1073    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_af1da3592e5e6c2d00903c2f411987233}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{1074                                  \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{1075                                  \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d}{model::KondoLattice\_1D<RealType>}} \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1076       }
\DoxyCodeLine{1077       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up          = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a65f4321d5d41b8898b4dcf17dd83329d}{GetOnsiteOperatorCUp}}();}
\DoxyCodeLine{1078       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_up\_dagger   = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a3686b4987cd45b9524faa073e1834cbb}{GetOnsiteOperatorCUpDagger}}();}
\DoxyCodeLine{1079       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down        = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a114ca4b0dec996f77b7f85c7f846f1b4}{GetOnsiteOperatorCDown}}();}
\DoxyCodeLine{1080       \textcolor{keyword}{const} \textcolor{keyword}{auto} \&c\_down\_dagger = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a4698ebcfbb9c957bb2edef2eccfdcd24}{GetOnsiteOperatorCDownDagger}}();}
\DoxyCodeLine{1081       }
\DoxyCodeLine{1082       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1083          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_af509aa69f9a132afbfafd86974317f3a}{GetDimOnsite}}());}
\DoxyCodeLine{1084       \}}
\DoxyCodeLine{1085       }
\DoxyCodeLine{1086       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{1087       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}(); ++site) \{}
\DoxyCodeLine{1088          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(edmc, basis, site, model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aef91160bc62bb058ea4dbb943bb60b0c}{GetOnsiteOperatorHam}}(), 1.0);}
\DoxyCodeLine{1089       \}}
\DoxyCodeLine{1090       }
\DoxyCodeLine{1091       \textcolor{comment}{//Intersite Hopping}}
\DoxyCodeLine{1092       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} distance = 1; distance <= static\_cast<int>(model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aa896770fcaa6a044e9083b8fbb8db3b3}{GetHopping}}().size()); ++distance) \{}
\DoxyCodeLine{1093          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_ac5aca3c2e80d606a71879e5103a5fb39}{GetSystemSize}}() -\/ distance; ++site) \{}
\DoxyCodeLine{1094             \textcolor{keyword}{const} \textcolor{keyword}{auto} t = model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_kondo_lattice__1_d_aa896770fcaa6a044e9083b8fbb8db3b3}{GetHopping}}(distance -\/ 1);}
\DoxyCodeLine{1095             \textcolor{keywordtype}{int} n\_electron = 0;}
\DoxyCodeLine{1096             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = site; s < site + distance; ++s) \{}
\DoxyCodeLine{1097                n\_electron += model\_input.\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin_electron__1_d_a66a72d066c290e214f6407b0eb746c42}{CalculateNumElectron}}(edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[s]);}
\DoxyCodeLine{1098             \}}
\DoxyCodeLine{1099             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up\_dagger  , site + distance, c\_up         , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1100             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_up         , site + distance, c\_up\_dagger  , -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1101             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down\_dagger, site + distance, c\_down       , +1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1102             \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site, c\_down       , site + distance, c\_down\_dagger, -\/1.0*t, 2*(n\_electron\%2) -\/ 1);}
\DoxyCodeLine{1103          \}}
\DoxyCodeLine{1104       \}}
\DoxyCodeLine{1105       }
\DoxyCodeLine{1106    \}}
\DoxyCodeLine{1107    }
\DoxyCodeLine{1108    \textcolor{keyword}{template}<\textcolor{keyword}{class} BaseClass>}
\DoxyCodeLine{1109    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a259b4ea5e04a394742135d8182a1f46e}{GenerateMatrixComponents}}(\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components}{ExactDiagMatrixComponents<RealType>}} *edmc,}
\DoxyCodeLine{1110                                  \textcolor{keyword}{const} std::int64\_t basis,}
\DoxyCodeLine{1111                                  \textcolor{keyword}{const} model::GeneralModel\_1D<BaseClass> \&model\_input)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1112       }
\DoxyCodeLine{1113       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < model\_input.GetSystemSize(); ++site) \{}
\DoxyCodeLine{1114          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a7329695bd8377ce171a1774a1ecb36a9}{basis\_onsite}}[site] = \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a1a3a0400cf96ee595d5a095cfb1c4f87}{CalculateLocalBasis}}(basis, site, model\_input.GetDimOnsite());}
\DoxyCodeLine{1115       \}}
\DoxyCodeLine{1116       }
\DoxyCodeLine{1117       \textcolor{comment}{//Onsite elements}}
\DoxyCodeLine{1118       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it: model\_input.GetOnsiteOperatorList()) \{}
\DoxyCodeLine{1119          \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a0b18fac0aecdc44c9c3309c8e8a7dfc8}{GenerateMatrixComponentsOnsite}}(edmc, basis, it.first, it.second, 1.0);}
\DoxyCodeLine{1120       \}}
\DoxyCodeLine{1121       }
\DoxyCodeLine{1122       \textcolor{comment}{//Intersite elements}}
\DoxyCodeLine{1123       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it1: \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_a4bb54cc68b058aa00720b0931c21736a}{model}}.GetIntersiteOperatorList()) \{}
\DoxyCodeLine{1124          \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1 = it1.first;}
\DoxyCodeLine{1125          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it2: it1.second) \{}
\DoxyCodeLine{1126             \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2 = it2.first;}
\DoxyCodeLine{1127             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&it3: it2.second) \{}
\DoxyCodeLine{1128                \textcolor{keyword}{const} \textcolor{keyword}{auto} \&m\_1 = it3.first;}
\DoxyCodeLine{1129                \textcolor{keyword}{const} \textcolor{keyword}{auto} \&m\_2 = it3.second;}
\DoxyCodeLine{1130                \mbox{\hyperlink{classcompnal_1_1solver_1_1_exact_diag_aedb25e4c8e244da2a95c38f855d0c5d1}{GenerateMatrixComponentsIntersite}}(edmc, basis, site\_1, m\_1, site\_2, m\_2, 1.0);}
\DoxyCodeLine{1131             \}}
\DoxyCodeLine{1132          \}}
\DoxyCodeLine{1133       \}}
\DoxyCodeLine{1134       }
\DoxyCodeLine{1135       \textcolor{comment}{//Fill zero in the diagonal elements for symmetric matrix vector product calculation.}}
\DoxyCodeLine{1136       \textcolor{keywordflow}{if} (edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}.count(basis) == 0) \{}
\DoxyCodeLine{1137          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a253673ab20bc51bc09af60c5daccf531}{inv\_basis\_affected}}[basis] = edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.size();}
\DoxyCodeLine{1138          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a2aa3acff1c3ac82a96a1713a0c26b260}{val}}.push\_back(0.0);}
\DoxyCodeLine{1139          edmc-\/>\mbox{\hyperlink{structcompnal_1_1solver_1_1_exact_diag_matrix_components_a5a060bd6aa290ed87ceaa581399e21ba}{basis\_affected}}.push\_back(basis);}
\DoxyCodeLine{1140       \}}
\DoxyCodeLine{1141       }
\DoxyCodeLine{1142    \}}
\DoxyCodeLine{1143    }
\DoxyCodeLine{1144    }
\DoxyCodeLine{1145    }
\DoxyCodeLine{1146 \};}
\DoxyCodeLine{1147 }
\DoxyCodeLine{1148 \}}
\DoxyCodeLine{1149 \}}
\DoxyCodeLine{1150 }
\DoxyCodeLine{1151 }
\DoxyCodeLine{1152 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SOLVER\_EXACT\_DIAG\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
