\hypertarget{compressed__row__storage_8hpp_source}{}\doxysection{compressed\+\_\+row\+\_\+storage.\+hpp}
\label{compressed__row__storage_8hpp_source}\index{src/sparse\_matrix/compressed\_row\_storage.hpp@{src/sparse\_matrix/compressed\_row\_storage.hpp}}
\mbox{\hyperlink{compressed__row__storage_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/05/20.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SPARSE\_MATRIX\_COMPRESSED\_ROW\_STORAGE\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SPARSE\_MATRIX\_COMPRESSED\_ROW\_STORAGE\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <iomanip>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{30 \textcolor{keyword}{namespace }sparse\_matrix \{}
\DoxyCodeLine{31 }
\DoxyCodeLine{33 \textcolor{keyword}{enum} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} \{}
\DoxyCodeLine{34    }
\DoxyCodeLine{36    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{NONE}} = 0,}
\DoxyCodeLine{37    }
\DoxyCodeLine{39    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{FERMION}} = 1,}
\DoxyCodeLine{40    }
\DoxyCodeLine{42    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca05234a42c14cce89b03095163ab5ed42}{BOSON}} = 2,}
\DoxyCodeLine{43    }
\DoxyCodeLine{45    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcab68331254a7c64a63ae149c44bfb74d8}{MIX}} = 3}
\DoxyCodeLine{46 \};}
\DoxyCodeLine{47 }
\DoxyCodeLine{50 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{51 \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \{}
\DoxyCodeLine{52    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{53    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{54    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{55    std::int64\_t \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} = 0;}
\DoxyCodeLine{56    std::int64\_t \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} = 0;}
\DoxyCodeLine{57    std::vector<std::int64\_t> \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}};}
\DoxyCodeLine{58    std::vector<std::int64\_t> \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}};}
\DoxyCodeLine{59    std::vector<RealType> \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}};}
\DoxyCodeLine{60    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{63    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{64    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{65    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad8ff5aced2c767e4f38f8c952f7cd638}{CRS}}(\textcolor{keyword}{const} std::int64\_t row\_dim\_in = 0, \textcolor{keyword}{const} std::int64\_t col\_dim\_in = 0, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} tag\_in = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}}) \{}
\DoxyCodeLine{66       this-\/>row\_dim = row\_dim\_in;}
\DoxyCodeLine{67       this-\/>col\_dim = col\_dim\_in;}
\DoxyCodeLine{68       this-\/>row.resize(row\_dim\_in + 1);}
\DoxyCodeLine{69 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{70       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i <= row\_dim\_in; ++i) \{}
\DoxyCodeLine{71          this-\/>row[i] = 0;}
\DoxyCodeLine{72       \}}
\DoxyCodeLine{73       this-\/>tag = tag\_in;}
\DoxyCodeLine{74    \}}
\DoxyCodeLine{75    }
\DoxyCodeLine{76    \textcolor{keyword}{explicit} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_abf651ae27c5d19a446933fce51a13ea6}{CRS}}(\textcolor{keyword}{const} std::vector<std::vector<RealType>> \&mat\_vec, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} tag\_in = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}}) \{}
\DoxyCodeLine{77       this-\/>row\_dim = mat\_vec.size();}
\DoxyCodeLine{78       this-\/>col\_dim = 0;}
\DoxyCodeLine{79       this-\/>row.resize(this-\/>row\_dim + 1);}
\DoxyCodeLine{80       this-\/>row[0] = 0;}
\DoxyCodeLine{81       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{82          \textcolor{keyword}{const} std::int64\_t size = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(mat\_vec[i].size());}
\DoxyCodeLine{83          \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < size;++j) \{}
\DoxyCodeLine{84             \textcolor{keywordflow}{if} (mat\_vec[i][j] != 0.0) \{}
\DoxyCodeLine{85                this-\/>col.push\_back(j);}
\DoxyCodeLine{86                this-\/>val.push\_back(mat\_vec[i][j]);}
\DoxyCodeLine{87             \}}
\DoxyCodeLine{88             \textcolor{keywordflow}{if} (this-\/>col\_dim < j + 1) \{}
\DoxyCodeLine{89                this-\/>col\_dim = j + 1;}
\DoxyCodeLine{90             \}}
\DoxyCodeLine{91          \}}
\DoxyCodeLine{92          this-\/>row[i + 1] = this-\/>col.size();}
\DoxyCodeLine{93       \}}
\DoxyCodeLine{94       this-\/>tag = tag\_in;}
\DoxyCodeLine{95    \}}
\DoxyCodeLine{96    }
\DoxyCodeLine{97    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a5fcddd1fd69cb414e15b7a35e173dfd9}{CRS}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix) \{}
\DoxyCodeLine{98       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ae9787c189eb909874211a098ba453ed7}{Assign}}(matrix);}
\DoxyCodeLine{99    \}}
\DoxyCodeLine{100    }
\DoxyCodeLine{101    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af3b2dc61ff6a6eb35e65e879cdc08ee4}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix) \& \{}
\DoxyCodeLine{102       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ae9787c189eb909874211a098ba453ed7}{Assign}}(matrix);}
\DoxyCodeLine{103       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{104    \}}
\DoxyCodeLine{105       }
\DoxyCodeLine{106    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{107    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{108    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{109    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ae9787c189eb909874211a098ba453ed7}{Assign}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix) \{}
\DoxyCodeLine{110       this-\/>row\_dim = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{111       this-\/>col\_dim = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}};}
\DoxyCodeLine{112       this-\/>row.resize(matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} + 1);}
\DoxyCodeLine{113       }
\DoxyCodeLine{114       this-\/>col.resize(matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size());}
\DoxyCodeLine{115       this-\/>val.resize(matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size());}
\DoxyCodeLine{116       }
\DoxyCodeLine{117 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{118       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i <= matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{119          this-\/>row[i] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i];}
\DoxyCodeLine{120       \}}
\DoxyCodeLine{121       }
\DoxyCodeLine{122 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{123       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size(); ++i) \{}
\DoxyCodeLine{124          this-\/>col[i] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i];}
\DoxyCodeLine{125          this-\/>val[i] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i];}
\DoxyCodeLine{126       \}}
\DoxyCodeLine{127       this-\/>tag = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}};}
\DoxyCodeLine{128    \}}
\DoxyCodeLine{129    }
\DoxyCodeLine{130    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a818173aa562d5c541552627b1570244f}{MultiplyByScalar}}(\textcolor{keyword}{const} RealType coeef) \{}
\DoxyCodeLine{131       \textcolor{keywordflow}{if} (coeef == 0.0) \{}
\DoxyCodeLine{132 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{133          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{134             this-\/>row[i + 1] = 0;}
\DoxyCodeLine{135          \}}
\DoxyCodeLine{136          this-\/>col.clear();}
\DoxyCodeLine{137          this-\/>val.clear();}
\DoxyCodeLine{138       \}}
\DoxyCodeLine{139       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{140 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{141          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>col.size(); ++i) \{}
\DoxyCodeLine{142             this-\/>val[i] *= coeef;}
\DoxyCodeLine{143          \}}
\DoxyCodeLine{144       \}}
\DoxyCodeLine{145    \}}
\DoxyCodeLine{146       }
\DoxyCodeLine{147    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad64678d1387884cbf00aefd936ee3f36}{DiagonalScaling}}(\textcolor{keyword}{const} RealType diag\_add) \{}
\DoxyCodeLine{148       \textcolor{keywordflow}{if} (this-\/>row\_dim != this-\/>col\_dim) \{}
\DoxyCodeLine{149          std::stringstream ss;}
\DoxyCodeLine{150          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{151          ss << \textcolor{stringliteral}{"{}The matrix is not a square matrix."{}} << std::endl;}
\DoxyCodeLine{152          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{153       \}}
\DoxyCodeLine{154 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{155       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{156          \textcolor{keywordtype}{bool} flag = \textcolor{keyword}{true};}
\DoxyCodeLine{157          \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row[i]; j < this-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{158             \textcolor{keywordflow}{if} (i == this-\/>col[j]) \{}
\DoxyCodeLine{159                this-\/>val[j] += diag\_add;}
\DoxyCodeLine{160                flag = \textcolor{keyword}{false};}
\DoxyCodeLine{161                \textcolor{keywordflow}{break};}
\DoxyCodeLine{162             \}}
\DoxyCodeLine{163          \}}
\DoxyCodeLine{164          \textcolor{keywordflow}{if} (flag) \{}
\DoxyCodeLine{165             std::stringstream ss;}
\DoxyCodeLine{166             ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{167             ss << \textcolor{stringliteral}{"{}Some of the diagonal components are not registered."{}} << std::endl;}
\DoxyCodeLine{168             \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{169          \}}
\DoxyCodeLine{170       \}}
\DoxyCodeLine{171    \}}
\DoxyCodeLine{172    }
\DoxyCodeLine{173    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a5ad7bce09d843653a2e9e6651ef2a7eb}{Free}}() \{}
\DoxyCodeLine{174       this-\/>row\_dim = 0;}
\DoxyCodeLine{175       this-\/>col\_dim = 0;}
\DoxyCodeLine{176       std::vector<std::int64\_t>().swap(this-\/>row);}
\DoxyCodeLine{177       std::vector<std::int64\_t>().swap(this-\/>col);}
\DoxyCodeLine{178       std::vector<RealType>().swap(this-\/>val);}
\DoxyCodeLine{179       this-\/>row.push\_back(0);}
\DoxyCodeLine{180       this-\/>tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{181    \}}
\DoxyCodeLine{182    }
\DoxyCodeLine{183    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ac196a07cc2959d23578ef9e25d2121c2}{Clear}}() \{}
\DoxyCodeLine{184       this-\/>row\_dim = 0;}
\DoxyCodeLine{185       this-\/>col\_dim = 0;}
\DoxyCodeLine{186       this-\/>row.clear();}
\DoxyCodeLine{187       this-\/>col.clear();}
\DoxyCodeLine{188       this-\/>val.clear();}
\DoxyCodeLine{189       this-\/>row.push\_back(0);}
\DoxyCodeLine{190       this-\/>tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{191    \}}
\DoxyCodeLine{192       }
\DoxyCodeLine{193    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a461f3df023c6215768aca60b9743fe0c}{SortCol}}() \{}
\DoxyCodeLine{194 \textcolor{preprocessor}{\#pragma omp parallel for schedule (guided)}}
\DoxyCodeLine{195       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{196          utility::QuickSort<std::int64\_t, RealType>(\&this-\/>col, \&this-\/>val, this-\/>row[i], this-\/>row[i + 1]);}
\DoxyCodeLine{197       \}}
\DoxyCodeLine{198    \}}
\DoxyCodeLine{199    }
\DoxyCodeLine{200    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a630ce4a8d7feb26bf33521bbe35f12c2}{Print}}(\textcolor{keyword}{const} std::string display\_name = \textcolor{stringliteral}{"{}Matrix"{}})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{201       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{202          \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row.at(i); j < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.at(i+1); ++j) \{}
\DoxyCodeLine{203             std::cout << display\_name << \textcolor{stringliteral}{"{}["{}};}
\DoxyCodeLine{204             std::cout << std::noshowpos << std::left << std::setw(3) << i << \textcolor{stringliteral}{"{}]["{}};}
\DoxyCodeLine{205             std::cout << std::left << std::setw(3) << this-\/>col[j] << \textcolor{stringliteral}{"{}]="{}};}
\DoxyCodeLine{206             std::cout << std::showpos << this-\/>val[j] << std::endl;}
\DoxyCodeLine{207          \}}
\DoxyCodeLine{208       \}}
\DoxyCodeLine{209       std::cout << std::noshowpos;}
\DoxyCodeLine{210    \}}
\DoxyCodeLine{211    }
\DoxyCodeLine{212    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a984f9042aade4c462eca059bb64ee346}{PrintInfo}}(\textcolor{keyword}{const} std::string display\_name = \textcolor{stringliteral}{"{}Matrix"{}})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{213       std::cout << \textcolor{stringliteral}{"{}Print information about CRS: "{}} << display\_name << std::endl;}
\DoxyCodeLine{214       std::cout << \textcolor{stringliteral}{"{}row\_dim = "{}} << this-\/>row\_dim << std::endl;}
\DoxyCodeLine{215       std::cout << \textcolor{stringliteral}{"{}col\_dim = "{}} << this-\/>col\_dim << std::endl;}
\DoxyCodeLine{216       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>row.size(); ++i) \{}
\DoxyCodeLine{217          std::cout << \textcolor{stringliteral}{"{}row["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>row.at(i) << std::endl;}
\DoxyCodeLine{218       \}}
\DoxyCodeLine{219       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>col.size(); ++i) \{}
\DoxyCodeLine{220          std::cout << \textcolor{stringliteral}{"{}col["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>col.at(i) << std::endl;}
\DoxyCodeLine{221       \}}
\DoxyCodeLine{222       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>val.size(); ++i) \{}
\DoxyCodeLine{223          std::cout << \textcolor{stringliteral}{"{}val["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>val.at(i) << std::endl;}
\DoxyCodeLine{224       \}}
\DoxyCodeLine{225    \}}
\DoxyCodeLine{226    }
\DoxyCodeLine{227    \textcolor{keywordtype}{bool} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a2d8712384b5f694bfd6d8e51eed2888d}{isSymmetric}}(\textcolor{keyword}{const} RealType threshold = 0.000000000000001\textcolor{comment}{/*pow(10,-\/15)*/})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{228       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{229          \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row[i]; j < this-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{230             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_begin = this-\/>col.begin() + this-\/>row[\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]];}
\DoxyCodeLine{231             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_end   = this-\/>col.begin() + this-\/>row[\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j] + 1];}
\DoxyCodeLine{232             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_find  = std::lower\_bound(iter\_begin, iter\_end, i);}
\DoxyCodeLine{233             \textcolor{keywordflow}{if} (iter\_find == iter\_end || *iter\_find != i) \{}
\DoxyCodeLine{234                std::cout << \textcolor{stringliteral}{"{}The input matrix is not symmetric."{}} << std::endl;}
\DoxyCodeLine{235                std::cout << \textcolor{stringliteral}{"{}Corresponding element does not exist."{}} << std::endl;}
\DoxyCodeLine{236                std::cout << \textcolor{stringliteral}{"{}row="{}} << i << \textcolor{stringliteral}{"{}, col="{}} << \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j] << \textcolor{stringliteral}{"{}, val="{}} << \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] << std::endl;}
\DoxyCodeLine{237                \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{238             \}}
\DoxyCodeLine{239             \textcolor{keyword}{const} \textcolor{keyword}{auto} inv = std::distance(iter\_begin, iter\_find);}
\DoxyCodeLine{240             \textcolor{keywordflow}{if} (std::abs(this-\/>val[j] -\/ this-\/>val[inv]) > threshold) \{}
\DoxyCodeLine{241                std::cout << \textcolor{stringliteral}{"{}The input matrix is not symmetric."{}} << std::endl;}
\DoxyCodeLine{242                std::cout << \textcolor{stringliteral}{"{}M["{}} << i << \textcolor{stringliteral}{"{}]["{}} << this-\/>col[j] << \textcolor{stringliteral}{"{}]="{}} << this-\/>val[j] << \textcolor{stringliteral}{"{}, "{}} << this-\/>val[inv] << \textcolor{stringliteral}{"{}=M["{}} << this-\/>col[j] << \textcolor{stringliteral}{"{}]["{}} << i << \textcolor{stringliteral}{"{}]"{}} << std::endl;}
\DoxyCodeLine{243                \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{244             \}}
\DoxyCodeLine{245          \}}
\DoxyCodeLine{246       \}}
\DoxyCodeLine{247       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{248    \}}
\DoxyCodeLine{249    }
\DoxyCodeLine{250 \};}
\DoxyCodeLine{251 }
\DoxyCodeLine{252 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{253 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\}*T3\{0\})> \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a84aff8ca71e76b722c47c396a0fc16e6}{CalculateMatrixMatrixProduct}}(\textcolor{keyword}{const} T1 coeef\_1,}
\DoxyCodeLine{254                                                               \textcolor{keyword}{const} CRS<T2> \&matrix\_1,}
\DoxyCodeLine{255                                                               \textcolor{keyword}{const} CRS<T3> \&matrix\_2) \{}
\DoxyCodeLine{256    }
\DoxyCodeLine{257    \textcolor{keywordflow}{if} (matrix\_1.col\_dim != matrix\_2.row\_dim) \{}
\DoxyCodeLine{258       std::stringstream ss;}
\DoxyCodeLine{259       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{260       ss << \textcolor{stringliteral}{"{}Matrix product cannot be defined"{}} << std::endl;}
\DoxyCodeLine{261       ss << \textcolor{stringliteral}{"{}matrix\_1.col\_dim = "{}} << matrix\_1.col\_dim << \textcolor{stringliteral}{"{}, matrix\_2.row\_dim = "{}} << matrix\_2.row\_dim << std::endl;}
\DoxyCodeLine{262       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{263    \}}
\DoxyCodeLine{264    }
\DoxyCodeLine{265    CRS<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\}*T3\{0\})> matrix\_out(matrix\_1.row\_dim, matrix\_2.col\_dim);}
\DoxyCodeLine{266    }
\DoxyCodeLine{267    std::vector<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\})>       temp\_v1(matrix\_1.col\_dim, 0.0);}
\DoxyCodeLine{268    std::vector<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\}*T3\{0\})> temp\_v2(matrix\_2.col\_dim, 0.0);}
\DoxyCodeLine{269    }
\DoxyCodeLine{270    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_1.row\_dim; ++i) \{}
\DoxyCodeLine{271       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_1.row[i]; j < matrix\_1.row[i + 1]; ++j) \{}
\DoxyCodeLine{272          temp\_v1[matrix\_1.col[j]] = coeef\_1*matrix\_1.val[j];}
\DoxyCodeLine{273       \}}
\DoxyCodeLine{274       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_1.col\_dim; ++j) \{}
\DoxyCodeLine{275          \textcolor{keywordflow}{for} (std::int64\_t k = matrix\_2.row[j]; k < matrix\_2.row[j + 1]; ++k) \{}
\DoxyCodeLine{276             temp\_v2[matrix\_2.col[k]] += temp\_v1[j]*matrix\_2.val[k];}
\DoxyCodeLine{277          \}}
\DoxyCodeLine{278       \}}
\DoxyCodeLine{279       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_2.col\_dim; ++j) \{}
\DoxyCodeLine{280          \textcolor{keywordflow}{if} (std::abs(temp\_v2[j]) > 0.0) \{}
\DoxyCodeLine{281             matrix\_out.val.push\_back(temp\_v2[j]);}
\DoxyCodeLine{282             matrix\_out.col.push\_back(j);}
\DoxyCodeLine{283          \}}
\DoxyCodeLine{284       \}}
\DoxyCodeLine{285       }
\DoxyCodeLine{286       matrix\_out.row[i + 1] = matrix\_out-\/>col.size();}
\DoxyCodeLine{287       }
\DoxyCodeLine{288       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_1.row[i]; j < matrix\_1.row[i + 1]; ++j) \{}
\DoxyCodeLine{289          temp\_v1[matrix\_1.col[j]] = 0.0;}
\DoxyCodeLine{290       \}}
\DoxyCodeLine{291       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_out-\/>row[i]; j < matrix\_out-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{292          temp\_v2[matrix\_out-\/>col[j]] = 0.0;}
\DoxyCodeLine{293       \}}
\DoxyCodeLine{294    \}}
\DoxyCodeLine{295    }
\DoxyCodeLine{296    \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}}) \{}
\DoxyCodeLine{297       matrix\_out.tag = matrix\_2.tag;}
\DoxyCodeLine{298    \}}
\DoxyCodeLine{299    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}}) \{}
\DoxyCodeLine{300       \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca05234a42c14cce89b03095163ab5ed42}{CRSTag::BOSON}}) \{}
\DoxyCodeLine{301          matrix\_out.tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}};}
\DoxyCodeLine{302       \}}
\DoxyCodeLine{303       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}}) \{}
\DoxyCodeLine{304          matrix\_out.tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca05234a42c14cce89b03095163ab5ed42}{CRSTag::BOSON}};}
\DoxyCodeLine{305       \}}
\DoxyCodeLine{306       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcab68331254a7c64a63ae149c44bfb74d8}{CRSTag::MIX}}) \{}
\DoxyCodeLine{307          matrix\_out.tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcab68331254a7c64a63ae149c44bfb74d8}{CRSTag::MIX}};}
\DoxyCodeLine{308       \}}
\DoxyCodeLine{309       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{310          std::stringstream ss;}
\DoxyCodeLine{311          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{312          ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{313          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{314       \}}
\DoxyCodeLine{315    \}}
\DoxyCodeLine{316    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca05234a42c14cce89b03095163ab5ed42}{CRSTag::BOSON}}) \{}
\DoxyCodeLine{317       \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca05234a42c14cce89b03095163ab5ed42}{CRSTag::BOSON}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcab68331254a7c64a63ae149c44bfb74d8}{CRSTag::MIX}}) \{}
\DoxyCodeLine{318          matrix\_out.tag = matrix\_2.tag;}
\DoxyCodeLine{319       \}}
\DoxyCodeLine{320       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}}) \{}
\DoxyCodeLine{321          matrix\_out.tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca05234a42c14cce89b03095163ab5ed42}{CRSTag::BOSON}};}
\DoxyCodeLine{322       \}}
\DoxyCodeLine{323       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{324          std::stringstream ss;}
\DoxyCodeLine{325          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{326          ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{327          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{328       \}}
\DoxyCodeLine{329    \}}
\DoxyCodeLine{330    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcab68331254a7c64a63ae149c44bfb74d8}{CRSTag::MIX}}) \{}
\DoxyCodeLine{331       matrix\_out.tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcab68331254a7c64a63ae149c44bfb74d8}{CRSTag::MIX}};}
\DoxyCodeLine{332    \}}
\DoxyCodeLine{333    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{334       std::stringstream ss;}
\DoxyCodeLine{335       ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{336       ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{337       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{338    \}}
\DoxyCodeLine{339    }
\DoxyCodeLine{340    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{341 \}}
\DoxyCodeLine{342 }
\DoxyCodeLine{343 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3, \textcolor{keyword}{typename} T4>}
\DoxyCodeLine{344 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}+T2\{0\}+T3\{0\}+T4\{0\})> \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_afe9699b31d9d2e37532767c6039a813a}{CalculateMatrixMatrixSum}}(\textcolor{keyword}{const} T1 coeef\_1,}
\DoxyCodeLine{345                                                                 \textcolor{keyword}{const} CRS<T2> \&matrix\_1,}
\DoxyCodeLine{346                                                                 \textcolor{keyword}{const} T3 coeef\_2,}
\DoxyCodeLine{347                                                                 \textcolor{keyword}{const} CRS<T4> \&matrix\_2) \{}
\DoxyCodeLine{348    }
\DoxyCodeLine{349    \textcolor{keywordflow}{if} (matrix\_1.row\_dim != matrix\_2.row\_dim || matrix\_1.col\_dim != matrix\_2.col\_dim) \{}
\DoxyCodeLine{350       std::stringstream ss;}
\DoxyCodeLine{351       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{352       ss << \textcolor{stringliteral}{"{}The summation of the matrices cannot be defined."{}} << std::endl;}
\DoxyCodeLine{353       ss << \textcolor{stringliteral}{"{}matrix\_1.row\_dim = "{}} << matrix\_1.row\_dim << \textcolor{stringliteral}{"{}, matrix\_1.col\_dim = "{}} << matrix\_1.col\_dim << std::endl;}
\DoxyCodeLine{354       ss << \textcolor{stringliteral}{"{}matrix\_2.row\_dim = "{}} << matrix\_2.row\_dim << \textcolor{stringliteral}{"{}, matrix\_2.col\_dim = "{}} << matrix\_2.col\_dim << std::endl;}
\DoxyCodeLine{355       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{356    \}}
\DoxyCodeLine{357       }
\DoxyCodeLine{358    CRS<\textcolor{keyword}{decltype}(T1\{0\}+T2\{0\}+T3\{0\}+T4\{0\})> matrix\_out(matrix\_1.row\_dim, matrix\_1.col\_dim);}
\DoxyCodeLine{359    }
\DoxyCodeLine{360    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_1.row\_dim; ++i) \{}
\DoxyCodeLine{361       }
\DoxyCodeLine{362       \textcolor{keywordtype}{int} check = 0;}
\DoxyCodeLine{363       std::int64\_t count\_1 = 0;}
\DoxyCodeLine{364       std::int64\_t count\_2 = 0;}
\DoxyCodeLine{365       }
\DoxyCodeLine{366       \textcolor{keyword}{const} std::int64\_t row\_lower\_1 = matrix\_1.row[  i  ];}
\DoxyCodeLine{367       \textcolor{keyword}{const} std::int64\_t row\_upper\_1 = matrix\_1.row[i + 1];}
\DoxyCodeLine{368       \textcolor{keyword}{const} std::int64\_t row\_lower\_2 = matrix\_2.row[  i  ];}
\DoxyCodeLine{369       \textcolor{keyword}{const} std::int64\_t row\_upper\_2 = matrix\_2.row[i + 1];}
\DoxyCodeLine{370       }
\DoxyCodeLine{371       \textcolor{keyword}{const} std::int64\_t m1\_count = row\_upper\_1 -\/ row\_lower\_1;}
\DoxyCodeLine{372       \textcolor{keyword}{const} std::int64\_t m2\_count = row\_upper\_2 -\/ row\_lower\_2;}
\DoxyCodeLine{373       }
\DoxyCodeLine{374       \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count == 0) \{}
\DoxyCodeLine{375          \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{376             matrix\_out.val.push\_back(coeef\_1*matrix\_1.val[j]);}
\DoxyCodeLine{377             matrix\_out.col.push\_back(matrix\_1.col[j]);}
\DoxyCodeLine{378          \}}
\DoxyCodeLine{379       \}}
\DoxyCodeLine{380       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count == 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{381          \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{382             matrix\_out.val.push\_back(coeef\_2*matrix\_2.val[j]);}
\DoxyCodeLine{383             matrix\_out.col.push\_back(matrix\_2.col[j]);}
\DoxyCodeLine{384          \}}
\DoxyCodeLine{385       \}}
\DoxyCodeLine{386       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{387          \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < m1\_count + m2\_count; ++j) \{}
\DoxyCodeLine{388             \textcolor{keywordflow}{if} (matrix\_1.col[row\_lower\_1 + count\_1] < matrix\_2.col[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{389                matrix\_out.val.push\_back(coeef\_1*matrix\_1.val[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{390                matrix\_out.col.push\_back(matrix\_1.col[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{391                count\_1++;}
\DoxyCodeLine{392                \textcolor{keywordflow}{if} (row\_lower\_1 + count\_1 == row\_upper\_1) \{}
\DoxyCodeLine{393                   check = 1;}
\DoxyCodeLine{394                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{395                \}}
\DoxyCodeLine{396             \}}
\DoxyCodeLine{397             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.col[row\_lower\_1 + count\_1] == matrix\_2.col[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{398                \textcolor{keyword}{const} \textcolor{keyword}{auto} val = coeef\_1*matrix\_1.val[row\_lower\_1 + count\_1] + coeef\_2*matrix\_2.val[row\_lower\_2 + count\_2];}
\DoxyCodeLine{399                \textcolor{keywordflow}{if} (std::abs(val) > 0.0) \{}
\DoxyCodeLine{400                   matrix\_out.val.push\_back(val);}
\DoxyCodeLine{401                   matrix\_out.col.push\_back(matrix\_1.col[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{402                   count\_1++;}
\DoxyCodeLine{403                   count\_2++;}
\DoxyCodeLine{404                   \textcolor{keyword}{const} std::int64\_t temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{405                   \textcolor{keyword}{const} std::int64\_t temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{406                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{407                      check = 1;}
\DoxyCodeLine{408                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{409                   \}}
\DoxyCodeLine{410                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{411                      check = 2;}
\DoxyCodeLine{412                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{413                   \}}
\DoxyCodeLine{414                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{415                      check = 0;}
\DoxyCodeLine{416                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{417                   \}}
\DoxyCodeLine{418                \}}
\DoxyCodeLine{419                \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{420                   count\_1++;}
\DoxyCodeLine{421                   count\_2++;}
\DoxyCodeLine{422                   \textcolor{keyword}{const} std::int64\_t temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{423                   \textcolor{keyword}{const} std::int64\_t temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{424                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{425                      check = 1;}
\DoxyCodeLine{426                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{427                   \}}
\DoxyCodeLine{428                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{429                      check = 2;}
\DoxyCodeLine{430                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{431                   \}}
\DoxyCodeLine{432                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{433                      check = 0;}
\DoxyCodeLine{434                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{435                   \}}
\DoxyCodeLine{436                \}}
\DoxyCodeLine{437             \}}
\DoxyCodeLine{438             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{439                matrix\_out.val.push\_back(coeef\_2*matrix\_2.val[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{440                matrix\_out.col.push\_back(matrix\_2.col[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{441                count\_2++;}
\DoxyCodeLine{442                \textcolor{keywordflow}{if} (row\_lower\_2 + count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{443                   check = 2;}
\DoxyCodeLine{444                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{445                \}}
\DoxyCodeLine{446             \}}
\DoxyCodeLine{447          \}}
\DoxyCodeLine{448          \textcolor{keywordflow}{if} (check == 1) \{}
\DoxyCodeLine{449             \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_2 + count\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{450                matrix\_out.val.push\_back(coeef\_2*matrix\_2.val[j]);}
\DoxyCodeLine{451                matrix\_out.col.push\_back(matrix\_2.col[j]);}
\DoxyCodeLine{452             \}}
\DoxyCodeLine{453          \}}
\DoxyCodeLine{454          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (check == 2) \{}
\DoxyCodeLine{455             \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_1 + count\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{456                matrix\_out.val.push\_back(coeef\_1*matrix\_1.val[j]);}
\DoxyCodeLine{457                matrix\_out.col.push\_back(matrix\_1.col[j]);}
\DoxyCodeLine{458             \}}
\DoxyCodeLine{459          \}}
\DoxyCodeLine{460       \}}
\DoxyCodeLine{461       matrix\_out.row[i + 1] = matrix\_out.col.size();}
\DoxyCodeLine{462    \}}
\DoxyCodeLine{463    }
\DoxyCodeLine{464    matrix\_out.tag = matrix\_1.tag;}
\DoxyCodeLine{465    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{466 \}}
\DoxyCodeLine{467 }
\DoxyCodeLine{468 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{469 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\})> \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_adbcb79d1f723a5809d308d7073336a8f}{CalculateScalarMatrixProduct}}(\textcolor{keyword}{const} T1 lhs, \textcolor{keyword}{const} CRS<T2> \&rhs) \{}
\DoxyCodeLine{470    }
\DoxyCodeLine{471    CRS<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\})> out(rhs.row\_dim, rhs.col\_dim, rhs.tag);}
\DoxyCodeLine{472    out.col.resize(rhs.col.size());}
\DoxyCodeLine{473    out.val.resize(rhs.val.size());}
\DoxyCodeLine{474    }
\DoxyCodeLine{475 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{476    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < rhs.col.size(); ++i) \{}
\DoxyCodeLine{477       out.col[i] = rhs.col[i];}
\DoxyCodeLine{478       out.val[i] = lhs*rhs.val[i];}
\DoxyCodeLine{479    \}}
\DoxyCodeLine{480    }
\DoxyCodeLine{481 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{482    \textcolor{keywordflow}{for} (std::int64\_t i = 1; i <= rhs.row\_dim; ++i) \{}
\DoxyCodeLine{483       out.row[i] = rhs.row[i];}
\DoxyCodeLine{484    \}}
\DoxyCodeLine{485    \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{486 \}}
\DoxyCodeLine{487 }
\DoxyCodeLine{488 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{489 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aeb8905fe10ee567358f1e3656ea21eb4}{CalculateTransposedMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_in) \{}
\DoxyCodeLine{490 }
\DoxyCodeLine{491    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} matrix\_out(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}, matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}, matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}});}
\DoxyCodeLine{492    }
\DoxyCodeLine{493    std::vector<std::int64\_t> row\_count(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{494    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}; ++i) \{}
\DoxyCodeLine{495       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++j) \{}
\DoxyCodeLine{496          \textcolor{keyword}{const} std::int64\_t row = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[j] + row\_count[j];}
\DoxyCodeLine{497          \textcolor{keywordflow}{if} (row < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[j + 1] \&\& matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row] == i) \{}
\DoxyCodeLine{498             matrix\_out.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row]);}
\DoxyCodeLine{499             matrix\_out.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(j);}
\DoxyCodeLine{500             row\_count[j]++;}
\DoxyCodeLine{501          \}}
\DoxyCodeLine{502       \}}
\DoxyCodeLine{503       matrix\_out.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] = matrix\_out.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{504    \}}
\DoxyCodeLine{505    }
\DoxyCodeLine{506    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{507 \}}
\DoxyCodeLine{508 }
\DoxyCodeLine{509 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{510 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Operator overloading-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{511 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{517 \textcolor{comment}{}\textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{518 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}+T2\{0\})> \textcolor{keyword}{operator}+(\textcolor{keyword}{const} CRS<T1> \&lhs, \textcolor{keyword}{const} CRS<T2> \&rhs) \{}
\DoxyCodeLine{519    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_afe9699b31d9d2e37532767c6039a813a}{CalculateMatrixMatrixSum}}(T1\{1\}, lhs, T2\{1\}, rhs);}
\DoxyCodeLine{520 \}}
\DoxyCodeLine{521 }
\DoxyCodeLine{527 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{528 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}-\/T2\{0\})> \textcolor{keyword}{operator}-\/(\textcolor{keyword}{const} CRS<T1> \&lhs, \textcolor{keyword}{const} CRS<T2> \&rhs) \{}
\DoxyCodeLine{529    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_afe9699b31d9d2e37532767c6039a813a}{CalculateMatrixMatrixSum}}(T1\{1\}, lhs, T2\{-\/1\}, rhs);}
\DoxyCodeLine{530 \}}
\DoxyCodeLine{531 }
\DoxyCodeLine{537 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{538 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\})> \textcolor{keyword}{operator}*(\textcolor{keyword}{const} CRS<T1> \&lhs, \textcolor{keyword}{const} CRS<T2> \&rhs) \{}
\DoxyCodeLine{539    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a84aff8ca71e76b722c47c396a0fc16e6}{CalculateMatrixMatrixProduct}}(T1\{1\}, lhs, rhs);}
\DoxyCodeLine{540 \}}
\DoxyCodeLine{541 }
\DoxyCodeLine{547 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{548 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\})> \textcolor{keyword}{operator}*(\textcolor{keyword}{const} T1 lhs, \textcolor{keyword}{const} CRS<T2> \&rhs) \{}
\DoxyCodeLine{549    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_adbcb79d1f723a5809d308d7073336a8f}{CalculateScalarMatrixProduct}}(lhs, rhs);}
\DoxyCodeLine{550 \}}
\DoxyCodeLine{551 }
\DoxyCodeLine{557 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{558 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}<\textcolor{keyword}{decltype}(T1\{0\}*T2\{0\})> \textcolor{keyword}{operator}*(\textcolor{keyword}{const} CRS<T1> \&lhs, \textcolor{keyword}{const} T2 rhs) \{}
\DoxyCodeLine{559    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_adbcb79d1f723a5809d308d7073336a8f}{CalculateScalarMatrixProduct}}(rhs, lhs);}
\DoxyCodeLine{560 \}}
\DoxyCodeLine{561 }
\DoxyCodeLine{567 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{568 \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abb6c59c798c127caa97ce367f9b8be0b}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<T2>}} \&rhs) \{}
\DoxyCodeLine{569    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}) \{}
\DoxyCodeLine{570       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{571    \}}
\DoxyCodeLine{572    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{573       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{574    \}}
\DoxyCodeLine{575    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.size() != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.size()) \{}
\DoxyCodeLine{576       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{577    \}}
\DoxyCodeLine{578    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}) \{}
\DoxyCodeLine{579       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{580    \}}
\DoxyCodeLine{581    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size() != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size()) \{}
\DoxyCodeLine{582       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{583    \}}
\DoxyCodeLine{584    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size() != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size()) \{}
\DoxyCodeLine{585       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{586    \}}
\DoxyCodeLine{587    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.size(); ++i) \{}
\DoxyCodeLine{588       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i] != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]) \{}
\DoxyCodeLine{589          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{590       \}}
\DoxyCodeLine{591    \}}
\DoxyCodeLine{592    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size(); ++i) \{}
\DoxyCodeLine{593       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i] != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[i]) \{}
\DoxyCodeLine{594          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{595       \}}
\DoxyCodeLine{596    \}}
\DoxyCodeLine{597    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size(); ++i) \{}
\DoxyCodeLine{598       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i] != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i]) \{}
\DoxyCodeLine{599          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{600       \}}
\DoxyCodeLine{601    \}}
\DoxyCodeLine{602    \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{603 \}}
\DoxyCodeLine{604 }
\DoxyCodeLine{610 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{611 \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_adcd40a447e73c362f846f73ec7d1be54}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<T2>}} \&rhs) \{}
\DoxyCodeLine{612    \textcolor{keywordflow}{return} !(lhs == rhs);}
\DoxyCodeLine{613 \}}
\DoxyCodeLine{614 }
\DoxyCodeLine{615 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{616 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Operator overloading: I/O Stream-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{617 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{622 \textcolor{comment}{}\textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{623 std::ostream\& \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a1e56b895c1f08b9af47da10a7d2bfb0e}{operator<<}}(std::ostream \&os, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&m) \{}
\DoxyCodeLine{624    os << std::fixed;}
\DoxyCodeLine{625    os << std::setprecision(16);}
\DoxyCodeLine{626    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{627       \textcolor{keywordflow}{for} (std::int64\_t j = m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.at(i); j < m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.at(i+1); ++j) \{}
\DoxyCodeLine{628          os << \textcolor{stringliteral}{"{}M["{}};}
\DoxyCodeLine{629          os << std::noshowpos << std::left << std::setw(3) << i << \textcolor{stringliteral}{"{}]["{}};}
\DoxyCodeLine{630          os << std::left << std::setw(3) << m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j] << \textcolor{stringliteral}{"{}]="{}};}
\DoxyCodeLine{631          os << std::showpos << m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] << std::endl;}
\DoxyCodeLine{632       \}}
\DoxyCodeLine{633    \}}
\DoxyCodeLine{634    \textcolor{keywordflow}{return} os;}
\DoxyCodeLine{635 \}}
\DoxyCodeLine{636 }
\DoxyCodeLine{637 }
\DoxyCodeLine{638 \} \textcolor{comment}{// namespace sparse\_matrix}}
\DoxyCodeLine{639 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{640 }
\DoxyCodeLine{641 }
\DoxyCodeLine{642 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SPARSE\_MATRIX\_COMPRESSED\_ROW\_STORAGE\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
