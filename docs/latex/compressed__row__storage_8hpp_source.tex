\hypertarget{compressed__row__storage_8hpp_source}{}\doxysection{compressed\+\_\+row\+\_\+storage.\+hpp}
\label{compressed__row__storage_8hpp_source}\index{src/sparse\_matrix/compressed\_row\_storage.hpp@{src/sparse\_matrix/compressed\_row\_storage.hpp}}
\mbox{\hyperlink{compressed__row__storage_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/05/20.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SPARSE\_MATRIX\_COMPRESSED\_ROW\_STORAGE\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SPARSE\_MATRIX\_COMPRESSED\_ROW\_STORAGE\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../type.hpp"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <iomanip>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{31 \textcolor{keyword}{namespace }sparse\_matrix \{}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{enum} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} \{}
\DoxyCodeLine{34    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{NONE}} = 0,}
\DoxyCodeLine{35    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{FERMION}} = 1}
\DoxyCodeLine{36 \};}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{39 \textcolor{keyword}{struct }\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \{}
\DoxyCodeLine{40    }
\DoxyCodeLine{41    \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} = 0;}
\DoxyCodeLine{42    \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} = 0;}
\DoxyCodeLine{43    std::vector<LInt> \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}};}
\DoxyCodeLine{44    std::vector<LInt> \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}};}
\DoxyCodeLine{45    std::vector<RealType> \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}};}
\DoxyCodeLine{46    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{47    }
\DoxyCodeLine{48    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ab1449c60ee044b7c0a290009fac0864e}{CRS}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} row\_dim\_in = 0, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} col\_dim\_in = 0, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} tag\_in = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}}) \{}
\DoxyCodeLine{49       this-\/>row\_dim = row\_dim\_in;}
\DoxyCodeLine{50       this-\/>col\_dim = col\_dim\_in;}
\DoxyCodeLine{51       this-\/>row.resize(row\_dim\_in + 1);}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{53       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i <= row\_dim\_in; ++i) \{}
\DoxyCodeLine{54          this-\/>row[i] = 0;}
\DoxyCodeLine{55       \}}
\DoxyCodeLine{56       this-\/>tag = tag\_in;}
\DoxyCodeLine{57    \}}
\DoxyCodeLine{58    }
\DoxyCodeLine{59    \textcolor{keyword}{explicit} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_abf651ae27c5d19a446933fce51a13ea6}{CRS}}(\textcolor{keyword}{const} std::vector<std::vector<RealType>> \&mat\_vec, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} tag\_in = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}}) \{}
\DoxyCodeLine{60       this-\/>row\_dim = mat\_vec.size();}
\DoxyCodeLine{61       this-\/>col\_dim = 0;}
\DoxyCodeLine{62       this-\/>row.resize(this-\/>row\_dim + 1);}
\DoxyCodeLine{63       this-\/>row[0] = 0;}
\DoxyCodeLine{64       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{65          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} size = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(mat\_vec[i].size());}
\DoxyCodeLine{66          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = 0; j < size;++j) \{}
\DoxyCodeLine{67             \textcolor{keywordflow}{if} (mat\_vec[i][j] != 0.0) \{}
\DoxyCodeLine{68                this-\/>col.push\_back(j);}
\DoxyCodeLine{69                this-\/>val.push\_back(mat\_vec[i][j]);}
\DoxyCodeLine{70             \}}
\DoxyCodeLine{71             \textcolor{keywordflow}{if} (this-\/>col\_dim < j + 1) \{}
\DoxyCodeLine{72                this-\/>col\_dim = j + 1;}
\DoxyCodeLine{73             \}}
\DoxyCodeLine{74          \}}
\DoxyCodeLine{75          this-\/>row[i + 1] = this-\/>col.size();}
\DoxyCodeLine{76       \}}
\DoxyCodeLine{77       this-\/>tag = tag\_in;}
\DoxyCodeLine{78    \}}
\DoxyCodeLine{79    }
\DoxyCodeLine{80    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a5fcddd1fd69cb414e15b7a35e173dfd9}{CRS}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix) \{}
\DoxyCodeLine{81       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ae9787c189eb909874211a098ba453ed7}{Assign}}(matrix);}
\DoxyCodeLine{82    \}}
\DoxyCodeLine{83    }
\DoxyCodeLine{84    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af3b2dc61ff6a6eb35e65e879cdc08ee4}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix) \& \{}
\DoxyCodeLine{85       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ae9787c189eb909874211a098ba453ed7}{Assign}}(matrix);}
\DoxyCodeLine{86       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{87    \}}
\DoxyCodeLine{88    }
\DoxyCodeLine{89    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ab9b4e491715df3d7826086bb3f9a2e54}{UpdateRow}}() \{}
\DoxyCodeLine{90       this-\/>row.push\_back(this-\/>col.size());}
\DoxyCodeLine{91    \}}
\DoxyCodeLine{92    }
\DoxyCodeLine{93    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ae9787c189eb909874211a098ba453ed7}{Assign}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&matrix) \{}
\DoxyCodeLine{94       this-\/>row\_dim = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}};}
\DoxyCodeLine{95       this-\/>col\_dim = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}};}
\DoxyCodeLine{96       this-\/>row.resize(matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} + 1);}
\DoxyCodeLine{97       }
\DoxyCodeLine{98       this-\/>col.resize(matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size());}
\DoxyCodeLine{99       this-\/>val.resize(matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size());}
\DoxyCodeLine{100       }
\DoxyCodeLine{101 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{102       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i <= matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{103          this-\/>row[i] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i];}
\DoxyCodeLine{104       \}}
\DoxyCodeLine{105       }
\DoxyCodeLine{106 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{107       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size(); ++i) \{}
\DoxyCodeLine{108          this-\/>col[i] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[i];}
\DoxyCodeLine{109          this-\/>val[i] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i];}
\DoxyCodeLine{110       \}}
\DoxyCodeLine{111       this-\/>tag = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}};}
\DoxyCodeLine{112    \}}
\DoxyCodeLine{113    }
\DoxyCodeLine{114    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a818173aa562d5c541552627b1570244f}{MultiplyByScalar}}(\textcolor{keyword}{const} RealType coeef) \{}
\DoxyCodeLine{115       \textcolor{keywordflow}{if} (coeef == 0.0) \{}
\DoxyCodeLine{116 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{117          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{118             this-\/>row[i + 1] = 0;}
\DoxyCodeLine{119          \}}
\DoxyCodeLine{120          this-\/>col.clear();}
\DoxyCodeLine{121          this-\/>val.clear();}
\DoxyCodeLine{122       \}}
\DoxyCodeLine{123       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{124 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{125          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>col.size(); ++i) \{}
\DoxyCodeLine{126             this-\/>val[i] *= coeef;}
\DoxyCodeLine{127          \}}
\DoxyCodeLine{128       \}}
\DoxyCodeLine{129    \}}
\DoxyCodeLine{130    }
\DoxyCodeLine{131    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6050c1888c1b37645e19d7379c19c4ad}{MultiplyByScalar}}(\textcolor{keyword}{const} RealType coeef)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{132       \textcolor{keywordflow}{if} (coeef == 0.0) \{}
\DoxyCodeLine{133          \textcolor{keywordflow}{return} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ab1449c60ee044b7c0a290009fac0864e}{CRS}}(this-\/>row\_dim, this-\/>col\_dim, this-\/>tag);}
\DoxyCodeLine{134       \}}
\DoxyCodeLine{135       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{136          \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} m = *\textcolor{keyword}{this};}
\DoxyCodeLine{137 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{138          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size(); ++i) \{}
\DoxyCodeLine{139             m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i] *= coeef;}
\DoxyCodeLine{140          \}}
\DoxyCodeLine{141          \textcolor{keywordflow}{return} m;}
\DoxyCodeLine{142       \}}
\DoxyCodeLine{143    \}}
\DoxyCodeLine{144    }
\DoxyCodeLine{145    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad64678d1387884cbf00aefd936ee3f36}{DiagonalScaling}}(\textcolor{keyword}{const} RealType diag\_add) \{}
\DoxyCodeLine{146       \textcolor{keywordflow}{if} (this-\/>row\_dim != this-\/>col\_dim) \{}
\DoxyCodeLine{147          std::stringstream ss;}
\DoxyCodeLine{148          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{149          ss << \textcolor{stringliteral}{"{}The matrix is not a square matrix."{}} << std::endl;}
\DoxyCodeLine{150          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{151       \}}
\DoxyCodeLine{152 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{153       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{154          \textcolor{keywordtype}{bool} flag = \textcolor{keyword}{true};}
\DoxyCodeLine{155          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = this-\/>row[i]; j < this-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{156             \textcolor{keywordflow}{if} (i == this-\/>col[j]) \{}
\DoxyCodeLine{157                this-\/>val[j] += diag\_add;}
\DoxyCodeLine{158                flag = \textcolor{keyword}{false};}
\DoxyCodeLine{159                \textcolor{keywordflow}{break};}
\DoxyCodeLine{160             \}}
\DoxyCodeLine{161          \}}
\DoxyCodeLine{162          \textcolor{keywordflow}{if} (flag) \{}
\DoxyCodeLine{163 \textcolor{preprocessor}{\#pragma omp critical}}
\DoxyCodeLine{164             \{}
\DoxyCodeLine{165                std::stringstream ss;}
\DoxyCodeLine{166                ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{167                ss << \textcolor{stringliteral}{"{}Some of the diagonal components are not registered."{}} << std::endl;}
\DoxyCodeLine{168                \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{169             \}}
\DoxyCodeLine{170          \}}
\DoxyCodeLine{171       \}}
\DoxyCodeLine{172    \}}
\DoxyCodeLine{173    }
\DoxyCodeLine{174    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a5ad7bce09d843653a2e9e6651ef2a7eb}{Free}}() \{}
\DoxyCodeLine{175       this-\/>row\_dim = 0;}
\DoxyCodeLine{176       this-\/>col\_dim = 0;}
\DoxyCodeLine{177       std::vector<LInt>().swap(this-\/>row);}
\DoxyCodeLine{178       std::vector<LInt>().swap(this-\/>col);}
\DoxyCodeLine{179       std::vector<RealType>().swap(this-\/>val);}
\DoxyCodeLine{180       this-\/>row.push\_back(0);}
\DoxyCodeLine{181       this-\/>tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{182    \}}
\DoxyCodeLine{183    }
\DoxyCodeLine{184    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ac196a07cc2959d23578ef9e25d2121c2}{Clear}}() \{}
\DoxyCodeLine{185       this-\/>row\_dim = 0;}
\DoxyCodeLine{186       this-\/>col\_dim = 0;}
\DoxyCodeLine{187       this-\/>row.clear();}
\DoxyCodeLine{188       this-\/>col.clear();}
\DoxyCodeLine{189       this-\/>val.clear();}
\DoxyCodeLine{190       this-\/>row.push\_back(0);}
\DoxyCodeLine{191       this-\/>tag = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{192    \}}
\DoxyCodeLine{193    }
\DoxyCodeLine{194    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a461f3df023c6215768aca60b9743fe0c}{SortCol}}() \{}
\DoxyCodeLine{195 \textcolor{preprocessor}{\#pragma omp parallel for schedule (guided)}}
\DoxyCodeLine{196       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{197          utility::QuickSort<LInt, RealType>(\&this-\/>col, \&this-\/>val, this-\/>row[i], this-\/>row[i + 1]);}
\DoxyCodeLine{198       \}}
\DoxyCodeLine{199    \}}
\DoxyCodeLine{200    }
\DoxyCodeLine{201    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4bec11205690c0b77b91e262356d49e7}{PrintMatrix}}(\textcolor{keyword}{const} std::string display\_name = \textcolor{stringliteral}{"{}Matrix"{}})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{202       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{203          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = this-\/>row.at(i); j < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}.at(i+1); ++j) \{}
\DoxyCodeLine{204             std::cout << display\_name << \textcolor{stringliteral}{"{}["{}};}
\DoxyCodeLine{205             std::cout << std::noshowpos << std::left << std::setw(3) << i << \textcolor{stringliteral}{"{}]["{}};}
\DoxyCodeLine{206             std::cout << std::left << std::setw(3) << this-\/>col[j] << \textcolor{stringliteral}{"{}]="{}};}
\DoxyCodeLine{207             std::cout << std::showpos << this-\/>val[j] << std::endl;}
\DoxyCodeLine{208          \}}
\DoxyCodeLine{209       \}}
\DoxyCodeLine{210       std::cout << std::noshowpos;}
\DoxyCodeLine{211    \}}
\DoxyCodeLine{212    }
\DoxyCodeLine{213    \textcolor{keywordtype}{void} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a984f9042aade4c462eca059bb64ee346}{PrintInfo}}(\textcolor{keyword}{const} std::string display\_name = \textcolor{stringliteral}{"{}Matrix"{}})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{214       std::cout << \textcolor{stringliteral}{"{}Print information about CRS: "{}} << display\_name << std::endl;}
\DoxyCodeLine{215       std::cout << \textcolor{stringliteral}{"{}row\_dim = "{}} << this-\/>row\_dim << std::endl;}
\DoxyCodeLine{216       std::cout << \textcolor{stringliteral}{"{}col\_dim = "{}} << this-\/>col\_dim << std::endl;}
\DoxyCodeLine{217       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>row.size(); ++i) \{}
\DoxyCodeLine{218          std::cout << \textcolor{stringliteral}{"{}row["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>row.at(i) << std::endl;}
\DoxyCodeLine{219       \}}
\DoxyCodeLine{220       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>col.size(); ++i) \{}
\DoxyCodeLine{221          std::cout << \textcolor{stringliteral}{"{}col["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>col.at(i) << std::endl;}
\DoxyCodeLine{222       \}}
\DoxyCodeLine{223       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>val.size(); ++i) \{}
\DoxyCodeLine{224          std::cout << \textcolor{stringliteral}{"{}val["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>val.at(i) << std::endl;}
\DoxyCodeLine{225       \}}
\DoxyCodeLine{226    \}}
\DoxyCodeLine{227    }
\DoxyCodeLine{228    \textcolor{keywordtype}{bool} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a2d8712384b5f694bfd6d8e51eed2888d}{isSymmetric}}(\textcolor{keyword}{const} RealType threshold = 0.000000000000001\textcolor{comment}{/*pow(10,-\/15)*/})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{229       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < this-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{230          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = this-\/>row[i]; j < this-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{231             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_begin = this-\/>col.begin() + this-\/>row[\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]];}
\DoxyCodeLine{232             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_end   = this-\/>col.begin() + this-\/>row[\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j] + 1];}
\DoxyCodeLine{233             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_find  = std::lower\_bound(iter\_begin, iter\_end, i);}
\DoxyCodeLine{234             \textcolor{keywordflow}{if} (iter\_find == iter\_end || *iter\_find != i) \{}
\DoxyCodeLine{235                std::cout << \textcolor{stringliteral}{"{}The input matrix is not symmetric."{}} << std::endl;}
\DoxyCodeLine{236                std::cout << \textcolor{stringliteral}{"{}Corresponding element does not exist."{}} << std::endl;}
\DoxyCodeLine{237                std::cout << \textcolor{stringliteral}{"{}row="{}} << i << \textcolor{stringliteral}{"{}, col="{}} << \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j] << \textcolor{stringliteral}{"{}, val="{}} << \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] << std::endl;}
\DoxyCodeLine{238                \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{239             \}}
\DoxyCodeLine{240             \textcolor{keyword}{const} \textcolor{keyword}{auto} inv = std::distance(iter\_begin, iter\_find);}
\DoxyCodeLine{241             \textcolor{keywordflow}{if} (std::abs(this-\/>val[j] -\/ this-\/>val[inv]) > threshold) \{}
\DoxyCodeLine{242                std::cout << \textcolor{stringliteral}{"{}The input matrix is not symmetric."{}} << std::endl;}
\DoxyCodeLine{243                std::cout << \textcolor{stringliteral}{"{}M["{}} << i << \textcolor{stringliteral}{"{}]["{}} << this-\/>col[j] << \textcolor{stringliteral}{"{}]="{}} << this-\/>val[j] << \textcolor{stringliteral}{"{}, "{}} << this-\/>val[inv] << \textcolor{stringliteral}{"{}=M["{}} << this-\/>col[j] << \textcolor{stringliteral}{"{}]["{}} << i << \textcolor{stringliteral}{"{}]"{}} << std::endl;}
\DoxyCodeLine{244                \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{245             \}}
\DoxyCodeLine{246          \}}
\DoxyCodeLine{247       \}}
\DoxyCodeLine{248       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{249    \}}
\DoxyCodeLine{250    }
\DoxyCodeLine{251 \};}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{comment}{//Operator overloading}}
\DoxyCodeLine{254 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{255 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab80c1b46b8f1a7e3d4fd6686ee455d44}{operator+}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&rhs) \{}
\DoxyCodeLine{256    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{CalculateMatrixMatrixSum}}(1.0, lhs, 1.0, rhs);}
\DoxyCodeLine{257 \}}
\DoxyCodeLine{258 }
\DoxyCodeLine{259 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{260 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a76a74686b1e0447d7ccd33bf29063f0a}{operator-\/}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&rhs) \{}
\DoxyCodeLine{261    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{CalculateMatrixMatrixSum}}(1.0, lhs, -\/1.0, rhs);}
\DoxyCodeLine{262 \}}
\DoxyCodeLine{263 }
\DoxyCodeLine{264 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{265 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_afc5b1fce88850c2e46c2b8efad188d59}{operator*}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&rhs) \{}
\DoxyCodeLine{266    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{CalculateMatrixMatrixProduct}}(1.0, lhs, 1.0, rhs);}
\DoxyCodeLine{267 \}}
\DoxyCodeLine{268 }
\DoxyCodeLine{269 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{270 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_afc5b1fce88850c2e46c2b8efad188d59}{operator*}}(\textcolor{keyword}{const} RealType \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&rhs) \{}
\DoxyCodeLine{271    \textcolor{keywordflow}{return} rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a818173aa562d5c541552627b1570244f}{MultiplyByScalar}}(lhs);}
\DoxyCodeLine{272 \}}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{275 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_afc5b1fce88850c2e46c2b8efad188d59}{operator*}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&lhs, \textcolor{keyword}{const} RealType \&rhs) \{}
\DoxyCodeLine{276    \textcolor{keywordflow}{return} lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a818173aa562d5c541552627b1570244f}{MultiplyByScalar}}(rhs);}
\DoxyCodeLine{277 \}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{280 \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a49f523fe4883113284aa74f545f307fc}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&rhs) \{}
\DoxyCodeLine{281    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}) \{}
\DoxyCodeLine{282       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{283    \}}
\DoxyCodeLine{284    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}}) \{}
\DoxyCodeLine{285       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{286    \}}
\DoxyCodeLine{287    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}.size() != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}.size()) \{}
\DoxyCodeLine{288       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{289    \}}
\DoxyCodeLine{290    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}) \{}
\DoxyCodeLine{291       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{292    \}}
\DoxyCodeLine{293    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size() != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size()) \{}
\DoxyCodeLine{294       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{295    \}}
\DoxyCodeLine{296    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size() != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size()) \{}
\DoxyCodeLine{297       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{298    \}}
\DoxyCodeLine{299    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}.size(); ++i) \{}
\DoxyCodeLine{300       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i] != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]) \{}
\DoxyCodeLine{301          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{302       \}}
\DoxyCodeLine{303    \}}
\DoxyCodeLine{304    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size(); ++i) \{}
\DoxyCodeLine{305       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[i] != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[i]) \{}
\DoxyCodeLine{306          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{307       \}}
\DoxyCodeLine{308    \}}
\DoxyCodeLine{309    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.size(); ++i) \{}
\DoxyCodeLine{310       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i] != rhs.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[i]) \{}
\DoxyCodeLine{311          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{312       \}}
\DoxyCodeLine{313    \}}
\DoxyCodeLine{314    \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{315 \}}
\DoxyCodeLine{316 }
\DoxyCodeLine{317 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{318 \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a3d5c87f0498c3f912ab74e67176c9297}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&rhs) \{}
\DoxyCodeLine{319    \textcolor{keywordflow}{return} !(lhs == rhs);}
\DoxyCodeLine{320 \}}
\DoxyCodeLine{321 }
\DoxyCodeLine{322 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{323 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{CalculateTransposedMatrix}}(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} *matrix\_out, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_in) \{}
\DoxyCodeLine{324    }
\DoxyCodeLine{325    std::vector<LInt> row\_count(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}});}
\DoxyCodeLine{326    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ac196a07cc2959d23578ef9e25d2121c2}{Clear}}();}
\DoxyCodeLine{327    \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}}; ++i) \{}
\DoxyCodeLine{328       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = 0; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++j) \{}
\DoxyCodeLine{329          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} row = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[j] + row\_count[j];}
\DoxyCodeLine{330          \textcolor{keywordflow}{if} (row < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[j + 1] \&\& matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row] == i) \{}
\DoxyCodeLine{331             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row]);}
\DoxyCodeLine{332             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(j);}
\DoxyCodeLine{333             row\_count[j]++;}
\DoxyCodeLine{334          \}}
\DoxyCodeLine{335       \}}
\DoxyCodeLine{336       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}.push\_back(matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size());}
\DoxyCodeLine{337    \}}
\DoxyCodeLine{338    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}};}
\DoxyCodeLine{339    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}};}
\DoxyCodeLine{340    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}     = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}};}
\DoxyCodeLine{341 \}}
\DoxyCodeLine{342 }
\DoxyCodeLine{343 }
\DoxyCodeLine{344 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{345 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{CalculateTransposedMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_in) \{}
\DoxyCodeLine{346    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} matrix\_out;}
\DoxyCodeLine{347    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{CalculateTransposedMatrix}}(\&matrix\_out, matrix\_in);}
\DoxyCodeLine{348    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{349 \}}
\DoxyCodeLine{350 }
\DoxyCodeLine{351 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{352 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{CalculateMatrixMatrixProduct}}(\textcolor{keyword}{const} RealType coeef\_1,}
\DoxyCodeLine{353                                            \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_1,}
\DoxyCodeLine{354                                            \textcolor{keyword}{const} RealType coeef\_2,}
\DoxyCodeLine{355                                            \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_2) \{}
\DoxyCodeLine{356    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} m;}
\DoxyCodeLine{357    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{CalculateMatrixMatrixProduct}}(\&m, coeef\_1, matrix\_1, coeef\_2, matrix\_2);}
\DoxyCodeLine{358    \textcolor{keywordflow}{return} m;}
\DoxyCodeLine{359 \}}
\DoxyCodeLine{360 }
\DoxyCodeLine{361 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{362 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{CalculateMatrixMatrixProduct}}(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} *matrix\_out,}
\DoxyCodeLine{363                                   \textcolor{keyword}{const} RealType coeef\_1,}
\DoxyCodeLine{364                                   \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_1,}
\DoxyCodeLine{365                                   \textcolor{keyword}{const} RealType coeef\_2,}
\DoxyCodeLine{366                                   \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_2) \{}
\DoxyCodeLine{367    }
\DoxyCodeLine{368    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}) \{}
\DoxyCodeLine{369       std::stringstream ss;}
\DoxyCodeLine{370       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{371       ss << \textcolor{stringliteral}{"{}Matrix product cannot be defined"{}} << std::endl;}
\DoxyCodeLine{372       ss << \textcolor{stringliteral}{"{}matrix\_1.col\_dim = "{}} << matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} << \textcolor{stringliteral}{"{}, matrix\_2.row\_dim = "{}} << matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} << std::endl;}
\DoxyCodeLine{373       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{374    \}}
\DoxyCodeLine{375    }
\DoxyCodeLine{376    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ac196a07cc2959d23578ef9e25d2121c2}{Clear}}();}
\DoxyCodeLine{377    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}.resize(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} + 1);}
\DoxyCodeLine{378    }
\DoxyCodeLine{379    std::vector<RealType> temp\_v1(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}}, 0.0);}
\DoxyCodeLine{380    std::vector<RealType> temp\_v2(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}}, 0.0);}
\DoxyCodeLine{381    }
\DoxyCodeLine{382    \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{383       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{384          temp\_v1[matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]] = coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{385       \}}
\DoxyCodeLine{386       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = 0; j < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}}; ++j) \{}
\DoxyCodeLine{387          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} k = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[j]; k < matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[j + 1]; ++k) \{}
\DoxyCodeLine{388             temp\_v2[matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[k]] += temp\_v1[j]*coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[k];}
\DoxyCodeLine{389          \}}
\DoxyCodeLine{390       \}}
\DoxyCodeLine{391       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = 0; j < matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}}; ++j) \{}
\DoxyCodeLine{392          \textcolor{keywordflow}{if} (std::abs(temp\_v2[j]) > 0.0) \{}
\DoxyCodeLine{393             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(temp\_v2[j]);}
\DoxyCodeLine{394             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(j);}
\DoxyCodeLine{395          \}}
\DoxyCodeLine{396       \}}
\DoxyCodeLine{397       }
\DoxyCodeLine{398       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1] = matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{399       }
\DoxyCodeLine{400       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{401          temp\_v1[matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]] = 0.0;}
\DoxyCodeLine{402       \}}
\DoxyCodeLine{403       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < matrix\_out-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{404          temp\_v2[matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]] = 0.0;}
\DoxyCodeLine{405       \}}
\DoxyCodeLine{406    \}}
\DoxyCodeLine{407    }
\DoxyCodeLine{408    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}};}
\DoxyCodeLine{409    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}};}
\DoxyCodeLine{410    }
\DoxyCodeLine{411    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}) \{}
\DoxyCodeLine{412       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{413    \}}
\DoxyCodeLine{414    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{415       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}};}
\DoxyCodeLine{416    \}}
\DoxyCodeLine{417    }
\DoxyCodeLine{418 \}}
\DoxyCodeLine{419 }
\DoxyCodeLine{420 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{421 \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{CalculateMatrixMatrixSum}}(\textcolor{keyword}{const} RealType coeef\_1,}
\DoxyCodeLine{422                                        \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_1,}
\DoxyCodeLine{423                                        \textcolor{keyword}{const} RealType coeef\_2,}
\DoxyCodeLine{424                                        \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_2) \{}
\DoxyCodeLine{425    }
\DoxyCodeLine{426    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} m;}
\DoxyCodeLine{427    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{CalculateMatrixMatrixSum}}(\&m, coeef\_1, matrix\_1, coeef\_2, matrix\_2);}
\DoxyCodeLine{428    \textcolor{keywordflow}{return} m;}
\DoxyCodeLine{429    }
\DoxyCodeLine{430 \}}
\DoxyCodeLine{431 }
\DoxyCodeLine{432 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{433 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{CalculateMatrixMatrixSum}}(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} *matrix\_out,}
\DoxyCodeLine{434                               \textcolor{keyword}{const} RealType coeef\_1,}
\DoxyCodeLine{435                               \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_1,}
\DoxyCodeLine{436                               \textcolor{keyword}{const} RealType coeef\_2,}
\DoxyCodeLine{437                               \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_2) \{}
\DoxyCodeLine{438    }
\DoxyCodeLine{439    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} || matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}}) \{}
\DoxyCodeLine{440       std::stringstream ss;}
\DoxyCodeLine{441       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{442       ss << \textcolor{stringliteral}{"{}The summation of the matrices cannot be defined."{}} << std::endl;}
\DoxyCodeLine{443       ss << \textcolor{stringliteral}{"{}matrix\_1.row\_dim = "{}} << matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} << \textcolor{stringliteral}{"{}, matrix\_1.col\_dim = "{}} << matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} << std::endl;}
\DoxyCodeLine{444       ss << \textcolor{stringliteral}{"{}matrix\_2.row\_dim = "{}} << matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}} << \textcolor{stringliteral}{"{}, matrix\_2.col\_dim = "{}} << matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}} << std::endl;}
\DoxyCodeLine{445       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{446    \}}
\DoxyCodeLine{447    }
\DoxyCodeLine{448    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}) \{}
\DoxyCodeLine{449       std::stringstream ss;}
\DoxyCodeLine{450       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{451       ss << \textcolor{stringliteral}{"{}The summation of bosonic and fermionic operator cannot be defined."{}} << std::endl;}
\DoxyCodeLine{452       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{453    \}}
\DoxyCodeLine{454    }
\DoxyCodeLine{455    *matrix\_out = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}}(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}, matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad85231132bd7a45bbc447fa02c10f0be}{col\_dim}});}
\DoxyCodeLine{456    \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{457       }
\DoxyCodeLine{458       \textcolor{keywordtype}{int} check = 0;}
\DoxyCodeLine{459       \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} count\_1 = 0;}
\DoxyCodeLine{460       \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} count\_2 = 0;}
\DoxyCodeLine{461       }
\DoxyCodeLine{462       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} row\_lower\_1 = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[  i  ];}
\DoxyCodeLine{463       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} row\_upper\_1 = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1];}
\DoxyCodeLine{464       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} row\_lower\_2 = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[  i  ];}
\DoxyCodeLine{465       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} row\_upper\_2 = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1];}
\DoxyCodeLine{466       }
\DoxyCodeLine{467       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} m1\_count = row\_upper\_1 -\/ row\_lower\_1;}
\DoxyCodeLine{468       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} m2\_count = row\_upper\_2 -\/ row\_lower\_2;}
\DoxyCodeLine{469       }
\DoxyCodeLine{470       \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count == 0) \{}
\DoxyCodeLine{471          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = row\_lower\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{472             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{473             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]);}
\DoxyCodeLine{474          \}}
\DoxyCodeLine{475       \}}
\DoxyCodeLine{476       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count == 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{477          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = row\_lower\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{478             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{479             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]);}
\DoxyCodeLine{480          \}}
\DoxyCodeLine{481       \}}
\DoxyCodeLine{482       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{483          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = 0; j < m1\_count + m2\_count; ++j) \{}
\DoxyCodeLine{484             \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row\_lower\_1 + count\_1] < matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{485                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{486                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{487                count\_1++;}
\DoxyCodeLine{488                \textcolor{keywordflow}{if} (row\_lower\_1 + count\_1 == row\_upper\_1) \{}
\DoxyCodeLine{489                   check = 1;}
\DoxyCodeLine{490                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{491                \}}
\DoxyCodeLine{492             \}}
\DoxyCodeLine{493             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row\_lower\_1 + count\_1] == matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{494                \textcolor{keyword}{const} RealType val = coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_1 + count\_1] + coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_2 + count\_2];}
\DoxyCodeLine{495                \textcolor{keywordflow}{if} (std::abs(val) > 0.0) \{}
\DoxyCodeLine{496                   matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(val);}
\DoxyCodeLine{497                   matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{498                   count\_1++;}
\DoxyCodeLine{499                   count\_2++;}
\DoxyCodeLine{500                   \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{501                   \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{502                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{503                      check = 1;}
\DoxyCodeLine{504                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{505                   \}}
\DoxyCodeLine{506                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{507                      check = 2;}
\DoxyCodeLine{508                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{509                   \}}
\DoxyCodeLine{510                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{511                      check = 0;}
\DoxyCodeLine{512                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{513                   \}}
\DoxyCodeLine{514                \}}
\DoxyCodeLine{515                \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{516                   count\_1++;}
\DoxyCodeLine{517                   count\_2++;}
\DoxyCodeLine{518                   \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{519                   \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{520                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{521                      check = 1;}
\DoxyCodeLine{522                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{523                   \}}
\DoxyCodeLine{524                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{525                      check = 2;}
\DoxyCodeLine{526                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{527                   \}}
\DoxyCodeLine{528                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{529                      check = 0;}
\DoxyCodeLine{530                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{531                   \}}
\DoxyCodeLine{532                \}}
\DoxyCodeLine{533             \}}
\DoxyCodeLine{534             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{535                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{536                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{537                count\_2++;}
\DoxyCodeLine{538                \textcolor{keywordflow}{if} (row\_lower\_2 + count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{539                   check = 2;}
\DoxyCodeLine{540                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{541                \}}
\DoxyCodeLine{542             \}}
\DoxyCodeLine{543          \}}
\DoxyCodeLine{544          \textcolor{keywordflow}{if} (check == 1) \{}
\DoxyCodeLine{545             \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = row\_lower\_2 + count\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{546                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{547                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]);}
\DoxyCodeLine{548             \}}
\DoxyCodeLine{549          \}}
\DoxyCodeLine{550          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (check == 2) \{}
\DoxyCodeLine{551             \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = row\_lower\_1 + count\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{552                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{553                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j]);}
\DoxyCodeLine{554             \}}
\DoxyCodeLine{555          \}}
\DoxyCodeLine{556       \}}
\DoxyCodeLine{557       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1] = matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{558    \}}
\DoxyCodeLine{559    }
\DoxyCodeLine{560    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}};}
\DoxyCodeLine{561    }
\DoxyCodeLine{562 \}}
\DoxyCodeLine{563 }
\DoxyCodeLine{564 }
\DoxyCodeLine{565 }
\DoxyCodeLine{566 }
\DoxyCodeLine{567 \} \textcolor{comment}{// namespace sparse\_matrix}}
\DoxyCodeLine{568 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{569 }
\DoxyCodeLine{570 }
\DoxyCodeLine{571 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SPARSE\_MATRIX\_COMPRESSED\_ROW\_STORAGE\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
