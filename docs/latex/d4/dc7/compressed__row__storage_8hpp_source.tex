\hypertarget{compressed__row__storage_8hpp_source}{}\doxysection{compressed\+\_\+row\+\_\+storage.\+hpp}
\label{compressed__row__storage_8hpp_source}\index{src/type/compressed\_row\_storage.hpp@{src/type/compressed\_row\_storage.hpp}}
\mbox{\hyperlink{compressed__row__storage_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/05/20.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_TYPE\_COMPRESSED\_ROW\_STORAGE\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_TYPE\_COMPRESSED\_ROW\_STORAGE\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <iomanip>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{28 \textcolor{keyword}{namespace }type \{}
\DoxyCodeLine{29 }
\DoxyCodeLine{31 \textcolor{keyword}{enum} \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11b}{CRSTag}} \{}
\DoxyCodeLine{32    }
\DoxyCodeLine{34    \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{NONE}} = 0,}
\DoxyCodeLine{35    }
\DoxyCodeLine{37    \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{FERMION}} = 1,}
\DoxyCodeLine{38    }
\DoxyCodeLine{40    \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{BOSON}} = 2,}
\DoxyCodeLine{41    }
\DoxyCodeLine{43    \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{MIX}} = 3}
\DoxyCodeLine{44 \};}
\DoxyCodeLine{45 }
\DoxyCodeLine{49 std::ostream\& \mbox{\hyperlink{namespacecompnal_1_1type_ab565f905bc0e0a4cdea7cbee1b5c0da1}{operator<<}}(std::ostream \&os, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11b}{CRSTag}} \&tag) \{}
\DoxyCodeLine{50    \textcolor{keywordflow}{if} (tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}}) \{}
\DoxyCodeLine{51       os << \textcolor{stringliteral}{"{}CRSTag::NONE"{}};}
\DoxyCodeLine{52    \}}
\DoxyCodeLine{53    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}}) \{}
\DoxyCodeLine{54       os << \textcolor{stringliteral}{"{}CRSTag::FERMION"{}};}
\DoxyCodeLine{55    \}}
\DoxyCodeLine{56    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}}) \{}
\DoxyCodeLine{57       os << \textcolor{stringliteral}{"{}CRSTag::BOSON"{}};}
\DoxyCodeLine{58    \}}
\DoxyCodeLine{59    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}}) \{}
\DoxyCodeLine{60       os << \textcolor{stringliteral}{"{}CRSTag::MIX"{}};}
\DoxyCodeLine{61    \}}
\DoxyCodeLine{62    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{63       std::stringstream ss;}
\DoxyCodeLine{64       ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{65       ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{66       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{67    \}}
\DoxyCodeLine{68    \textcolor{keywordflow}{return} os;}
\DoxyCodeLine{69 \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 }
\DoxyCodeLine{74 \textcolor{keyword}{template}<\textcolor{keyword}{typename} ElementType>}
\DoxyCodeLine{75 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \{}
\DoxyCodeLine{76    }
\DoxyCodeLine{77 \textcolor{keyword}{public}:}
\DoxyCodeLine{78    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{79    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Type Alias-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{80    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{82 \textcolor{comment}{}   \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a22bb8787abc4618bc014aa842be4a763}{ValueType}} = ElementType;}
\DoxyCodeLine{83    }
\DoxyCodeLine{84    }
\DoxyCodeLine{85    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{86    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Variables-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{87    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{89 \textcolor{comment}{}   std::int64\_t \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} = 0;}
\DoxyCodeLine{90    }
\DoxyCodeLine{92    std::int64\_t \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}} = 0;}
\DoxyCodeLine{93    }
\DoxyCodeLine{95    std::vector<std::int64\_t> \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}} = \{0\};}
\DoxyCodeLine{96    }
\DoxyCodeLine{98    std::vector<std::int64\_t> \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}};}
\DoxyCodeLine{99    }
\DoxyCodeLine{101    std::vector<ElementType> \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}};}
\DoxyCodeLine{102    }
\DoxyCodeLine{104    \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11b}{CRSTag}} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}};}
\DoxyCodeLine{105    }
\DoxyCodeLine{107    std::string \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8ff961838014a2146c4e570ebbb85840}{name}} = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{108    }
\DoxyCodeLine{109    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{110    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{111    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{113 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a76dae7aa62d63f21ecfa49eb3a73b721}{CRS}}() \{\};}
\DoxyCodeLine{114       }
\DoxyCodeLine{119    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a717531e4c418f1da4ee500ff751b154a}{CRS}}(\textcolor{keyword}{const} std::int64\_t row\_dim\_in, \textcolor{keyword}{const} std::int64\_t col\_dim\_in, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11b}{CRSTag}} tag\_in = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}}) \{}
\DoxyCodeLine{120       }
\DoxyCodeLine{121       this-\/>row\_dim = row\_dim\_in;}
\DoxyCodeLine{122       this-\/>col\_dim = col\_dim\_in;}
\DoxyCodeLine{123       this-\/>row.resize(row\_dim\_in + 1);}
\DoxyCodeLine{124 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{125       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i <= row\_dim\_in; ++i) \{}
\DoxyCodeLine{126          this-\/>row[i] = 0;}
\DoxyCodeLine{127       \}}
\DoxyCodeLine{128       this-\/>tag = tag\_in;}
\DoxyCodeLine{129    \}}
\DoxyCodeLine{130    }
\DoxyCodeLine{135    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T=ElementType>}
\DoxyCodeLine{136    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a5025f416b1ed779c591da43d30df2edb}{CRS}}(\textcolor{keyword}{const} std::vector<std::vector<T>> \&mat\_vec, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11b}{CRSTag}} tag\_in = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}}) \{}
\DoxyCodeLine{137       this-\/>row\_dim = mat\_vec.size();}
\DoxyCodeLine{138       this-\/>col\_dim = 0;}
\DoxyCodeLine{139       this-\/>row.resize(this-\/>row\_dim + 1);}
\DoxyCodeLine{140       this-\/>row[0] = 0;}
\DoxyCodeLine{141       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{142          \textcolor{keyword}{const} std::int64\_t size = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(mat\_vec[i].size());}
\DoxyCodeLine{143          \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < size;++j) \{}
\DoxyCodeLine{144             \textcolor{keywordflow}{if} (mat\_vec[i][j] != 0.0) \{}
\DoxyCodeLine{145                this-\/>col.push\_back(j);}
\DoxyCodeLine{146                this-\/>val.push\_back(mat\_vec[i][j]);}
\DoxyCodeLine{147             \}}
\DoxyCodeLine{148             \textcolor{keywordflow}{if} (this-\/>col\_dim < j + 1) \{}
\DoxyCodeLine{149                this-\/>col\_dim = j + 1;}
\DoxyCodeLine{150             \}}
\DoxyCodeLine{151          \}}
\DoxyCodeLine{152          this-\/>row[i + 1] = this-\/>col.size();}
\DoxyCodeLine{153       \}}
\DoxyCodeLine{154       this-\/>tag = tag\_in;}
\DoxyCodeLine{155    \}}
\DoxyCodeLine{156    }
\DoxyCodeLine{160    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{161    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a794c0b1737646f1aba58f923c1d19070}{CRS}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} \&matrix) \{}
\DoxyCodeLine{162       \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac4696f6f7423080adbdbc490d49f0b0a}{Assign}}(matrix);}
\DoxyCodeLine{163    \}}
\DoxyCodeLine{164    }
\DoxyCodeLine{165    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{166    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{167    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{169 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a1ff94881b52233a2903d369e398e907a}{Free}}() \{}
\DoxyCodeLine{170       this-\/>row\_dim = 0;}
\DoxyCodeLine{171       this-\/>col\_dim = 0;}
\DoxyCodeLine{172       std::vector<std::int64\_t>().swap(this-\/>row);}
\DoxyCodeLine{173       std::vector<std::int64\_t>().swap(this-\/>col);}
\DoxyCodeLine{174       std::vector<ElementType>().swap(this-\/>val);}
\DoxyCodeLine{175       this-\/>row.push\_back(0);}
\DoxyCodeLine{176       this-\/>tag = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}};}
\DoxyCodeLine{177       this-\/>name = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{178    \}}
\DoxyCodeLine{179    }
\DoxyCodeLine{183    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{184    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac4696f6f7423080adbdbc490d49f0b0a}{Assign}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} \&matrix) \{}
\DoxyCodeLine{185       this-\/>row\_dim = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}};}
\DoxyCodeLine{186       this-\/>col\_dim = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}};}
\DoxyCodeLine{187       this-\/>row.resize(matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} + 1);}
\DoxyCodeLine{188       }
\DoxyCodeLine{189       this-\/>col.resize(matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size());}
\DoxyCodeLine{190       this-\/>val.resize(matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size());}
\DoxyCodeLine{191       }
\DoxyCodeLine{192 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{193       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i <= matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{194          this-\/>row[i] = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i];}
\DoxyCodeLine{195       \}}
\DoxyCodeLine{196       }
\DoxyCodeLine{197 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{198       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size(); ++i) \{}
\DoxyCodeLine{199          this-\/>col[i] = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[i];}
\DoxyCodeLine{200          this-\/>val[i] = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i];}
\DoxyCodeLine{201       \}}
\DoxyCodeLine{202       this-\/>tag = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}};}
\DoxyCodeLine{203       this-\/>name = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8ff961838014a2146c4e570ebbb85840}{name}};}
\DoxyCodeLine{204    \}}
\DoxyCodeLine{205    }
\DoxyCodeLine{209    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{210    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a1ce10267ddf6fd06620f57bc9b0a7e43}{MultiplyByScalar}}(\textcolor{keyword}{const} T coeff) \{}
\DoxyCodeLine{211       \textcolor{keywordflow}{if} (coeff == 0.0) \{}
\DoxyCodeLine{212 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{213          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{214             this-\/>row[i + 1] = 0;}
\DoxyCodeLine{215          \}}
\DoxyCodeLine{216          this-\/>col.clear();}
\DoxyCodeLine{217          this-\/>val.clear();}
\DoxyCodeLine{218       \}}
\DoxyCodeLine{219       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{220 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{221          \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>col.size(); ++i) \{}
\DoxyCodeLine{222             this-\/>val[i] *= coeff;}
\DoxyCodeLine{223          \}}
\DoxyCodeLine{224       \}}
\DoxyCodeLine{225    \}}
\DoxyCodeLine{226    }
\DoxyCodeLine{230    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{231    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_aa7c4b4d33b18686e7da7ccdae4b94733}{AddDiagonalElements}}(\textcolor{keyword}{const} T diag\_add) \{}
\DoxyCodeLine{232       \textcolor{keywordflow}{if} (this-\/>row\_dim != this-\/>col\_dim) \{}
\DoxyCodeLine{233          std::stringstream ss;}
\DoxyCodeLine{234          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{235          ss << \textcolor{stringliteral}{"{}The matrix is not a square matrix."{}} << std::endl;}
\DoxyCodeLine{236          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{237       \}}
\DoxyCodeLine{238       }
\DoxyCodeLine{239       \textcolor{keywordtype}{bool} flag = \textcolor{keyword}{false};}
\DoxyCodeLine{240 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{241       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{242          \textcolor{keywordtype}{bool} temp\_flag = \textcolor{keyword}{true};}
\DoxyCodeLine{243          \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row[i]; j < this-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{244             \textcolor{keywordflow}{if} (i == this-\/>col[j]) \{}
\DoxyCodeLine{245                this-\/>val[j] += diag\_add;}
\DoxyCodeLine{246                temp\_flag = \textcolor{keyword}{false};}
\DoxyCodeLine{247                \textcolor{keywordflow}{break};}
\DoxyCodeLine{248             \}}
\DoxyCodeLine{249          \}}
\DoxyCodeLine{250          \textcolor{keywordflow}{if} (temp\_flag) \{}
\DoxyCodeLine{251 \textcolor{preprocessor}{\#pragma omp critical}}
\DoxyCodeLine{252             \{}
\DoxyCodeLine{253             flag = temp\_flag;}
\DoxyCodeLine{254             \}}
\DoxyCodeLine{255          \}}
\DoxyCodeLine{256       \}}
\DoxyCodeLine{257       \textcolor{keywordflow}{if} (flag) \{}
\DoxyCodeLine{258          \textcolor{comment}{//Restore the diagonal elements.}}
\DoxyCodeLine{259 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{260          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{261             \textcolor{keywordtype}{bool} temp\_flag = \textcolor{keyword}{true};}
\DoxyCodeLine{262             \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row[i]; j < this-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{263                \textcolor{keywordflow}{if} (i == this-\/>col[j]) \{}
\DoxyCodeLine{264                   this-\/>val[j] -\/= diag\_add;}
\DoxyCodeLine{265                   temp\_flag = \textcolor{keyword}{false};}
\DoxyCodeLine{266                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{267                \}}
\DoxyCodeLine{268             \}}
\DoxyCodeLine{269          \}}
\DoxyCodeLine{270          std::stringstream ss;}
\DoxyCodeLine{271          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{272          ss << \textcolor{stringliteral}{"{}Could not add the value to the diagonal elements."{}} << std::endl;}
\DoxyCodeLine{273          ss << \textcolor{stringliteral}{"{}The matrix need to have all the diagonal elements even if they are zero."{}} << std::endl;}
\DoxyCodeLine{274          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{275       \}}
\DoxyCodeLine{276    \}}
\DoxyCodeLine{277    }
\DoxyCodeLine{279    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a7fd21b0a2b0c525b831cf03e896fa525}{SortCol}}() \{}
\DoxyCodeLine{280       \textcolor{keyword}{auto} compare = [\textcolor{keyword}{this}](\textcolor{keyword}{auto} \&a, \textcolor{keyword}{auto} \&b) \{}
\DoxyCodeLine{281          \textcolor{keywordflow}{if} (a > b) \{}
\DoxyCodeLine{282             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{283          \}}
\DoxyCodeLine{284          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{285             std::swap(this-\/>val[std::distance(\&this-\/>col[0], \&a)],}
\DoxyCodeLine{286                       this-\/>val[std::distance(\&this-\/>col[0], \&b)]);}
\DoxyCodeLine{287             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{288          \}}
\DoxyCodeLine{289       \};}
\DoxyCodeLine{290       }
\DoxyCodeLine{291 \textcolor{preprocessor}{\#pragma omp parallel for schedule(guided)}}
\DoxyCodeLine{292       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{293          std::sort(\&this-\/>col[this-\/>row[i]], \&this-\/>col[this-\/>row[i + 1]], compare);}
\DoxyCodeLine{294       \}}
\DoxyCodeLine{295    \}}
\DoxyCodeLine{296    }
\DoxyCodeLine{298    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ab43150585915445e3b8745cf9ff1924c}{Print}}(\textcolor{keyword}{const} std::string display\_name = \textcolor{stringliteral}{"{}"{}})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{299       \textcolor{keywordflow}{if} (this-\/>name != \textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{300          std::cout << \textcolor{stringliteral}{"{}Name: "{}} << this-\/>name << std::endl;}
\DoxyCodeLine{301       \}}
\DoxyCodeLine{302       std::cout << this-\/>tag << std::endl;}
\DoxyCodeLine{303       std::cout << std::fixed;}
\DoxyCodeLine{304       std::cout << std::setprecision(std::numeric\_limits<ElementType>::max\_digits10);}
\DoxyCodeLine{305       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{306          \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row.at(i); j < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.at(i+1); ++j) \{}
\DoxyCodeLine{307             std::cout << display\_name << \textcolor{stringliteral}{"{}["{}};}
\DoxyCodeLine{308             std::cout << std::noshowpos << std::left << std::setw(3) << i << \textcolor{stringliteral}{"{}]["{}};}
\DoxyCodeLine{309             std::cout << std::left << std::setw(3) << this-\/>col[j] << \textcolor{stringliteral}{"{}]="{}};}
\DoxyCodeLine{310             std::cout << std::showpos << this-\/>val[j] << std::endl;}
\DoxyCodeLine{311          \}}
\DoxyCodeLine{312       \}}
\DoxyCodeLine{313       std::cout << std::noshowpos;}
\DoxyCodeLine{314    \}}
\DoxyCodeLine{315    }
\DoxyCodeLine{317    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a7cd67a00d8952a69b7563343d79de2fc}{PrintInfo}}(\textcolor{keyword}{const} std::string display\_name = \textcolor{stringliteral}{"{}Matrix"{}})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{318       std::cout << std::fixed;}
\DoxyCodeLine{319       std::cout << std::setprecision(std::numeric\_limits<ElementType>::max\_digits10);}
\DoxyCodeLine{320       std::cout << \textcolor{stringliteral}{"{}Print information about CRS: "{}} << display\_name << std::endl;}
\DoxyCodeLine{321       std::cout << this-\/>tag << std::endl;}
\DoxyCodeLine{322       std::cout << \textcolor{stringliteral}{"{}row\_dim = "{}} << this-\/>row\_dim << std::endl;}
\DoxyCodeLine{323       std::cout << \textcolor{stringliteral}{"{}col\_dim = "{}} << this-\/>col\_dim << std::endl;}
\DoxyCodeLine{324       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>row.size(); ++i) \{}
\DoxyCodeLine{325          std::cout << \textcolor{stringliteral}{"{}row["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>row.at(i) << std::endl;}
\DoxyCodeLine{326       \}}
\DoxyCodeLine{327       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>col.size(); ++i) \{}
\DoxyCodeLine{328          std::cout << \textcolor{stringliteral}{"{}col["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>col.at(i) << std::endl;}
\DoxyCodeLine{329       \}}
\DoxyCodeLine{330       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < this-\/>val.size(); ++i) \{}
\DoxyCodeLine{331          std::cout << \textcolor{stringliteral}{"{}val["{}} << i << \textcolor{stringliteral}{"{}] = "{}} << this-\/>val.at(i) << std::endl;}
\DoxyCodeLine{332       \}}
\DoxyCodeLine{333    \}}
\DoxyCodeLine{334    }
\DoxyCodeLine{339    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_accd09f748ee88f6b50816cb5da91c68d}{CheckSymmetric}}(\textcolor{keyword}{const} ElementType threshold = 0.000000000000001\textcolor{comment}{/*pow(10,-\/15)*/}, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} flag\_display\_info = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{340       \textcolor{keywordflow}{if} (this-\/>row\_dim != this-\/>col\_dim) \{}
\DoxyCodeLine{341          std::stringstream ss;}
\DoxyCodeLine{342          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{343          ss << \textcolor{stringliteral}{"{}The matrix is not square one."{}} << std::endl;}
\DoxyCodeLine{344          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{345       \}}
\DoxyCodeLine{346       \textcolor{comment}{// Check sorted}}
\DoxyCodeLine{347       \textcolor{keywordtype}{bool} flag\_sorted = \textcolor{keyword}{false};}
\DoxyCodeLine{348 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{349       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{350          \textcolor{keywordtype}{bool} temp\_flag = \textcolor{keyword}{false};}
\DoxyCodeLine{351          \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row[i]; j < this-\/>row[i + 1] -\/ 1; ++j) \{}
\DoxyCodeLine{352             \textcolor{keywordflow}{if} (this-\/>col[j] >= this-\/>col[j + 1]) \{}
\DoxyCodeLine{353                temp\_flag = \textcolor{keyword}{true};}
\DoxyCodeLine{354             \}}
\DoxyCodeLine{355          \}}
\DoxyCodeLine{356          \textcolor{keywordflow}{if} (temp\_flag) \{}
\DoxyCodeLine{357 \textcolor{preprocessor}{\#pragma omp critical}}
\DoxyCodeLine{358             \{}
\DoxyCodeLine{359                flag\_sorted = temp\_flag;}
\DoxyCodeLine{360             \}}
\DoxyCodeLine{361          \}}
\DoxyCodeLine{362       \}}
\DoxyCodeLine{363       \textcolor{keywordflow}{if} (flag\_sorted) \{}
\DoxyCodeLine{364          std::stringstream ss;}
\DoxyCodeLine{365          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{366          ss << \textcolor{stringliteral}{"{}The colmun indexes of the matrix is not sorted."{}} << std::endl;}
\DoxyCodeLine{367          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{368       \}}
\DoxyCodeLine{369       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < this-\/>\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{370          \textcolor{keywordflow}{for} (std::int64\_t j = this-\/>row[i]; j < this-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{371             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_begin = this-\/>col.begin() + this-\/>row[this-\/>col[j]];}
\DoxyCodeLine{372             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_end   = this-\/>col.begin() + this-\/>row[this-\/>col[j] + 1];}
\DoxyCodeLine{373             \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_find  = std::lower\_bound(iter\_begin, iter\_end, i);}
\DoxyCodeLine{374             \textcolor{keywordflow}{if} (iter\_find == iter\_end || *iter\_find != i) \{}
\DoxyCodeLine{375                \textcolor{keywordflow}{if} (flag\_display\_info) \{}
\DoxyCodeLine{376                   std::cout << \textcolor{stringliteral}{"{}The input matrix is not symmetric."{}} << std::endl;}
\DoxyCodeLine{377                   std::cout << \textcolor{stringliteral}{"{}Corresponding element does not exist."{}} << std::endl;}
\DoxyCodeLine{378                   std::cout << \textcolor{stringliteral}{"{}row="{}} << i << \textcolor{stringliteral}{"{}, col="{}} << \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j] << \textcolor{stringliteral}{"{}, val="{}} << \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j] << std::endl;}
\DoxyCodeLine{379                \}}
\DoxyCodeLine{380                \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{381             \}}
\DoxyCodeLine{382             \textcolor{keyword}{const} \textcolor{keyword}{auto} inv = std::distance(this-\/>col.begin(), iter\_find);}
\DoxyCodeLine{383             \textcolor{keywordflow}{if} (std::abs(this-\/>val[j] -\/ this-\/>val[inv]) > threshold) \{}
\DoxyCodeLine{384                \textcolor{keywordflow}{if} (flag\_display\_info) \{}
\DoxyCodeLine{385                   std::cout << \textcolor{stringliteral}{"{}The input matrix is not symmetric."{}} << std::endl;}
\DoxyCodeLine{386                   std::cout << \textcolor{stringliteral}{"{}M["{}} << i << \textcolor{stringliteral}{"{}]["{}} << this-\/>col[j] << \textcolor{stringliteral}{"{}]="{}} << this-\/>val[j] << \textcolor{stringliteral}{"{}, "{}} << this-\/>val[inv] << \textcolor{stringliteral}{"{}=M["{}} << this-\/>col[j] << \textcolor{stringliteral}{"{}]["{}} << i << \textcolor{stringliteral}{"{}]"{}} << std::endl;}
\DoxyCodeLine{387                \}}
\DoxyCodeLine{388                \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{389             \}}
\DoxyCodeLine{390          \}}
\DoxyCodeLine{391       \}}
\DoxyCodeLine{392       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{393    \}}
\DoxyCodeLine{394    }
\DoxyCodeLine{395    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{396    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Operator Overloading-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{397    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{400 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_abcfc5d5e087b26264f1225949304f2ee}{operator+}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{401       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{402    \}}
\DoxyCodeLine{403    }
\DoxyCodeLine{406    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_aa02cc0d2b9d8dd67514abe11e52b7bbf}{operator-\/}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{407       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1type_a75e2fe84321e8bdb8853194f74451c3b}{CalculateScalarMatrixProduct}}(-\/1, *\textcolor{keyword}{this});}
\DoxyCodeLine{408    \}}
\DoxyCodeLine{409    }
\DoxyCodeLine{414    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{415    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}}\& \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a878cede5b8041d4cf1cabf5bc809fdd0}{operator+=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} rhs) \{}
\DoxyCodeLine{416       \textcolor{keywordflow}{return} *\textcolor{keyword}{this} = *\textcolor{keyword}{this} + rhs;}
\DoxyCodeLine{417    \}}
\DoxyCodeLine{418    }
\DoxyCodeLine{423    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{424    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}}\& \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a04ea5951e267780634957ac36f2fbaf2}{operator-\/=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} rhs) \{}
\DoxyCodeLine{425       \textcolor{keywordflow}{return} *\textcolor{keyword}{this} = *\textcolor{keyword}{this} -\/ rhs;}
\DoxyCodeLine{426    \}}
\DoxyCodeLine{427    }
\DoxyCodeLine{432    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{433    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}}\& \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a3dbeb14b8c90fc4f0439ce7e9edab126}{operator*=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} rhs) \{}
\DoxyCodeLine{434       \textcolor{keywordflow}{return} *\textcolor{keyword}{this} = *\textcolor{keyword}{this} * rhs;}
\DoxyCodeLine{435    \}}
\DoxyCodeLine{436    }
\DoxyCodeLine{441    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{442    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a7621f2369023bfd850e0908482f3f07f}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} \&matrix) \& \{}
\DoxyCodeLine{443       \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac4696f6f7423080adbdbc490d49f0b0a}{Assign}}(matrix);}
\DoxyCodeLine{444       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{445    \}}
\DoxyCodeLine{446    }
\DoxyCodeLine{447 \};}
\DoxyCodeLine{448 }
\DoxyCodeLine{449 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{450 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Operator overloading-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{451 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{458 \textcolor{comment}{}\textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{459 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_a40da0ddd6d39a53f8064c31f523560ca}{operator+}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&rhs) -\/>}
\DoxyCodeLine{460 CRS<\textcolor{keyword}{decltype}(std::declval<T1>() + std::declval<T2>())> \{}
\DoxyCodeLine{461    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1type_add38fc1fb1f7babb20b058653d949687}{CalculateMatrixMatrixSum}}(T1\{1\}, lhs, T2\{1\}, rhs);}
\DoxyCodeLine{462 \}}
\DoxyCodeLine{463 }
\DoxyCodeLine{470 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{471 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_afae823b533de3a1b9d269b9b30d7e388}{operator-\/}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&rhs) -\/>}
\DoxyCodeLine{472 CRS<\textcolor{keyword}{decltype}(std::declval<T1>() -\/ std::declval<T2>())> \{}
\DoxyCodeLine{473    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1type_add38fc1fb1f7babb20b058653d949687}{CalculateMatrixMatrixSum}}(T1\{1\}, lhs, T2\{-\/1\}, rhs);}
\DoxyCodeLine{474 \}}
\DoxyCodeLine{475 }
\DoxyCodeLine{482 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{483 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_af68e0fefdd6f8dc9bc3c0c97be663a98}{operator*}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&rhs) -\/>}
\DoxyCodeLine{484 CRS<\textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>())> \{}
\DoxyCodeLine{485    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1type_a9180334d20402ec5bd10f8b982c8d069}{CalculateMatrixMatrixProduct}}(T1\{1\}, lhs, rhs);}
\DoxyCodeLine{486 \}}
\DoxyCodeLine{487 }
\DoxyCodeLine{494 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{495 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_af68e0fefdd6f8dc9bc3c0c97be663a98}{operator*}}(\textcolor{keyword}{const} T1 lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&rhs) -\/>}
\DoxyCodeLine{496 CRS<\textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>())> \{}
\DoxyCodeLine{497    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1type_a75e2fe84321e8bdb8853194f74451c3b}{CalculateScalarMatrixProduct}}(lhs, rhs);}
\DoxyCodeLine{498 \}}
\DoxyCodeLine{499 }
\DoxyCodeLine{506 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{507 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_af68e0fefdd6f8dc9bc3c0c97be663a98}{operator*}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} T2 rhs) -\/>}
\DoxyCodeLine{508 CRS<\textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>())> \{}
\DoxyCodeLine{509    \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1type_a75e2fe84321e8bdb8853194f74451c3b}{CalculateScalarMatrixProduct}}(rhs, lhs);}
\DoxyCodeLine{510 \}}
\DoxyCodeLine{511 }
\DoxyCodeLine{518 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{519 \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacecompnal_1_1type_abb6429171e978e71a1fbd6682875ca56}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&rhs) \{}
\DoxyCodeLine{520    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}} != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}) \{}
\DoxyCodeLine{521       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{522    \}}
\DoxyCodeLine{523    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}} != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}}) \{}
\DoxyCodeLine{524       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{525    \}}
\DoxyCodeLine{526    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.size() != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.size()) \{}
\DoxyCodeLine{527       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{528    \}}
\DoxyCodeLine{529    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}}) \{}
\DoxyCodeLine{530       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{531    \}}
\DoxyCodeLine{532    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size() != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size()) \{}
\DoxyCodeLine{533       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{534    \}}
\DoxyCodeLine{535    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.size() != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.size()) \{}
\DoxyCodeLine{536       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{537    \}}
\DoxyCodeLine{538    \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8ff961838014a2146c4e570ebbb85840}{name}} != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8ff961838014a2146c4e570ebbb85840}{name}}) \{}
\DoxyCodeLine{539       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{540    \}}
\DoxyCodeLine{541    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.size(); ++i) \{}
\DoxyCodeLine{542       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i] != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i]) \{}
\DoxyCodeLine{543          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{544       \}}
\DoxyCodeLine{545    \}}
\DoxyCodeLine{546    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size(); ++i) \{}
\DoxyCodeLine{547       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[i] != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[i]) \{}
\DoxyCodeLine{548          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{549       \}}
\DoxyCodeLine{550    \}}
\DoxyCodeLine{551    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.size(); ++i) \{}
\DoxyCodeLine{552       \textcolor{keywordflow}{if} (lhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i] != rhs.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i]) \{}
\DoxyCodeLine{553          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{554       \}}
\DoxyCodeLine{555    \}}
\DoxyCodeLine{556    \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{557 \}}
\DoxyCodeLine{558 }
\DoxyCodeLine{565 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{566 \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacecompnal_1_1type_a2ef017632e376f62ac6a249c5b291b9c}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1>}} \&lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&rhs) \{}
\DoxyCodeLine{567    \textcolor{keywordflow}{return} !(lhs == rhs);}
\DoxyCodeLine{568 \}}
\DoxyCodeLine{569 }
\DoxyCodeLine{570 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{571 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Operator overloading: I/O Stream-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{572 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{577 \textcolor{comment}{}\textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{578 std::ostream\& \mbox{\hyperlink{namespacecompnal_1_1type_ab565f905bc0e0a4cdea7cbee1b5c0da1}{operator<<}}(std::ostream \&os, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} \&m) \{}
\DoxyCodeLine{579    os << m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} << std::endl;}
\DoxyCodeLine{580    os << std::fixed;}
\DoxyCodeLine{581    os << std::setprecision(std::numeric\_limits<T>::max\_digits10);}
\DoxyCodeLine{582    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++i) \{}
\DoxyCodeLine{583       \textcolor{keywordflow}{for} (std::int64\_t j = m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.at(i); j < m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}.at(i+1); ++j) \{}
\DoxyCodeLine{584          os << m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8ff961838014a2146c4e570ebbb85840}{name}};}
\DoxyCodeLine{585          os << \textcolor{stringliteral}{"{}["{}};}
\DoxyCodeLine{586          os << std::noshowpos << std::left << std::setw(3) << i << \textcolor{stringliteral}{"{}]["{}};}
\DoxyCodeLine{587          os << std::left << std::setw(3) << m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j] << \textcolor{stringliteral}{"{}]="{}};}
\DoxyCodeLine{588          os << std::showpos << m.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[j] << std::endl;}
\DoxyCodeLine{589       \}}
\DoxyCodeLine{590    \}}
\DoxyCodeLine{591    \textcolor{keywordflow}{return} os;}
\DoxyCodeLine{592 \}}
\DoxyCodeLine{593 }
\DoxyCodeLine{594 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{595 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Global Functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{596 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{607 \textcolor{comment}{}\textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3, \textcolor{keyword}{typename} T4>}
\DoxyCodeLine{608 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_add38fc1fb1f7babb20b058653d949687}{CalculateMatrixMatrixSum}}(\textcolor{keyword}{const} T1 coeff\_1,}
\DoxyCodeLine{609                               \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&matrix\_1,}
\DoxyCodeLine{610                               \textcolor{keyword}{const} T3 coeff\_2,}
\DoxyCodeLine{611                               \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T4>}} \&matrix\_2) -\/>}
\DoxyCodeLine{612 CRS<\textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>() + std::declval<T3>()*std::declval<T4>())> \{}
\DoxyCodeLine{613    }
\DoxyCodeLine{614    \textcolor{keywordflow}{if} (matrix\_1.row\_dim != matrix\_2.row\_dim || matrix\_1.col\_dim != matrix\_2.col\_dim) \{}
\DoxyCodeLine{615       std::stringstream ss;}
\DoxyCodeLine{616       ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{617       ss << \textcolor{stringliteral}{"{}The summation of the matrices cannot be defined."{}} << std::endl;}
\DoxyCodeLine{618       ss << \textcolor{stringliteral}{"{}matrix\_1.row\_dim = "{}} << matrix\_1.row\_dim << \textcolor{stringliteral}{"{}, matrix\_1.col\_dim = "{}} << matrix\_1.col\_dim << std::endl;}
\DoxyCodeLine{619       ss << \textcolor{stringliteral}{"{}matrix\_2.row\_dim = "{}} << matrix\_2.row\_dim << \textcolor{stringliteral}{"{}, matrix\_2.col\_dim = "{}} << matrix\_2.col\_dim << std::endl;}
\DoxyCodeLine{620       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{621    \}}
\DoxyCodeLine{622    }
\DoxyCodeLine{623    \textcolor{keyword}{using} T1T2T3T4 = \textcolor{keyword}{decltype}(std::declval<T1>() *}
\DoxyCodeLine{624                              std::declval<T2>() +}
\DoxyCodeLine{625                              std::declval<T3>() *}
\DoxyCodeLine{626                              std::declval<T4>());}
\DoxyCodeLine{627    }
\DoxyCodeLine{628    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1T2T3T4>}} matrix\_out(matrix\_1.row\_dim, matrix\_1.col\_dim);}
\DoxyCodeLine{629    }
\DoxyCodeLine{630    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_1.row\_dim; ++i) \{}
\DoxyCodeLine{631       }
\DoxyCodeLine{632       \textcolor{keywordtype}{int} check = 0;}
\DoxyCodeLine{633       std::int64\_t count\_1 = 0;}
\DoxyCodeLine{634       std::int64\_t count\_2 = 0;}
\DoxyCodeLine{635       }
\DoxyCodeLine{636       \textcolor{keyword}{const} std::int64\_t row\_lower\_1 = matrix\_1.row[  i  ];}
\DoxyCodeLine{637       \textcolor{keyword}{const} std::int64\_t row\_upper\_1 = matrix\_1.row[i + 1];}
\DoxyCodeLine{638       \textcolor{keyword}{const} std::int64\_t row\_lower\_2 = matrix\_2.row[  i  ];}
\DoxyCodeLine{639       \textcolor{keyword}{const} std::int64\_t row\_upper\_2 = matrix\_2.row[i + 1];}
\DoxyCodeLine{640       }
\DoxyCodeLine{641       \textcolor{keyword}{const} std::int64\_t m1\_count = row\_upper\_1 -\/ row\_lower\_1;}
\DoxyCodeLine{642       \textcolor{keyword}{const} std::int64\_t m2\_count = row\_upper\_2 -\/ row\_lower\_2;}
\DoxyCodeLine{643       }
\DoxyCodeLine{644       \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count == 0) \{}
\DoxyCodeLine{645          \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{646             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(coeff\_1*matrix\_1.val[j]);}
\DoxyCodeLine{647             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(matrix\_1.col[j]);}
\DoxyCodeLine{648          \}}
\DoxyCodeLine{649       \}}
\DoxyCodeLine{650       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count == 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{651          \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{652             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(coeff\_2*matrix\_2.val[j]);}
\DoxyCodeLine{653             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(matrix\_2.col[j]);}
\DoxyCodeLine{654          \}}
\DoxyCodeLine{655       \}}
\DoxyCodeLine{656       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{657          \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < m1\_count + m2\_count; ++j) \{}
\DoxyCodeLine{658             \textcolor{keywordflow}{if} (matrix\_1.col[row\_lower\_1 + count\_1] < matrix\_2.col[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{659                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(coeff\_1*matrix\_1.val[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{660                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(matrix\_1.col[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{661                count\_1++;}
\DoxyCodeLine{662                \textcolor{keywordflow}{if} (row\_lower\_1 + count\_1 == row\_upper\_1) \{}
\DoxyCodeLine{663                   check = 1;}
\DoxyCodeLine{664                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{665                \}}
\DoxyCodeLine{666             \}}
\DoxyCodeLine{667             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.col[row\_lower\_1 + count\_1] == matrix\_2.col[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{668                \textcolor{keyword}{const} \textcolor{keyword}{auto} val = coeff\_1*matrix\_1.val[row\_lower\_1 + count\_1] + coeff\_2*matrix\_2.val[row\_lower\_2 + count\_2];}
\DoxyCodeLine{669                \textcolor{keywordflow}{if} (std::abs(val) > 0.0) \{}
\DoxyCodeLine{670                   matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(val);}
\DoxyCodeLine{671                   matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(matrix\_1.col[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{672                   count\_1++;}
\DoxyCodeLine{673                   count\_2++;}
\DoxyCodeLine{674                   \textcolor{keyword}{const} std::int64\_t temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{675                   \textcolor{keyword}{const} std::int64\_t temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{676                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{677                      check = 1;}
\DoxyCodeLine{678                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{679                   \}}
\DoxyCodeLine{680                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{681                      check = 2;}
\DoxyCodeLine{682                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{683                   \}}
\DoxyCodeLine{684                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{685                      check = 0;}
\DoxyCodeLine{686                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{687                   \}}
\DoxyCodeLine{688                \}}
\DoxyCodeLine{689                \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{690                   count\_1++;}
\DoxyCodeLine{691                   count\_2++;}
\DoxyCodeLine{692                   \textcolor{keyword}{const} std::int64\_t temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{693                   \textcolor{keyword}{const} std::int64\_t temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{694                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{695                      check = 1;}
\DoxyCodeLine{696                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{697                   \}}
\DoxyCodeLine{698                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{699                      check = 2;}
\DoxyCodeLine{700                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{701                   \}}
\DoxyCodeLine{702                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{703                      check = 0;}
\DoxyCodeLine{704                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{705                   \}}
\DoxyCodeLine{706                \}}
\DoxyCodeLine{707             \}}
\DoxyCodeLine{708             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{709                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(coeff\_2*matrix\_2.val[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{710                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(matrix\_2.col[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{711                count\_2++;}
\DoxyCodeLine{712                \textcolor{keywordflow}{if} (row\_lower\_2 + count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{713                   check = 2;}
\DoxyCodeLine{714                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{715                \}}
\DoxyCodeLine{716             \}}
\DoxyCodeLine{717          \}}
\DoxyCodeLine{718          \textcolor{keywordflow}{if} (check == 1) \{}
\DoxyCodeLine{719             \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_2 + count\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{720                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(coeff\_2*matrix\_2.val[j]);}
\DoxyCodeLine{721                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(matrix\_2.col[j]);}
\DoxyCodeLine{722             \}}
\DoxyCodeLine{723          \}}
\DoxyCodeLine{724          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (check == 2) \{}
\DoxyCodeLine{725             \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_1 + count\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{726                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(coeff\_1*matrix\_1.val[j]);}
\DoxyCodeLine{727                matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(matrix\_1.col[j]);}
\DoxyCodeLine{728             \}}
\DoxyCodeLine{729          \}}
\DoxyCodeLine{730       \}}
\DoxyCodeLine{731       matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i + 1] = matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size();}
\DoxyCodeLine{732    \}}
\DoxyCodeLine{733    }
\DoxyCodeLine{734    \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}}) \{}
\DoxyCodeLine{735       matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = matrix\_2.tag;}
\DoxyCodeLine{736    \}}
\DoxyCodeLine{737    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}}) \{}
\DoxyCodeLine{738       \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}}) \{}
\DoxyCodeLine{739          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}};}
\DoxyCodeLine{740       \}}
\DoxyCodeLine{741       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}}) \{}
\DoxyCodeLine{742          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}};}
\DoxyCodeLine{743       \}}
\DoxyCodeLine{744       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{745          std::stringstream ss;}
\DoxyCodeLine{746          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{747          ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{748          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{749       \}}
\DoxyCodeLine{750    \}}
\DoxyCodeLine{751    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}}) \{}
\DoxyCodeLine{752       \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}}) \{}
\DoxyCodeLine{753          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}};}
\DoxyCodeLine{754       \}}
\DoxyCodeLine{755       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}}) \{}
\DoxyCodeLine{756          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}};}
\DoxyCodeLine{757       \}}
\DoxyCodeLine{758       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{759          std::stringstream ss;}
\DoxyCodeLine{760          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{761          ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{762          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{763       \}}
\DoxyCodeLine{764    \}}
\DoxyCodeLine{765    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}}) \{}
\DoxyCodeLine{766       matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}};}
\DoxyCodeLine{767    \}}
\DoxyCodeLine{768    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{769       std::stringstream ss;}
\DoxyCodeLine{770       ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{771       ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{772       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{773    \}}
\DoxyCodeLine{774    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{775 \}}
\DoxyCodeLine{776 }
\DoxyCodeLine{785 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2, \textcolor{keyword}{typename} T3>}
\DoxyCodeLine{786 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_a9180334d20402ec5bd10f8b982c8d069}{CalculateMatrixMatrixProduct}}(\textcolor{keyword}{const} T1 coeff\_1,}
\DoxyCodeLine{787                                   \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&matrix\_1,}
\DoxyCodeLine{788                                   \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T3>}} \&matrix\_2) -\/>}
\DoxyCodeLine{789 CRS<\textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>()*std::declval<T3>())> \{}
\DoxyCodeLine{790    }
\DoxyCodeLine{791    \textcolor{keywordflow}{if} (matrix\_1.col\_dim != matrix\_2.row\_dim) \{}
\DoxyCodeLine{792       std::stringstream ss;}
\DoxyCodeLine{793       ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{794       ss << \textcolor{stringliteral}{"{}Matrix product cannot be defined"{}} << std::endl;}
\DoxyCodeLine{795       ss << \textcolor{stringliteral}{"{}matrix\_1.col\_dim = "{}} << matrix\_1.col\_dim << \textcolor{stringliteral}{"{}, matrix\_2.row\_dim = "{}} << matrix\_2.row\_dim << std::endl;}
\DoxyCodeLine{796       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{797    \}}
\DoxyCodeLine{798    }
\DoxyCodeLine{799    \textcolor{keyword}{using} T1T2   = \textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>());}
\DoxyCodeLine{800    \textcolor{keyword}{using} T1T2T3 = \textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>()*std::declval<T3>());}
\DoxyCodeLine{801 }
\DoxyCodeLine{802    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1T2T3>}} matrix\_out(matrix\_1.row\_dim, matrix\_2.col\_dim);}
\DoxyCodeLine{803    }
\DoxyCodeLine{804    std::vector<T1T2>   temp\_v1(matrix\_1.col\_dim, 0.0);}
\DoxyCodeLine{805    std::vector<T1T2T3> temp\_v2(matrix\_2.col\_dim, 0.0);}
\DoxyCodeLine{806    }
\DoxyCodeLine{807    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_1.row\_dim; ++i) \{}
\DoxyCodeLine{808       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_1.row[i]; j < matrix\_1.row[i + 1]; ++j) \{}
\DoxyCodeLine{809          temp\_v1[matrix\_1.col[j]] = coeff\_1*matrix\_1.val[j];}
\DoxyCodeLine{810       \}}
\DoxyCodeLine{811       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_1.col\_dim; ++j) \{}
\DoxyCodeLine{812          \textcolor{keywordflow}{for} (std::int64\_t k = matrix\_2.row[j]; k < matrix\_2.row[j + 1]; ++k) \{}
\DoxyCodeLine{813             temp\_v2[matrix\_2.col[k]] += temp\_v1[j]*matrix\_2.val[k];}
\DoxyCodeLine{814          \}}
\DoxyCodeLine{815       \}}
\DoxyCodeLine{816       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_2.col\_dim; ++j) \{}
\DoxyCodeLine{817          \textcolor{keywordflow}{if} (std::abs(temp\_v2[j]) > 0.0) \{}
\DoxyCodeLine{818             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(temp\_v2[j]);}
\DoxyCodeLine{819             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(j);}
\DoxyCodeLine{820          \}}
\DoxyCodeLine{821       \}}
\DoxyCodeLine{822       }
\DoxyCodeLine{823       matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i + 1] = matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size();}
\DoxyCodeLine{824       }
\DoxyCodeLine{825       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_1.row[i]; j < matrix\_1.row[i + 1]; ++j) \{}
\DoxyCodeLine{826          temp\_v1[matrix\_1.col[j]] = 0.0;}
\DoxyCodeLine{827       \}}
\DoxyCodeLine{828       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i]; j < matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{829          temp\_v2[matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[j]] = 0.0;}
\DoxyCodeLine{830       \}}
\DoxyCodeLine{831    \}}
\DoxyCodeLine{832    }
\DoxyCodeLine{833    \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}}) \{}
\DoxyCodeLine{834       matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = matrix\_2.tag;}
\DoxyCodeLine{835    \}}
\DoxyCodeLine{836    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}}) \{}
\DoxyCodeLine{837       \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}}) \{}
\DoxyCodeLine{838          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}};}
\DoxyCodeLine{839       \}}
\DoxyCodeLine{840       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}}) \{}
\DoxyCodeLine{841          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}};}
\DoxyCodeLine{842       \}}
\DoxyCodeLine{843       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}}) \{}
\DoxyCodeLine{844          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}};}
\DoxyCodeLine{845       \}}
\DoxyCodeLine{846       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{847          std::stringstream ss;}
\DoxyCodeLine{848          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{849          ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{850          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{851       \}}
\DoxyCodeLine{852    \}}
\DoxyCodeLine{853    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}}) \{}
\DoxyCodeLine{854       \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baf96aeb914af342db32480b224f95bd6f}{CRSTag::FERMION}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}} || matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}}) \{}
\DoxyCodeLine{855          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = matrix\_2.tag;}
\DoxyCodeLine{856       \}}
\DoxyCodeLine{857       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_2.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11ba861b16b31f1b6b1c04552516e7a85987}{CRSTag::NONE}}) \{}
\DoxyCodeLine{858          matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11bad14dac1fb07c963ddc13357a8b1a94de}{CRSTag::BOSON}};}
\DoxyCodeLine{859       \}}
\DoxyCodeLine{860       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{861          std::stringstream ss;}
\DoxyCodeLine{862          ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{863          ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{864          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{865       \}}
\DoxyCodeLine{866    \}}
\DoxyCodeLine{867    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.tag == \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}}) \{}
\DoxyCodeLine{868       matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1type_aa249dd69b73057aa6d2d501c0825e11baac3550dd78df756a2b31dfbab46f2647}{CRSTag::MIX}};}
\DoxyCodeLine{869    \}}
\DoxyCodeLine{870    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{871       std::stringstream ss;}
\DoxyCodeLine{872       ss << \textcolor{stringliteral}{"{}Error at "{}} << \_\_LINE\_\_ << \textcolor{stringliteral}{"{} in "{}} << \_\_func\_\_ << \textcolor{stringliteral}{"{} in "{}}<< \_\_FILE\_\_ << std::endl;}
\DoxyCodeLine{873       ss << \textcolor{stringliteral}{"{}Unknown CRSTag detected."{}};}
\DoxyCodeLine{874       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{875    \}}
\DoxyCodeLine{876    }
\DoxyCodeLine{877    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{878 \}}
\DoxyCodeLine{879 }
\DoxyCodeLine{886 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{887 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacecompnal_1_1type_a75e2fe84321e8bdb8853194f74451c3b}{CalculateScalarMatrixProduct}}(\textcolor{keyword}{const} T1 coeff, \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T2>}} \&matrix) -\/>}
\DoxyCodeLine{888 CRS<\textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>())> \{}
\DoxyCodeLine{889    }
\DoxyCodeLine{890    \textcolor{keyword}{using} T1T2 = \textcolor{keyword}{decltype}(std::declval<T1>()*std::declval<T2>());}
\DoxyCodeLine{891    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T1T2>}} out(matrix.row\_dim, matrix.col\_dim, matrix.tag);}
\DoxyCodeLine{892    }
\DoxyCodeLine{893    \textcolor{keywordflow}{if} (coeff == T1\{0\}) \{}
\DoxyCodeLine{894       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{895    \}}
\DoxyCodeLine{896    }
\DoxyCodeLine{897    out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.resize(matrix.col.size());}
\DoxyCodeLine{898    out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.resize(matrix.val.size());}
\DoxyCodeLine{899    }
\DoxyCodeLine{900 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{901    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < matrix.col.size(); ++i) \{}
\DoxyCodeLine{902       out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[i] = matrix.col[i];}
\DoxyCodeLine{903       out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[i] = coeff*matrix.val[i];}
\DoxyCodeLine{904    \}}
\DoxyCodeLine{905    }
\DoxyCodeLine{906 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{907    \textcolor{keywordflow}{for} (std::int64\_t i = 1; i <= matrix.row\_dim; ++i) \{}
\DoxyCodeLine{908       out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i] = matrix.row[i];}
\DoxyCodeLine{909    \}}
\DoxyCodeLine{910    \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{911 \}}
\DoxyCodeLine{912 }
\DoxyCodeLine{917 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{918 \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} \mbox{\hyperlink{namespacecompnal_1_1type_a59fb41af50a085e7de7640b31b6fd240}{CalculateTransposedMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} \&matrix) \{}
\DoxyCodeLine{919    }
\DoxyCodeLine{920    \mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s}{CRS<T>}} matrix\_out(matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}}, matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}, matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a10f8e01e4b381e42a2d93203098aa5ca}{tag}});}
\DoxyCodeLine{921    }
\DoxyCodeLine{922    std::vector<std::int64\_t> row\_count(matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}});}
\DoxyCodeLine{923    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a47d4db1759d84328b3f534bd5f6a7444}{col\_dim}}; ++i) \{}
\DoxyCodeLine{924       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_ac790fec841b1ca31157753797fba985d}{row\_dim}}; ++j) \{}
\DoxyCodeLine{925          \textcolor{keyword}{const} std::int64\_t row = matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[j] + row\_count[j];}
\DoxyCodeLine{926          \textcolor{keywordflow}{if} (row < matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[j + 1] \&\& matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}[row] == i) \{}
\DoxyCodeLine{927             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}.push\_back(matrix.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a49f08adf2c82f9729d4d2da4296c5984}{val}}[row]);}
\DoxyCodeLine{928             matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.push\_back(j);}
\DoxyCodeLine{929             row\_count[j]++;}
\DoxyCodeLine{930          \}}
\DoxyCodeLine{931       \}}
\DoxyCodeLine{932       matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a6a151570fadeaab5b9a5b74da39294ff}{row}}[i + 1] = matrix\_out.\mbox{\hyperlink{classcompnal_1_1type_1_1_c_r_s_a8e206b942a97428dbfd09e62cf17be94}{col}}.size();}
\DoxyCodeLine{933    \}}
\DoxyCodeLine{934    }
\DoxyCodeLine{935    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{936 \}}
\DoxyCodeLine{937 }
\DoxyCodeLine{938 \} \textcolor{comment}{// namespace type}}
\DoxyCodeLine{939 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{940 }
\DoxyCodeLine{941 }
\DoxyCodeLine{942 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_TYPE\_COMPRESSED\_ROW\_STORAGE\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
