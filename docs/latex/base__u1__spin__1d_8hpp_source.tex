\hypertarget{base__u1__spin__1d_8hpp_source}{}\doxysection{base\+\_\+u1\+\_\+spin\+\_\+1d.\+hpp}
\label{base__u1__spin__1d_8hpp_source}\index{src/model/base\_u1\_spin\_1d.hpp@{src/model/base\_u1\_spin\_1d.hpp}}
\mbox{\hyperlink{base__u1__spin__1d_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/18.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_MODEL\_BASE\_U1SPIN\_1D\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_MODEL\_BASE\_U1SPIN\_1D\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}../type.hpp"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <unordered\_set>}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{33 \textcolor{keyword}{namespace }model \{}
\DoxyCodeLine{34 }
\DoxyCodeLine{37 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{38 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}} \{}
\DoxyCodeLine{39    }
\DoxyCodeLine{41    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{42    }
\DoxyCodeLine{44    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a84976fe8bfcbaf92d804939a3259b989}{QType}} = \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}};}
\DoxyCodeLine{45    }
\DoxyCodeLine{46 \textcolor{keyword}{public}:}
\DoxyCodeLine{47    }
\DoxyCodeLine{49    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a44c9489af0b9d886187ffa94b7cbecad}{ValueType}} = RealType;}
\DoxyCodeLine{50    }
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{52    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{53    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{55 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abdfcbc3475819c0858af77cf31e4b164}{BaseU1Spin\_1D}}() \{}
\DoxyCodeLine{56       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a580d5de16a28c5246363c3a1b2975430}{SetOnsiteOperator}}();}
\DoxyCodeLine{57    \}}
\DoxyCodeLine{58    }
\DoxyCodeLine{61    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a20288b7e59875d82c99307127877d060}{BaseU1Spin\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}}() \{}
\DoxyCodeLine{62       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ab34e5e3dd6fdb9581c785c92f3ded892}{SetSystemSize}}(system\_size);}
\DoxyCodeLine{63    \}}
\DoxyCodeLine{64    }
\DoxyCodeLine{68    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af60d3338c3243a0ae29edc83c29a45cf}{BaseU1Spin\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}}(system\_size) \{}
\DoxyCodeLine{69       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a005aa6c8c74deee5788175db6052bbb9}{SetMagnitudeSpin}}(magnitude\_spin);}
\DoxyCodeLine{70    \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{76    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8a9336529b9d943764660faec0d4bed7}{BaseU1Spin\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}}(system\_size, magnitude\_spin) \{}
\DoxyCodeLine{77       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa0b67864945fb2a6ccf76db0ee0984}{SetTotalSz}}(total\_sz);}
\DoxyCodeLine{78    \}}
\DoxyCodeLine{79    }
\DoxyCodeLine{82    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ab34e5e3dd6fdb9581c785c92f3ded892}{SetSystemSize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size) \{}
\DoxyCodeLine{83       \textcolor{keywordflow}{if} (system\_size <= 0) \{}
\DoxyCodeLine{84          std::stringstream ss;}
\DoxyCodeLine{85          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{86          ss << \textcolor{stringliteral}{"{}system\_size must be a non-\/negative integer"{}} << std::endl;}
\DoxyCodeLine{87          ss << \textcolor{stringliteral}{"{}system\_size="{}} << system\_size << \textcolor{stringliteral}{"{}is not allowed"{}} << std::endl;}
\DoxyCodeLine{88          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}} != system\_size) \{}
\DoxyCodeLine{91          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}} = system\_size;}
\DoxyCodeLine{92          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.clear();}
\DoxyCodeLine{93          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}.clear();}
\DoxyCodeLine{94          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{95       \}}
\DoxyCodeLine{96    \}}
\DoxyCodeLine{97    }
\DoxyCodeLine{100    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a005aa6c8c74deee5788175db6052bbb9}{SetMagnitudeSpin}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{101       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{102       \textcolor{keywordflow}{if} (magnitude\_2spin <= 0) \{}
\DoxyCodeLine{103          std::stringstream ss;}
\DoxyCodeLine{104          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{105          ss << \textcolor{stringliteral}{"{}Please set magnitude\_2spin > 0"{}} << std::endl;}
\DoxyCodeLine{106          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{107       \}}
\DoxyCodeLine{108       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} != magnitude\_2spin) \{}
\DoxyCodeLine{109          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} = magnitude\_2spin;}
\DoxyCodeLine{110          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}      = magnitude\_2spin + 1;}
\DoxyCodeLine{111          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a580d5de16a28c5246363c3a1b2975430}{SetOnsiteOperator}}();}
\DoxyCodeLine{112          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.clear();}
\DoxyCodeLine{113          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}.clear();}
\DoxyCodeLine{114          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{115       \}}
\DoxyCodeLine{116    \}}
\DoxyCodeLine{117    }
\DoxyCodeLine{120    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa0b67864945fb2a6ccf76db0ee0984}{SetTotalSz}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{121       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{122       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}} != total\_2sz) \{}
\DoxyCodeLine{123          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}} = total\_2sz;}
\DoxyCodeLine{124          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{125       \}}
\DoxyCodeLine{126    \}}
\DoxyCodeLine{127    }
\DoxyCodeLine{130    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8debe1ee25a9ea86154932dd4a31a647}{SetCalculatedEigenvectorSet}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} level) \{}
\DoxyCodeLine{131       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.emplace(level);}
\DoxyCodeLine{132    \}}
\DoxyCodeLine{133       }
\DoxyCodeLine{137    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{138       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}, total\_sz);}
\DoxyCodeLine{139    \}}
\DoxyCodeLine{140    }
\DoxyCodeLine{144    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a941ea41537eec8a4e4dc88405f37af56}{CalculateNumElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{145       \textcolor{keywordflow}{if} (0 <= basis\_onsite \&\& basis\_onsite < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}) \{}
\DoxyCodeLine{146          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{147       \}}
\DoxyCodeLine{148       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{149          std::stringstream ss;}
\DoxyCodeLine{150          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_  << std::endl;}
\DoxyCodeLine{151          ss << \textcolor{stringliteral}{"{}Invalid onsite basis"{}} << std::endl;}
\DoxyCodeLine{152          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{153       \}}
\DoxyCodeLine{154    \}}
\DoxyCodeLine{155    }
\DoxyCodeLine{157    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a3304d8eb9d66f44fbdd833dd8a51d467}{PrintBasisOnsite}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{158       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}/2.0;}
\DoxyCodeLine{159       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}; ++row) \{}
\DoxyCodeLine{160          std::cout << \textcolor{stringliteral}{"{}row "{}} << row << \textcolor{stringliteral}{"{}: |Sz="{}} << magnitude\_spin -\/ row << \textcolor{stringliteral}{"{}>"{}} << std::endl;}
\DoxyCodeLine{161       \}}
\DoxyCodeLine{162    \}}
\DoxyCodeLine{163    }
\DoxyCodeLine{167    \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af1a2181378f1722f4bcbff01e07f8060}{CalculateTargetDim}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{168       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af1a2181378f1722f4bcbff01e07f8060}{CalculateTargetDim}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{169    \}}
\DoxyCodeLine{170    }
\DoxyCodeLine{175    \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a136b594e935bd5f33c0ddc5a5404abcd}{CalculateTargetDim}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{176       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af1a2181378f1722f4bcbff01e07f8060}{CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}, total\_sz);}
\DoxyCodeLine{177    \}}
\DoxyCodeLine{178    }
\DoxyCodeLine{181    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a0d5752987edf3d3ca6eca59696d32a6d}{GenerateBasis}}() \{}
\DoxyCodeLine{182       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a0d5752987edf3d3ca6eca59696d32a6d}{GenerateBasis}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{183    \}}
\DoxyCodeLine{184    }
\DoxyCodeLine{188    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a93629bfbf89753e784a731b15d385a14}{GenerateBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{189       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(total\_sz)) \{}
\DoxyCodeLine{190          std::stringstream ss;}
\DoxyCodeLine{191          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{192          ss << \textcolor{stringliteral}{"{}Invalid parameters (system\_size or magnitude\_spin or total\_sz)"{}} << std::endl;}
\DoxyCodeLine{193          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{194       \}}
\DoxyCodeLine{195       }
\DoxyCodeLine{196       \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{197       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{198       }
\DoxyCodeLine{199       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.count(total\_2sz) != 0) \{}
\DoxyCodeLine{200          \textcolor{keywordflow}{return};}
\DoxyCodeLine{201       \}}
\DoxyCodeLine{202       }
\DoxyCodeLine{203       std::cout << \textcolor{stringliteral}{"{}Generating Basis..."{}} << std::flush;}
\DoxyCodeLine{204       }
\DoxyCodeLine{205       \textcolor{keyword}{const} \textcolor{keywordtype}{int} shifted\_2sz = (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} -\/ total\_2sz)/2;}
\DoxyCodeLine{206       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} dim\_target = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af1a2181378f1722f4bcbff01e07f8060}{CalculateTargetDim}}(total\_sz);}
\DoxyCodeLine{207       std::vector<std::vector<int>> partition\_integers;}
\DoxyCodeLine{208       \mbox{\hyperlink{namespacecompnal_1_1utility_a2580357fcc88b1c7bac5627e5b47925f}{utility::GenerateIntegerPartition}}(\&partition\_integers, shifted\_2sz, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{209       }
\DoxyCodeLine{210       std::vector<LInt> site\_constant(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}});}
\DoxyCodeLine{211       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; ++site) \{}
\DoxyCodeLine{212          site\_constant[site] = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}, site));}
\DoxyCodeLine{213       \}}
\DoxyCodeLine{214       }
\DoxyCodeLine{215       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.count(total\_2sz) == 0) \{}
\DoxyCodeLine{216          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}[total\_2sz] = std::vector<LInt>();}
\DoxyCodeLine{217       \}}
\DoxyCodeLine{218       }
\DoxyCodeLine{219       std::vector<LInt>().swap(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz));}
\DoxyCodeLine{220       }
\DoxyCodeLine{221 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{222       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{223       std::vector<std::vector<LInt>> temp\_basis(num\_threads);}
\DoxyCodeLine{224       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&integer\_list: partition\_integers) \{}
\DoxyCodeLine{225          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition1 = (0 < integer\_list.size()) \&\& (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()) <= \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}});}
\DoxyCodeLine{226          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition2 = (integer\_list.size() == 0) \&\& (shifted\_2sz  == 0);}
\DoxyCodeLine{227          \textcolor{keywordflow}{if} (condition1 || condition2) \{}
\DoxyCodeLine{228             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()); j < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; ++j) \{}
\DoxyCodeLine{229                integer\_list.push\_back(0);}
\DoxyCodeLine{230             \}}
\DoxyCodeLine{231             }
\DoxyCodeLine{232             \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} size = \mbox{\hyperlink{namespacecompnal_1_1utility_a994046cacd6facdee7cfde9aa3b9626c}{utility::CalculateNumCombination}}(integer\_list);}
\DoxyCodeLine{233             std::vector<std::vector<int>> temp\_partition\_integer(num\_threads);}
\DoxyCodeLine{234             }
\DoxyCodeLine{235 \textcolor{preprocessor}{\#pragma omp parallel num\_threads (num\_threads)}}
\DoxyCodeLine{236             \{}
\DoxyCodeLine{237                \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{238                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} loop\_begin = thread\_num*size/num\_threads;}
\DoxyCodeLine{239                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} loop\_end   = (thread\_num + 1)*size/num\_threads;}
\DoxyCodeLine{240                temp\_partition\_integer[thread\_num] = integer\_list;}
\DoxyCodeLine{241                \mbox{\hyperlink{namespacecompnal_1_1utility_ad87f45a3383a5b141b1804d8e8ec558d}{utility::CalculateNthPermutation}}(\&temp\_partition\_integer[thread\_num], loop\_begin);}
\DoxyCodeLine{242                }
\DoxyCodeLine{243                \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = loop\_begin; j < loop\_end; ++j) \{}
\DoxyCodeLine{244                   \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} basis\_global = 0;}
\DoxyCodeLine{245                   \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_begin = temp\_partition\_integer[thread\_num].begin();}
\DoxyCodeLine{246                   \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_end   = temp\_partition\_integer[thread\_num].end();}
\DoxyCodeLine{247                   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} itr = iter\_begin; itr != iter\_end; ++itr) \{}
\DoxyCodeLine{248                      basis\_global += *itr*site\_constant[std::distance(iter\_begin, itr)];}
\DoxyCodeLine{249                   \}}
\DoxyCodeLine{250                   temp\_basis[thread\_num].push\_back(basis\_global);}
\DoxyCodeLine{251                   std::next\_permutation(temp\_partition\_integer[thread\_num].begin(), temp\_partition\_integer[thread\_num].end());}
\DoxyCodeLine{252                \}}
\DoxyCodeLine{253             \}}
\DoxyCodeLine{254          \}}
\DoxyCodeLine{255       \}}
\DoxyCodeLine{256       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&basis: temp\_basis) \{}
\DoxyCodeLine{257          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz).insert(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz).end(), basis.begin(), basis.end());}
\DoxyCodeLine{258          std::vector<LInt>().swap(basis);}
\DoxyCodeLine{259       \}}
\DoxyCodeLine{260       }
\DoxyCodeLine{261 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{262       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz).reserve(dim\_target);}
\DoxyCodeLine{263       }
\DoxyCodeLine{264       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&integer\_list: partition\_integers) \{}
\DoxyCodeLine{265          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition1 = (0 < integer\_list.size()) \&\& (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()) <= \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}});}
\DoxyCodeLine{266          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition2 = (integer\_list.size() == 0) \&\& (shifted\_2sz  == 0);}
\DoxyCodeLine{267          \textcolor{keywordflow}{if} (condition1 || condition2) \{}
\DoxyCodeLine{268             }
\DoxyCodeLine{269             \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = integer\_list.size(); j < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; ++j) \{}
\DoxyCodeLine{270                integer\_list.push\_back(0);}
\DoxyCodeLine{271             \}}
\DoxyCodeLine{272             }
\DoxyCodeLine{273             std::sort(integer\_list.begin(), integer\_list.end());}
\DoxyCodeLine{274             }
\DoxyCodeLine{275             \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{276                \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} basis\_global = 0;}
\DoxyCodeLine{277                \textcolor{keywordflow}{for} (std::size\_t j = 0; j < integer\_list.size(); ++j) \{}
\DoxyCodeLine{278                   basis\_global += integer\_list[j]*site\_constant[j];}
\DoxyCodeLine{279                \}}
\DoxyCodeLine{280                \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz).push\_back(basis\_global);}
\DoxyCodeLine{281             \} \textcolor{keywordflow}{while} (std::next\_permutation(integer\_list.begin(), integer\_list.end()));}
\DoxyCodeLine{282          \}}
\DoxyCodeLine{283       \}}
\DoxyCodeLine{284       }
\DoxyCodeLine{285 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{286       }
\DoxyCodeLine{287       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}}\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz).size()) != dim\_target) \{}
\DoxyCodeLine{288          std::stringstream ss;}
\DoxyCodeLine{289          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{290          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{291       \}}
\DoxyCodeLine{292       }
\DoxyCodeLine{293       std::sort(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz).begin(), \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz).end());}
\DoxyCodeLine{294       }
\DoxyCodeLine{295       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}.count(total\_2sz) == 0) \{}
\DoxyCodeLine{296          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}[total\_2sz] = \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<LInt, LInt>}}();}
\DoxyCodeLine{297       \}}
\DoxyCodeLine{298       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}.at(total\_2sz).clear();}
\DoxyCodeLine{299       }
\DoxyCodeLine{300       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < dim\_target; ++i) \{}
\DoxyCodeLine{301          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}.at(total\_2sz)[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(total\_2sz)[i]] = i;}
\DoxyCodeLine{302       \}}
\DoxyCodeLine{303       }
\DoxyCodeLine{304       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{305       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{sparse\_matrix::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{306       std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating basis:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{307    \}}
\DoxyCodeLine{308    }
\DoxyCodeLine{313    std::vector<QType> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8bf413019e4ba0ae9e2822e3893e8d9c}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{314       }
\DoxyCodeLine{315       std::unordered\_set<QType> delta\_sector\_set\_m1;}
\DoxyCodeLine{316       std::unordered\_set<QType> delta\_sector\_set\_m2;}
\DoxyCodeLine{317       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{318          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{319             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{320                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{321             \}}
\DoxyCodeLine{322          \}}
\DoxyCodeLine{323       \}}
\DoxyCodeLine{324       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{325          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{326             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{327                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{328             \}}
\DoxyCodeLine{329          \}}
\DoxyCodeLine{330       \}}
\DoxyCodeLine{331       std::vector<QType> target\_sector\_set;}
\DoxyCodeLine{332       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{333          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{334             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{335             \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2 \&\& c1) \{}
\DoxyCodeLine{336                target\_sector\_set.push\_back(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{337             \}}
\DoxyCodeLine{338          \}}
\DoxyCodeLine{339       \}}
\DoxyCodeLine{340       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{341       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{342       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{343    \}}
\DoxyCodeLine{344    }
\DoxyCodeLine{350    std::vector<std::pair<QType, QType>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ade82ed7429ce5bd1bd1e38141342027e}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{351       std::unordered\_set<QType> delta\_sector\_set\_m1;}
\DoxyCodeLine{352       std::unordered\_set<QType> delta\_sector\_set\_m2;}
\DoxyCodeLine{353       std::unordered\_set<QType> delta\_sector\_set\_m3;}
\DoxyCodeLine{354       }
\DoxyCodeLine{355       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{356          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{357             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{358                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{359             \}}
\DoxyCodeLine{360          \}}
\DoxyCodeLine{361       \}}
\DoxyCodeLine{362       }
\DoxyCodeLine{363       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{364          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{365             \textcolor{keywordflow}{if} (m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{366                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{367             \}}
\DoxyCodeLine{368          \}}
\DoxyCodeLine{369       \}}
\DoxyCodeLine{370       }
\DoxyCodeLine{371       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{372          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{373             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{374                delta\_sector\_set\_m3.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{375             \}}
\DoxyCodeLine{376          \}}
\DoxyCodeLine{377       \}}
\DoxyCodeLine{378       }
\DoxyCodeLine{379       std::vector<std::pair<QType, QType>> target\_sector\_set;}
\DoxyCodeLine{380       }
\DoxyCodeLine{381       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{382          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{383             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{384                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{385                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(del\_sec\_m3 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{386                \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2 + del\_sec\_m3 \&\& c1 \&\& c2) \{}
\DoxyCodeLine{387                   target\_sector\_set.push\_back(\{}
\DoxyCodeLine{388                      del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}},}
\DoxyCodeLine{389                      del\_sec\_m3 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}}}
\DoxyCodeLine{390                   \});}
\DoxyCodeLine{391                \}}
\DoxyCodeLine{392             \}}
\DoxyCodeLine{393          \}}
\DoxyCodeLine{394       \}}
\DoxyCodeLine{395       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{396    \}}
\DoxyCodeLine{397    }
\DoxyCodeLine{404    std::vector<std::tuple<QType, QType, QType>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a08ea0601048493ce13b22c4dd3016e8f}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_4\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{405       std::unordered\_set<QType> delta\_sector\_set\_m1;}
\DoxyCodeLine{406       std::unordered\_set<QType> delta\_sector\_set\_m2;}
\DoxyCodeLine{407       std::unordered\_set<QType> delta\_sector\_set\_m3;}
\DoxyCodeLine{408       std::unordered\_set<QType> delta\_sector\_set\_m4;}
\DoxyCodeLine{409       }
\DoxyCodeLine{410       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{411          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{412             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{413                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{414             \}}
\DoxyCodeLine{415          \}}
\DoxyCodeLine{416       \}}
\DoxyCodeLine{417       }
\DoxyCodeLine{418       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{419          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{420             \textcolor{keywordflow}{if} (m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{421                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{422             \}}
\DoxyCodeLine{423          \}}
\DoxyCodeLine{424       \}}
\DoxyCodeLine{425       }
\DoxyCodeLine{426       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{427          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{428             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{429                delta\_sector\_set\_m3.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{430             \}}
\DoxyCodeLine{431          \}}
\DoxyCodeLine{432       \}}
\DoxyCodeLine{433       }
\DoxyCodeLine{434       \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} i = 0; i < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad0729e9e6d307d317752691580e02343}{row\_dim}}; ++i) \{}
\DoxyCodeLine{435          \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} j = m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i]; j < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{436             \textcolor{keywordflow}{if} (m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{437                delta\_sector\_set\_m4.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}[j])));}
\DoxyCodeLine{438             \}}
\DoxyCodeLine{439          \}}
\DoxyCodeLine{440       \}}
\DoxyCodeLine{441       }
\DoxyCodeLine{442       std::vector<std::tuple<QType, QType, QType>> target\_sector\_set;}
\DoxyCodeLine{443       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{444          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{445             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{446                \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m4: delta\_sector\_set\_m4) \{}
\DoxyCodeLine{447                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{448                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(del\_sec\_m1 + del\_sec\_m2 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{449                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(del\_sec\_m4 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{450                   \textcolor{keywordflow}{if} (del\_sec\_m1 + del\_sec\_m2 == del\_sec\_m3 + del\_sec\_m4 \&\& c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{451                      target\_sector\_set.push\_back(\{}
\DoxyCodeLine{452                         del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}},}
\DoxyCodeLine{453                         del\_sec\_m1 + del\_sec\_m2 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}},}
\DoxyCodeLine{454                         del\_sec\_m4 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}}}
\DoxyCodeLine{455                      \});}
\DoxyCodeLine{456                   \}}
\DoxyCodeLine{457                \}}
\DoxyCodeLine{458             \}}
\DoxyCodeLine{459          \}}
\DoxyCodeLine{460       \}}
\DoxyCodeLine{461       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{462    \}}
\DoxyCodeLine{463    }
\DoxyCodeLine{469    \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_afc882f8b78ada9a87ccb0ffade4ae7ea}{isValidQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{470       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{471       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{472       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = ((system\_size*magnitude\_2spin -\/ total\_2sz)\%2 == 0);}
\DoxyCodeLine{473       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (-\/system\_size*magnitude\_2spin <= total\_2sz);}
\DoxyCodeLine{474       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (total\_2sz <= system\_size*magnitude\_2spin);}
\DoxyCodeLine{475       \textcolor{keywordflow}{if} (c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{476          \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{477       \}}
\DoxyCodeLine{478       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{479          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{480       \}}
\DoxyCodeLine{481    \}}
\DoxyCodeLine{482    }
\DoxyCodeLine{488    \textcolor{keyword}{static} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a96a0a0d9c6dbf1da3f658782ccf858d4}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz) \{}
\DoxyCodeLine{489       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{490       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae4686d536414d2945fc3ab0d7d53faf0}{isValidQNumber}}(system\_size, magnitude\_spin, total\_sz)) \{}
\DoxyCodeLine{491          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{492       \}}
\DoxyCodeLine{493       \textcolor{keywordflow}{if} (system\_size <= 0) \{}
\DoxyCodeLine{494          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{495       \}}
\DoxyCodeLine{496       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz);}
\DoxyCodeLine{497       \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_total\_2sz = system\_size*magnitude\_2spin;}
\DoxyCodeLine{498       std::vector<std::vector<LInt>> dim(system\_size, std::vector<LInt>(max\_total\_2sz + 1));}
\DoxyCodeLine{499       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{500          dim[0][(s + magnitude\_2spin)/2] = 1;}
\DoxyCodeLine{501       \}}
\DoxyCodeLine{502       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 1; site < system\_size; site++) \{}
\DoxyCodeLine{503          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{504             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s\_prev = -\/magnitude\_2spin*site; s\_prev <= magnitude\_2spin*site; s\_prev += 2) \{}
\DoxyCodeLine{505                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} a = dim[site    ][(s + s\_prev + magnitude\_2spin*(site + 1))/2];}
\DoxyCodeLine{506                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a5c65468895022d33488c22744a8c46fc}{LInt}} b = dim[site -\/ 1][(s\_prev + magnitude\_2spin*site)/2];}
\DoxyCodeLine{507                \textcolor{keywordflow}{if} (a >= INT64\_MAX -\/ b) \{}
\DoxyCodeLine{508                   \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Overflow detected for sumation using uint64\_t"{}});}
\DoxyCodeLine{509                \}}
\DoxyCodeLine{510                dim[site][(s + s\_prev + magnitude\_2spin*(site + 1))/2] = a + b;}
\DoxyCodeLine{511             \}}
\DoxyCodeLine{512          \}}
\DoxyCodeLine{513       \}}
\DoxyCodeLine{514       \textcolor{keywordflow}{return} dim[system\_size -\/ 1][(total\_2sz + max\_total\_2sz)/2];}
\DoxyCodeLine{515    \}}
\DoxyCodeLine{516    }
\DoxyCodeLine{520    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a5de77a6360e6d833f90ea95aeab2cbad}{CreateOnsiteOperatorSx}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{521       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{522       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{523       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{524       \textcolor{keywordtype}{int} a = 0;}
\DoxyCodeLine{525       \textcolor{keywordtype}{int} b = 1;}
\DoxyCodeLine{526       }
\DoxyCodeLine{527       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{528       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{529       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{530       }
\DoxyCodeLine{531       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite -\/ 1; ++row) \{}
\DoxyCodeLine{532          a = row;}
\DoxyCodeLine{533          b = row -\/ 1;}
\DoxyCodeLine{534          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{535          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{536          }
\DoxyCodeLine{537          a = row;}
\DoxyCodeLine{538          b = row + 1;}
\DoxyCodeLine{539          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{540          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{541          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{542       \}}
\DoxyCodeLine{543       }
\DoxyCodeLine{544       a = dim\_onsite -\/ 1;}
\DoxyCodeLine{545       b = dim\_onsite -\/ 2;}
\DoxyCodeLine{546       }
\DoxyCodeLine{547       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{548       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{549       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{550       }
\DoxyCodeLine{551       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{552    \}}
\DoxyCodeLine{553    }
\DoxyCodeLine{557    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ab2f7b9f0f8a196cbe294b72857980ed2}{CreateOnsiteOperatoriSy}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{558       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{559       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{560       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{561       \textcolor{keywordtype}{int} a = 0;}
\DoxyCodeLine{562       \textcolor{keywordtype}{int} b = 1;}
\DoxyCodeLine{563       }
\DoxyCodeLine{564       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{565       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{566       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{567       }
\DoxyCodeLine{568       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite -\/ 1; ++row) \{}
\DoxyCodeLine{569          a = row;}
\DoxyCodeLine{570          b = row -\/ 1;}
\DoxyCodeLine{571          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(-\/0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{572          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{573          }
\DoxyCodeLine{574          a = row;}
\DoxyCodeLine{575          b = row + 1;}
\DoxyCodeLine{576          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{577          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{578          }
\DoxyCodeLine{579          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{580       \}}
\DoxyCodeLine{581       }
\DoxyCodeLine{582       a = dim\_onsite -\/ 1;}
\DoxyCodeLine{583       b = dim\_onsite -\/ 2;}
\DoxyCodeLine{584       }
\DoxyCodeLine{585       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(-\/0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{586       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(b);}
\DoxyCodeLine{587       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{588       }
\DoxyCodeLine{589       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{590    \}}
\DoxyCodeLine{591    }
\DoxyCodeLine{595    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abc1ef4288c88f2488145568351d929d2}{CreateOnsiteOperatorSz}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{596       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{597       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{598       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{599       }
\DoxyCodeLine{600       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{601          \textcolor{keyword}{const} RealType val = magnitude\_spin -\/ row;}
\DoxyCodeLine{602          \textcolor{keywordflow}{if} (val != 0.0) \{}
\DoxyCodeLine{603             matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(val);}
\DoxyCodeLine{604             matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(row);}
\DoxyCodeLine{605          \}}
\DoxyCodeLine{606          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{607       \}}
\DoxyCodeLine{608       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{609    \}}
\DoxyCodeLine{610    }
\DoxyCodeLine{614    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a715d6a19d7c935934966a37ab72a27fc}{CreateOnsiteOperatorSp}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{615       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{616       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{617       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{618       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{619          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*2*row -\/ row*(row + 1)));}
\DoxyCodeLine{620          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(row);}
\DoxyCodeLine{621          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[row] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{622       \}}
\DoxyCodeLine{623       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{624       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{625    \}}
\DoxyCodeLine{626    }
\DoxyCodeLine{630    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7757b492b357ad1238ace40671bc9895}{CreateOnsiteOperatorSm}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} magnitude\_spin) \{}
\DoxyCodeLine{631       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(magnitude\_spin);}
\DoxyCodeLine{632       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{633       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{634       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{635          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*2*row -\/ row*(row + 1)));}
\DoxyCodeLine{636          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.push\_back(row -\/ 1);}
\DoxyCodeLine{637          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a9d168c9d0e3e508f151d1ab7ee411037}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a79a056edc2d34eb11aa3cae611aa5e0b}{col}}.size();}
\DoxyCodeLine{638       \}}
\DoxyCodeLine{639       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{640    \}}
\DoxyCodeLine{641    }
\DoxyCodeLine{646    \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} row, \textcolor{keyword}{const} \textcolor{keywordtype}{int} col) \{}
\DoxyCodeLine{647       \textcolor{keywordflow}{return} col -\/ row;}
\DoxyCodeLine{648    \}}
\DoxyCodeLine{649 }
\DoxyCodeLine{652    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; \}}
\DoxyCodeLine{653    }
\DoxyCodeLine{656    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ac08fdfaf7f9574d95c5a450b67104dd2}{GetDimOnsite}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}; \}}
\DoxyCodeLine{657       }
\DoxyCodeLine{660    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9ec6e2ae96a566a5775017faccdcb35f}{GetTotalSz}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}}; \}}
\DoxyCodeLine{661    }
\DoxyCodeLine{664    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9885c94867739757b8408566fe84326}{GetMagnitudeSpin}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}; \}}
\DoxyCodeLine{665    }
\DoxyCodeLine{668    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a30092d8e74a2246007842fb4dfcefcf8}{GetOnsiteOperatorSx}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a482541fe5c7239b8de7982d8aed891b9}{onsite\_operator\_sx\_}}; \}}
\DoxyCodeLine{669    }
\DoxyCodeLine{672    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a98076b01b7cd2adb89ce89f1ec9da89d}{GetOnsiteOperatoriSy}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aed9107549c634b2fb418968479eedffa}{onsite\_operator\_isy\_}}; \}}
\DoxyCodeLine{673    }
\DoxyCodeLine{676    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a506fddc0454a4008ed2cda1315b59f1e}{GetOnsiteOperatorSz}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abfa21ea7f92f51e8514542414ae33ccb}{onsite\_operator\_sz\_}}; \}}
\DoxyCodeLine{677    }
\DoxyCodeLine{680    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af28691e881c5f8b981c8e6712b29283b}{GetOnsiteOperatorSp}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa158ac550bb1a52a0833c2f955384cb8}{onsite\_operator\_sp\_}}; \}}
\DoxyCodeLine{681    }
\DoxyCodeLine{684    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a66ad7be43af97b8162f2aadeda0512ad}{GetOnsiteOperatorSm}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a813e8a32bf3b2ec8deba2c6092d4682d}{onsite\_operator\_sm\_}}; \}}
\DoxyCodeLine{685    }
\DoxyCodeLine{688    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_set<int> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a49ec19ada4660c35eb02fa6edfab3f8f}{GetCalculatedEigenvectorSet}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{689       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{690    \}}
\DoxyCodeLine{691    }
\DoxyCodeLine{694    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<int, std::vector<LInt>}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a46136b0caf9dfff52dc335d46e9b33c9}{GetBases}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{695       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}};}
\DoxyCodeLine{696    \}}
\DoxyCodeLine{697    }
\DoxyCodeLine{700    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<int, Map<LInt, LInt>}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a38ab2739b21c2fd30d45884cb45599c3}{GetBasesInv}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{701       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}};}
\DoxyCodeLine{702    \}}
\DoxyCodeLine{703    }
\DoxyCodeLine{708    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<LInt> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a26fe0fccbc983434f976563605b8512d}{GetBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{709       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(\mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz));}
\DoxyCodeLine{710    \}}
\DoxyCodeLine{711    }
\DoxyCodeLine{716    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<LInt, LInt>}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a2c43389a9cb5ce923c4c452bd7f467fa}{GetBasisInv}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7acc1f64e3855db32099e5ad7c798e4a}{HalfInt}} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{717       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}.at(\mbox{\hyperlink{namespacecompnal_1_1utility_abe920cc5242e3538cc6b4007331e516e}{utility::DoubleTheNumber}}(total\_sz));}
\DoxyCodeLine{718    \}}
\DoxyCodeLine{719    }
\DoxyCodeLine{723    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<LInt> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad33474be6ba96d36f4c2a8b4bc24d854}{GetTargetBasis}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{724       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}}.at(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{725    \}}
\DoxyCodeLine{726    }
\DoxyCodeLine{730    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<LInt, LInt>}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a17a62818abc3d0a017b01e42ee04648a}{GetTargetBasisInv}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{731       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}}.at(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{732    \}}
\DoxyCodeLine{733    }
\DoxyCodeLine{734 \textcolor{keyword}{protected}:}
\DoxyCodeLine{735    }
\DoxyCodeLine{737    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a482541fe5c7239b8de7982d8aed891b9}{onsite\_operator\_sx\_}};}
\DoxyCodeLine{738    }
\DoxyCodeLine{740    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aed9107549c634b2fb418968479eedffa}{onsite\_operator\_isy\_}};}
\DoxyCodeLine{741    }
\DoxyCodeLine{743    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abfa21ea7f92f51e8514542414ae33ccb}{onsite\_operator\_sz\_}};}
\DoxyCodeLine{744    }
\DoxyCodeLine{746    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa158ac550bb1a52a0833c2f955384cb8}{onsite\_operator\_sp\_}};}
\DoxyCodeLine{747    }
\DoxyCodeLine{749    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a813e8a32bf3b2ec8deba2c6092d4682d}{onsite\_operator\_sm\_}};}
\DoxyCodeLine{750    }
\DoxyCodeLine{752    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}} = 0;}
\DoxyCodeLine{753    }
\DoxyCodeLine{755    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}} = 0;}
\DoxyCodeLine{756    }
\DoxyCodeLine{758    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}} = 2;}
\DoxyCodeLine{759    }
\DoxyCodeLine{761    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} = 1;}
\DoxyCodeLine{762       }
\DoxyCodeLine{764    std::unordered\_set<int> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{765    }
\DoxyCodeLine{768    \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<int, std::vector<LInt>}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a879f01c33bdbe933f64782b79ec4ec30}{bases\_}};}
\DoxyCodeLine{769    }
\DoxyCodeLine{772    \mbox{\hyperlink{namespacecompnal_a7d6082c366cc92ba48d14a1f91c7e223}{Map<int, Map<LInt, LInt>}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a27a5d2863dbc97bafabb753641113fd7}{bases\_inv\_}};}
\DoxyCodeLine{773    }
\DoxyCodeLine{775    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a580d5de16a28c5246363c3a1b2975430}{SetOnsiteOperator}}() \{}
\DoxyCodeLine{776       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a482541fe5c7239b8de7982d8aed891b9}{onsite\_operator\_sx\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a5de77a6360e6d833f90ea95aeab2cbad}{CreateOnsiteOperatorSx}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{777       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aed9107549c634b2fb418968479eedffa}{onsite\_operator\_isy\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ab2f7b9f0f8a196cbe294b72857980ed2}{CreateOnsiteOperatoriSy}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{778       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abfa21ea7f92f51e8514542414ae33ccb}{onsite\_operator\_sz\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abc1ef4288c88f2488145568351d929d2}{CreateOnsiteOperatorSz}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{779       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa158ac550bb1a52a0833c2f955384cb8}{onsite\_operator\_sp\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a715d6a19d7c935934966a37ab72a27fc}{CreateOnsiteOperatorSp}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{780       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a813e8a32bf3b2ec8deba2c6092d4682d}{onsite\_operator\_sm\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7757b492b357ad1238ace40671bc9895}{CreateOnsiteOperatorSm}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{781    \}}
\DoxyCodeLine{782    }
\DoxyCodeLine{783 \};}
\DoxyCodeLine{784 }
\DoxyCodeLine{785 }
\DoxyCodeLine{786 }
\DoxyCodeLine{787 \}}
\DoxyCodeLine{788 \}}
\DoxyCodeLine{789 }
\DoxyCodeLine{790 }
\DoxyCodeLine{791 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_BASE\_U1SPIN\_1D\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
