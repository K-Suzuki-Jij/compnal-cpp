\hypertarget{base__u1__spin__1d_8hpp_source}{}\doxysection{base\+\_\+u1\+\_\+spin\+\_\+1d.\+hpp}
\label{base__u1__spin__1d_8hpp_source}\index{src/model/base\_u1\_spin\_1d.hpp@{src/model/base\_u1\_spin\_1d.hpp}}
\mbox{\hyperlink{base__u1__spin__1d_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/18.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_MODEL\_BASE\_U1SPIN\_1D\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_MODEL\_BASE\_U1SPIN\_1D\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <unordered\_set>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{32 \textcolor{keyword}{namespace }model \{}
\DoxyCodeLine{33 }
\DoxyCodeLine{36 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{37 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}} \{}
\DoxyCodeLine{38    }
\DoxyCodeLine{40    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{41    }
\DoxyCodeLine{43    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aabf62e609b35ab3962c6f793e0585e02}{QType}} = double;}
\DoxyCodeLine{44    }
\DoxyCodeLine{45 \textcolor{keyword}{public}:}
\DoxyCodeLine{46    }
\DoxyCodeLine{48    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a44c9489af0b9d886187ffa94b7cbecad}{ValueType}} = RealType;}
\DoxyCodeLine{49    }
\DoxyCodeLine{50    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{52    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{54 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abdfcbc3475819c0858af77cf31e4b164}{BaseU1Spin\_1D}}() \{}
\DoxyCodeLine{55       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a580d5de16a28c5246363c3a1b2975430}{SetOnsiteOperator}}();}
\DoxyCodeLine{56    \}}
\DoxyCodeLine{57    }
\DoxyCodeLine{60    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a20288b7e59875d82c99307127877d060}{BaseU1Spin\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}}() \{}
\DoxyCodeLine{61       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ab34e5e3dd6fdb9581c785c92f3ded892}{SetSystemSize}}(system\_size);}
\DoxyCodeLine{62    \}}
\DoxyCodeLine{63    }
\DoxyCodeLine{67    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a868c9b7ff1bb2d8ad976959f1013b044}{BaseU1Spin\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}}(system\_size) \{}
\DoxyCodeLine{68       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a200a44a8ea5b4d47d904208b24984f98}{SetMagnitudeSpin}}(magnitude\_spin);}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{75    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a53d26e80db8732863ad329df62729bea}{BaseU1Spin\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin, \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d}{BaseU1Spin\_1D}}(system\_size, magnitude\_spin) \{}
\DoxyCodeLine{76       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a4412e8c37d3c49bab4c5f983b89d06e9}{SetTotalSz}}(total\_sz);}
\DoxyCodeLine{77    \}}
\DoxyCodeLine{78    }
\DoxyCodeLine{81    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ab34e5e3dd6fdb9581c785c92f3ded892}{SetSystemSize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size) \{}
\DoxyCodeLine{82       \textcolor{keywordflow}{if} (system\_size <= 0) \{}
\DoxyCodeLine{83          std::stringstream ss;}
\DoxyCodeLine{84          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_ << std::endl;}
\DoxyCodeLine{85          ss << \textcolor{stringliteral}{"{}system\_size must be a non-\/negative integer"{}} << std::endl;}
\DoxyCodeLine{86          ss << \textcolor{stringliteral}{"{}system\_size="{}} << system\_size << \textcolor{stringliteral}{"{}is not allowed"{}} << std::endl;}
\DoxyCodeLine{87          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{88       \}}
\DoxyCodeLine{89       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}} != system\_size) \{}
\DoxyCodeLine{90          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}} = system\_size;}
\DoxyCodeLine{91          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.clear();}
\DoxyCodeLine{92          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}.clear();}
\DoxyCodeLine{93          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{94       \}}
\DoxyCodeLine{95    \}}
\DoxyCodeLine{96    }
\DoxyCodeLine{99    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a200a44a8ea5b4d47d904208b24984f98}{SetMagnitudeSpin}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin) \{}
\DoxyCodeLine{100       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{101       \textcolor{keywordflow}{if} (magnitude\_2spin <= 0) \{}
\DoxyCodeLine{102          std::stringstream ss;}
\DoxyCodeLine{103          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_ << std::endl;}
\DoxyCodeLine{104          ss << \textcolor{stringliteral}{"{}Please set magnitude\_2spin > 0"{}} << std::endl;}
\DoxyCodeLine{105          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{106       \}}
\DoxyCodeLine{107       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} != magnitude\_2spin) \{}
\DoxyCodeLine{108          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} = magnitude\_2spin;}
\DoxyCodeLine{109          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}      = magnitude\_2spin + 1;}
\DoxyCodeLine{110          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a580d5de16a28c5246363c3a1b2975430}{SetOnsiteOperator}}();}
\DoxyCodeLine{111          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.clear();}
\DoxyCodeLine{112          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}.clear();}
\DoxyCodeLine{113          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{114       \}}
\DoxyCodeLine{115    \}}
\DoxyCodeLine{116    }
\DoxyCodeLine{119    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a4412e8c37d3c49bab4c5f983b89d06e9}{SetTotalSz}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz) \{}
\DoxyCodeLine{120       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{121       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}} != total\_2sz) \{}
\DoxyCodeLine{122          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}} = total\_2sz;}
\DoxyCodeLine{123          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{124       \}}
\DoxyCodeLine{125    \}}
\DoxyCodeLine{126    }
\DoxyCodeLine{129    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a1eaf81e0f4eb1f295d203984ede5aabc}{SetCalculatedEigenvectorSet}}(\textcolor{keyword}{const} std::int64\_t level) \{}
\DoxyCodeLine{130       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}}.emplace(level);}
\DoxyCodeLine{131    \}}
\DoxyCodeLine{132       }
\DoxyCodeLine{136    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{137       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}, total\_sz);}
\DoxyCodeLine{138    \}}
\DoxyCodeLine{139    }
\DoxyCodeLine{143    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a941ea41537eec8a4e4dc88405f37af56}{CalculateNumElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{144       \textcolor{keywordflow}{if} (0 <= basis\_onsite \&\& basis\_onsite < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}) \{}
\DoxyCodeLine{145          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{146       \}}
\DoxyCodeLine{147       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{148          std::stringstream ss;}
\DoxyCodeLine{149          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_  << std::endl;}
\DoxyCodeLine{150          ss << \textcolor{stringliteral}{"{}Invalid onsite basis"{}} << std::endl;}
\DoxyCodeLine{151          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{152       \}}
\DoxyCodeLine{153    \}}
\DoxyCodeLine{154    }
\DoxyCodeLine{156    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a3304d8eb9d66f44fbdd833dd8a51d467}{PrintBasisOnsite}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{157       \textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}/2.0;}
\DoxyCodeLine{158       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}; ++row) \{}
\DoxyCodeLine{159          std::cout << \textcolor{stringliteral}{"{}row "{}} << row << \textcolor{stringliteral}{"{}: |Sz="{}} << magnitude\_spin -\/ row << \textcolor{stringliteral}{"{}>"{}} << std::endl;}
\DoxyCodeLine{160       \}}
\DoxyCodeLine{161    \}}
\DoxyCodeLine{162    }
\DoxyCodeLine{166    std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a2457e64fe751736bc3e533aebe3db1d3}{CalculateTargetDim}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{167       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a2457e64fe751736bc3e533aebe3db1d3}{CalculateTargetDim}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{168    \}}
\DoxyCodeLine{169    }
\DoxyCodeLine{174    std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a931e027ba146cb7283de8e3a0fa4b58e}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{175       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a2457e64fe751736bc3e533aebe3db1d3}{CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}, total\_sz);}
\DoxyCodeLine{176    \}}
\DoxyCodeLine{177    }
\DoxyCodeLine{180    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a0d5752987edf3d3ca6eca59696d32a6d}{GenerateBasis}}() \{}
\DoxyCodeLine{181       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a0d5752987edf3d3ca6eca59696d32a6d}{GenerateBasis}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{182    \}}
\DoxyCodeLine{183    }
\DoxyCodeLine{187    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a60f9a90328ba84738a35f5d0c2e519c7}{GenerateBasis}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz) \{}
\DoxyCodeLine{188       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(total\_sz)) \{}
\DoxyCodeLine{189          std::stringstream ss;}
\DoxyCodeLine{190          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_ << std::endl;}
\DoxyCodeLine{191          ss << \textcolor{stringliteral}{"{}Invalid parameters (system\_size or magnitude\_spin or total\_sz)"{}} << std::endl;}
\DoxyCodeLine{192          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{193       \}}
\DoxyCodeLine{194       }
\DoxyCodeLine{195       \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{196       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{197       }
\DoxyCodeLine{198       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.count(total\_2sz) != 0) \{}
\DoxyCodeLine{199          \textcolor{keywordflow}{return};}
\DoxyCodeLine{200       \}}
\DoxyCodeLine{201       }
\DoxyCodeLine{202       std::cout << \textcolor{stringliteral}{"{}Generating Basis..."{}} << std::flush;}
\DoxyCodeLine{203       }
\DoxyCodeLine{204       \textcolor{keyword}{const} \textcolor{keywordtype}{int} shifted\_2sz = (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} -\/ total\_2sz)/2;}
\DoxyCodeLine{205       \textcolor{keyword}{const} std::int64\_t dim\_target = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a2457e64fe751736bc3e533aebe3db1d3}{CalculateTargetDim}}(total\_sz);}
\DoxyCodeLine{206       std::vector<std::vector<int>> partition\_integers;}
\DoxyCodeLine{207       \mbox{\hyperlink{namespacecompnal_1_1utility_a2580357fcc88b1c7bac5627e5b47925f}{utility::GenerateIntegerPartition}}(\&partition\_integers, shifted\_2sz, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{208       }
\DoxyCodeLine{209       std::vector<std::int64\_t> site\_constant(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}});}
\DoxyCodeLine{210       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; ++site) \{}
\DoxyCodeLine{211          site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}, site));}
\DoxyCodeLine{212       \}}
\DoxyCodeLine{213       }
\DoxyCodeLine{214       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.count(total\_2sz) == 0) \{}
\DoxyCodeLine{215          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}[total\_2sz] = std::vector<std::int64\_t>();}
\DoxyCodeLine{216       \}}
\DoxyCodeLine{217       }
\DoxyCodeLine{218       std::vector<std::int64\_t>().swap(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz));}
\DoxyCodeLine{219       }
\DoxyCodeLine{220 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{221       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{222       std::vector<std::vector<std::int64\_t>> temp\_basis(num\_threads);}
\DoxyCodeLine{223       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&integer\_list: partition\_integers) \{}
\DoxyCodeLine{224          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition1 = (0 < integer\_list.size()) \&\& (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()) <= \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}});}
\DoxyCodeLine{225          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition2 = (integer\_list.size() == 0) \&\& (shifted\_2sz  == 0);}
\DoxyCodeLine{226          \textcolor{keywordflow}{if} (condition1 || condition2) \{}
\DoxyCodeLine{227             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()); j < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; ++j) \{}
\DoxyCodeLine{228                integer\_list.push\_back(0);}
\DoxyCodeLine{229             \}}
\DoxyCodeLine{230             }
\DoxyCodeLine{231             \textcolor{keyword}{const} std::int64\_t size = \mbox{\hyperlink{namespacecompnal_1_1utility_a31be084029ddf129959d1682fd54cdf5}{utility::CalculateNumCombination}}(integer\_list);}
\DoxyCodeLine{232             std::vector<std::vector<int>> temp\_partition\_integer(num\_threads);}
\DoxyCodeLine{233             }
\DoxyCodeLine{234 \textcolor{preprocessor}{\#pragma omp parallel num\_threads (num\_threads)}}
\DoxyCodeLine{235             \{}
\DoxyCodeLine{236                \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{237                \textcolor{keyword}{const} std::int64\_t loop\_begin = thread\_num*size/num\_threads;}
\DoxyCodeLine{238                \textcolor{keyword}{const} std::int64\_t loop\_end   = (thread\_num + 1)*size/num\_threads;}
\DoxyCodeLine{239                temp\_partition\_integer[thread\_num] = integer\_list;}
\DoxyCodeLine{240                \mbox{\hyperlink{namespacecompnal_1_1utility_a6d7737688a03ef322d62fc96017af67a}{utility::CalculateNthPermutation}}(\&temp\_partition\_integer[thread\_num], loop\_begin);}
\DoxyCodeLine{241                }
\DoxyCodeLine{242                \textcolor{keywordflow}{for} (std::int64\_t j = loop\_begin; j < loop\_end; ++j) \{}
\DoxyCodeLine{243                   std::int64\_t basis\_global = 0;}
\DoxyCodeLine{244                   \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_begin = temp\_partition\_integer[thread\_num].begin();}
\DoxyCodeLine{245                   \textcolor{keyword}{const} \textcolor{keyword}{auto} iter\_end   = temp\_partition\_integer[thread\_num].end();}
\DoxyCodeLine{246                   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} itr = iter\_begin; itr != iter\_end; ++itr) \{}
\DoxyCodeLine{247                      basis\_global += *itr*site\_constant[std::distance(iter\_begin, itr)];}
\DoxyCodeLine{248                   \}}
\DoxyCodeLine{249                   temp\_basis[thread\_num].push\_back(basis\_global);}
\DoxyCodeLine{250                   std::next\_permutation(temp\_partition\_integer[thread\_num].begin(), temp\_partition\_integer[thread\_num].end());}
\DoxyCodeLine{251                \}}
\DoxyCodeLine{252             \}}
\DoxyCodeLine{253          \}}
\DoxyCodeLine{254       \}}
\DoxyCodeLine{255       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&basis: temp\_basis) \{}
\DoxyCodeLine{256          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz).insert(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz).end(), basis.begin(), basis.end());}
\DoxyCodeLine{257          std::vector<std::int64\_t>().swap(basis);}
\DoxyCodeLine{258       \}}
\DoxyCodeLine{259       }
\DoxyCodeLine{260 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{261       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz).reserve(dim\_target);}
\DoxyCodeLine{262       }
\DoxyCodeLine{263       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&integer\_list: partition\_integers) \{}
\DoxyCodeLine{264          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition1 = (0 < integer\_list.size()) \&\& (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(integer\_list.size()) <= \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}});}
\DoxyCodeLine{265          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} condition2 = (integer\_list.size() == 0) \&\& (shifted\_2sz  == 0);}
\DoxyCodeLine{266          \textcolor{keywordflow}{if} (condition1 || condition2) \{}
\DoxyCodeLine{267             }
\DoxyCodeLine{268             \textcolor{keywordflow}{for} (std::int64\_t j = integer\_list.size(); j < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; ++j) \{}
\DoxyCodeLine{269                integer\_list.push\_back(0);}
\DoxyCodeLine{270             \}}
\DoxyCodeLine{271             }
\DoxyCodeLine{272             std::sort(integer\_list.begin(), integer\_list.end());}
\DoxyCodeLine{273             }
\DoxyCodeLine{274             \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{275                std::int64\_t basis\_global = 0;}
\DoxyCodeLine{276                \textcolor{keywordflow}{for} (std::size\_t j = 0; j < integer\_list.size(); ++j) \{}
\DoxyCodeLine{277                   basis\_global += integer\_list[j]*site\_constant[j];}
\DoxyCodeLine{278                \}}
\DoxyCodeLine{279                \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz).push\_back(basis\_global);}
\DoxyCodeLine{280             \} \textcolor{keywordflow}{while} (std::next\_permutation(integer\_list.begin(), integer\_list.end()));}
\DoxyCodeLine{281          \}}
\DoxyCodeLine{282       \}}
\DoxyCodeLine{283       }
\DoxyCodeLine{284 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{285       }
\DoxyCodeLine{286       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz).size()) != dim\_target) \{}
\DoxyCodeLine{287          std::stringstream ss;}
\DoxyCodeLine{288          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << \textcolor{stringliteral}{"{} at "{}} << \_\_LINE\_\_ << std::endl;}
\DoxyCodeLine{289          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{290       \}}
\DoxyCodeLine{291       }
\DoxyCodeLine{292       std::sort(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz).begin(), \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz).end());}
\DoxyCodeLine{293       }
\DoxyCodeLine{294       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}.count(total\_2sz) == 0) \{}
\DoxyCodeLine{295          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}[total\_2sz] = std::unordered\_map<std::int64\_t, std::int64\_t>();}
\DoxyCodeLine{296       \}}
\DoxyCodeLine{297       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}.at(total\_2sz).clear();}
\DoxyCodeLine{298       }
\DoxyCodeLine{299       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target; ++i) \{}
\DoxyCodeLine{300          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}.at(total\_2sz)[\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(total\_2sz)[i]] = i;}
\DoxyCodeLine{301       \}}
\DoxyCodeLine{302       }
\DoxyCodeLine{303       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{304       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{sparse\_matrix::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{305       std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating basis:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{306    \}}
\DoxyCodeLine{307    }
\DoxyCodeLine{312    std::vector<QType> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8bf413019e4ba0ae9e2822e3893e8d9c}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{313       }
\DoxyCodeLine{314       std::unordered\_set<QType> delta\_sector\_set\_m1;}
\DoxyCodeLine{315       std::unordered\_set<QType> delta\_sector\_set\_m2;}
\DoxyCodeLine{316       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{317          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{318             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{319                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{320             \}}
\DoxyCodeLine{321          \}}
\DoxyCodeLine{322       \}}
\DoxyCodeLine{323       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{324          \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{325             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{326                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{327             \}}
\DoxyCodeLine{328          \}}
\DoxyCodeLine{329       \}}
\DoxyCodeLine{330       std::vector<QType> target\_sector\_set;}
\DoxyCodeLine{331       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{332          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{333             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{334             \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2 \&\& c1) \{}
\DoxyCodeLine{335                target\_sector\_set.push\_back(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{336             \}}
\DoxyCodeLine{337          \}}
\DoxyCodeLine{338       \}}
\DoxyCodeLine{339       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{340       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{341       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{342    \}}
\DoxyCodeLine{343    }
\DoxyCodeLine{349    std::vector<std::pair<QType, QType>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ade82ed7429ce5bd1bd1e38141342027e}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{350       std::unordered\_set<QType> delta\_sector\_set\_m1;}
\DoxyCodeLine{351       std::unordered\_set<QType> delta\_sector\_set\_m2;}
\DoxyCodeLine{352       std::unordered\_set<QType> delta\_sector\_set\_m3;}
\DoxyCodeLine{353       }
\DoxyCodeLine{354       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{355          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{356             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{357                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{358             \}}
\DoxyCodeLine{359          \}}
\DoxyCodeLine{360       \}}
\DoxyCodeLine{361       }
\DoxyCodeLine{362       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{363          \textcolor{keywordflow}{for} (std::int64\_t j = m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{364             \textcolor{keywordflow}{if} (m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{365                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{366             \}}
\DoxyCodeLine{367          \}}
\DoxyCodeLine{368       \}}
\DoxyCodeLine{369       }
\DoxyCodeLine{370       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{371          \textcolor{keywordflow}{for} (std::int64\_t j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{372             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{373                delta\_sector\_set\_m3.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{374             \}}
\DoxyCodeLine{375          \}}
\DoxyCodeLine{376       \}}
\DoxyCodeLine{377       }
\DoxyCodeLine{378       std::vector<std::pair<QType, QType>> target\_sector\_set;}
\DoxyCodeLine{379       }
\DoxyCodeLine{380       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{381          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{382             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{383                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{384                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(del\_sec\_m3 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{385                \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2 + del\_sec\_m3 \&\& c1 \&\& c2) \{}
\DoxyCodeLine{386                   target\_sector\_set.push\_back(\{}
\DoxyCodeLine{387                      del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}},}
\DoxyCodeLine{388                      del\_sec\_m3 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}}}
\DoxyCodeLine{389                   \});}
\DoxyCodeLine{390                \}}
\DoxyCodeLine{391             \}}
\DoxyCodeLine{392          \}}
\DoxyCodeLine{393       \}}
\DoxyCodeLine{394       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{395    \}}
\DoxyCodeLine{396    }
\DoxyCodeLine{403    std::vector<std::tuple<QType, QType, QType>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a08ea0601048493ce13b22c4dd3016e8f}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_4\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{404       std::unordered\_set<QType> delta\_sector\_set\_m1;}
\DoxyCodeLine{405       std::unordered\_set<QType> delta\_sector\_set\_m2;}
\DoxyCodeLine{406       std::unordered\_set<QType> delta\_sector\_set\_m3;}
\DoxyCodeLine{407       std::unordered\_set<QType> delta\_sector\_set\_m4;}
\DoxyCodeLine{408       }
\DoxyCodeLine{409       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{410          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{411             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{412                delta\_sector\_set\_m1.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{413             \}}
\DoxyCodeLine{414          \}}
\DoxyCodeLine{415       \}}
\DoxyCodeLine{416       }
\DoxyCodeLine{417       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{418          \textcolor{keywordflow}{for} (std::int64\_t j = m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{419             \textcolor{keywordflow}{if} (m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{420                delta\_sector\_set\_m2.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{421             \}}
\DoxyCodeLine{422          \}}
\DoxyCodeLine{423       \}}
\DoxyCodeLine{424       }
\DoxyCodeLine{425       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{426          \textcolor{keywordflow}{for} (std::int64\_t j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{427             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{428                delta\_sector\_set\_m3.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{429             \}}
\DoxyCodeLine{430          \}}
\DoxyCodeLine{431       \}}
\DoxyCodeLine{432       }
\DoxyCodeLine{433       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{434          \textcolor{keywordflow}{for} (std::int64\_t j = m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{435             \textcolor{keywordflow}{if} (m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{436                delta\_sector\_set\_m4.emplace(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{437             \}}
\DoxyCodeLine{438          \}}
\DoxyCodeLine{439       \}}
\DoxyCodeLine{440       }
\DoxyCodeLine{441       std::vector<std::tuple<QType, QType, QType>> target\_sector\_set;}
\DoxyCodeLine{442       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{443          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{444             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{445                \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m4: delta\_sector\_set\_m4) \{}
\DoxyCodeLine{446                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{447                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(del\_sec\_m1 + del\_sec\_m2 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{448                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(del\_sec\_m4 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{449                   \textcolor{keywordflow}{if} (del\_sec\_m1 + del\_sec\_m2 == del\_sec\_m3 + del\_sec\_m4 \&\& c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{450                      target\_sector\_set.push\_back(\{}
\DoxyCodeLine{451                         del\_sec\_m1 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}},}
\DoxyCodeLine{452                         del\_sec\_m1 + del\_sec\_m2 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}},}
\DoxyCodeLine{453                         del\_sec\_m4 + 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}}}
\DoxyCodeLine{454                      \});}
\DoxyCodeLine{455                   \}}
\DoxyCodeLine{456                \}}
\DoxyCodeLine{457             \}}
\DoxyCodeLine{458          \}}
\DoxyCodeLine{459       \}}
\DoxyCodeLine{460       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{461    \}}
\DoxyCodeLine{462    }
\DoxyCodeLine{468    \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af1c5be1ab60a0a335a52cc78bd9190d7}{isValidQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin, \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz) \{}
\DoxyCodeLine{469       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{470       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{471       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = ((system\_size*magnitude\_2spin -\/ total\_2sz)\%2 == 0);}
\DoxyCodeLine{472       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = (-\/system\_size*magnitude\_2spin <= total\_2sz);}
\DoxyCodeLine{473       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (total\_2sz <= system\_size*magnitude\_2spin);}
\DoxyCodeLine{474       \textcolor{keywordflow}{if} (c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{475          \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{476       \}}
\DoxyCodeLine{477       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{478          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{479       \}}
\DoxyCodeLine{480    \}}
\DoxyCodeLine{481    }
\DoxyCodeLine{487    \textcolor{keyword}{static} std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abe62f6fab5eb37595dc8bbbb99db7991}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin, \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz) \{}
\DoxyCodeLine{488       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{489       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae77f7a42530aabf69cf9bbd7b9e42dd9}{isValidQNumber}}(system\_size, magnitude\_spin, total\_sz)) \{}
\DoxyCodeLine{490          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{491       \}}
\DoxyCodeLine{492       \textcolor{keywordflow}{if} (system\_size <= 0) \{}
\DoxyCodeLine{493          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{494       \}}
\DoxyCodeLine{495       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{496       \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_total\_2sz = system\_size*magnitude\_2spin;}
\DoxyCodeLine{497       std::vector<std::vector<std::int64\_t>> dim(system\_size, std::vector<std::int64\_t>(max\_total\_2sz + 1));}
\DoxyCodeLine{498       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{499          dim[0][(s + magnitude\_2spin)/2] = 1;}
\DoxyCodeLine{500       \}}
\DoxyCodeLine{501       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 1; site < system\_size; site++) \{}
\DoxyCodeLine{502          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = -\/magnitude\_2spin; s <= magnitude\_2spin; s += 2) \{}
\DoxyCodeLine{503             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s\_prev = -\/magnitude\_2spin*site; s\_prev <= magnitude\_2spin*site; s\_prev += 2) \{}
\DoxyCodeLine{504                \textcolor{keyword}{const} std::int64\_t a = dim[site    ][(s + s\_prev + magnitude\_2spin*(site + 1))/2];}
\DoxyCodeLine{505                \textcolor{keyword}{const} std::int64\_t b = dim[site -\/ 1][(s\_prev + magnitude\_2spin*site)/2];}
\DoxyCodeLine{506                \textcolor{keywordflow}{if} (a >= INT64\_MAX -\/ b) \{}
\DoxyCodeLine{507                   \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Overflow detected for sumation using uint64\_t"{}});}
\DoxyCodeLine{508                \}}
\DoxyCodeLine{509                dim[site][(s + s\_prev + magnitude\_2spin*(site + 1))/2] = a + b;}
\DoxyCodeLine{510             \}}
\DoxyCodeLine{511          \}}
\DoxyCodeLine{512       \}}
\DoxyCodeLine{513       \textcolor{keywordflow}{return} dim[system\_size -\/ 1][(total\_2sz + max\_total\_2sz)/2];}
\DoxyCodeLine{514    \}}
\DoxyCodeLine{515    }
\DoxyCodeLine{519    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a63e052b4fac0a797486ae37f288775d8}{CreateOnsiteOperatorSx}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin) \{}
\DoxyCodeLine{520       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{521       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{522       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{523       \textcolor{keywordtype}{int} a = 0;}
\DoxyCodeLine{524       \textcolor{keywordtype}{int} b = 1;}
\DoxyCodeLine{525       }
\DoxyCodeLine{526       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{527       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{528       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{529       }
\DoxyCodeLine{530       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite -\/ 1; ++row) \{}
\DoxyCodeLine{531          a = row;}
\DoxyCodeLine{532          b = row -\/ 1;}
\DoxyCodeLine{533          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{534          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{535          }
\DoxyCodeLine{536          a = row;}
\DoxyCodeLine{537          b = row + 1;}
\DoxyCodeLine{538          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{539          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{540          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{541       \}}
\DoxyCodeLine{542       }
\DoxyCodeLine{543       a = dim\_onsite -\/ 1;}
\DoxyCodeLine{544       b = dim\_onsite -\/ 2;}
\DoxyCodeLine{545       }
\DoxyCodeLine{546       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt((magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1)) );}
\DoxyCodeLine{547       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{548       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{549       }
\DoxyCodeLine{550       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{551    \}}
\DoxyCodeLine{552    }
\DoxyCodeLine{556    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a805af825f870052d613484dfc32bf781}{CreateOnsiteOperatoriSy}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin) \{}
\DoxyCodeLine{557       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{558       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{559       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{560       \textcolor{keywordtype}{int} a = 0;}
\DoxyCodeLine{561       \textcolor{keywordtype}{int} b = 1;}
\DoxyCodeLine{562       }
\DoxyCodeLine{563       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{564       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{565       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{566       }
\DoxyCodeLine{567       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite -\/ 1; ++row) \{}
\DoxyCodeLine{568          a = row;}
\DoxyCodeLine{569          b = row -\/ 1;}
\DoxyCodeLine{570          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(-\/0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{571          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{572          }
\DoxyCodeLine{573          a = row;}
\DoxyCodeLine{574          b = row + 1;}
\DoxyCodeLine{575          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{576          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{577          }
\DoxyCodeLine{578          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{579       \}}
\DoxyCodeLine{580       }
\DoxyCodeLine{581       a = dim\_onsite -\/ 1;}
\DoxyCodeLine{582       b = dim\_onsite -\/ 2;}
\DoxyCodeLine{583       }
\DoxyCodeLine{584       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(-\/0.5*std::sqrt( (magnitude\_spin + 1)*(a + b + 1) -\/ (a + 1)*(b + 1) ) );}
\DoxyCodeLine{585       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(b);}
\DoxyCodeLine{586       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{587       }
\DoxyCodeLine{588       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{589    \}}
\DoxyCodeLine{590    }
\DoxyCodeLine{594    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a4b021604c01c8b7f9f2eab804cc78608}{CreateOnsiteOperatorSz}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin) \{}
\DoxyCodeLine{595       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{596       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{597       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{598       }
\DoxyCodeLine{599       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{600          \textcolor{keyword}{const} RealType val = magnitude\_spin -\/ row;}
\DoxyCodeLine{601          \textcolor{keywordflow}{if} (val != 0.0) \{}
\DoxyCodeLine{602             matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(val);}
\DoxyCodeLine{603             matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(row);}
\DoxyCodeLine{604          \}}
\DoxyCodeLine{605          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{606       \}}
\DoxyCodeLine{607       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{608    \}}
\DoxyCodeLine{609    }
\DoxyCodeLine{613    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a2c17c2baee22281d6d02f5dd5ab0b39d}{CreateOnsiteOperatorSp}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin) \{}
\DoxyCodeLine{614       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{615       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{616       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{617       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{618          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*2*row -\/ row*(row + 1)));}
\DoxyCodeLine{619          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(row);}
\DoxyCodeLine{620          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{621       \}}
\DoxyCodeLine{622       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[dim\_onsite] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{623       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{624    \}}
\DoxyCodeLine{625    }
\DoxyCodeLine{629    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae10de81ba249004460d22bd991efe4f9}{CreateOnsiteOperatorSm}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} magnitude\_spin) \{}
\DoxyCodeLine{630       \textcolor{keyword}{const} \textcolor{keywordtype}{int} magnitude\_2spin = \mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(magnitude\_spin);}
\DoxyCodeLine{631       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite      = magnitude\_2spin + 1;}
\DoxyCodeLine{632       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{633       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 1; row < dim\_onsite; ++row) \{}
\DoxyCodeLine{634          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(std::sqrt((magnitude\_spin + 1)*2*row -\/ row*(row + 1)));}
\DoxyCodeLine{635          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(row -\/ 1);}
\DoxyCodeLine{636          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{637       \}}
\DoxyCodeLine{638       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{639    \}}
\DoxyCodeLine{640    }
\DoxyCodeLine{645    \textcolor{keyword}{inline} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ad03c53376583b17781b280f5613ab1e4}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} row, \textcolor{keyword}{const} \textcolor{keywordtype}{int} col) \{}
\DoxyCodeLine{646       \textcolor{keywordflow}{return} col -\/ row;}
\DoxyCodeLine{647    \}}
\DoxyCodeLine{648 }
\DoxyCodeLine{651    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa81237fe786d60d4ba859a889d95040c}{GetSystemSize}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}}; \}}
\DoxyCodeLine{652    }
\DoxyCodeLine{655    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ac08fdfaf7f9574d95c5a450b67104dd2}{GetDimOnsite}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}}; \}}
\DoxyCodeLine{656       }
\DoxyCodeLine{659    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9ec6e2ae96a566a5775017faccdcb35f}{GetTotalSz}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}}; \}}
\DoxyCodeLine{660    }
\DoxyCodeLine{663    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9885c94867739757b8408566fe84326}{GetMagnitudeSpin}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}}; \}}
\DoxyCodeLine{664    }
\DoxyCodeLine{667    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a30092d8e74a2246007842fb4dfcefcf8}{GetOnsiteOperatorSx}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a482541fe5c7239b8de7982d8aed891b9}{onsite\_operator\_sx\_}}; \}}
\DoxyCodeLine{668    }
\DoxyCodeLine{671    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a98076b01b7cd2adb89ce89f1ec9da89d}{GetOnsiteOperatoriSy}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aed9107549c634b2fb418968479eedffa}{onsite\_operator\_isy\_}}; \}}
\DoxyCodeLine{672    }
\DoxyCodeLine{675    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a506fddc0454a4008ed2cda1315b59f1e}{GetOnsiteOperatorSz}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abfa21ea7f92f51e8514542414ae33ccb}{onsite\_operator\_sz\_}}; \}}
\DoxyCodeLine{676    }
\DoxyCodeLine{679    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_af28691e881c5f8b981c8e6712b29283b}{GetOnsiteOperatorSp}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa158ac550bb1a52a0833c2f955384cb8}{onsite\_operator\_sp\_}}; \}}
\DoxyCodeLine{680    }
\DoxyCodeLine{683    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a66ad7be43af97b8162f2aadeda0512ad}{GetOnsiteOperatorSm}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a813e8a32bf3b2ec8deba2c6092d4682d}{onsite\_operator\_sm\_}}; \}}
\DoxyCodeLine{684    }
\DoxyCodeLine{687    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_set<int> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a49ec19ada4660c35eb02fa6edfab3f8f}{GetCalculatedEigenvectorSet}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{688       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{689    \}}
\DoxyCodeLine{690    }
\DoxyCodeLine{693    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<int, std::vector<std::int64\_t>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a3ac05a82ce0bead6031a3da7d146914b}{GetBases}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{694       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}};}
\DoxyCodeLine{695    \}}
\DoxyCodeLine{696    }
\DoxyCodeLine{699    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<int, std::unordered\_map<std::int64\_t, std::int64\_t>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a58e15e0f22ba92e51d4fb2e4192126df}{GetBasesInv}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{700       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}};}
\DoxyCodeLine{701    \}}
\DoxyCodeLine{702    }
\DoxyCodeLine{707    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9d991926c779bf24c6608279a7f10601}{GetBasis}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{708       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(\mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(total\_sz));}
\DoxyCodeLine{709    \}}
\DoxyCodeLine{710    }
\DoxyCodeLine{715    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<std::int64\_t, std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ac878a891c7aa10eca8840f3de0e8d0e1}{GetBasisInv}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{716       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}.at(\mbox{\hyperlink{namespacecompnal_1_1utility_a171eba2f7ced9de2db1f498bb07862df}{utility::DoubleHalfInteger}}(total\_sz));}
\DoxyCodeLine{717    \}}
\DoxyCodeLine{718    }
\DoxyCodeLine{722    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a150a88b5f29693fd0342ec9d5f826be6}{GetTargetBasis}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{723       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}}.at(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{724    \}}
\DoxyCodeLine{725    }
\DoxyCodeLine{729    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<std::int64\_t, std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a40d13ea34bab79bcc0dc312922d105b3}{GetTargetBasisInv}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{730       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}}.at(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}});}
\DoxyCodeLine{731    \}}
\DoxyCodeLine{732    }
\DoxyCodeLine{733 \textcolor{keyword}{protected}:}
\DoxyCodeLine{734    }
\DoxyCodeLine{736    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a482541fe5c7239b8de7982d8aed891b9}{onsite\_operator\_sx\_}};}
\DoxyCodeLine{737    }
\DoxyCodeLine{739    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aed9107549c634b2fb418968479eedffa}{onsite\_operator\_isy\_}};}
\DoxyCodeLine{740    }
\DoxyCodeLine{742    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abfa21ea7f92f51e8514542414ae33ccb}{onsite\_operator\_sz\_}};}
\DoxyCodeLine{743    }
\DoxyCodeLine{745    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa158ac550bb1a52a0833c2f955384cb8}{onsite\_operator\_sp\_}};}
\DoxyCodeLine{746    }
\DoxyCodeLine{748    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a813e8a32bf3b2ec8deba2c6092d4682d}{onsite\_operator\_sm\_}};}
\DoxyCodeLine{749    }
\DoxyCodeLine{751    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a7d24d3a81f90fd3181c76094bde48617}{system\_size\_}} = 0;}
\DoxyCodeLine{752    }
\DoxyCodeLine{754    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a822529c233c911a2db759c809628ed32}{total\_2sz\_}} = 0;}
\DoxyCodeLine{755    }
\DoxyCodeLine{757    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a9924b41c451f42c5cef0a2047c6b64db}{dim\_onsite\_}} = 2;}
\DoxyCodeLine{758    }
\DoxyCodeLine{760    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}} = 1;}
\DoxyCodeLine{761       }
\DoxyCodeLine{763    std::unordered\_set<int> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae9be05e81a30dddb6cd321248c66caf5}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{764    }
\DoxyCodeLine{767    std::unordered\_map<int, std::vector<std::int64\_t>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a8d1ca56fb9e8187821e797b0a713cb54}{bases\_}};}
\DoxyCodeLine{768    }
\DoxyCodeLine{771    std::unordered\_map<int, std::unordered\_map<std::int64\_t, std::int64\_t>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abeabf635a134fc6176db74e7fef56245}{bases\_inv\_}};}
\DoxyCodeLine{772    }
\DoxyCodeLine{774    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a580d5de16a28c5246363c3a1b2975430}{SetOnsiteOperator}}() \{}
\DoxyCodeLine{775       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a482541fe5c7239b8de7982d8aed891b9}{onsite\_operator\_sx\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a63e052b4fac0a797486ae37f288775d8}{CreateOnsiteOperatorSx}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{776       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aed9107549c634b2fb418968479eedffa}{onsite\_operator\_isy\_}} = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a805af825f870052d613484dfc32bf781}{CreateOnsiteOperatoriSy}}(0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{777       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_abfa21ea7f92f51e8514542414ae33ccb}{onsite\_operator\_sz\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a4b021604c01c8b7f9f2eab804cc78608}{CreateOnsiteOperatorSz}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{778       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_aa158ac550bb1a52a0833c2f955384cb8}{onsite\_operator\_sp\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a2c17c2baee22281d6d02f5dd5ab0b39d}{CreateOnsiteOperatorSp}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{779       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_a813e8a32bf3b2ec8deba2c6092d4682d}{onsite\_operator\_sm\_}}  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_ae10de81ba249004460d22bd991efe4f9}{CreateOnsiteOperatorSm}} (0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_spin__1_d_acaa58974948a62739c8d584a45e24981}{magnitude\_2spin\_}});}
\DoxyCodeLine{780    \}}
\DoxyCodeLine{781    }
\DoxyCodeLine{782 \};}
\DoxyCodeLine{783 }
\DoxyCodeLine{784 }
\DoxyCodeLine{785 }
\DoxyCodeLine{786 \}}
\DoxyCodeLine{787 \}}
\DoxyCodeLine{788 }
\DoxyCodeLine{789 }
\DoxyCodeLine{790 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_BASE\_U1SPIN\_1D\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
