\hypertarget{base__u1__electron__1d_8hpp_source}{}\doxysection{base\+\_\+u1\+\_\+electron\+\_\+1d.\+hpp}
\label{base__u1__electron__1d_8hpp_source}\index{src/model/base\_u1\_electron\_1d.hpp@{src/model/base\_u1\_electron\_1d.hpp}}
\mbox{\hyperlink{base__u1__electron__1d_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/27.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_MODEL\_BASE\_U1ELECTRON\_1D\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_MODEL\_BASE\_U1ELECTRON\_1D\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}../utility/all.hpp"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <unordered\_set>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{32 \textcolor{keyword}{namespace }model \{}
\DoxyCodeLine{33 }
\DoxyCodeLine{36 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{37 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d}{BaseU1Electron\_1D}} \{}
\DoxyCodeLine{38    }
\DoxyCodeLine{40    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{41    }
\DoxyCodeLine{43    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} = std::pair<int, double>;}
\DoxyCodeLine{44    }
\DoxyCodeLine{45 \textcolor{keyword}{public}:}
\DoxyCodeLine{46    }
\DoxyCodeLine{48    \textcolor{keyword}{using} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6536848ae3bab6c5492ed59a5f6c6317}{ValueType}} = RealType;}
\DoxyCodeLine{49    }
\DoxyCodeLine{50    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{51    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Constructors-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{52    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{54 \textcolor{comment}{}   \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_afe94b89531b77fa1c038aa7d70f41f8e}{BaseU1Electron\_1D}}() \{}
\DoxyCodeLine{55       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_abd6cf3af110e61f2015ed3074652d2cc}{SetOnsiteOperator}}();}
\DoxyCodeLine{56    \}}
\DoxyCodeLine{57    }
\DoxyCodeLine{60    \textcolor{keyword}{explicit} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_acdf8febe028e5371cd5d580dfef43d42}{BaseU1Electron\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d}{BaseU1Electron\_1D}}() \{}
\DoxyCodeLine{61       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4d218a9889fb9fac1f10d592e9c6524b}{SetSystemSize}}(system\_size);}
\DoxyCodeLine{62    \}}
\DoxyCodeLine{63    }
\DoxyCodeLine{68    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a9963373216d5fc6c02081cfd788bc517}{BaseU1Electron\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d}{BaseU1Electron\_1D}}(system\_size) \{}
\DoxyCodeLine{69       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a1c3eb6bf3ebf8e161f3f5c3e6d96d549}{SetTotalElectron}}(total\_electron);}
\DoxyCodeLine{70    \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{78    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a9b081d41fe745aa93360ddefac19376d}{BaseU1Electron\_1D}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size,}
\DoxyCodeLine{79                      \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron,}
\DoxyCodeLine{80                      \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz): \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d}{BaseU1Electron\_1D}}(system\_size, total\_electron) \{}
\DoxyCodeLine{81       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aa1b973c2fc19f93b869304baea8de4ba}{SetTotalSz}}(total\_sz);}
\DoxyCodeLine{82    \}}
\DoxyCodeLine{83    }
\DoxyCodeLine{84    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{85    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/Public Member functions-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{86    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{89 \textcolor{comment}{}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4d218a9889fb9fac1f10d592e9c6524b}{SetSystemSize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size) \{}
\DoxyCodeLine{90       \textcolor{keywordflow}{if} (system\_size <= 0) \{}
\DoxyCodeLine{91          std::stringstream ss;}
\DoxyCodeLine{92          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{93          ss << \textcolor{stringliteral}{"{}system\_size must be a non-\/negative integer"{}} << std::endl;}
\DoxyCodeLine{94          ss << \textcolor{stringliteral}{"{}system\_size="{}} << system\_size << \textcolor{stringliteral}{"{}is not allowed"{}} << std::endl;}
\DoxyCodeLine{95          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{96       \}}
\DoxyCodeLine{97       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}} != system\_size) \{}
\DoxyCodeLine{98          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}} = system\_size;}
\DoxyCodeLine{99          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a62cd383b7a05eb9a8b751bdfb7380557}{bases\_}}.clear();}
\DoxyCodeLine{100          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7943bbf48afea8677e5ead0e354c7b76}{bases\_inv\_}}.clear();}
\DoxyCodeLine{101          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aee93327a0e55a00bb8d759247c17fb3d}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{102       \}}
\DoxyCodeLine{103    \}}
\DoxyCodeLine{104    }
\DoxyCodeLine{108    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aa1b973c2fc19f93b869304baea8de4ba}{SetTotalSz}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz) \{}
\DoxyCodeLine{109       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_a2a72f9ca4b619a91f9f98f97aac96787}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{110       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af32092dc9d581d77d60b126fc71f9237}{total\_2sz\_}} != total\_2sz) \{}
\DoxyCodeLine{111          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af32092dc9d581d77d60b126fc71f9237}{total\_2sz\_}} = total\_2sz;}
\DoxyCodeLine{112          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aee93327a0e55a00bb8d759247c17fb3d}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{113       \}}
\DoxyCodeLine{114    \}}
\DoxyCodeLine{115    }
\DoxyCodeLine{119    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a1c3eb6bf3ebf8e161f3f5c3e6d96d549}{SetTotalElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron) \{}
\DoxyCodeLine{120       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a36eefbf738be25b44035a74a3b5030fe}{total\_electron\_}} != total\_electron) \{}
\DoxyCodeLine{121          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a36eefbf738be25b44035a74a3b5030fe}{total\_electron\_}} = total\_electron;}
\DoxyCodeLine{122          \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aee93327a0e55a00bb8d759247c17fb3d}{calculated\_eigenvector\_set\_}}.clear();}
\DoxyCodeLine{123       \}}
\DoxyCodeLine{124    \}}
\DoxyCodeLine{125    }
\DoxyCodeLine{128    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af0bf4076c6d37899df7a84c9c92a7ce5}{SetCalculatedEigenvectorSet}}(\textcolor{keyword}{const} std::int64\_t level) \{}
\DoxyCodeLine{129       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aee93327a0e55a00bb8d759247c17fb3d}{calculated\_eigenvector\_set\_}}.emplace(level);}
\DoxyCodeLine{130    \}}
\DoxyCodeLine{131    }
\DoxyCodeLine{135    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab98d36fb64012bf4029274e8ecb9fa51}{isValidQNumber}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} \&quantum\_number)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{136       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab98d36fb64012bf4029274e8ecb9fa51}{isValidQNumber}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}}, quantum\_number.first, quantum\_number.second);}
\DoxyCodeLine{137    \}}
\DoxyCodeLine{138    }
\DoxyCodeLine{143    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac0430da0873d39165b73d77bed146369}{isValidQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron, \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{144       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab98d36fb64012bf4029274e8ecb9fa51}{isValidQNumber}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}}, total\_electron, total\_sz);}
\DoxyCodeLine{145    \}}
\DoxyCodeLine{146    }
\DoxyCodeLine{150    \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a465e32e606632a760db7e21c8c1c3e72}{CalculateNumElectron}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} basis\_onsite)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{151       }
\DoxyCodeLine{152       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{153       \textcolor{comment}{// \# <-\/>  [Cherge  ] -\/-\/ (N,  2*sz)}}
\DoxyCodeLine{154       \textcolor{comment}{// 0 <-\/>  [        ] -\/-\/ (0,  0   )}}
\DoxyCodeLine{155       \textcolor{comment}{// 1 <-\/>  [up      ] -\/-\/ (1,  1   )}}
\DoxyCodeLine{156       \textcolor{comment}{// 2 <-\/>  [down    ] -\/-\/ (1, -\/1   )}}
\DoxyCodeLine{157       \textcolor{comment}{// 3 <-\/>  [up\&down ] -\/-\/ (2,  0   )}}
\DoxyCodeLine{158       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{159       }
\DoxyCodeLine{160       \textcolor{keywordflow}{if} (basis\_onsite == 0) \{}
\DoxyCodeLine{161          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{162       \}}
\DoxyCodeLine{163       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_onsite == 1 || basis\_onsite == 2) \{}
\DoxyCodeLine{164          \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{165       \}}
\DoxyCodeLine{166       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (basis\_onsite == 3) \{}
\DoxyCodeLine{167          \textcolor{keywordflow}{return} 2;}
\DoxyCodeLine{168       \}}
\DoxyCodeLine{169       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{170          std::stringstream ss;}
\DoxyCodeLine{171          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_  << std::endl;}
\DoxyCodeLine{172          ss << \textcolor{stringliteral}{"{}Invalid onsite basis"{}} << std::endl;}
\DoxyCodeLine{173          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{174       \}}
\DoxyCodeLine{175    \}}
\DoxyCodeLine{176    }
\DoxyCodeLine{178    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab5fd9f537769641895c16dab8da8318d}{PrintBasisOnsite}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{179       std::cout << \textcolor{stringliteral}{"{}row "{}} << 0 << \textcolor{stringliteral}{"{}: |vac>"{}} << std::endl;}
\DoxyCodeLine{180       std::cout << \textcolor{stringliteral}{"{}row "{}} << 1 << \textcolor{stringliteral}{"{}: |↑>"{}}   << std::endl;}
\DoxyCodeLine{181       std::cout << \textcolor{stringliteral}{"{}row "{}} << 2 << \textcolor{stringliteral}{"{}: |↓>"{}}   << std::endl;}
\DoxyCodeLine{182       std::cout << \textcolor{stringliteral}{"{}row "{}} << 3 << \textcolor{stringliteral}{"{}: |↑↓>"{}}  << std::endl;}
\DoxyCodeLine{183    \}}
\DoxyCodeLine{184    }
\DoxyCodeLine{188    std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac274d1305642a32127c47e7bbcf3e325}{CalculateTargetDim}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{189       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac274d1305642a32127c47e7bbcf3e325}{CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}}, \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a36eefbf738be25b44035a74a3b5030fe}{total\_electron\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af32092dc9d581d77d60b126fc71f9237}{total\_2sz\_}});}
\DoxyCodeLine{190    \}}
\DoxyCodeLine{191    }
\DoxyCodeLine{197    std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab1689df03b4be95637c11630a50c791f}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron, \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{198       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac274d1305642a32127c47e7bbcf3e325}{CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}}, total\_electron, total\_sz);}
\DoxyCodeLine{199    \}}
\DoxyCodeLine{200    }
\DoxyCodeLine{205    std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_abd8cd0cdf337cecb5937c6060ec49476}{CalculateTargetDim}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} \&quantum\_number)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{206       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac274d1305642a32127c47e7bbcf3e325}{CalculateTargetDim}}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}}, quantum\_number.first, quantum\_number.second);}
\DoxyCodeLine{207    \}}
\DoxyCodeLine{208    }
\DoxyCodeLine{211    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_abf7199869785477d6749367be2b547f0}{GenerateBasis}}() \{}
\DoxyCodeLine{212       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_abf7199869785477d6749367be2b547f0}{GenerateBasis}}(\{\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a36eefbf738be25b44035a74a3b5030fe}{total\_electron\_}}, 0.5*\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af32092dc9d581d77d60b126fc71f9237}{total\_2sz\_}}\});}
\DoxyCodeLine{213    \}}
\DoxyCodeLine{214    }
\DoxyCodeLine{218    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a46f744447cc2482b88f1d5978d6e4b32}{GenerateBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} \&quantum\_number) \{}
\DoxyCodeLine{219       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab98d36fb64012bf4029274e8ecb9fa51}{isValidQNumber}}(quantum\_number)) \{}
\DoxyCodeLine{220          std::stringstream ss;}
\DoxyCodeLine{221          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{222          ss << \textcolor{stringliteral}{"{}Invalid parameters (system\_size or magnitude\_spin or total\_sz)"{}} << std::endl;}
\DoxyCodeLine{223          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{224       \}}
\DoxyCodeLine{225       }
\DoxyCodeLine{226       \textcolor{keyword}{const} \textcolor{keyword}{auto} start         = std::chrono::system\_clock::now();}
\DoxyCodeLine{227       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron = quantum\_number.first;}
\DoxyCodeLine{228       \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz    = quantum\_number.second;}
\DoxyCodeLine{229       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz      = \mbox{\hyperlink{namespacecompnal_1_1utility_a2a72f9ca4b619a91f9f98f97aac96787}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{230       }
\DoxyCodeLine{231       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a62cd383b7a05eb9a8b751bdfb7380557}{bases\_}}.count(\{total\_electron, total\_2sz\}) != 0) \{}
\DoxyCodeLine{232          \textcolor{keywordflow}{return};}
\DoxyCodeLine{233       \}}
\DoxyCodeLine{234       }
\DoxyCodeLine{235       std::cout << \textcolor{stringliteral}{"{}Generating Basis..."{}} << std::flush;}
\DoxyCodeLine{236       \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_n\_up\_down = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(total\_electron/2);}
\DoxyCodeLine{237       \textcolor{keyword}{const} std::int64\_t dim\_target = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac274d1305642a32127c47e7bbcf3e325}{CalculateTargetDim}}(\{total\_electron, total\_sz\});}
\DoxyCodeLine{238       }
\DoxyCodeLine{239       std::vector<std::int64\_t>().swap(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a62cd383b7a05eb9a8b751bdfb7380557}{bases\_}}[\{total\_electron, total\_2sz\}]);}
\DoxyCodeLine{240       \textcolor{keyword}{auto} \&basis\_ref = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a62cd383b7a05eb9a8b751bdfb7380557}{bases\_}}.at(\{total\_electron, total\_2sz\});}
\DoxyCodeLine{241       }
\DoxyCodeLine{242       std::vector<std::int64\_t> site\_constant(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}});}
\DoxyCodeLine{243       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} site = 0; site < \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}}; ++site) \{}
\DoxyCodeLine{244          site\_constant[site] = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(std::pow(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a55ca064c4d2105e1d477488c9a95bdbf}{dim\_onsite\_}}, site));}
\DoxyCodeLine{245       \}}
\DoxyCodeLine{246       }
\DoxyCodeLine{247       std::vector<int> basis\_list(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}});}
\DoxyCodeLine{248       }
\DoxyCodeLine{249 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{250       \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{251       std::vector<std::vector<std::int64\_t>> temp\_basis(num\_threads);}
\DoxyCodeLine{252       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n\_up\_down = 0; n\_up\_down <= max\_n\_up\_down; ++n\_up\_down) \{}
\DoxyCodeLine{253          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((total\_electron -\/ 2*n\_up\_down + total\_2sz)/2);}
\DoxyCodeLine{254          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((total\_electron -\/ 2*n\_up\_down -\/ total\_2sz)/2);}
\DoxyCodeLine{255          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_vac  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}} -\/ total\_electron + n\_up\_down;}
\DoxyCodeLine{256          \textcolor{keywordflow}{if} (0 <= n\_up \&\& 0 <= n\_down \&\& 0 <= n\_vac) \{}
\DoxyCodeLine{257             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_vac; ++s) \{}
\DoxyCodeLine{258                basis\_list[s] = 0;}
\DoxyCodeLine{259             \}}
\DoxyCodeLine{260             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_up; ++s) \{}
\DoxyCodeLine{261                basis\_list[s + n\_vac] = 1;}
\DoxyCodeLine{262             \}}
\DoxyCodeLine{263             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_down; ++s) \{}
\DoxyCodeLine{264                basis\_list[s + n\_vac + n\_up] = 2;}
\DoxyCodeLine{265             \}}
\DoxyCodeLine{266             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_up\_down; ++s) \{}
\DoxyCodeLine{267                basis\_list[s + n\_vac + n\_up + n\_down] = 3;}
\DoxyCodeLine{268             \}}
\DoxyCodeLine{269             }
\DoxyCodeLine{270             \textcolor{keyword}{const} std::int64\_t size = \mbox{\hyperlink{namespacecompnal_1_1utility_a31be084029ddf129959d1682fd54cdf5}{utility::CalculateNumCombination}}(basis\_list);}
\DoxyCodeLine{271             std::vector<std::vector<int>> temp\_basis\_list(num\_threads);}
\DoxyCodeLine{272             }
\DoxyCodeLine{273 \textcolor{preprocessor}{\#pragma omp parallel num\_threads (num\_threads)}}
\DoxyCodeLine{274             \{}
\DoxyCodeLine{275                \textcolor{keyword}{const} \textcolor{keywordtype}{int} thread\_num = omp\_get\_thread\_num();}
\DoxyCodeLine{276                \textcolor{keyword}{const} std::int64\_t loop\_begin = thread\_num*size/num\_threads;}
\DoxyCodeLine{277                \textcolor{keyword}{const} std::int64\_t loop\_end   = (thread\_num + 1)*size/num\_threads;}
\DoxyCodeLine{278                temp\_basis\_list[thread\_num]   = basis\_list;}
\DoxyCodeLine{279                \mbox{\hyperlink{namespacecompnal_1_1utility_a6d7737688a03ef322d62fc96017af67a}{utility::CalculateNthPermutation}}(\&temp\_basis\_list[thread\_num], loop\_begin);}
\DoxyCodeLine{280                }
\DoxyCodeLine{281                \textcolor{keywordflow}{for} (std::int64\_t j = loop\_begin; j < loop\_end; ++j) \{}
\DoxyCodeLine{282                   std::int64\_t basis\_global = 0;}
\DoxyCodeLine{283                   \textcolor{keywordflow}{for} (std::size\_t k = 0; k < temp\_basis\_list[thread\_num].size(); ++k) \{}
\DoxyCodeLine{284                      basis\_global += temp\_basis\_list[thread\_num][k]*site\_constant[k];}
\DoxyCodeLine{285                   \}}
\DoxyCodeLine{286                   temp\_basis[thread\_num].push\_back(basis\_global);}
\DoxyCodeLine{287                   std::next\_permutation(temp\_basis\_list[thread\_num].begin(), temp\_basis\_list[thread\_num].end());}
\DoxyCodeLine{288                \}}
\DoxyCodeLine{289             \}}
\DoxyCodeLine{290          \}}
\DoxyCodeLine{291       \}}
\DoxyCodeLine{292       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&basis: temp\_basis) \{}
\DoxyCodeLine{293          basis\_ref.insert(basis\_ref.end(), basis.begin(), basis.end());}
\DoxyCodeLine{294          std::vector<std::int64\_t>().swap(basis);}
\DoxyCodeLine{295       \}}
\DoxyCodeLine{296       }
\DoxyCodeLine{297 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{298       }
\DoxyCodeLine{299       basis\_ref.reserve(dim\_target);}
\DoxyCodeLine{300       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n\_up\_down = 0; n\_up\_down <= max\_n\_up\_down; ++n\_up\_down) \{}
\DoxyCodeLine{301          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((total\_electron -\/ 2*n\_up\_down + total\_2sz)/2);}
\DoxyCodeLine{302          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((total\_electron -\/ 2*n\_up\_down -\/ total\_2sz)/2);}
\DoxyCodeLine{303          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_vac  = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a48de32d5c4d81ab303856679df0e2040}{system\_size\_}} -\/ total\_electron + n\_up\_down;}
\DoxyCodeLine{304          \textcolor{keywordflow}{if} (0 <= n\_up \&\& 0 <= n\_down \&\& 0 <= n\_vac) \{}
\DoxyCodeLine{305             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_vac; ++s) \{}
\DoxyCodeLine{306                basis\_list[s] = 0;}
\DoxyCodeLine{307             \}}
\DoxyCodeLine{308             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_up; ++s) \{}
\DoxyCodeLine{309                basis\_list[s + n\_vac] = 1;}
\DoxyCodeLine{310             \}}
\DoxyCodeLine{311             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_down; ++s) \{}
\DoxyCodeLine{312                basis\_list[s + n\_vac + n\_up] = 2;}
\DoxyCodeLine{313             \}}
\DoxyCodeLine{314             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} s = 0; s < n\_up\_down; ++s) \{}
\DoxyCodeLine{315                basis\_list[s + n\_vac + n\_up + n\_down] = 3;}
\DoxyCodeLine{316             \}}
\DoxyCodeLine{317             }
\DoxyCodeLine{318             \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{319                std::int64\_t basis\_global = 0;}
\DoxyCodeLine{320                \textcolor{keywordflow}{for} (std::size\_t j = 0; j < basis\_list.size(); ++j) \{}
\DoxyCodeLine{321                   basis\_global += basis\_list[j]*site\_constant[j];}
\DoxyCodeLine{322                \}}
\DoxyCodeLine{323                basis\_ref.push\_back(basis\_global);}
\DoxyCodeLine{324             \} \textcolor{keywordflow}{while} (std::next\_permutation(basis\_list.begin(), basis\_list.end()));}
\DoxyCodeLine{325          \}}
\DoxyCodeLine{326       \}}
\DoxyCodeLine{327 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{328       }
\DoxyCodeLine{329       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a62cd383b7a05eb9a8b751bdfb7380557}{bases\_}}.at(\{total\_electron, total\_2sz\}).size()) != dim\_target) \{}
\DoxyCodeLine{330          std::stringstream ss;}
\DoxyCodeLine{331          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{332          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{333       \}}
\DoxyCodeLine{334       }
\DoxyCodeLine{335       std::sort(basis\_ref.begin(), basis\_ref.end());}
\DoxyCodeLine{336       }
\DoxyCodeLine{337       \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7943bbf48afea8677e5ead0e354c7b76}{bases\_inv\_}}[\{total\_electron, total\_2sz\}].clear();}
\DoxyCodeLine{338       }
\DoxyCodeLine{339       \textcolor{keyword}{auto} \&basis\_inv\_ref = \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7943bbf48afea8677e5ead0e354c7b76}{bases\_inv\_}}.at(\{total\_electron, total\_2sz\});}
\DoxyCodeLine{340       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim\_target; ++i) \{}
\DoxyCodeLine{341          basis\_inv\_ref[basis\_ref[i]] = i;}
\DoxyCodeLine{342       \}}
\DoxyCodeLine{343       }
\DoxyCodeLine{344       \textcolor{keywordflow}{if} (basis\_inv\_ref.size() != basis\_ref.size()) \{}
\DoxyCodeLine{345          std::stringstream ss;}
\DoxyCodeLine{346          ss << \textcolor{stringliteral}{"{}Unknown error detected in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{347          ss << \textcolor{stringliteral}{"{}The same basis has been detected"{}} << std::endl;}
\DoxyCodeLine{348          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{349       \}}
\DoxyCodeLine{350       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{351       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{sparse\_matrix::TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{352       std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of generating basis:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::endl;}
\DoxyCodeLine{353    \}}
\DoxyCodeLine{354    }
\DoxyCodeLine{359    std::vector<QType> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4b4774a67ebb600f15fd49976a1b8df7}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{360       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m1;}
\DoxyCodeLine{361       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m2;}
\DoxyCodeLine{362       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{363          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{364             \textcolor{keywordflow}{if} (m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{365                delta\_sector\_set\_m1.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{366             \}}
\DoxyCodeLine{367          \}}
\DoxyCodeLine{368       \}}
\DoxyCodeLine{369       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{370          \textcolor{keywordflow}{for} (std::int64\_t j = m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{371             \textcolor{keywordflow}{if} (m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{372                delta\_sector\_set\_m2.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{373             \}}
\DoxyCodeLine{374          \}}
\DoxyCodeLine{375       \}}
\DoxyCodeLine{376       std::vector<QType> target\_sector\_set;}
\DoxyCodeLine{377       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{378          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{379             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = isValidQNumber(del\_sec\_m1.first + total\_electron\_, del\_sec\_m1.second + 0.5*total\_2sz\_);}
\DoxyCodeLine{380             \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2 \&\& c1) \{}
\DoxyCodeLine{381                target\_sector\_set.push\_back(\{del\_sec\_m1.first + total\_electron\_, del\_sec\_m1.second + 0.5*total\_2sz\_\});}
\DoxyCodeLine{382             \}}
\DoxyCodeLine{383          \}}
\DoxyCodeLine{384       \}}
\DoxyCodeLine{385       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{386       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{387       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{388    \}}
\DoxyCodeLine{389    }
\DoxyCodeLine{395    std::vector<std::pair<QType, QType>> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a3481d7f1ed4b6b1a07f363851a7704cd}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{396       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m1;}
\DoxyCodeLine{397       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m2;}
\DoxyCodeLine{398       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m3;}
\DoxyCodeLine{399       }
\DoxyCodeLine{400       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{401          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{402             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{403                delta\_sector\_set\_m1.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{404             \}}
\DoxyCodeLine{405          \}}
\DoxyCodeLine{406       \}}
\DoxyCodeLine{407       }
\DoxyCodeLine{408       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{409          \textcolor{keywordflow}{for} (std::int64\_t j = m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{410             \textcolor{keywordflow}{if} (m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{411                delta\_sector\_set\_m2.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{412             \}}
\DoxyCodeLine{413          \}}
\DoxyCodeLine{414       \}}
\DoxyCodeLine{415       }
\DoxyCodeLine{416       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{417          \textcolor{keywordflow}{for} (std::int64\_t j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{418             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{419                delta\_sector\_set\_m3.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{420             \}}
\DoxyCodeLine{421          \}}
\DoxyCodeLine{422       \}}
\DoxyCodeLine{423       }
\DoxyCodeLine{424       std::vector<std::pair<QType, QType>> target\_sector\_set;}
\DoxyCodeLine{425       }
\DoxyCodeLine{426       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{427          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{428             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{429                \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} del\_sec\_m2\_m3 = \{del\_sec\_m2.first + del\_sec\_m3.first, del\_sec\_m2.second + del\_sec\_m3.second\};}
\DoxyCodeLine{430                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = isValidQNumber(del\_sec\_m1.first + total\_electron\_, del\_sec\_m1.second + 0.5*total\_2sz\_);}
\DoxyCodeLine{431                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = isValidQNumber(del\_sec\_m3.first + total\_electron\_, del\_sec\_m3.second + 0.5*total\_2sz\_);}
\DoxyCodeLine{432                \textcolor{keywordflow}{if} (del\_sec\_m1 == del\_sec\_m2\_m3 \&\& c1 \&\& c2) \{}
\DoxyCodeLine{433                   target\_sector\_set.push\_back(\{}
\DoxyCodeLine{434                      \{del\_sec\_m1.first + total\_electron\_, del\_sec\_m1.second + 0.5*total\_2sz\_\},}
\DoxyCodeLine{435                      \{del\_sec\_m3.first + total\_electron\_, del\_sec\_m3.second + 0.5*total\_2sz\_\}}
\DoxyCodeLine{436                   \});}
\DoxyCodeLine{437                \}}
\DoxyCodeLine{438             \}}
\DoxyCodeLine{439          \}}
\DoxyCodeLine{440       \}}
\DoxyCodeLine{441       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{442       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{443       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{444    \}}
\DoxyCodeLine{445    }
\DoxyCodeLine{452    std::vector<std::tuple<QType, QType, QType>>}
\DoxyCodeLine{453    \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a06b84fcba1019019aefac574ff4a4423}{GenerateTargetSector}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2\_bra, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_3\_ket, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_4\_ket)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{454       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m1;}
\DoxyCodeLine{455       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m2;}
\DoxyCodeLine{456       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m3;}
\DoxyCodeLine{457       std::unordered\_set<QType, utility::PairHash> delta\_sector\_set\_m4;}
\DoxyCodeLine{458       }
\DoxyCodeLine{459       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{460          \textcolor{keywordflow}{for} (std::int64\_t j = m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{461             \textcolor{keywordflow}{if} (m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{462                delta\_sector\_set\_m1.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_1\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{463             \}}
\DoxyCodeLine{464          \}}
\DoxyCodeLine{465       \}}
\DoxyCodeLine{466       }
\DoxyCodeLine{467       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{468          \textcolor{keywordflow}{for} (std::int64\_t j = m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{469             \textcolor{keywordflow}{if} (m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{470                delta\_sector\_set\_m2.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_2\_bra.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{471             \}}
\DoxyCodeLine{472          \}}
\DoxyCodeLine{473       \}}
\DoxyCodeLine{474       }
\DoxyCodeLine{475       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{476          \textcolor{keywordflow}{for} (std::int64\_t j = m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{477             \textcolor{keywordflow}{if} (m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{478                delta\_sector\_set\_m3.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_3\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{479             \}}
\DoxyCodeLine{480          \}}
\DoxyCodeLine{481       \}}
\DoxyCodeLine{482       }
\DoxyCodeLine{483       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{484          \textcolor{keywordflow}{for} (std::int64\_t j = m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{485             \textcolor{keywordflow}{if} (m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j] != 0.0) \{}
\DoxyCodeLine{486                delta\_sector\_set\_m4.emplace(CalculateQuntumNumberDifference(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(m\_4\_ket.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j])));}
\DoxyCodeLine{487             \}}
\DoxyCodeLine{488          \}}
\DoxyCodeLine{489       \}}
\DoxyCodeLine{490       }
\DoxyCodeLine{491       std::vector<std::tuple<QType, QType, QType>> target\_sector\_set;}
\DoxyCodeLine{492       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m1: delta\_sector\_set\_m1) \{}
\DoxyCodeLine{493          \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m2: delta\_sector\_set\_m2) \{}
\DoxyCodeLine{494             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m3: delta\_sector\_set\_m3) \{}
\DoxyCodeLine{495                \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&del\_sec\_m4: delta\_sector\_set\_m4) \{}
\DoxyCodeLine{496                   \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} del\_sec\_m1\_m2 = \{del\_sec\_m1.first + del\_sec\_m2.first, del\_sec\_m1.second + del\_sec\_m2.second\};}
\DoxyCodeLine{497                   \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} del\_sec\_m3\_m4 = \{del\_sec\_m3.first + del\_sec\_m4.first, del\_sec\_m3.second + del\_sec\_m4.second\};}
\DoxyCodeLine{498                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = isValidQNumber(del\_sec\_m1.first    + total\_electron\_, del\_sec\_m1.second    + 0.5*total\_2sz\_);}
\DoxyCodeLine{499                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = isValidQNumber(del\_sec\_m1\_m2.first + total\_electron\_, del\_sec\_m1\_m2.second + 0.5*total\_2sz\_);}
\DoxyCodeLine{500                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = isValidQNumber(del\_sec\_m4.first    + total\_electron\_, del\_sec\_m4.second    + 0.5*total\_2sz\_);}
\DoxyCodeLine{501                   \textcolor{keywordflow}{if} (del\_sec\_m1\_m2 == del\_sec\_m3\_m4 \&\& c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{502                      target\_sector\_set.push\_back(\{}
\DoxyCodeLine{503                         \{del\_sec\_m1.first    + total\_electron\_, del\_sec\_m1.second    + 0.5*total\_2sz\_\},}
\DoxyCodeLine{504                         \{del\_sec\_m1\_m2.first + total\_electron\_, del\_sec\_m1\_m2.second + 0.5*total\_2sz\_\},}
\DoxyCodeLine{505                         \{del\_sec\_m4.first    + total\_electron\_, del\_sec\_m4.second    + 0.5*total\_2sz\_\}}
\DoxyCodeLine{506                      \});}
\DoxyCodeLine{507                   \}}
\DoxyCodeLine{508                \}}
\DoxyCodeLine{509             \}}
\DoxyCodeLine{510          \}}
\DoxyCodeLine{511       \}}
\DoxyCodeLine{512       }
\DoxyCodeLine{513       std::sort(target\_sector\_set.begin(), target\_sector\_set.end());}
\DoxyCodeLine{514       target\_sector\_set.erase(std::unique(target\_sector\_set.begin(), target\_sector\_set.end()), target\_sector\_set.end());}
\DoxyCodeLine{515       \textcolor{keywordflow}{return} target\_sector\_set;}
\DoxyCodeLine{516    \}}
\DoxyCodeLine{517       }
\DoxyCodeLine{523    \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab9b2211fa92094ca8a9da65de0f32688}{isValidQNumber}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron, \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz) \{}
\DoxyCodeLine{524       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_a2a72f9ca4b619a91f9f98f97aac96787}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{525       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c1 = (0 <= total\_electron \&\& total\_electron <= 2*system\_size);}
\DoxyCodeLine{526       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c2 = ((total\_electron -\/ total\_2sz)\%2 == 0);}
\DoxyCodeLine{527       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} c3 = (-\/total\_electron <= total\_2sz \&\& total\_2sz <= total\_electron);}
\DoxyCodeLine{528       \textcolor{keywordflow}{if} (c1 \&\& c2 \&\& c3) \{}
\DoxyCodeLine{529          \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{530       \}}
\DoxyCodeLine{531       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{532          \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{533       \}}
\DoxyCodeLine{534    \}}
\DoxyCodeLine{535    }
\DoxyCodeLine{541    \textcolor{keyword}{static} std::int64\_t \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a06e56d262688f1c1f7652c596b3322ee}{CalculateTargetDim}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size, \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_electron, \textcolor{keyword}{const} \textcolor{keywordtype}{double} total\_sz) \{}
\DoxyCodeLine{542       \textcolor{keywordflow}{if} (!isValidQNumber(system\_size, total\_electron, total\_sz)) \{}
\DoxyCodeLine{543          \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{544       \}}
\DoxyCodeLine{545       \textcolor{keyword}{const} \textcolor{keywordtype}{int} total\_2sz = \mbox{\hyperlink{namespacecompnal_1_1utility_a2a72f9ca4b619a91f9f98f97aac96787}{utility::DoubleHalfInteger}}(total\_sz);}
\DoxyCodeLine{546       \textcolor{keyword}{const} std::vector<std::vector<std::int64\_t>> binom = \mbox{\hyperlink{namespacecompnal_1_1utility_a4cce9c29a3548fefaf4814bc1bfd0345}{utility::CalculateBinomialTable}}(system\_size);}
\DoxyCodeLine{547       \textcolor{keyword}{const} \textcolor{keywordtype}{int} max\_n\_up\_down = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(total\_electron/2);}
\DoxyCodeLine{548       std::int64\_t dim = 0;}
\DoxyCodeLine{549       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} n\_up\_down = 0; n\_up\_down <= max\_n\_up\_down; ++n\_up\_down) \{}
\DoxyCodeLine{550          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_up   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((total\_electron -\/ 2*n\_up\_down + total\_2sz)/2);}
\DoxyCodeLine{551          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_down = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((total\_electron -\/ 2*n\_up\_down -\/ total\_2sz)/2);}
\DoxyCodeLine{552          \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\_vac  = system\_size -\/ total\_electron + n\_up\_down;}
\DoxyCodeLine{553          \textcolor{keywordflow}{if} (0 <= n\_up \&\& 0 <= n\_down \&\& 0 <= n\_vac) \{}
\DoxyCodeLine{554             \textcolor{comment}{// TODO: Detect Overflow}}
\DoxyCodeLine{555             dim += binom[system\_size][n\_up]*binom[system\_size -\/ n\_up][n\_down]*binom[system\_size -\/ n\_up -\/ n\_down][n\_up\_down];}
\DoxyCodeLine{556          \}}
\DoxyCodeLine{557       \}}
\DoxyCodeLine{558       \textcolor{keywordflow}{return} dim;}
\DoxyCodeLine{559    \}}
\DoxyCodeLine{560    }
\DoxyCodeLine{563    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a51b7f7b843cf925e4fd86c768e6abd90}{CreateOnsiteOperatorCUp}}() \{}
\DoxyCodeLine{564       }
\DoxyCodeLine{565       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{566       \textcolor{comment}{// \# <-\/>  [Cherge  ] -\/-\/ (N,  2*sz)}}
\DoxyCodeLine{567       \textcolor{comment}{// 0 <-\/>  [        ] -\/-\/ (0,  0   )}}
\DoxyCodeLine{568       \textcolor{comment}{// 1 <-\/>  [up      ] -\/-\/ (1,  1   )}}
\DoxyCodeLine{569       \textcolor{comment}{// 2 <-\/>  [down    ] -\/-\/ (1, -\/1   )}}
\DoxyCodeLine{570       \textcolor{comment}{// 3 <-\/>  [up\&down ] -\/-\/ (2,  0   )}}
\DoxyCodeLine{571       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{572       }
\DoxyCodeLine{573       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 4;}
\DoxyCodeLine{574       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{575       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; row++) \{}
\DoxyCodeLine{576          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} col = 0; col < dim\_onsite; col++) \{}
\DoxyCodeLine{577             \textcolor{keywordflow}{if} ((col == 1 \&\& row == 0) || (col == 3 \&\& row == 2)) \{}
\DoxyCodeLine{578                matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(col);}
\DoxyCodeLine{579                matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(1.0);}
\DoxyCodeLine{580             \}}
\DoxyCodeLine{581          \}}
\DoxyCodeLine{582          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{583       \}}
\DoxyCodeLine{584       }
\DoxyCodeLine{585       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}};}
\DoxyCodeLine{586       }
\DoxyCodeLine{587       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{588    \}}
\DoxyCodeLine{589    }
\DoxyCodeLine{592    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ab395758624dddcb8d1488ab6efb7e0b7}{CreateOnsiteOperatorCDown}}() \{}
\DoxyCodeLine{593       }
\DoxyCodeLine{594       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{595       \textcolor{comment}{// \# <-\/>  [Cherge  ] -\/-\/ (N,  2*sz)}}
\DoxyCodeLine{596       \textcolor{comment}{// 0 <-\/>  [        ] -\/-\/ (0,  0   )}}
\DoxyCodeLine{597       \textcolor{comment}{// 1 <-\/>  [up      ] -\/-\/ (1,  1   )}}
\DoxyCodeLine{598       \textcolor{comment}{// 2 <-\/>  [down    ] -\/-\/ (1, -\/1   )}}
\DoxyCodeLine{599       \textcolor{comment}{// 3 <-\/>  [up\&down ] -\/-\/ (2,  0   )}}
\DoxyCodeLine{600       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{601       }
\DoxyCodeLine{602       \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite = 4;}
\DoxyCodeLine{603       \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} matrix(dim\_onsite, dim\_onsite);}
\DoxyCodeLine{604       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} row = 0; row < dim\_onsite; row++) \{}
\DoxyCodeLine{605          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} col = 0; col < dim\_onsite; col++) \{}
\DoxyCodeLine{606             \textcolor{keywordflow}{if} (col == 2 \&\& row == 0) \{}
\DoxyCodeLine{607                matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(col);}
\DoxyCodeLine{608                matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(1.0);}
\DoxyCodeLine{609             \}}
\DoxyCodeLine{610             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (col == 3 \&\& row == 1) \{}
\DoxyCodeLine{611                matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(col);}
\DoxyCodeLine{612                matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(-\/1.0);}
\DoxyCodeLine{613             \}}
\DoxyCodeLine{614          \}}
\DoxyCodeLine{615          matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[row + 1] = matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{616       \}}
\DoxyCodeLine{617       }
\DoxyCodeLine{618       matrix.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{sparse\_matrix::CRSTag::FERMION}};}
\DoxyCodeLine{619 }
\DoxyCodeLine{620       \textcolor{keywordflow}{return} matrix;}
\DoxyCodeLine{621    \}}
\DoxyCodeLine{622    }
\DoxyCodeLine{626    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a063b1f41011709867e97df0ade5e5739}{CreateOnsiteOperatorCUpDagger}}() \{}
\DoxyCodeLine{627       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(CreateOnsiteOperatorCUp());}
\DoxyCodeLine{628    \}}
\DoxyCodeLine{629    }
\DoxyCodeLine{633    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_afa19a276a4a0e96c781556ba53905a85}{CreateOnsiteOperatorCDownDagger}}() \{}
\DoxyCodeLine{634       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{sparse\_matrix::CalculateTransposedMatrix}}(CreateOnsiteOperatorCDown());}
\DoxyCodeLine{635    \}}
\DoxyCodeLine{636    }
\DoxyCodeLine{640    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a3b8fcfdefbef8ade799801c8119e3f04}{CreateOnsiteOperatorNCUp}}() \{}
\DoxyCodeLine{641       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{sparse\_matrix::CalculateMatrixMatrixProduct}}(1.0, CreateOnsiteOperatorCUpDagger(), 1.0, CreateOnsiteOperatorCUp());}
\DoxyCodeLine{642    \}}
\DoxyCodeLine{643    }
\DoxyCodeLine{647    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a9fd576d344dc72d5c7b9361a3cad51d9}{CreateOnsiteOperatorNCDown}}() \{}
\DoxyCodeLine{648       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{sparse\_matrix::CalculateMatrixMatrixProduct}}(1.0, CreateOnsiteOperatorCDownDagger(), 1.0, CreateOnsiteOperatorCDown());}
\DoxyCodeLine{649    \}}
\DoxyCodeLine{650    }
\DoxyCodeLine{654    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aec77c76276610fa623fe1127594bf8e7}{CreateOnsiteOperatorNC}}() \{}
\DoxyCodeLine{655       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{sparse\_matrix::CalculateMatrixMatrixSum}}(1.0, CreateOnsiteOperatorNCUp(), 1.0, CreateOnsiteOperatorNCDown());}
\DoxyCodeLine{656    \}}
\DoxyCodeLine{657    }
\DoxyCodeLine{661    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a78088b3950053826909b7c70b08d1724}{CreateOnsiteOperatorSx}}() \{}
\DoxyCodeLine{662       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{sparse\_matrix::CalculateMatrixMatrixSum}}(0.5, CreateOnsiteOperatorSp(), 0.5, CreateOnsiteOperatorSm());}
\DoxyCodeLine{663    \}}
\DoxyCodeLine{664    }
\DoxyCodeLine{669    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ad1b145ffc9fc740d52bc16a24dc17726}{CreateOnsiteOperatoriSy}}() \{}
\DoxyCodeLine{670       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{sparse\_matrix::CalculateMatrixMatrixSum}}(0.5, CreateOnsiteOperatorSp(), -\/0.5, CreateOnsiteOperatorSm());}
\DoxyCodeLine{671    \}}
\DoxyCodeLine{672    }
\DoxyCodeLine{676    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a5835026708b0d6a101027b0d84c3d3f9}{CreateOnsiteOperatorSz}}() \{}
\DoxyCodeLine{677       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{sparse\_matrix::CalculateMatrixMatrixSum}}(0.5, CreateOnsiteOperatorNCUp(), -\/0.5,CreateOnsiteOperatorNCDown());}
\DoxyCodeLine{678    \}}
\DoxyCodeLine{679    }
\DoxyCodeLine{683    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a74e428afd2ae4c3a29c23d187d472729}{CreateOnsiteOperatorSp}}() \{}
\DoxyCodeLine{684       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{sparse\_matrix::CalculateMatrixMatrixProduct}}(1.0, CreateOnsiteOperatorCUpDagger(), 1.0, CreateOnsiteOperatorCDown());}
\DoxyCodeLine{685    \}}
\DoxyCodeLine{686    }
\DoxyCodeLine{690    \textcolor{keyword}{static} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aa22882e9e45d96221f3a9ca2dcfc6dfd}{CreateOnsiteOperatorSm}}() \{}
\DoxyCodeLine{691       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{sparse\_matrix::CalculateMatrixMatrixProduct}}(1.0, CreateOnsiteOperatorCDownDagger(), 1.0, CreateOnsiteOperatorCUp());}
\DoxyCodeLine{692    \}}
\DoxyCodeLine{693    }
\DoxyCodeLine{699    \textcolor{keyword}{static} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7eeaeb64c183a9be7d49d2dea7ade5ef}{CalculateQuntumNumberDifference}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} row, \textcolor{keyword}{const} \textcolor{keywordtype}{int} col) \{}
\DoxyCodeLine{700       \textcolor{keywordflow}{if} (row == col \&\& 0 <= row \&\& row < 4 \&\& 0 <= col \&\& col < 4) \{}
\DoxyCodeLine{701          \textcolor{keywordflow}{return} \{+0, +0.0\};}
\DoxyCodeLine{702       \}}
\DoxyCodeLine{703       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 0 \&\& col == 1) \{}
\DoxyCodeLine{704          \textcolor{keywordflow}{return} \{-\/1, -\/0.5\};}
\DoxyCodeLine{705       \}}
\DoxyCodeLine{706       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 0 \&\& col == 2) \{}
\DoxyCodeLine{707          \textcolor{keywordflow}{return} \{-\/1, +0.5\};}
\DoxyCodeLine{708       \}}
\DoxyCodeLine{709       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 0 \&\& col == 3) \{}
\DoxyCodeLine{710          \textcolor{keywordflow}{return} \{-\/2, +0.0\};}
\DoxyCodeLine{711       \}}
\DoxyCodeLine{712       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 1 \&\& col == 0) \{}
\DoxyCodeLine{713          \textcolor{keywordflow}{return} \{+1, +0.5\};}
\DoxyCodeLine{714       \}}
\DoxyCodeLine{715       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 1 \&\& col == 2) \{}
\DoxyCodeLine{716          \textcolor{keywordflow}{return} \{+0, +1.0\};}
\DoxyCodeLine{717       \}}
\DoxyCodeLine{718       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 1 \&\& col == 3) \{}
\DoxyCodeLine{719          \textcolor{keywordflow}{return} \{-\/1, +0.5\};}
\DoxyCodeLine{720       \}}
\DoxyCodeLine{721       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 2 \&\& col == 0) \{}
\DoxyCodeLine{722          \textcolor{keywordflow}{return} \{+1, -\/0.5\};}
\DoxyCodeLine{723       \}}
\DoxyCodeLine{724       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 2 \&\& col == 1) \{}
\DoxyCodeLine{725          \textcolor{keywordflow}{return} \{+0, -\/1.0\};}
\DoxyCodeLine{726       \}}
\DoxyCodeLine{727       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 2 \&\& col == 3) \{}
\DoxyCodeLine{728          \textcolor{keywordflow}{return} \{-\/1, -\/0.5\};}
\DoxyCodeLine{729       \}}
\DoxyCodeLine{730       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 3 \&\& col == 0) \{}
\DoxyCodeLine{731          \textcolor{keywordflow}{return} \{+2, +0.0\};}
\DoxyCodeLine{732       \}}
\DoxyCodeLine{733       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 3 \&\& col == 1) \{}
\DoxyCodeLine{734          \textcolor{keywordflow}{return} \{+1, -\/0.5\};}
\DoxyCodeLine{735       \}}
\DoxyCodeLine{736       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (row == 3 \&\& col == 2) \{}
\DoxyCodeLine{737          \textcolor{keywordflow}{return} \{+1, +0.5\};}
\DoxyCodeLine{738       \}}
\DoxyCodeLine{739       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{740          std::stringstream ss;}
\DoxyCodeLine{741          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{742          ss << \textcolor{stringliteral}{"{}The dimenstion of the matrix must be 4"{}};}
\DoxyCodeLine{743          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{744       \}}
\DoxyCodeLine{745    \}}
\DoxyCodeLine{746    }
\DoxyCodeLine{749    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6519589bb67f63f761d4b90a6b7fd51b}{GetSystemSize}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} system\_size\_; \}}
\DoxyCodeLine{750    }
\DoxyCodeLine{753    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_af85f0a2c8d11d5fc5df37fab13068222}{GetDimOnsite}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} dim\_onsite\_; \}}
\DoxyCodeLine{754    }
\DoxyCodeLine{757    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a90a80f2ca072abd8f881d6634d0e8e12}{GetTotalSz}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0.5*total\_2sz\_; \}}
\DoxyCodeLine{758    }
\DoxyCodeLine{761    \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac3cee2826343874981ca15b2dd383514}{GetTotalElectron}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} total\_electron\_; \}}
\DoxyCodeLine{762    }
\DoxyCodeLine{765    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a15fe38d996c2d23748a2eb254807b882}{GetOnsiteOperatorCUp}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_c\_up\_;   \}}
\DoxyCodeLine{766    }
\DoxyCodeLine{769    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4dfc489bed6324d3d4092e3ae215c224}{GetOnsiteOperatorCDown}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_c\_down\_; \}}
\DoxyCodeLine{770    }
\DoxyCodeLine{774    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7a2de63620d20978d0d2d39c722222fd}{GetOnsiteOperatorCUpDagger}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_c\_up\_dagger\_; \}}
\DoxyCodeLine{775    }
\DoxyCodeLine{779    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4892fdee7d5a231b434a6b0335c0cedd}{GetOnsiteOperatorCDownDagger}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_c\_down\_dagger\_; \}}
\DoxyCodeLine{780    }
\DoxyCodeLine{784    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a18f85301715137e29a9efe55d293b680}{GetOnsiteOperatorNCUp}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_nc\_up\_; \}}
\DoxyCodeLine{785    }
\DoxyCodeLine{789    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a568630fdde2d69ae8166d0f4c5230034}{GetOnsiteOperatorNCDown}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_nc\_down\_; \}}
\DoxyCodeLine{790    }
\DoxyCodeLine{794    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ae4807dc416a3b14a3a6eddfcfa155463}{GetOnsiteOperatorNC}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_nc\_; \}}
\DoxyCodeLine{795    }
\DoxyCodeLine{799    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a804fcc953f4094c743ff7a090c5c5648}{GetOnsiteOperatorSx}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_sx\_ ; \}}
\DoxyCodeLine{800    }
\DoxyCodeLine{805    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a93994944b367d1dda1fd5086c3b39160}{GetOnsiteOperatoriSy}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_isy\_; \}}
\DoxyCodeLine{806    }
\DoxyCodeLine{810    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a4d101c612f474f7f1360e01fb2e11458}{GetOnsiteOperatorSz}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_sz\_ ; \}}
\DoxyCodeLine{811    }
\DoxyCodeLine{815    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ad0a789379520130e320c9db5c17bd187}{GetOnsiteOperatorSp}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_sp\_ ; \}}
\DoxyCodeLine{816    }
\DoxyCodeLine{820    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ae52e204919ad16ced312da56529b69fb}{GetOnsiteOperatorSm}} ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_sm\_ ; \}}
\DoxyCodeLine{821    }
\DoxyCodeLine{824    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_set<int> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_acf692080230871d5262686508a87620d}{GetCalculatedEigenvectorSet}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{825       \textcolor{keywordflow}{return} calculated\_eigenvector\_set\_;}
\DoxyCodeLine{826    \}}
\DoxyCodeLine{827    }
\DoxyCodeLine{828    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<std::pair<int, int>, std::vector<std::int64\_t>, \mbox{\hyperlink{structcompnal_1_1utility_1_1_pair_hash}{utility::PairHash}}> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a1d242ab78d4a4af85f642cc8d837ea8d}{GetBases}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{829       \textcolor{keywordflow}{return} bases\_;}
\DoxyCodeLine{830    \}}
\DoxyCodeLine{831    }
\DoxyCodeLine{832    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<std::pair<int, int>, std::unordered\_map<std::int64\_t, std::int64\_t>, \mbox{\hyperlink{structcompnal_1_1utility_1_1_pair_hash}{utility::PairHash}}> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a0c26fc8ed640fec495cd78a6e740cf79}{GetBasesInv}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{833       \textcolor{keywordflow}{return} bases\_inv\_;}
\DoxyCodeLine{834    \}}
\DoxyCodeLine{835    }
\DoxyCodeLine{841    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a21ecf217e365b76ffd1968da0453c6df}{GetBasis}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} \&quantum\_number)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{842       \textcolor{keywordflow}{return} bases\_.at(\{quantum\_number.first, \mbox{\hyperlink{namespacecompnal_1_1utility_a2a72f9ca4b619a91f9f98f97aac96787}{utility::DoubleHalfInteger}}(quantum\_number.second)\});}
\DoxyCodeLine{843    \}}
\DoxyCodeLine{844    }
\DoxyCodeLine{850    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<std::int64\_t, std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a549ebf12d4a87d6d30c0fe405a6c3770}{GetBasisInv}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a8f0a590290a48392b0b3a3ebdb7e2ab2}{QType}} \&quantum\_number)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{851       \textcolor{keywordflow}{return} bases\_inv\_.at(\{quantum\_number.first, \mbox{\hyperlink{namespacecompnal_1_1utility_a2a72f9ca4b619a91f9f98f97aac96787}{utility::DoubleHalfInteger}}(quantum\_number.second)\});}
\DoxyCodeLine{852    \}}
\DoxyCodeLine{853    }
\DoxyCodeLine{857    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a194405e7ddf3ac34b19cf3720f85ffec}{GetTargetBasis}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{858       \textcolor{keywordflow}{return} bases\_.at(\{total\_electron\_, total\_2sz\_\});}
\DoxyCodeLine{859    \}}
\DoxyCodeLine{860    }
\DoxyCodeLine{864    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<std::int64\_t, std::int64\_t> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_add2da8e17e9aef282ca6761a3c4d7acd}{GetTargetBasisInv}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{865       \textcolor{keywordflow}{return} bases\_inv\_.at(\{total\_electron\_, total\_2sz\_\});}
\DoxyCodeLine{866    \}}
\DoxyCodeLine{867    }
\DoxyCodeLine{868 \textcolor{keyword}{protected}:}
\DoxyCodeLine{870    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a80ce3f95ed41479a23b48beaa97f9dc8}{onsite\_operator\_c\_up\_}};}
\DoxyCodeLine{871    }
\DoxyCodeLine{873    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_afd210bc73eb8edea115ca6047e2e8dbe}{onsite\_operator\_c\_down\_}};}
\DoxyCodeLine{874    }
\DoxyCodeLine{877    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a94f04fbce3a0534df21565ab36084e52}{onsite\_operator\_c\_up\_dagger\_}};}
\DoxyCodeLine{878    }
\DoxyCodeLine{881    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a27cbc9f82f413f94d626123485e34ce8}{onsite\_operator\_c\_down\_dagger\_}};}
\DoxyCodeLine{882    }
\DoxyCodeLine{885    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a2ee108993d5d6e18643705073af3c71a}{onsite\_operator\_nc\_up\_}};}
\DoxyCodeLine{886    }
\DoxyCodeLine{889    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a2ed9eed4ec767decefd586405a602901}{onsite\_operator\_nc\_down\_}};}
\DoxyCodeLine{890    }
\DoxyCodeLine{893    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_ac4b973da5fe608fa25bc4109661ebb10}{onsite\_operator\_nc\_}};}
\DoxyCodeLine{894    }
\DoxyCodeLine{897    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a6a7e825a56be5ba28dfbdb755f0501f3}{onsite\_operator\_sx\_}};}
\DoxyCodeLine{898    }
\DoxyCodeLine{902    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a5660d6dd3578e59266896709f6b8d7e8}{onsite\_operator\_isy\_}};}
\DoxyCodeLine{903    }
\DoxyCodeLine{906    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a1862e467bab408d0bdce9a74fa26a52d}{onsite\_operator\_sz\_}};}
\DoxyCodeLine{907    }
\DoxyCodeLine{910    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a954dcd2609b8833568d884317423a619}{onsite\_operator\_sp\_}};}
\DoxyCodeLine{911    }
\DoxyCodeLine{914    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a61a6fd3082cd225e600d4d65a6bc5282}{onsite\_operator\_sm\_}};}
\DoxyCodeLine{915    }
\DoxyCodeLine{917    \textcolor{keywordtype}{int} system\_size\_ = 0;}
\DoxyCodeLine{918    }
\DoxyCodeLine{920    \textcolor{keywordtype}{int} total\_2sz\_ = 0;}
\DoxyCodeLine{921    }
\DoxyCodeLine{923    \textcolor{keywordtype}{int} total\_electron\_ = 0;}
\DoxyCodeLine{924    }
\DoxyCodeLine{926    \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim\_onsite\_ = 4;}
\DoxyCodeLine{927    }
\DoxyCodeLine{929    std::unordered\_set<int> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_aee93327a0e55a00bb8d759247c17fb3d}{calculated\_eigenvector\_set\_}};}
\DoxyCodeLine{930    }
\DoxyCodeLine{933    std::unordered\_map<std::pair<int, int>, std::vector<std::int64\_t>, \mbox{\hyperlink{structcompnal_1_1utility_1_1_pair_hash}{utility::PairHash}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a62cd383b7a05eb9a8b751bdfb7380557}{bases\_}};}
\DoxyCodeLine{934    }
\DoxyCodeLine{937    std::unordered\_map<std::pair<int, int>, std::unordered\_map<std::int64\_t, std::int64\_t>, \mbox{\hyperlink{structcompnal_1_1utility_1_1_pair_hash}{utility::PairHash}}> \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_a7943bbf48afea8677e5ead0e354c7b76}{bases\_inv\_}};}
\DoxyCodeLine{938    }
\DoxyCodeLine{940    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_base_u1_electron__1_d_abd6cf3af110e61f2015ed3074652d2cc}{SetOnsiteOperator}}() \{}
\DoxyCodeLine{941       onsite\_operator\_c\_up\_   = CreateOnsiteOperatorCUp();}
\DoxyCodeLine{942       onsite\_operator\_c\_down\_ = CreateOnsiteOperatorCDown();}
\DoxyCodeLine{943       onsite\_operator\_c\_up\_dagger\_   = CreateOnsiteOperatorCUpDagger();}
\DoxyCodeLine{944       onsite\_operator\_c\_down\_dagger\_ = CreateOnsiteOperatorCDownDagger();}
\DoxyCodeLine{945       onsite\_operator\_nc\_up\_   = CreateOnsiteOperatorNCUp();}
\DoxyCodeLine{946       onsite\_operator\_nc\_down\_ = CreateOnsiteOperatorNCDown();}
\DoxyCodeLine{947       onsite\_operator\_nc\_ = CreateOnsiteOperatorNC();}
\DoxyCodeLine{948       onsite\_operator\_sx\_ = CreateOnsiteOperatorSx ();}
\DoxyCodeLine{949       onsite\_operator\_isy\_= CreateOnsiteOperatoriSy();}
\DoxyCodeLine{950       onsite\_operator\_sz\_ = CreateOnsiteOperatorSz ();}
\DoxyCodeLine{951       onsite\_operator\_sp\_ = CreateOnsiteOperatorSp ();}
\DoxyCodeLine{952       onsite\_operator\_sm\_ = CreateOnsiteOperatorSm ();}
\DoxyCodeLine{953    \}}
\DoxyCodeLine{954    }
\DoxyCodeLine{955 \};}
\DoxyCodeLine{956 }
\DoxyCodeLine{957 \}}
\DoxyCodeLine{958 \}}
\DoxyCodeLine{959 }
\DoxyCodeLine{960 }
\DoxyCodeLine{961 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_BASE\_U1ELECTRON\_1D\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
