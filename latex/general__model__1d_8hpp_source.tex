\hypertarget{general__model__1d_8hpp_source}{}\doxysection{general\+\_\+model\+\_\+1d.\+hpp}
\label{general__model__1d_8hpp_source}\index{src/model/general\_model\_1d.hpp@{src/model/general\_model\_1d.hpp}}
\mbox{\hyperlink{general__model__1d_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00002}00002 \textcolor{comment}{//  u1\_electron\_1d.hpp}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00003}00003 \textcolor{comment}{//  compnal}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00005}00005 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/11/27.}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00006}00006 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00008}00008 \textcolor{preprocessor}{\#ifndef COMPNAL\_MODEL\_U1\_ELECTRON\_1D\_HPP\_}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00009}00009 \textcolor{preprocessor}{\#define COMPNAL\_MODEL\_U1\_ELECTRON\_1D\_HPP\_}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00011}00011 \textcolor{preprocessor}{\#include "{}../sparse\_matrix/all.hpp"{}}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00013}00013 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00014}00014 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00016}00016 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00017}00017 \textcolor{keyword}{namespace }model \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00019}00019 \textcolor{keyword}{template}<\textcolor{keyword}{class} BaseClass>}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00020}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d}{00020}} \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d}{GeneralModel\_1D}}: \textcolor{keyword}{public} BaseClass \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00021}00021    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00022}00022    \textcolor{keyword}{using} RealType = \textcolor{keyword}{typename} BaseClass::ValueType;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00023}00023    \textcolor{keyword}{using} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} = \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{sparse\_matrix::CRS<RealType>}};}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00024}00024    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00025}00025 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00026}00026    \textcolor{keyword}{using} BaseClass::BaseClass;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00027}00027    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00028}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_ab3cd64496b8e2876648f3c935b53e48e}{00028}}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_ab3cd64496b8e2876648f3c935b53e48e}{AddOnsitePotential}}(\textcolor{keyword}{const} RealType val, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00029}00029       \textcolor{keywordflow}{if} (val == 0.0) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00030}00030          \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00031}00031       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00032}00032       \textcolor{keywordflow}{if} (site < 0 || this-\/>system\_size\_ <= site) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00033}00033          std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00034}00034          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00035}00035          ss << \textcolor{stringliteral}{"{}Invalid site: "{}} << site << std::endl;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00036}00036          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00037}00037       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00038}00038       \textcolor{keywordflow}{if} (onsite\_operator\_list\_.count(site) == 0) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00039}00039          onsite\_operator\_list\_[site] = m.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a818173aa562d5c541552627b1570244f}{MultiplyByScalar}}(val);}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00040}00040       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00041}00041       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00042}00042          onsite\_operator\_list\_.at(site) = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{CalculateMatrixMatrixSum}}(val, m, 1.0, onsite\_operator\_list\_.at(site));}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00043}00043       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00044}00044    \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00045}00045    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00046}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a01d85f8969816d57cd3f4aa8b79e239a}{00046}}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a01d85f8969816d57cd3f4aa8b79e239a}{AddOnsitePotential}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00047}00047       \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_ab3cd64496b8e2876648f3c935b53e48e}{AddOnsitePotential}}(1.0, m, site);}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00048}00048    \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00049}00049    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00050}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a11bd36ed6a869440b9bd8ed666152f4e}{00050}}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a11bd36ed6a869440b9bd8ed666152f4e}{AddInteraction}}(\textcolor{keyword}{const} RealType val, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00051}00051       \textcolor{keywordflow}{if} (val == 0.0) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00052}00052          \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00053}00053       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00054}00054       \textcolor{keywordflow}{if} (site\_1 < 0 || this-\/>system\_size\_ <= site\_1) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00055}00055          std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00056}00056          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00057}00057          ss << \textcolor{stringliteral}{"{}Invalid site: "{}} << site\_1 << std::endl;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00058}00058          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00059}00059       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00060}00060       \textcolor{keywordflow}{if} (site\_2 < 0 || this-\/>system\_size\_ <= site\_2) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00061}00061          std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00062}00062          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_FUNCTION\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00063}00063          ss << \textcolor{stringliteral}{"{}Invalid site: "{}} << site\_2 << std::endl;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00064}00064          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00065}00065       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00066}00066       \textcolor{keywordflow}{if} (site\_1 == site\_2) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00067}00067          \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_ab3cd64496b8e2876648f3c935b53e48e}{AddOnsitePotential}}(val, \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{sparse\_matrix::CalculateMatrixMatrixProduct}}(val, m\_1, 1.0, m\_2), site\_1);}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00068}00068          \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00069}00069       \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00070}00070       }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00071}00071       intersite\_operator\_list\_[site\_1][site\_2].push\_back(\{m\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a818173aa562d5c541552627b1570244f}{MultiplyByScalar}}(val), m\_2\});}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00072}00072    \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00073}00073    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00074}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a29f2987eb544d43923121fa98ae2b6b6}{00074}}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a29f2987eb544d43923121fa98ae2b6b6}{AddInteraction}}(\textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1, \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&m\_2, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2) \{}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00075}00075       \mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a11bd36ed6a869440b9bd8ed666152f4e}{AddInteraction}}(1.0, m\_1, site\_1, m\_2, site\_2);}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00076}00076    \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00077}00077    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00078}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a06a053ae83790d126cb115b5559682f5}{00078}}    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<int, CRS> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a06a053ae83790d126cb115b5559682f5}{GetOnsiteOperatorList}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_list\_; \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00079}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a7313b90fc9dc9c1da3cf17062a632f20}{00079}}    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}} \&\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a7313b90fc9dc9c1da3cf17062a632f20}{GetOnsiteOperator}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} site)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} onsite\_operator\_list\_.at(site); \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00080}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a7f9817acdb9c4112f648cc5515065e93}{00080}}    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::unordered\_map<int, std::unordered\_map<int, std::vector<std::pair<CRS, CRS>>>> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_a7f9817acdb9c4112f648cc5515065e93}{GetIntersiteOperatorList}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} intersite\_operator\_list\_; \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00081}\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_aef282dab7ad34ff8a3fafd050b49785b}{00081}}    \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<std::pair<CRS, CRS>> \&\mbox{\hyperlink{classcompnal_1_1model_1_1_general_model__1_d_aef282dab7ad34ff8a3fafd050b49785b}{GetIntersiteOperator}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_1, \textcolor{keyword}{const} \textcolor{keywordtype}{int} site\_2)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} intersite\_operator\_list\_.at(site\_1).at(site\_2); \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00082}00082    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00083}00083 \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00084}00084    std::unordered\_map<int, CRS> onsite\_operator\_list\_;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00085}00085    std::unordered\_map<int, std::unordered\_map<int, std::vector<std::pair<CRS, CRS>>>> intersite\_operator\_list\_;}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00086}00086    }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00087}00087 \};}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00089}00089 \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00090}00090 \}}
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00092}00092 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{general__model__1d_8hpp_source_l00096}00096 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_U1\_ELECTRON\_1D\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
