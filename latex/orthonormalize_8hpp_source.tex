\hypertarget{orthonormalize_8hpp_source}{}\doxysection{orthonormalize.\+hpp}
\label{orthonormalize_8hpp_source}\index{src/sparse\_matrix/orthonormalize.hpp@{src/sparse\_matrix/orthonormalize.hpp}}
\mbox{\hyperlink{orthonormalize_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00002}00002 \textcolor{comment}{//  orthonormalization.hpp}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00003}00003 \textcolor{comment}{//  compnal}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00005}00005 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/12/09.}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00006}00006 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00008}00008 \textcolor{preprocessor}{\#ifndef COMPNAL\_SPARSE\_MATRIX\_ORTHONORMALIZE\_HPP\_}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00009}00009 \textcolor{preprocessor}{\#define COMPNAL\_SPARSE\_MATRIX\_ORTHONORMALIZE\_HPP\_}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00011}00011 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{braket__vector_8hpp}{braket\_vector.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00012}00012 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00014}00014 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00015}00015 \textcolor{keyword}{namespace }sparse\_matrix \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00016}00016 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00017}00017 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00018}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{00018}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(std::vector<\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}}> *vectors) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00019}00019    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vectors-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00020}00020       \textcolor{keyword}{const} int64\_t dim = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vectors[i]-\/>size());}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00021}00021       \textcolor{keywordflow}{for} (std::size\_t j = 0; j < i; ++j) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00022}00022          \textcolor{keyword}{const} RealType inner\_product = -\/1.0*\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(*vectors[i], (*vectors)[j]);}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00023}00023 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00024}00024          \textcolor{keywordflow}{for} (std::int64\_t k = 0; k < dim; ++k) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00025}00025             vectors[i]-\/>val[k] += inner\_product*vectors[j]-\/>val[k];}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00026}00026          \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00027}00027       \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00028}00028    \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00029}00029 \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00031}00031 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00032}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_acc7659e912249aaf5279eaa263311906}{00032}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} *target\_vector, \textcolor{keyword}{const} std::vector<\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}}> \&vectors) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00033}00033    \textcolor{keyword}{const} int64\_t dim = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(target\_vector-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size());}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00034}00034    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vectors.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00035}00035       \textcolor{keyword}{const} RealType inner\_product = -\/1.0*\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(*target\_vector, vectors[i]);}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00036}00036 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00037}00037       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < dim; ++j) \{}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00038}00038          target\_vector-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[j] += inner\_product*vectors[i].val[j];}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00039}00039       \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00040}00040    \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00041}00041 \}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00043}00043 \}  \textcolor{comment}{// namespace sparse\_matrix}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00044}00044 \}  \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{orthonormalize_8hpp_source_l00047}00047 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SPARSE\_MATRIX\_ORTHONORMALIZE\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
