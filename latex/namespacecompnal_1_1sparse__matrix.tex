\hypertarget{namespacecompnal_1_1sparse__matrix}{}\doxysection{compnal\+::sparse\+\_\+matrix Namespace Reference}
\label{namespacecompnal_1_1sparse__matrix}\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}
\item 
struct \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}
\item 
struct \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_all}{Parameters\+All}}
\item 
struct \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{Parameters\+CG}}
\item 
struct \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{Parameters\+II}}
\item 
struct \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}}
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{CRSTag}} \{ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{NONE}} = 0
, \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{FERMION}} = 1
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{Calculate\+Vector\+Sum}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$vector\+\_\+out, const Real\+Type coeef\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+1, const Real\+Type coeef\+\_\+2, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\Real\+Type \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a1a9993418bced60b2ec89ed57b48c665}{Calculate\+L1\+Norm}} (const Real\+Type coeef\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+1, const Real\+Type coeef\+\_\+2, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\Real\+Type \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{Calculate\+Inner\+Product}} (const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a3942b79c66a1a5c4603698e0eb56c9ca}{Calculate\+Vector\+Sum}} (const Real\+Type coeef\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+1, const Real\+Type coeef\+\_\+2, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&braket\+\_\+vector\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}{Calculate\+Transposed\+Matrix}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$matrix\+\_\+out, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aeb8905fe10ee567358f1e3656ea21eb4}{Calculate\+Transposed\+Matrix}} (const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}{Calculate\+Matrix\+Matrix\+Product}} (const Real\+Type coeef\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+1, const Real\+Type coeef\+\_\+2, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a62aabe97379db1f1486aadd833ac51b4}{Calculate\+Matrix\+Matrix\+Product}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$matrix\+\_\+out, const Real\+Type coeef\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+1, const Real\+Type coeef\+\_\+2, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}{Calculate\+Matrix\+Matrix\+Sum}} (const Real\+Type coeef\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+1, const Real\+Type coeef\+\_\+2, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab0ce2bb34e0ce5690e1c8bc876580ac1}{Calculate\+Matrix\+Matrix\+Sum}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$matrix\+\_\+out, const Real\+Type coeef\+\_\+1, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+1, const Real\+Type coeef\+\_\+2, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+2)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\std\+::pair$<$ int, double $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a5542adf7c191075452c4b94070fee14e}{Conjugate\+Gradient}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$vec\+\_\+out, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&vec\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{Parameters\+CG}} \&params=\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{Parameters\+CG}}(), const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&subspace\+\_\+vectors=\{\})
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\std\+::pair$<$ int, double $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}{Eigenvalue\+Decomposition\+Lanczos}} (Real\+Type $\ast$target\+\_\+value\+\_\+out, \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$target\+\_\+vector\+\_\+out, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const int target\+\_\+level, const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&subspace\+\_\+vectors, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}} \&params=\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}}())
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\std\+::pair$<$ int, double $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a785dabd2915fe57f77fa60259958a92c}{Eigenvalue\+Decomposition\+Lanczos}} (Real\+Type $\ast$gs\+\_\+value\+\_\+out, \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$gs\+\_\+vector\+\_\+out, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}} \&params=\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}}())
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\std\+::pair$<$ int, double $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086}{Eigenvalue\+Decomposition\+LOBPCG}} (Real\+Type $\ast$gs\+\_\+value\+\_\+out, \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$gs\+\_\+vector\+\_\+out, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}} \&params=\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}}())
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\std\+::pair$<$ int, double $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61}{Inverse\+Iteration}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$matrix\+\_\+in, \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$eigenvector, const Real\+Type eigenvalue, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{Parameters\+II}} \&params=\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{Parameters\+II}}(), const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&subspace\+\_\+vectors=\{\})
\item 
void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e}{dsyev\+\_\+}} (const char \&JOBZ, const char \&UPLO, const int \&N, double $\ast$$\ast$A, const int \&LDA, double $\ast$W, double $\ast$work, const int \&Lwork, int \&INFO)
\item 
void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6}{dstev\+\_\+}} (const char \&JOBZ, const int \&N, double $\ast$D, double $\ast$E, double $\ast$$\ast$Z, const int \&LDZ, double $\ast$WORK, int \&INFO)
\item 
void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80}{dspgv\+\_\+}} (const int \&ITYPE, const char \&JOBZ, const char \&UPLO, const int \&N, double $\ast$AP, double $\ast$BP, double $\ast$W, double $\ast$$\ast$Z, const int \&LDZ, double $\ast$WORK, int \&INFO)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{Lapack\+Dsyev}} (Real\+Type $\ast$gs\+\_\+value, std\+::vector$<$ Real\+Type $>$ $\ast$gs\+\_\+vector, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const int target\+\_\+level=0)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}{Lapack\+Dstev}} (Real\+Type $\ast$gs\+\_\+value, std\+::vector$<$ Real\+Type $>$ $\ast$gs\+\_\+vector, const std\+::vector$<$ Real\+Type $>$ \&diag, const std\+::vector$<$ Real\+Type $>$ \&off\+\_\+diag)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78}{Lapack\+Dspgv}} (std\+::vector$<$ Real\+Type $>$ $\ast$eigenvalues, std\+::vector$<$ Real\+Type $>$ $\ast$eigenvectors, const int i\+\_\+type, const int dim, const std\+::vector$<$ Real\+Type $>$ \&mat\+\_\+a, const std\+::vector$<$ Real\+Type $>$ \&mat\+\_\+b)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{Calculate\+Matrix\+Vector\+Product}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$vector\+\_\+out, const Real\+Type coeef, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&vector\+\_\+in)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{Calculate\+Symmetric\+Matrix\+Vector\+Product}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$vector\+\_\+out, const Real\+Type coeef, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&vector\+\_\+in, std\+::vector$<$ std\+::vector$<$ Real\+Type $>$ $>$ $\ast$vectors\+\_\+work)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a921298b3f9466b07630d3307baee5af1}{Calculate\+Symmetric\+Matrix\+Vector\+Product}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$vector\+\_\+out, const Real\+Type coeef, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&vector\+\_\+in)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a07090032644fc1d985808c6ee89fe359}{Calculate\+Matrix\+Vector\+Product}} (const Real\+Type coeef, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&vector\+\_\+in)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_adee9a61402378974ed29c3220239fe32}{Calculate\+Symmetric\+Matrix\+Vector\+Product}} (const Real\+Type coeef, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&vector\+\_\+in, std\+::vector$<$ std\+::vector$<$ Real\+Type $>$ $>$ $\ast$vectors\+\_\+work)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a2f8bc088d76b49229dd4240f10626cde}{Calculate\+Symmetric\+Matrix\+Vector\+Product}} (const Real\+Type coeef, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&matrix\+\_\+in, const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&vector\+\_\+in)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}} (std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ $\ast$vectors)
\item 
{\footnotesize template$<$typename Real\+Type $>$ }\\void \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_acc7659e912249aaf5279eaa263311906}{Orthonormalize}} (\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$target\+\_\+vector, const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&vectors)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const int \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\+\_\+\+UNIT\+\_\+\+CONSTANT}} = 1000$\ast$1000
\end{DoxyCompactItemize}


\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}\label{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CRSTag@{CRSTag}}
\index{CRSTag@{CRSTag}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CRSTag}{CRSTag}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dc}{compnal\+::sparse\+\_\+matrix\+::\+CRSTag}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{NONE@{NONE}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!NONE@{NONE}}}\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}\label{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}} 
NONE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{FERMION@{FERMION}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!FERMION@{FERMION}}}\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}\label{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}} 
FERMION&\\
\hline

\end{DoxyEnumFields}


Definition at line \mbox{\hyperlink{compressed__row__storage_8hpp_source_l00021}{21}} of file \mbox{\hyperlink{compressed__row__storage_8hpp_source}{compressed\+\_\+row\+\_\+storage.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00021}00021             \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00022}00022    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{NONE}} = 0,}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00023}00023    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{FERMION}} = 1}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00024}00024 \};}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}\label{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateInnerProduct@{CalculateInnerProduct}}
\index{CalculateInnerProduct@{CalculateInnerProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateInnerProduct()}{CalculateInnerProduct()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
Real\+Type compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Inner\+Product (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{braket__vector_8hpp_source_l00169}{169}} of file \mbox{\hyperlink{braket__vector_8hpp_source}{braket\+\_\+vector.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00170}00170                                                                               \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00171}00171    \textcolor{keywordflow}{if} (braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() != braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00172}00172       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00173}00173       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00174}00174       ss << \textcolor{stringliteral}{"{}BraketVector types do not match each other"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00175}00175       ss << \textcolor{stringliteral}{"{}dim\_1 = "{}} << braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << \textcolor{stringliteral}{"{}, dim\_2 = "{}} << braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00176}00176       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00177}00177    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00178}00178    RealType val\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00179}00179 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: val\_out)}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00180}00180    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00181}00181       val\_out += braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]*braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00182}00182    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00183}00183    \textcolor{keywordflow}{return} val\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00184}00184 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a1a9993418bced60b2ec89ed57b48c665}\label{namespacecompnal_1_1sparse__matrix_a1a9993418bced60b2ec89ed57b48c665}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateL1Norm@{CalculateL1Norm}}
\index{CalculateL1Norm@{CalculateL1Norm}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateL1Norm()}{CalculateL1Norm()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
Real\+Type compnal\+::sparse\+\_\+matrix\+::\+Calculate\+L1\+Norm (\begin{DoxyParamCaption}\item[{const Real\+Type}]{coeef\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+1,  }\item[{const Real\+Type}]{coeef\+\_\+2,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{braket__vector_8hpp_source_l00146}{146}} of file \mbox{\hyperlink{braket__vector_8hpp_source}{braket\+\_\+vector.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00150}00150                            \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00151}00151    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00152}00152    \textcolor{keywordflow}{if} (braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() != braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00153}00153       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00154}00154       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00155}00155       ss << \textcolor{stringliteral}{"{}BraketVector types do not match each other"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00156}00156       ss << \textcolor{stringliteral}{"{}dim\_1 = "{}} << braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << \textcolor{stringliteral}{"{}, dim\_2 = "{}} << braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00157}00157       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00158}00158    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00159}00159    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00160}00160    RealType val\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00161}00161 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: val\_out)}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00162}00162    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00163}00163       val\_out += std::abs(coeef\_1*braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] -\/ coeef\_2*braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00164}00164    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00165}00165    \textcolor{keywordflow}{return} val\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00166}00166 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}\label{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateMatrixMatrixProduct@{CalculateMatrixMatrixProduct}}
\index{CalculateMatrixMatrixProduct@{CalculateMatrixMatrixProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateMatrixMatrixProduct()}{CalculateMatrixMatrixProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Matrix\+Matrix\+Product (\begin{DoxyParamCaption}\item[{const Real\+Type}]{coeef\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+1,  }\item[{const Real\+Type}]{coeef\+\_\+2,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{compressed__row__storage_8hpp_source_l00271}{271}} of file \mbox{\hyperlink{compressed__row__storage_8hpp_source}{compressed\+\_\+row\+\_\+storage.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00274}00274                                                                           \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00275}00275    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} m;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00276}00276    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a62aabe97379db1f1486aadd833ac51b4}{CalculateMatrixMatrixProduct}}(\&m, coeef\_1, matrix\_1, coeef\_2, matrix\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00277}00277    \textcolor{keywordflow}{return} m;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00278}00278 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=232pt]{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ae96031f37623a90ebb421f75d8f3ae83_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a62aabe97379db1f1486aadd833ac51b4}\label{namespacecompnal_1_1sparse__matrix_a62aabe97379db1f1486aadd833ac51b4}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateMatrixMatrixProduct@{CalculateMatrixMatrixProduct}}
\index{CalculateMatrixMatrixProduct@{CalculateMatrixMatrixProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateMatrixMatrixProduct()}{CalculateMatrixMatrixProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Matrix\+Matrix\+Product (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$}]{matrix\+\_\+out,  }\item[{const Real\+Type}]{coeef\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+1,  }\item[{const Real\+Type}]{coeef\+\_\+2,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{compressed__row__storage_8hpp_source_l00281}{281}} of file \mbox{\hyperlink{compressed__row__storage_8hpp_source}{compressed\+\_\+row\+\_\+storage.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00285}00285                                                                  \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00286}00286    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00287}00287    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00288}00288       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00289}00289       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00290}00290       ss << \textcolor{stringliteral}{"{}Matrix product cannot be defined"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00291}00291       ss << \textcolor{stringliteral}{"{}matrix\_1.col\_dim = "{}} << matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << \textcolor{stringliteral}{"{}, matrix\_2.row\_dim = "{}} << matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00292}00292       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00293}00293    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00294}00294    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00295}00295    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ac196a07cc2959d23578ef9e25d2121c2}{Clear}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00296}00296    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.resize(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} + 1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00297}00297    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00298}00298    std::vector<RealType> temp\_v1(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}, 0.0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00299}00299    std::vector<RealType> temp\_v2(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}, 0.0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00300}00300    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00301}00301    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00302}00302       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00303}00303          temp\_v1[matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] = coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00304}00304       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00305}00305       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00306}00306          \textcolor{keywordflow}{for} (std::int64\_t k = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[j]; k < matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[j + 1]; ++k) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00307}00307             temp\_v2[matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[k]] += temp\_v1[j]*coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[k];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00308}00308          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00309}00309       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00310}00310       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00311}00311          \textcolor{keywordflow}{if} (std::abs(temp\_v2[j]) > 0.0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00312}00312             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(temp\_v2[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00313}00313             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(j);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00314}00314          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00315}00315       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00316}00316       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00317}00317       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] = matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00318}00318       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00319}00319       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00320}00320          temp\_v1[matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00321}00321       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00322}00322       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_out-\/>row[i + 1]; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00323}00323          temp\_v2[matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00324}00324       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00325}00325    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00326}00326    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00327}00327    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00328}00328    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00329}00329    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00330}00330    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} == matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00331}00331       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dcae05bdf4bb6404aff5e00fb5c3b5eaca0}{CRSTag::NONE}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00332}00332    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00333}00333    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00334}00334       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab956f5ab317ec175be8c3b3d709880dca5607eb17709d701c2f5eed55b61bd68c}{CRSTag::FERMION}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00335}00335    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00336}00336    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00337}00337 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a62aabe97379db1f1486aadd833ac51b4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}\label{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateMatrixMatrixSum@{CalculateMatrixMatrixSum}}
\index{CalculateMatrixMatrixSum@{CalculateMatrixMatrixSum}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateMatrixMatrixSum()}{CalculateMatrixMatrixSum()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Matrix\+Matrix\+Sum (\begin{DoxyParamCaption}\item[{const Real\+Type}]{coeef\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+1,  }\item[{const Real\+Type}]{coeef\+\_\+2,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{compressed__row__storage_8hpp_source_l00340}{340}} of file \mbox{\hyperlink{compressed__row__storage_8hpp_source}{compressed\+\_\+row\+\_\+storage.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00343}00343                                                                       \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00344}00344    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00345}00345    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} m;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00346}00346    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab0ce2bb34e0ce5690e1c8bc876580ac1}{CalculateMatrixMatrixSum}}(\&m, coeef\_1, matrix\_1, coeef\_2, matrix\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00347}00347    \textcolor{keywordflow}{return} m;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00348}00348    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00349}00349 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ac96ccd3b32760093ebb9dbc2481053b2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ab0ce2bb34e0ce5690e1c8bc876580ac1}\label{namespacecompnal_1_1sparse__matrix_ab0ce2bb34e0ce5690e1c8bc876580ac1}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateMatrixMatrixSum@{CalculateMatrixMatrixSum}}
\index{CalculateMatrixMatrixSum@{CalculateMatrixMatrixSum}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateMatrixMatrixSum()}{CalculateMatrixMatrixSum()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Matrix\+Matrix\+Sum (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$}]{matrix\+\_\+out,  }\item[{const Real\+Type}]{coeef\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+1,  }\item[{const Real\+Type}]{coeef\+\_\+2,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{compressed__row__storage_8hpp_source_l00352}{352}} of file \mbox{\hyperlink{compressed__row__storage_8hpp_source}{compressed\+\_\+row\+\_\+storage.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00356}00356                                                              \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00357}00357    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00358}00358    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} || matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00359}00359       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00360}00360       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00361}00361       ss << \textcolor{stringliteral}{"{}The summation of the matrices cannot be defined."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00362}00362       ss << \textcolor{stringliteral}{"{}matrix\_1.row\_dim = "{}} << matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, matrix\_1.col\_dim = "{}} << matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00363}00363       ss << \textcolor{stringliteral}{"{}matrix\_2.row\_dim = "{}} << matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, matrix\_2.col\_dim = "{}} << matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00364}00364       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00365}00365    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00366}00366    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00367}00367    \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} != matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00368}00368       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00369}00369       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00370}00370       ss << \textcolor{stringliteral}{"{}The summation of bosonic and fermionic operator cannot be defined."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00371}00371       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00372}00372    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00373}00373    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00374}00374    *matrix\_out = CRS<RealType>(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}, matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}});}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00375}00375    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00376}00376       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00377}00377       \textcolor{keywordtype}{int} check = 0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00378}00378       std::int64\_t count\_1 = 0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00379}00379       std::int64\_t count\_2 = 0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00380}00380       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00381}00381       \textcolor{keyword}{const} std::int64\_t row\_lower\_1 = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[  i  ];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00382}00382       \textcolor{keyword}{const} std::int64\_t row\_upper\_1 = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00383}00383       \textcolor{keyword}{const} std::int64\_t row\_lower\_2 = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[  i  ];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00384}00384       \textcolor{keyword}{const} std::int64\_t row\_upper\_2 = matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00385}00385       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00386}00386       \textcolor{keyword}{const} std::int64\_t m1\_count = row\_upper\_1 -\/ row\_lower\_1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00387}00387       \textcolor{keyword}{const} std::int64\_t m2\_count = row\_upper\_2 -\/ row\_lower\_2;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00388}00388       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00389}00389       \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count == 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00390}00390          \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00391}00391             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00392}00392             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00393}00393          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00394}00394       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00395}00395       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count == 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00396}00396          \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00397}00397             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00398}00398             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00399}00399          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00400}00400       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00401}00401       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m1\_count != 0 \&\& m2\_count != 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00402}00402          \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < m1\_count + m2\_count; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00403}00403             \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row\_lower\_1 + count\_1] < matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00404}00404                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00405}00405                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00406}00406                count\_1++;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00407}00407                \textcolor{keywordflow}{if} (row\_lower\_1 + count\_1 == row\_upper\_1) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00408}00408                   check = 1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00409}00409                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00410}00410                \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00411}00411             \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00412}00412             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row\_lower\_1 + count\_1] == matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row\_lower\_2 + count\_2]) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00413}00413                \textcolor{keyword}{const} RealType val = coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_1 + count\_1] + coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_2 + count\_2];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00414}00414                \textcolor{keywordflow}{if} (std::abs(val) > 0.0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00415}00415                   matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(val);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00416}00416                   matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row\_lower\_1 + count\_1]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00417}00417                   count\_1++;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00418}00418                   count\_2++;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00419}00419                   \textcolor{keyword}{const} std::int64\_t temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00420}00420                   \textcolor{keyword}{const} std::int64\_t temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00421}00421                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00422}00422                      check = 1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00423}00423                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00424}00424                   \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00425}00425                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00426}00426                      check = 2;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00427}00427                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00428}00428                   \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00429}00429                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00430}00430                      check = 0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00431}00431                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00432}00432                   \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00433}00433                \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00434}00434                \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00435}00435                   count\_1++;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00436}00436                   count\_2++;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00437}00437                   \textcolor{keyword}{const} std::int64\_t temp\_count\_1 = row\_lower\_1 + count\_1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00438}00438                   \textcolor{keyword}{const} std::int64\_t temp\_count\_2 = row\_lower\_2 + count\_2;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00439}00439                   \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 < row\_upper\_2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00440}00440                      check = 1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00441}00441                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00442}00442                   \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00443}00443                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 < row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00444}00444                      check = 2;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00445}00445                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00446}00446                   \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00447}00447                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp\_count\_1 == row\_upper\_1 \&\& temp\_count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00448}00448                      check = 0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00449}00449                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00450}00450                   \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00451}00451                \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00452}00452             \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00453}00453             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00454}00454                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00455}00455                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row\_lower\_2 + count\_2]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00456}00456                count\_2++;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00457}00457                \textcolor{keywordflow}{if} (row\_lower\_2 + count\_2 == row\_upper\_2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00458}00458                   check = 2;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00459}00459                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00460}00460                \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00461}00461             \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00462}00462          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00463}00463          \textcolor{keywordflow}{if} (check == 1) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00464}00464             \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_2 + count\_2; j < row\_upper\_2; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00465}00465                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_2*matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00466}00466                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(matrix\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00467}00467             \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00468}00468          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00469}00469          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (check == 2) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00470}00470             \textcolor{keywordflow}{for} (std::int64\_t j = row\_lower\_1 + count\_1; j < row\_upper\_1; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00471}00471                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(coeef\_1*matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00472}00472                matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00473}00473             \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00474}00474          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00475}00475       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00476}00476       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] = matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00477}00477    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00478}00478    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00479}00479    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}} = matrix\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00480}00480    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00481}00481 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}\label{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateMatrixVectorProduct@{CalculateMatrixVectorProduct}}
\index{CalculateMatrixVectorProduct@{CalculateMatrixVectorProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateMatrixVectorProduct()}{CalculateMatrixVectorProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Matrix\+Vector\+Product (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{vector\+\_\+out,  }\item[{const Real\+Type}]{coeef,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{vector\+\_\+in }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{matrix__vector__operation_8hpp_source_l00018}{18}} of file \mbox{\hyperlink{matrix__vector__operation_8hpp_source}{matrix\+\_\+vector\+\_\+operation.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00021}00021                                                                            \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00022}00022    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00023}00023    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} != \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size())) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00024}00024       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00025}00025       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00026}00026       ss << \textcolor{stringliteral}{"{}The column of the input matrix is "{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}  << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00027}00027       ss << \textcolor{stringliteral}{"{}The dimension of the input vector is "{}} << vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00028}00028       ss << \textcolor{stringliteral}{"{}Both must be equal"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00029}00029       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00030}00030    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00031}00031    vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00032}00032 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00033}00033    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00034}00034       RealType temp = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00035}00035       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i+1]; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00036}00036          temp += matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]*vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00037}00037       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00038}00038       vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp*coeef;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00039}00039    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00040}00040 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a07090032644fc1d985808c6ee89fe359}\label{namespacecompnal_1_1sparse__matrix_a07090032644fc1d985808c6ee89fe359}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateMatrixVectorProduct@{CalculateMatrixVectorProduct}}
\index{CalculateMatrixVectorProduct@{CalculateMatrixVectorProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateMatrixVectorProduct()}{CalculateMatrixVectorProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Matrix\+Vector\+Product (\begin{DoxyParamCaption}\item[{const Real\+Type}]{coeef,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{vector\+\_\+in }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{matrix__vector__operation_8hpp_source_l00150}{150}} of file \mbox{\hyperlink{matrix__vector__operation_8hpp_source}{matrix\+\_\+vector\+\_\+operation.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00152}00152                                                                                              \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00153}00153    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00154}00154    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a07090032644fc1d985808c6ee89fe359}{CalculateMatrixVectorProduct}}(\&vector\_out, coeef, matrix\_in, vector\_in);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00155}00155    \textcolor{keywordflow}{return} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00156}00156 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a07090032644fc1d985808c6ee89fe359_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a921298b3f9466b07630d3307baee5af1}\label{namespacecompnal_1_1sparse__matrix_a921298b3f9466b07630d3307baee5af1}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}}
\index{CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateSymmetricMatrixVectorProduct()}{CalculateSymmetricMatrixVectorProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [1/4]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Symmetric\+Matrix\+Vector\+Product (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{vector\+\_\+out,  }\item[{const Real\+Type}]{coeef,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{vector\+\_\+in }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{matrix__vector__operation_8hpp_source_l00113}{113}} of file \mbox{\hyperlink{matrix__vector__operation_8hpp_source}{matrix\+\_\+vector\+\_\+operation.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00116}00116                                                                                     \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00117}00117 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00118}00118    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00119}00119       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00120}00120       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00121}00121       ss << \textcolor{stringliteral}{"{}The input matrix is not symmetric"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00122}00122       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00123}00123    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00124}00124    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00125}00125    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} != \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size())) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00126}00126       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00127}00127       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00128}00128       ss << \textcolor{stringliteral}{"{}The column of the input matrix is "{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}  << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00129}00129       ss << \textcolor{stringliteral}{"{}The dimension of the input vector is "{}} << vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00130}00130       ss << \textcolor{stringliteral}{"{}Both must be equal"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00131}00131       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00132}00132    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00133}00133    vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00134}00134    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00135}00135    vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_abce9f7ffdc98fd45a75f29c76bfb2fcb}{Fill}}(0.0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00136}00136    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00137}00137       \textcolor{keyword}{const} RealType temp\_vec\_in = vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00138}00138       RealType       temp\_val    = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] -\/ 1]*temp\_vec\_in;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00139}00139       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] -\/ 1; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00140}00140          temp\_val += matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]*vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00141}00141          vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] += matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]*temp\_vec\_in;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00142}00142       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00143}00143       vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] += temp\_val*coeef;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00144}00144    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00145}00145 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00146}00146 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a921298b3f9466b07630d3307baee5af1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}\label{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}}
\index{CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateSymmetricMatrixVectorProduct()}{CalculateSymmetricMatrixVectorProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [2/4]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Symmetric\+Matrix\+Vector\+Product (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{vector\+\_\+out,  }\item[{const Real\+Type}]{coeef,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{vector\+\_\+in,  }\item[{std\+::vector$<$ std\+::vector$<$ Real\+Type $>$ $>$ $\ast$}]{vectors\+\_\+work }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{matrix__vector__operation_8hpp_source_l00043}{43}} of file \mbox{\hyperlink{matrix__vector__operation_8hpp_source}{matrix\+\_\+vector\+\_\+operation.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00047}00047                                                                                          \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00048}00048    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00049}00049    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00050}00050       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00051}00051       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00052}00052       ss << \textcolor{stringliteral}{"{}The input matrix is not symmetric"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00053}00053       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00054}00054    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00055}00055    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00056}00056    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} != \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size())) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00057}00057       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00058}00058       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00059}00059       ss << \textcolor{stringliteral}{"{}The column of the input matrix is "{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}  << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00060}00060       ss << \textcolor{stringliteral}{"{}The dimension of the input vector is "{}} << vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00061}00061       ss << \textcolor{stringliteral}{"{}Both must be equal"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00062}00062       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00063}00063    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00064}00064    vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00065}00065    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00066}00066 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00067}00067    \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_threads = omp\_get\_max\_threads();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00068}00068    \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(vectors\_work-\/>size()) != num\_threads) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00069}00069       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00070}00070       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00071}00071       ss << \textcolor{stringliteral}{"{}Working vector (vectors\_work) must be arrays of the number of parallel threads"{}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00072}00072       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00073}00073    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00074}00074    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00075}00075 \textcolor{preprocessor}{\#pragma omp parallel for schedule (guided)}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00076}00076    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00077}00077       \textcolor{keyword}{const} \textcolor{keywordtype}{int}      thread\_num  = omp\_get\_thread\_num();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00078}00078       \textcolor{keyword}{const} RealType temp\_vec\_in = vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00079}00079       RealType       temp\_val    = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] -\/ 1]*temp\_vec\_in;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00080}00080       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] -\/ 1; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00081}00081          temp\_val += matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]*vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00082}00082          (*vectors\_work)[thread\_num][matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] += matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]*temp\_vec\_in;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00083}00083       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00084}00084       (*vectors\_work)[thread\_num][i] += temp\_val;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00085}00085    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00086}00086    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00087}00087 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00088}00088    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00089}00089       RealType temp\_val = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00090}00090       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} thread\_num = 0; thread\_num < num\_threads; ++thread\_num) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00091}00091          temp\_val += (*vectors\_work)[thread\_num][i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00092}00092          (*vectors\_work)[thread\_num][i] = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00093}00093       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00094}00094       vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val*coeef;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00095}00095    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00096}00096    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00097}00097 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00098}00098    vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_abce9f7ffdc98fd45a75f29c76bfb2fcb}{Fill}}(0.0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00099}00099    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00100}00100       \textcolor{keyword}{const} RealType temp\_vec\_in = vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00101}00101       RealType       temp\_val    = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] -\/ 1]*temp\_vec\_in;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00102}00102       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1] -\/ 1; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00103}00103          temp\_val += matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]*vector\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00104}00104          vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] += matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]*temp\_vec\_in;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00105}00105       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00106}00106       vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] += temp\_val*coeef;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00107}00107    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00108}00108    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00109}00109 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00110}00110 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a2f8bc088d76b49229dd4240f10626cde}\label{namespacecompnal_1_1sparse__matrix_a2f8bc088d76b49229dd4240f10626cde}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}}
\index{CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateSymmetricMatrixVectorProduct()}{CalculateSymmetricMatrixVectorProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [3/4]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Symmetric\+Matrix\+Vector\+Product (\begin{DoxyParamCaption}\item[{const Real\+Type}]{coeef,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{vector\+\_\+in }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{matrix__vector__operation_8hpp_source_l00169}{169}} of file \mbox{\hyperlink{matrix__vector__operation_8hpp_source}{matrix\+\_\+vector\+\_\+operation.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00171}00171                                                                                                       \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00172}00172    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00173}00173    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a2f8bc088d76b49229dd4240f10626cde}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_out, coeef, matrix\_in, vector\_in);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00174}00174    \textcolor{keywordflow}{return} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00175}00175 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a2f8bc088d76b49229dd4240f10626cde_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_adee9a61402378974ed29c3220239fe32}\label{namespacecompnal_1_1sparse__matrix_adee9a61402378974ed29c3220239fe32}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}}
\index{CalculateSymmetricMatrixVectorProduct@{CalculateSymmetricMatrixVectorProduct}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateSymmetricMatrixVectorProduct()}{CalculateSymmetricMatrixVectorProduct()}\hspace{0.1cm}{\footnotesize\ttfamily [4/4]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Symmetric\+Matrix\+Vector\+Product (\begin{DoxyParamCaption}\item[{const Real\+Type}]{coeef,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{vector\+\_\+in,  }\item[{std\+::vector$<$ std\+::vector$<$ Real\+Type $>$ $>$ $\ast$}]{vectors\+\_\+work }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{matrix__vector__operation_8hpp_source_l00159}{159}} of file \mbox{\hyperlink{matrix__vector__operation_8hpp_source}{matrix\+\_\+vector\+\_\+operation.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00162}00162                                                                                                            \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00163}00163    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00164}00164    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a2f8bc088d76b49229dd4240f10626cde}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_out, coeef, matrix\_in, vector\_in, vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00165}00165    \textcolor{keywordflow}{return} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00166}00166 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_adee9a61402378974ed29c3220239fe32_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_aeb8905fe10ee567358f1e3656ea21eb4}\label{namespacecompnal_1_1sparse__matrix_aeb8905fe10ee567358f1e3656ea21eb4}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateTransposedMatrix@{CalculateTransposedMatrix}}
\index{CalculateTransposedMatrix@{CalculateTransposedMatrix}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateTransposedMatrix()}{CalculateTransposedMatrix()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Transposed\+Matrix (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{compressed__row__storage_8hpp_source_l00264}{264}} of file \mbox{\hyperlink{compressed__row__storage_8hpp_source}{compressed\+\_\+row\+\_\+storage.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00264}00264                                                                         \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00265}00265    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} matrix\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00266}00266    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aeb8905fe10ee567358f1e3656ea21eb4}{CalculateTransposedMatrix}}(\&matrix\_out, matrix\_in);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00267}00267    \textcolor{keywordflow}{return} matrix\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00268}00268 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_aeb8905fe10ee567358f1e3656ea21eb4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}\label{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateTransposedMatrix@{CalculateTransposedMatrix}}
\index{CalculateTransposedMatrix@{CalculateTransposedMatrix}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateTransposedMatrix()}{CalculateTransposedMatrix()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Transposed\+Matrix (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$}]{matrix\+\_\+out,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{compressed__row__storage_8hpp_source_l00242}{242}} of file \mbox{\hyperlink{compressed__row__storage_8hpp_source}{compressed\+\_\+row\+\_\+storage.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00242}00242                                                                                           \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00243}00243    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00244}00244    std::vector<std::int64\_t> row\_count(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00245}00245    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ac196a07cc2959d23578ef9e25d2121c2}{Clear}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00246}00246    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00247}00247       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00248}00248          \textcolor{keyword}{const} std::int64\_t row = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[j] + row\_count[j];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00249}00249          \textcolor{keywordflow}{if} (row < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[j + 1] \&\& matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[row] == i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00250}00250             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}.push\_back(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[row]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00251}00251             matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.push\_back(j);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00252}00252             row\_count[j]++;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00253}00253          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00254}00254       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00255}00255       matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}.push\_back(matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}.size());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00256}00256    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00257}00257    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00258}00258    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00259}00259    matrix\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}}     = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a6e745b9eae6656c2210783e1e9d1d2b7}{tag}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00260}00260 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a55b77bf4b52994ffde7829a8b1ad8637_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}\label{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateVectorSum@{CalculateVectorSum}}
\index{CalculateVectorSum@{CalculateVectorSum}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateVectorSum()}{CalculateVectorSum()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Vector\+Sum (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{vector\+\_\+out,  }\item[{const Real\+Type}]{coeef\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+1,  }\item[{const Real\+Type}]{coeef\+\_\+2,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{braket__vector_8hpp_source_l00126}{126}} of file \mbox{\hyperlink{braket__vector_8hpp_source}{braket\+\_\+vector.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00130}00130                                                                        \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00131}00131    \textcolor{keywordflow}{if} (braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() != braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00132}00132       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00133}00133       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00134}00134       ss << \textcolor{stringliteral}{"{}BraketVector types do not match each other"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00135}00135       ss << \textcolor{stringliteral}{"{}dim\_1 = "{}} << braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << \textcolor{stringliteral}{"{}, dim\_2 = "{}} << braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00136}00136       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00137}00137    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00138}00138    vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00139}00139 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00140}00140    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00141}00141       vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = coeef\_1*braket\_vector\_1.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] + coeef\_2*braket\_vector\_2.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00142}00142    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00143}00143 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a3942b79c66a1a5c4603698e0eb56c9ca}\label{namespacecompnal_1_1sparse__matrix_a3942b79c66a1a5c4603698e0eb56c9ca}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!CalculateVectorSum@{CalculateVectorSum}}
\index{CalculateVectorSum@{CalculateVectorSum}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{CalculateVectorSum()}{CalculateVectorSum()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ compnal\+::sparse\+\_\+matrix\+::\+Calculate\+Vector\+Sum (\begin{DoxyParamCaption}\item[{const Real\+Type}]{coeef\+\_\+1,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+1,  }\item[{const Real\+Type}]{coeef\+\_\+2,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{braket\+\_\+vector\+\_\+2 }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{braket__vector_8hpp_source_l00187}{187}} of file \mbox{\hyperlink{braket__vector_8hpp_source}{braket\+\_\+vector.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00190}00190                                                                                          \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00191}00191    \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{BraketVector<RealType>}} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00192}00192    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a3942b79c66a1a5c4603698e0eb56c9ca}{CalculateVectorSum}}(\&vector\_out, coeef\_1, braket\_vector\_1, coeef\_2, braket\_vector\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00193}00193    \textcolor{keywordflow}{return} vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00194}00194 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a3942b79c66a1a5c4603698e0eb56c9ca_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a5542adf7c191075452c4b94070fee14e}\label{namespacecompnal_1_1sparse__matrix_a5542adf7c191075452c4b94070fee14e}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!ConjugateGradient@{ConjugateGradient}}
\index{ConjugateGradient@{ConjugateGradient}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{ConjugateGradient()}{ConjugateGradient()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
std\+::pair$<$ int, double $>$ compnal\+::sparse\+\_\+matrix\+::\+Conjugate\+Gradient (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{vec\+\_\+out,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ \&}]{vec\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{Parameters\+CG}} \&}]{params = {\ttfamily \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g}{Parameters\+CG}}()},  }\item[{const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&}]{subspace\+\_\+vectors = {\ttfamily \{\}} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{conjugate__gradient_8hpp_source_l00025}{25}} of file \mbox{\hyperlink{conjugate__gradient_8hpp_source}{conjugate\+\_\+gradient.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00029}00029                                                                                                      \{\}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00030}00030                                          ) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00031}00031    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00032}00032    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00033}00033       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00034}00034       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00035}00035       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00036}00036       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00037}00037       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00038}00038    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00039}00039    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00040}00040    \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vec\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00041}00041       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00042}00042       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00043}00043       ss << \textcolor{stringliteral}{"{}Matrix vector product (Ax=b) cannot be defined."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00044}00044       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00045}00045    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00046}00046    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00047}00047    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00048}00048    \textcolor{keyword}{const} std::int64\_t dim = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00049}00049    BraketVector<RealType> rrr(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00050}00050    BraketVector<RealType> ppp(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00051}00051    BraketVector<RealType> yyy(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00052}00052    std::vector<std::vector<RealType>> vectors\_work;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00053}00053    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00054}00054    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00055}00055 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00056}00056       vectors\_work = std::vector<std::vector<RealType>>(omp\_get\_max\_threads(), std::vector<RealType>(dim));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00057}00057 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00058}00058    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00059}00059    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00060}00060    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_ab77ae3ceff61132bd26ae14cd43c5f44}{flag\_use\_initial\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00061}00061       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vec\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) != dim) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00062}00062          std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00063}00063          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00064}00064          ss << \textcolor{stringliteral}{"{}The dimension of the initial vector is not equal to that of the input matrix."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00065}00065          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00066}00066       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00067}00067    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00068}00068    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00069}00069       std::uniform\_real\_distribution<RealType> uniform\_rand(-\/1, 1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00070}00070       std::mt19937 random\_number\_engine;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00071}00071       random\_number\_engine.seed(std::random\_device()());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00072}00072       vec\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00073}00073       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00074}00074          vec\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00075}00075       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00076}00076    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00077}00077    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(vec\_out, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00078}00078    vec\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00079}00079    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00080}00080       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&rrr, 1.0, matrix\_in, *vec\_out, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00081}00081    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00082}00082    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00083}00083       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&rrr, 1.0, matrix\_in, *vec\_out);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00084}00084    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00085}00085    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00086}00086 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00087}00087    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00088}00088       rrr.val[i] = vec\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] -\/ rrr.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00089}00089       ppp.val[i] = rrr.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00090}00090    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00091}00091    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00092}00092    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&rrr, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00093}00093    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&ppp, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00094}00094    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00095}00095    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a10b4190e1585c5e57c378165d72ddb69}{max\_step}}; ++step) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00096}00096       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00097}00097          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&yyy, 1.0, matrix\_in, ppp, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00098}00098       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00099}00099       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00100}00100          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&yyy, 1.0, matrix\_in, ppp);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00101}00101       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00102}00102       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00103}00103       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&yyy, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00104}00104       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00105}00105       \textcolor{keyword}{const} RealType inner\_prod = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(rrr, rrr);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00106}00106       \textcolor{keyword}{const} RealType alpha      = inner\_prod/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(ppp, yyy);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00107}00107       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00108}00108 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00109}00109       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00110}00110          vec\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] += alpha*ppp.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00111}00111          rrr.val[i]      -\/= alpha*yyy.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00112}00112       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00113}00113       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00114}00114       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(vec\_out, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00115}00115       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&rrr    , subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00116}00116       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00117}00117       \textcolor{keyword}{const} RealType residual\_error = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(rrr, rrr);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00118}00118       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00119}00119       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a866af8027ccba21859411e381a3dd618}{flag\_output\_info}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00120}00120          std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rCG\_Step["{}} << step << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00121}00121          std::cout << residual\_error << std::string(5, \textcolor{charliteral}{' '}) << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00122}00122       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00123}00123       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00124}00124       \textcolor{keywordflow}{if} (residual\_error < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_a17e4642941049d302a36a65c89eb222c}{acc}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00125}00125          \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00126}00126          \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00127}00127          std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of conjugate\_gradient:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00128}00128          std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00129}00129          std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00130}00130          \textcolor{keywordflow}{return} \{step, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00131}00131       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00132}00132       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00133}00133       \textcolor{keyword}{const} RealType beta = residual\_error/inner\_prod;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00134}00134       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00135}00135 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00136}00136       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00137}00137          ppp.val[i] = rrr.val[i] + beta*ppp.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00138}00138       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00139}00139       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&ppp, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00140}00140    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00141}00141    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00142}00142    std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00143}00143    ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00144}00144    ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00145}00145    \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00146}00146    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00147}00147 \}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80}\label{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!dspgv\_@{dspgv\_}}
\index{dspgv\_@{dspgv\_}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{dspgv\_()}{dspgv\_()}}
{\footnotesize\ttfamily void compnal\+::sparse\+\_\+matrix\+::dspgv\+\_\+ (\begin{DoxyParamCaption}\item[{const int \&}]{ITYPE,  }\item[{const char \&}]{JOBZ,  }\item[{const char \&}]{UPLO,  }\item[{const int \&}]{N,  }\item[{double $\ast$}]{AP,  }\item[{double $\ast$}]{BP,  }\item[{double $\ast$}]{W,  }\item[{double $\ast$$\ast$}]{Z,  }\item[{const int \&}]{LDZ,  }\item[{double $\ast$}]{WORK,  }\item[{int \&}]{INFO }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6}\label{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!dstev\_@{dstev\_}}
\index{dstev\_@{dstev\_}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{dstev\_()}{dstev\_()}}
{\footnotesize\ttfamily void compnal\+::sparse\+\_\+matrix\+::dstev\+\_\+ (\begin{DoxyParamCaption}\item[{const char \&}]{JOBZ,  }\item[{const int \&}]{N,  }\item[{double $\ast$}]{D,  }\item[{double $\ast$}]{E,  }\item[{double $\ast$$\ast$}]{Z,  }\item[{const int \&}]{LDZ,  }\item[{double $\ast$}]{WORK,  }\item[{int \&}]{INFO }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e}\label{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!dsyev\_@{dsyev\_}}
\index{dsyev\_@{dsyev\_}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{dsyev\_()}{dsyev\_()}}
{\footnotesize\ttfamily void compnal\+::sparse\+\_\+matrix\+::dsyev\+\_\+ (\begin{DoxyParamCaption}\item[{const char \&}]{JOBZ,  }\item[{const char \&}]{UPLO,  }\item[{const int \&}]{N,  }\item[{double $\ast$$\ast$}]{A,  }\item[{const int \&}]{LDA,  }\item[{double $\ast$}]{W,  }\item[{double $\ast$}]{work,  }\item[{const int \&}]{Lwork,  }\item[{int \&}]{INFO }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a785dabd2915fe57f77fa60259958a92c}\label{namespacecompnal_1_1sparse__matrix_a785dabd2915fe57f77fa60259958a92c}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!EigenvalueDecompositionLanczos@{EigenvalueDecompositionLanczos}}
\index{EigenvalueDecompositionLanczos@{EigenvalueDecompositionLanczos}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{EigenvalueDecompositionLanczos()}{EigenvalueDecompositionLanczos()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
std\+::pair$<$ int, double $>$ compnal\+::sparse\+\_\+matrix\+::\+Eigenvalue\+Decomposition\+Lanczos (\begin{DoxyParamCaption}\item[{Real\+Type $\ast$}]{gs\+\_\+value\+\_\+out,  }\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{gs\+\_\+vector\+\_\+out,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}} \&}]{params = {\ttfamily \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}}()} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{eigendecomposition_8hpp_source_l00293}{293}} of file \mbox{\hyperlink{eigendecomposition_8hpp_source}{eigendecomposition.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00297}00297                                                         \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00298}00298    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00299}00299    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00300}00300       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00301}00301       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00302}00302       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00303}00303       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00304}00304       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00305}00305    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00306}00306    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00307}00307    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00308}00308    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00309}00309    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00310}00310       *gs\_value\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00311}00311       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aea9a7595862adf9c7e98138aaf0806e1}{Clear}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00312}00312       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00313}00313       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00314}00314       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00315}00315    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00316}00316    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00317}00317    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 1) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00318}00318       *gs\_value\_out = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[0];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00319}00319       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00320}00320       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00321}00321       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00322}00322       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00323}00323       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00324}00324    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00325}00325    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00326}00326    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} <= 1000) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00327}00327       std::vector<RealType> temp\_gs\_vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00328}00328       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{LapackDsyev}}(gs\_value\_out, \&temp\_gs\_vector\_out, matrix\_in);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00329}00329       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(temp\_gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00330}00330       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00331}00331       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00332}00332       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00333}00333    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00334}00334    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00335}00335    \textcolor{keywordtype}{int} converge\_step\_number = 0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00336}00336    \textcolor{keyword}{const} std::int64\_t dim = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00337}00337    RealType residual\_error\_final = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00338}00338    BraketVector<RealType> vector\_0(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00339}00339    BraketVector<RealType> vector\_1(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00340}00340    BraketVector<RealType> vector\_2(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00341}00341 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00342}00342    std::vector<std::vector<RealType>> rits\_vector;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00343}00343    std::vector<RealType> krylov\_eigen\_vector;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00344}00344    std::vector<RealType> krylov\_eigen\_value(params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_adc7f6d768228c64cbdb1d33b12c9de09}{max\_step}} + 1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00345}00345    std::vector<RealType> diagonal\_value;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00346}00346    std::vector<RealType> off\_diagonal\_value;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00347}00347    std::vector<std::vector<RealType>> vectors\_work;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00348}00348    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00349}00349    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00350}00350 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00351}00351       vectors\_work = std::vector<std::vector<RealType>>(omp\_get\_max\_threads(), std::vector<RealType>(dim));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00352}00352 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00353}00353    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00354}00354 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00355}00355       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00356}00356    std::uniform\_real\_distribution<RealType> uniform\_rand(-\/1, 1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00357}00357    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = std::random\_device()();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00358}00358    std::mt19937 random\_number\_engine;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00359}00359    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00360}00360    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a49d60a22784ad109c4f66d8548603de9}{flag\_use\_initial\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00361}00361       vector\_0.Assign(*gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00362}00362    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00363}00363    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00364}00364       random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00365}00365       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00366}00366          vector\_0.val[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00367}00367       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00368}00368    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00369}00369    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00370}00370    vector\_0.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00371}00371    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00372}00372    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{flag\_store\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00373}00373       rits\_vector.push\_back(vector\_0.val);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00374}00374    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00375}00375    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00376}00376    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00377}00377       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00378}00378    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00379}00379    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00380}00380       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00381}00381    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00382}00382    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00383}00383    diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_0, vector\_1));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00384}00384    krylov\_eigen\_value[0] = diagonal\_value[0];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00385}00385    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00386}00386       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00387}00387    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_adc7f6d768228c64cbdb1d33b12c9de09}{max\_step}}; ++step) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00388}00388       vector\_2.Assign(vector\_1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00389}00389       off\_diagonal\_value.push\_back(vector\_2.L2Norm());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00390}00390       vector\_2.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00391}00391       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00392}00392       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{flag\_store\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00393}00393          rits\_vector.push\_back(vector\_2.val);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00394}00394       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00395}00395       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00396}00396       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00397}00397          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00398}00398       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00399}00399       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00400}00400          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00401}00401       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00402}00402       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00403}00403       diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_1, vector\_2));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00404}00404       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00405}00405       \textcolor{keywordflow}{if} (step >= params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a7ef7b43a9660fc136be725620fbeaf6f}{min\_step}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00406}00406          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}{LapackDstev}}(\&krylov\_eigen\_value[step + 1], \&krylov\_eigen\_vector, diagonal\_value, off\_diagonal\_value);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00407}00407          \textcolor{keyword}{const} RealType residual\_error = std::abs(krylov\_eigen\_value[step + 1] -\/ krylov\_eigen\_value[step]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00408}00408          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00409}00409          \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ab5874cbc827cbeafcd626b43189e0e13}{flag\_output\_info}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00410}00410             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Step["{}} << step + 1 << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00411}00411             std::cout << residual\_error << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00412}00412          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00413}00413          \textcolor{keywordflow}{if} (residual\_error < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a4df305aa854596ff50f61b7d3c707830}{acc}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00414}00414             *gs\_value\_out = krylov\_eigen\_value[step + 1];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00415}00415             converge\_step\_number = step + 1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00416}00416             residual\_error\_final = residual\_error;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00417}00417             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00418}00418          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00419}00419       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00420}00420 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00421}00421       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00422}00422          vector\_1.val[i] -\/= diagonal\_value[step + 1]*vector\_2.val[i] + off\_diagonal\_value[step]*vector\_0.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00423}00423          vector\_0.val[i]  = vector\_2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00424}00424       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00425}00425    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00426}00426    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00427}00427    \textcolor{keywordflow}{if} (converge\_step\_number <= 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00428}00428       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00429}00429       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00430}00430       ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00431}00431       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00432}00432    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00433}00433    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00434}00434    gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00435}00435    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00436}00436    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{flag\_store\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00437}00437 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00438}00438       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00439}00439          RealType temp\_val = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00440}00440          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j <= converge\_step\_number; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00441}00441             temp\_val += krylov\_eigen\_vector[j]*rits\_vector[j][i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00442}00442          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00443}00443          gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00444}00444       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00445}00445       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00446}00446    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00447}00447    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00448}00448       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a49d60a22784ad109c4f66d8548603de9}{flag\_use\_initial\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00449}00449 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00450}00450          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00451}00451             vector\_0.val[i] = gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00452}00452             gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00453}00453          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00454}00454       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00455}00455       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00456}00456          random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00457}00457          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00458}00458             vector\_0.val[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00459}00459          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00460}00460       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00461}00461       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00462}00462       vector\_0.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00463}00463       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(gs\_vector\_out, 1.0, *gs\_vector\_out, krylov\_eigen\_vector[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00464}00464       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00465}00465          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00466}00466       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00467}00467       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00468}00468          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00469}00469       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00470}00470       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00471}00471       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00472}00472       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00473}00473       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 1; step <= converge\_step\_number; ++step) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00474}00474          vector\_2.Assign(vector\_1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00475}00475          vector\_2.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00476}00476          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(gs\_vector\_out, 1.0, *gs\_vector\_out, krylov\_eigen\_vector[step], vector\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00477}00477          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00478}00478          \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00479}00479             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00480}00480          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00481}00481          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00482}00482             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00483}00483          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00484}00484          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00485}00485 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00486}00486          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00487}00487             vector\_1.val[i] -\/= diagonal\_value[step]*vector\_2.val[i] + off\_diagonal\_value[step -\/ 1]*vector\_0.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00488}00488             vector\_0.val[i]  = vector\_2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00489}00489          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00490}00490          \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ab5874cbc827cbeafcd626b43189e0e13}{flag\_output\_info}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00491}00491             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Vec\_Step:"{}} << step << \textcolor{stringliteral}{"{}/"{}} << converge\_step\_number << std::string(5, \textcolor{charliteral}{' '}) << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00492}00492          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00493}00493       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00494}00494       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00495}00495    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00496}00496    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00497}00497    \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00498}00498    \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00499}00499    std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of diagonalization:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00500}00500    std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error\_final << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00501}00501    std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00502}00502    \textcolor{keywordflow}{return} \{converge\_step\_number, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00503}00503 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a785dabd2915fe57f77fa60259958a92c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}\label{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!EigenvalueDecompositionLanczos@{EigenvalueDecompositionLanczos}}
\index{EigenvalueDecompositionLanczos@{EigenvalueDecompositionLanczos}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{EigenvalueDecompositionLanczos()}{EigenvalueDecompositionLanczos()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
std\+::pair$<$ int, double $>$ compnal\+::sparse\+\_\+matrix\+::\+Eigenvalue\+Decomposition\+Lanczos (\begin{DoxyParamCaption}\item[{Real\+Type $\ast$}]{target\+\_\+value\+\_\+out,  }\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{target\+\_\+vector\+\_\+out,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const int}]{target\+\_\+level,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&}]{subspace\+\_\+vectors,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}} \&}]{params = {\ttfamily \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}}()} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{eigendecomposition_8hpp_source_l00065}{65}} of file \mbox{\hyperlink{eigendecomposition_8hpp_source}{eigendecomposition.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00071}00071                                                         \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00072}00072    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00073}00073    \textcolor{keywordflow}{if} (target\_level == 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00074}00074       \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a785dabd2915fe57f77fa60259958a92c}{EigenvalueDecompositionLanczos}}(target\_value\_out, target\_vector\_out, matrix\_in, params);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00075}00075    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00076}00076    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00077}00077    \textcolor{keywordflow}{if} (target\_level < 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00078}00078       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00079}00079       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00080}00080       ss << \textcolor{stringliteral}{"{}Invalid target\_level"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00081}00081       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00082}00082    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00083}00083    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00084}00084    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00085}00085    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00086}00086    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00087}00087       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00088}00088       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00089}00089       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00090}00090       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00091}00091       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00092}00092    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00093}00093    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00094}00094    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00095}00095       *target\_value\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00096}00096       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aea9a7595862adf9c7e98138aaf0806e1}{Clear}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00097}00097       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00098}00098       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00099}00099       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00100}00100    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00101}00101    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00102}00102    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} <= 1000) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00103}00103       std::vector<RealType> temp\_gs\_vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00104}00104       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{LapackDsyev}}(target\_value\_out, \&temp\_gs\_vector\_out, matrix\_in, target\_level);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00105}00105       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(temp\_gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00106}00106       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00107}00107       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00108}00108       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00109}00109    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00110}00110    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00111}00111    \textcolor{keywordflow}{if} (target\_level != \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(subspace\_vectors.size())) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00112}00112       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00113}00113       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00114}00114       ss << \textcolor{stringliteral}{"{}Invalid size of subspace\_vectors"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00115}00115       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00116}00116    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00117}00117    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00118}00118    \textcolor{keywordtype}{int} converge\_step\_number = 0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00119}00119    \textcolor{keyword}{const} std::int64\_t dim = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00120}00120    RealType residual\_error\_final = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00121}00121    BraketVector<RealType> vector\_0(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00122}00122    BraketVector<RealType> vector\_1(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00123}00123    BraketVector<RealType> vector\_2(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00124}00124 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00125}00125    std::vector<std::vector<RealType>> rits\_vector;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00126}00126    std::vector<RealType> krylov\_eigen\_vector;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00127}00127    std::vector<RealType> krylov\_eigen\_value(params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_adc7f6d768228c64cbdb1d33b12c9de09}{max\_step}} + 1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00128}00128    std::vector<RealType> diagonal\_value;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00129}00129    std::vector<RealType> off\_diagonal\_value;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00130}00130    std::vector<std::vector<RealType>> vectors\_work;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00131}00131    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00132}00132    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00133}00133 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00134}00134       vectors\_work = std::vector<std::vector<RealType>>(omp\_get\_max\_threads(), std::vector<RealType>(dim));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00135}00135 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00136}00136    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00137}00137    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00138}00138    std::uniform\_real\_distribution<RealType> uniform\_rand(-\/1, 1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00139}00139    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = std::random\_device()();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00140}00140    std::mt19937 random\_number\_engine;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00141}00141    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00142}00142    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a49d60a22784ad109c4f66d8548603de9}{flag\_use\_initial\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00143}00143       vector\_0.Assign(*target\_vector\_out);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00144}00144    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00145}00145    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00146}00146       random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00147}00147       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00148}00148          vector\_0.val[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00149}00149       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00150}00150    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00151}00151    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_0, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00152}00152    vector\_0.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00153}00153    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00154}00154    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{flag\_store\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00155}00155       rits\_vector.push\_back(vector\_0.val);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00156}00156    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00157}00157    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00158}00158    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00159}00159       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00160}00160    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00161}00161    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00162}00162       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00163}00163    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00164}00164    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00165}00165    diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_0, vector\_1));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00166}00166    krylov\_eigen\_value[0] = diagonal\_value[0];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00167}00167    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00168}00168    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00169}00169    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_adc7f6d768228c64cbdb1d33b12c9de09}{max\_step}}; ++step) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00170}00170       vector\_2.Assign(vector\_1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00171}00171       off\_diagonal\_value.push\_back(vector\_2.L2Norm());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00172}00172       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_2, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00173}00173       vector\_2.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00174}00174       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00175}00175       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{flag\_store\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00176}00176          rits\_vector.push\_back(vector\_2.val);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00177}00177       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00178}00178       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00179}00179       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00180}00180          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00181}00181       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00182}00182       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00183}00183          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00184}00184       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00185}00185       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00186}00186       diagonal\_value.push\_back(\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(vector\_1, vector\_2));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00187}00187       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00188}00188       \textcolor{keywordflow}{if} (step >= params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a7ef7b43a9660fc136be725620fbeaf6f}{min\_step}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00189}00189          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}{LapackDstev}}(\&krylov\_eigen\_value[step + 1], \&krylov\_eigen\_vector, diagonal\_value, off\_diagonal\_value);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00190}00190          \textcolor{keyword}{const} RealType residual\_error = std::abs(krylov\_eigen\_value[step + 1] -\/ krylov\_eigen\_value[step]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00191}00191          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00192}00192          \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ab5874cbc827cbeafcd626b43189e0e13}{flag\_output\_info}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00193}00193             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Step["{}} << step + 1 << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00194}00194             std::cout << residual\_error << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00195}00195          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00196}00196          \textcolor{keywordflow}{if} (residual\_error < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a4df305aa854596ff50f61b7d3c707830}{acc}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00197}00197             *target\_value\_out    = krylov\_eigen\_value[step + 1];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00198}00198             converge\_step\_number = step + 1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00199}00199             residual\_error\_final = residual\_error;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00200}00200             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00201}00201          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00202}00202       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00203}00203 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00204}00204       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00205}00205          vector\_1.val[i] -\/= diagonal\_value[step + 1]*vector\_2.val[i] + off\_diagonal\_value[step]*vector\_0.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00206}00206          vector\_0.val[i]  = vector\_2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00207}00207       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00208}00208    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00209}00209    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00210}00210    \textcolor{keywordflow}{if} (converge\_step\_number <= 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00211}00211       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00212}00212       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00213}00213       ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00214}00214       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00215}00215    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00216}00216    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00217}00217    target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00218}00218    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00219}00219    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a2bd5b62e307561b323f4f81bce4532cf}{flag\_store\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00220}00220 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00221}00221       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00222}00222          RealType temp\_val = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00223}00223          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j <= converge\_step\_number; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00224}00224             temp\_val += krylov\_eigen\_vector[j]*rits\_vector[j][i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00225}00225          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00226}00226          target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = temp\_val;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00227}00227       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00228}00228       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00229}00229    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00230}00230    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00231}00231       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a49d60a22784ad109c4f66d8548603de9}{flag\_use\_initial\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00232}00232 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00233}00233          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00234}00234             vector\_0.val[i] = target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00235}00235             target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00236}00236          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00237}00237       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00238}00238       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00239}00239          random\_number\_engine.seed(seed);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00240}00240          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00241}00241             vector\_0.val[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00242}00242          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00243}00243       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00244}00244       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00245}00245       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_0, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00246}00246       vector\_0.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00247}00247 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00248}00248       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(target\_vector\_out, 1.0, *target\_vector\_out, krylov\_eigen\_vector[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00249}00249       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00250}00250          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00251}00251       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00252}00252       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00253}00253          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00254}00254       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00255}00255       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00256}00256       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(\&vector\_1, 1.0, vector\_1, -\/krylov\_eigen\_value[0], vector\_0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00257}00257       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00258}00258       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 1; step <= converge\_step\_number; ++step) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00259}00259          vector\_2.Assign(vector\_1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00260}00260          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}{Orthonormalize}}(\&vector\_2, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00261}00261          vector\_2.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00262}00262          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac6379142a8da9a140ba3ff9de1e3ab35}{CalculateVectorSum}}(target\_vector\_out, 1.0, *target\_vector\_out, krylov\_eigen\_vector[step], vector\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00263}00263          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00264}00264          \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00265}00265             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00266}00266          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00267}00267          \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00268}00268             \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vector\_1, 1.0, matrix\_in, vector\_2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00269}00269          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00270}00270          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00271}00271 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00272}00272          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00273}00273             vector\_1.val[i] -\/= diagonal\_value[step]*vector\_2.val[i] + off\_diagonal\_value[step -\/ 1]*vector\_0.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00274}00274             vector\_0.val[i]  = vector\_2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00275}00275          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00276}00276          \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ab5874cbc827cbeafcd626b43189e0e13}{flag\_output\_info}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00277}00277             std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLanczos\_Vec\_Step:"{}} << step << \textcolor{stringliteral}{"{}/"{}} << converge\_step\_number << std::string(5, \textcolor{charliteral}{' '}) << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00278}00278          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00279}00279       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00280}00280       target\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00281}00281    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00282}00282    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00283}00283    \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00284}00284    \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00285}00285    std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of diagonalization:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00286}00286    std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error\_final << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00287}00287    std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00288}00288    \textcolor{keywordflow}{return} \{converge\_step\_number, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00289}00289    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00290}00290 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ab653e2e978de33c4cb8eaa35562e6fdd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086}\label{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!EigenvalueDecompositionLOBPCG@{EigenvalueDecompositionLOBPCG}}
\index{EigenvalueDecompositionLOBPCG@{EigenvalueDecompositionLOBPCG}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{EigenvalueDecompositionLOBPCG()}{EigenvalueDecompositionLOBPCG()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
std\+::pair$<$ int, double $>$ compnal\+::sparse\+\_\+matrix\+::\+Eigenvalue\+Decomposition\+LOBPCG (\begin{DoxyParamCaption}\item[{Real\+Type $\ast$}]{gs\+\_\+value\+\_\+out,  }\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{gs\+\_\+vector\+\_\+out,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}} \&}]{params = {\ttfamily \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos}{Parameters\+Lanczos}}()} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{eigendecomposition_8hpp_source_l00506}{506}} of file \mbox{\hyperlink{eigendecomposition_8hpp_source}{eigendecomposition.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00509}00509                                                                                                             \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00510}00510    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00511}00511    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00512}00512       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00513}00513       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00514}00514       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00515}00515       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00516}00516       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00517}00517    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00518}00518    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00519}00519    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00520}00520    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00521}00521    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00522}00522       *gs\_value\_out = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00523}00523       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_aea9a7595862adf9c7e98138aaf0806e1}{Clear}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00524}00524       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00525}00525       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00526}00526       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00527}00527    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00528}00528    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00529}00529    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} == 1) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00530}00530       *gs\_value\_out = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[0];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00531}00531       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00532}00532       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00533}00533       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00534}00534       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00535}00535       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00536}00536    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00537}00537    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00538}00538    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} <= 1000) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00539}00539       std::vector<RealType> temp\_gs\_vector\_out;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00540}00540       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{LapackDsyev}}(gs\_value\_out, \&temp\_gs\_vector\_out, matrix\_in);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00541}00541       gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(temp\_gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00542}00542       \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00543}00543       \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00544}00544       \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00545}00545    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00546}00546    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00547}00547    \textcolor{keyword}{const} std::int64\_t dim = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00548}00548    BraketVector<RealType> v0(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00549}00549    BraketVector<RealType> v1(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00550}00550    BraketVector<RealType> v2(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00551}00551    BraketVector<RealType> w0(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00552}00552    BraketVector<RealType> w1(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00553}00553    BraketVector<RealType> w2(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00554}00554    BraketVector<RealType> r (dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00555}00555    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00556}00556    std::vector<std::vector<RealType>> vectors\_work;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00557}00557 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00558}00558    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00559}00559 \textcolor{preprocessor}{\#ifdef \_OPENMP}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00560}00560       vectors\_work = std::vector<std::vector<RealType>>(omp\_get\_max\_threads(), std::vector<RealType>(dim));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00561}00561 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00562}00562    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00563}00563    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00564}00564    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a49d60a22784ad109c4f66d8548603de9}{flag\_use\_initial\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00565}00565       v0.Assign(*gs\_vector\_out);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00566}00566    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00567}00567    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00568}00568       std::uniform\_real\_distribution<RealType> uniform\_rand(-\/1, 1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00569}00569       std::mt19937 random\_number\_engine;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00570}00570       random\_number\_engine.seed(std::random\_device()());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00571}00571       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00572}00572          v0.val[i] = uniform\_rand(random\_number\_engine);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00573}00573       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00574}00574    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00575}00575    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00576}00576    v0.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00577}00577    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00578}00578    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00579}00579       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&w0, 1.0, matrix\_in, v0, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00580}00580    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00581}00581    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00582}00582       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&w0, 1.0, matrix\_in, v0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00583}00583    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00584}00584    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00585}00585    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_adc7f6d768228c64cbdb1d33b12c9de09}{max\_step}}; ++step) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00586}00586       RealType a0 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00587}00587       RealType a1 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00588}00588       RealType a2 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00589}00589       RealType a3 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00590}00590       RealType a4 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00591}00591       RealType a5 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00592}00592       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00593}00593       RealType b0 = 1.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00594}00594       RealType b1 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00595}00595       RealType b2 = 1.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00596}00596       RealType b3 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00597}00597       RealType b4 = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00598}00598       RealType b5 = 1.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00599}00599 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00600}00600 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: a0, a1, a2, a3, a4, a5, b1, b3, b4)}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00601}00601       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00602}00602          a0 += v0.val[i]*w0.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00603}00603          a1 += v0.val[i]*w1.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00604}00604          a2 += v1.val[i]*w1.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00605}00605          a3 += v0.val[i]*w2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00606}00606          a4 += v1.val[i]*w2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00607}00607          a5 += v2.val[i]*w2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00608}00608          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00609}00609          b1 += v0.val[i]*v1.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00610}00610          b3 += v0.val[i]*v2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00611}00611          b4 += v1.val[i]*v2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00612}00612       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00613}00613             }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00614}00614       std::vector<RealType> k\_e\_val(3);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00615}00615       std::vector<RealType> k\_e\_vec(9);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00616}00616       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00617}00617       \textcolor{keywordtype}{int} krylov\_dim = 3;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00618}00618       std::vector<RealType> mat\_a = \{a0, a1, a2, a3, a4, a5\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00619}00619       std::vector<RealType> mat\_b = \{b0, b1, b2, b3, b4, b5\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00620}00620 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00621}00621       \textcolor{keywordflow}{if} (step <= 1) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00622}00622          krylov\_dim = step + 1;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00623}00623       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00624}00624 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00625}00625       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78}{LapackDspgv}}(\&k\_e\_val, \&k\_e\_vec, 1, krylov\_dim, mat\_a, mat\_b);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00626}00626          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00627}00627       RealType residual\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00628}00628       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00629}00629 \textcolor{preprocessor}{\#pragma omp parallel for reduction (+: residual\_error)}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00630}00630       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00631}00631          r.val[i] = k\_e\_vec[0]*w0.val[i] + k\_e\_vec[1]*w1.val[i] + k\_e\_vec[2]*w2.val[i]}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00632}00632                   -\/ k\_e\_val[0]*(k\_e\_vec[0]*v0.val[i] + k\_e\_vec[1]*v1.val[i] + k\_e\_vec[2]*v2.val[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00633}00633          residual\_error += r.val[i]*r.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00634}00634       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00635}00635       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00636}00636       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ab5874cbc827cbeafcd626b43189e0e13}{flag\_output\_info}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00637}00637          std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rLOBPCG\_Step["{}} << step + 1 << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00638}00638          std::cout << residual\_error << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00639}00639       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00640}00640       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00641}00641       \textcolor{keywordflow}{if} (residual\_error < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_a4df305aa854596ff50f61b7d3c707830}{acc}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00642}00642          *gs\_value\_out = k\_e\_val[0];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00643}00643          gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.resize(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00644}00644          }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00645}00645 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00646}00646          \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00647}00647             gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[i] = k\_e\_vec[0]*w0.val[i] + k\_e\_vec[1]*w1.val[i] + k\_e\_vec[2]*w2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00648}00648          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00649}00649          gs\_vector\_out-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae74e77fff5c779f264238f0b4bf0bdb6}{Normalize}}();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00650}00650          \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00651}00651          \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00652}00652          std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of diagonalization:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00653}00653          std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00654}00654          std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00655}00655          \textcolor{keywordflow}{return} \{0, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00656}00656       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00657}00657 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00658}00658 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00659}00659       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00660}00660          v0.val[i] = k\_e\_vec[0]*v0.val[i] + k\_e\_vec[1]*v1.val[i] + k\_e\_vec[2]*v2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00661}00661          v2.val[i] = k\_e\_vec[1]*v1.val[i] + k\_e\_vec[2]*v2.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00662}00662          v1.val[i] = r.val[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00663}00663       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00664}00664       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00665}00665       RealType alpha = 1.0/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(v0, v0);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00666}00666       RealType beta  = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(v2, v2);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00667}00667             }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00668}00668       v0.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00669}00669       v1.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00670}00670       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00671}00671       \textcolor{keywordflow}{if} (beta > 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00672}00672          beta = 1.0/std::sqrt(beta);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00673}00673          v2.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00674}00674       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00675}00675       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00676}00676          beta = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00677}00677       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00678}00678       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00679}00679 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00680}00680       \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00681}00681          w0.val[i] = alpha*(k\_e\_vec[0]*w0.val[i] + k\_e\_vec[1]*w1.val[i] + k\_e\_vec[2]*w2.val[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00682}00682          w2.val[i] = beta*(k\_e\_vec[1]*w1.val[i] + k\_e\_vec[2]*w2.val[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00683}00683       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00684}00684       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00685}00685       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_lanczos_ade8e0723d977e210e29d498039a99675}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00686}00686          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&w1, 1.0, matrix\_in, v1, \&vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00687}00687       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00688}00688       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00689}00689          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&w1, 1.0, matrix\_in, v1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00690}00690       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00691}00691    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00692}00692    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00693}00693    std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00694}00694    ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00695}00695    ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00696}00696    \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00697}00697    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00698}00698 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a7fe5c3d33825a5f1d493f29c61f3c086_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61}\label{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!InverseIteration@{InverseIteration}}
\index{InverseIteration@{InverseIteration}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{InverseIteration()}{InverseIteration()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
std\+::pair$<$ int, double $>$ compnal\+::sparse\+\_\+matrix\+::\+Inverse\+Iteration (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ $\ast$}]{matrix\+\_\+in,  }\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{eigenvector,  }\item[{const Real\+Type}]{eigenvalue,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{Parameters\+II}} \&}]{params = {\ttfamily \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i}{Parameters\+II}}()},  }\item[{const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&}]{subspace\+\_\+vectors = {\ttfamily \{\}} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{inverse__iteration_8hpp_source_l00018}{18}} of file \mbox{\hyperlink{inverse__iteration_8hpp_source}{inverse\+\_\+iteration.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00022}00022                                                                                                     \{\}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00023}00023                                         ) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00024}00024    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00025}00025    \textcolor{keywordflow}{if} (matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00026}00026       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00027}00027       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00028}00028       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00029}00029       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00030}00030       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00031}00031    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00032}00032    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00033}00033    \textcolor{keyword}{const} \textcolor{keyword}{auto} start = std::chrono::system\_clock::now();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00034}00034    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00035}00035    BraketVector<RealType> improved\_eigenvector;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00036}00036    BraketVector<RealType> vectors\_work(matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00037}00037    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00038}00038    \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{cg}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_ab77ae3ceff61132bd26ae14cd43c5f44}{flag\_use\_initial\_vec}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00039}00039       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(eigenvector-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size()) != matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00040}00040          std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00041}00041          ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00042}00042          ss << \textcolor{stringliteral}{"{}The dimension of the initial vector is not equal to that of the input matrix."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00043}00043          \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00044}00044       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00045}00045       improved\_eigenvector = *eigenvector;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00046}00046    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00047}00047 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00048}00048    matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad64678d1387884cbf00aefd936ee3f36}{DiagonalScaling}}(params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a41b46226c3df3aaeb6c400a90a6b0c83}{diag\_add}} -\/ eigenvalue);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00049}00049    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00050}00050    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} step = 0; step < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a5d2bc4ffc7ce3c90b24acf47b0f164f8}{max\_step}}; ++step) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00051}00051       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{cg}}.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_c_g_aec5c0c297f1e3c670b03616e9ebbf544}{flag\_symmetric\_crs}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00052}00052          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a413b2336cf26abb302f7fd6f2ac5830c}{CalculateSymmetricMatrixVectorProduct}}(\&vectors\_work, 1.0, *matrix\_in, *eigenvector);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00053}00053       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00054}00054       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00055}00055          \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab4434cd1f0754845236fda113f33393b}{CalculateMatrixVectorProduct}}(\&vectors\_work, 1.0, *matrix\_in, *eigenvector);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00056}00056       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00057}00057       \textcolor{keyword}{const} RealType residual\_error = \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a1a9993418bced60b2ec89ed57b48c665}{CalculateL1Norm}}(params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a41b46226c3df3aaeb6c400a90a6b0c83}{diag\_add}}, *eigenvector, 1.0, vectors\_work);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00058}00058       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00059}00059       \textcolor{keywordflow}{if} (params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a8570010c2aa9695d6126827a945bee15}{flag\_output\_info}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00060}00060          std::cout << \textcolor{stringliteral}{"{}\(\backslash\)rII\_Step["{}} << step << \textcolor{stringliteral}{"{}]="{}} << std::scientific << std::setprecision(1);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00061}00061          std::cout << residual\_error << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00062}00062       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00063}00063       }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00064}00064       \textcolor{keywordflow}{if} (residual\_error < params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adc36eda90cdf668f8efa3ed2f9fb4afe}{acc}}) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00065}00065          matrix\_in-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad64678d1387884cbf00aefd936ee3f36}{DiagonalScaling}}(-\/(params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_a41b46226c3df3aaeb6c400a90a6b0c83}{diag\_add}} -\/ eigenvalue));}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00066}00066          \textcolor{keyword}{const} \textcolor{keyword}{auto}   time\_count = std::chrono::duration\_cast<std::chrono::microseconds>(std::chrono::system\_clock::now() -\/ start).count();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00067}00067          \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_sec   = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(time\_count)/\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}{TIME\_UNIT\_CONSTANT}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00068}00068          std::cout << std::defaultfloat << std::setprecision(8) << \textcolor{stringliteral}{"{}\(\backslash\)rElapsed time of inverse iteration:"{}} << time\_sec << \textcolor{stringliteral}{"{}[sec]"{}};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00069}00069          std::cout << \textcolor{stringliteral}{"{} ("{}} << residual\_error << \textcolor{stringliteral}{"{})"{}} << std::flush;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00070}00070          std::cout << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00071}00071          \textcolor{keywordflow}{return} \{step, time\_sec\};}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00072}00072       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00073}00073 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00074}00074       \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a5542adf7c191075452c4b94070fee14e}{ConjugateGradient}}(\&improved\_eigenvector, *matrix\_in, *eigenvector, params.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_parameters_i_i_adf10c5e3f66431f46c8ec57610c5b8f7}{cg}}, subspace\_vectors);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00075}00075       improved\_eigenvector.Normalize();}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00076}00076       eigenvector-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_afd6b6047b0a723c2b892c11a46b8947b}{Assign}}(improved\_eigenvector);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00077}00077    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00078}00078    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00079}00079    std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00080}00080    ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00081}00081    ss << \textcolor{stringliteral}{"{}Does not converge"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00082}00082    \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00083}00083    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00084}00084 \}}

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a6a27a252e65bad8f004467384383df61_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78}\label{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!LapackDspgv@{LapackDspgv}}
\index{LapackDspgv@{LapackDspgv}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{LapackDspgv()}{LapackDspgv()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Lapack\+Dspgv (\begin{DoxyParamCaption}\item[{std\+::vector$<$ Real\+Type $>$ $\ast$}]{eigenvalues,  }\item[{std\+::vector$<$ Real\+Type $>$ $\ast$}]{eigenvectors,  }\item[{const int}]{i\+\_\+type,  }\item[{const int}]{dim,  }\item[{const std\+::vector$<$ Real\+Type $>$ \&}]{mat\+\_\+a,  }\item[{const std\+::vector$<$ Real\+Type $>$ \&}]{mat\+\_\+b }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{lapack_8hpp_source_l00124}{124}} of file \mbox{\hyperlink{lapack_8hpp_source}{lapack.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00129}00129                                                    \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00130}00130    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00131}00131    \textcolor{keyword}{const} \textcolor{keywordtype}{int} size = dim*(dim + 1)/2;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00132}00132    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00133}00133    \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(mat\_a.size()) < size || \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(mat\_b.size()) < size) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00134}00134       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00135}00135       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00136}00136       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00137}00137    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00138}00138    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00139}00139    \textcolor{keywordtype}{double} lap\_ap[size];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00140}00140    \textcolor{keywordtype}{double} lap\_bp[size];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00141}00141    \textcolor{keywordtype}{double} lap\_w[dim];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00142}00142    \textcolor{keywordtype}{double} lap\_z[dim][dim];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00143}00143    \textcolor{keywordtype}{double} lap\_work[3*dim];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00144}00144    \textcolor{keywordtype}{int} lap\_ldz = dim;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00145}00145    \textcolor{keywordtype}{int} lap\_info;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00146}00146    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00147}00147    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00148}00148       lap\_ap[i] = mat\_a[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00149}00149       lap\_bp[i] = mat\_b[i];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00150}00150    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00151}00151    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00152}00152    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80}{dspgv\_}}(i\_type, \textcolor{charliteral}{'V'}, \textcolor{charliteral}{'U'}, dim, lap\_ap, lap\_bp, lap\_w, (\textcolor{keywordtype}{double}**)lap\_z, lap\_ldz, lap\_work, lap\_info);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00153}00153    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00154}00154    eigenvalues-\/>resize(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00155}00155    eigenvectors-\/>resize(dim*dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00156}00156    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00157}00157    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00158}00158       (*eigenvalues)[i] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(lap\_w[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00159}00159       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00160}00160          (*eigenvectors)[i*dim + j] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(lap\_z[i][j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00161}00161       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00162}00162    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00163}00163    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00164}00164 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}\label{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!LapackDstev@{LapackDstev}}
\index{LapackDstev@{LapackDstev}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{LapackDstev()}{LapackDstev()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Lapack\+Dstev (\begin{DoxyParamCaption}\item[{Real\+Type $\ast$}]{gs\+\_\+value,  }\item[{std\+::vector$<$ Real\+Type $>$ $\ast$}]{gs\+\_\+vector,  }\item[{const std\+::vector$<$ Real\+Type $>$ \&}]{diag,  }\item[{const std\+::vector$<$ Real\+Type $>$ \&}]{off\+\_\+diag }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{lapack_8hpp_source_l00084}{84}} of file \mbox{\hyperlink{lapack_8hpp_source}{lapack.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00087}00087                                                       \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00088}00088    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00089}00089    \textcolor{keywordflow}{if} (off\_diag.size() + 1 != diag.size()) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00090}00090       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00091}00091       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00092}00092       ss << \textcolor{stringliteral}{"{}diag size="{}} << diag.size() << \textcolor{stringliteral}{"{}, off\_diag size="{}} << off\_diag.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00093}00093       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00094}00094    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00095}00095    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00096}00096    \textcolor{keywordtype}{int} dim = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(diag.size());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00097}00097 }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00098}00098    \textcolor{keywordtype}{int} info;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00099}00099    \textcolor{keywordtype}{double} Lap\_D[dim];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00100}00100    \textcolor{keywordtype}{double} Lap\_E[dim -\/ 1];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00101}00101    \textcolor{keywordtype}{double} Lap\_Vec[dim][dim];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00102}00102    \textcolor{keywordtype}{double} Lap\_Work[2*dim];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00103}00103    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00104}00104    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim; i++) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00105}00105       Lap\_D[i] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(diag[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00106}00106    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00107}00107    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00108}00108    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim -\/ 1; i++) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00109}00109       Lap\_E[i] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(off\_diag[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00110}00110    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00111}00111    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00112}00112    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6}{dstev\_}}(\textcolor{charliteral}{'V'}, dim, Lap\_D, Lap\_E, (\textcolor{keywordtype}{double}**)Lap\_Vec, dim, Lap\_Work, info);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00113}00113    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00114}00114    gs\_vector-\/>resize(dim);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00115}00115    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00116}00116    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00117}00117       (*gs\_vector)[i] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(Lap\_Vec[0][i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00118}00118    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00119}00119    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00120}00120    *gs\_value = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(Lap\_D[0]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00121}00121 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}\label{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!LapackDsyev@{LapackDsyev}}
\index{LapackDsyev@{LapackDsyev}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{LapackDsyev()}{LapackDsyev()}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Lapack\+Dsyev (\begin{DoxyParamCaption}\item[{Real\+Type $\ast$}]{gs\+\_\+value,  }\item[{std\+::vector$<$ Real\+Type $>$ $\ast$}]{gs\+\_\+vector,  }\item[{const \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS}}$<$ Real\+Type $>$ \&}]{matrix\+\_\+in,  }\item[{const int}]{target\+\_\+level = {\ttfamily 0} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{lapack_8hpp_source_l00030}{30}} of file \mbox{\hyperlink{lapack_8hpp_source}{lapack.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00034}00034                    \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00035}00035    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00036}00036    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} || matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} < 1 || matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} < 1) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00037}00037       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00038}00038       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00039}00039       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00040}00040       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00041}00041       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00042}00042    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00043}00043    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00044}00044    \textcolor{keywordflow}{if} (target\_level < 0) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00045}00045       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00046}00046       ss << \textcolor{stringliteral}{"{}Invalid target\_level"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00047}00047       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00048}00048    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00049}00049    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00050}00050    \textcolor{keywordtype}{double} matrix\_array[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}][matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00051}00051    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00052}00052    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00053}00053       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00054}00054          matrix\_array[i][j] = 0.0;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00055}00055       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00056}00056    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00057}00057    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00058}00058    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00059}00059       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00060}00060          matrix\_array[i][matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00061}00061          matrix\_array[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]][i] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00062}00062       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00063}00063    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00064}00064    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00065}00065    \textcolor{keywordtype}{int} info;}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00066}00066    \textcolor{keywordtype}{double} val\_array[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00067}00067    \textcolor{keywordtype}{double} work[3 * matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00068}00068    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00069}00069    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e}{dsyev\_}}(\textcolor{charliteral}{'V'}, \textcolor{charliteral}{'L'}, \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}),}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00070}00070           (\textcolor{keywordtype}{double}**)matrix\_array,}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00071}00071           \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}), val\_array, work,}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00072}00072           \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(3 * matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}), info);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00073}00073    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00074}00074    gs\_vector-\/>resize(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00075}00075    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00076}00076    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00077}00077        (*gs\_vector)[i] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(matrix\_array[target\_level][i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00078}00078    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00079}00079    }
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00080}00080    *gs\_value = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(val\_array[target\_level]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00081}00081 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_acc7659e912249aaf5279eaa263311906}\label{namespacecompnal_1_1sparse__matrix_acc7659e912249aaf5279eaa263311906}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!Orthonormalize@{Orthonormalize}}
\index{Orthonormalize@{Orthonormalize}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{Orthonormalize()}{Orthonormalize()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Orthonormalize (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $\ast$}]{target\+\_\+vector,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ \&}]{vectors }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{orthonormalize_8hpp_source_l00032}{32}} of file \mbox{\hyperlink{orthonormalize_8hpp_source}{orthonormalize.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00032}00032                                                                                                              \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00033}00033    \textcolor{keyword}{const} int64\_t dim = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(target\_vector-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}.size());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00034}00034    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vectors.size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00035}00035       \textcolor{keyword}{const} RealType inner\_product = -\/1.0*\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(*target\_vector, vectors[i]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00036}00036 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00037}00037       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < dim; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00038}00038          target\_vector-\/>\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector_ae87a30e388c5e8cbc7617b72d21ee801}{val}}[j] += inner\_product*vectors[i].val[j];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00039}00039       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00040}00040    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00041}00041 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_acc7659e912249aaf5279eaa263311906_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}\label{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!Orthonormalize@{Orthonormalize}}
\index{Orthonormalize@{Orthonormalize}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{Orthonormalize()}{Orthonormalize()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Real\+Type $>$ \\
void compnal\+::sparse\+\_\+matrix\+::\+Orthonormalize (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_braket_vector}{Braket\+Vector}}$<$ Real\+Type $>$ $>$ $\ast$}]{vectors }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{orthonormalize_8hpp_source_l00018}{18}} of file \mbox{\hyperlink{orthonormalize_8hpp_source}{orthonormalize.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00018}00018                                                                 \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00019}00019    \textcolor{keywordflow}{for} (std::size\_t i = 0; i < vectors-\/>size(); ++i) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00020}00020       \textcolor{keyword}{const} int64\_t dim = \textcolor{keyword}{static\_cast<}std::int64\_t\textcolor{keyword}{>}(vectors[i]-\/>size());}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00021}00021       \textcolor{keywordflow}{for} (std::size\_t j = 0; j < i; ++j) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00022}00022          \textcolor{keyword}{const} RealType inner\_product = -\/1.0*\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ac72eb2d652259d294644b3b00745a9df}{CalculateInnerProduct}}(*vectors[i], (*vectors)[j]);}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00023}00023 \textcolor{preprocessor}{\#pragma omp parallel for}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00024}00024          \textcolor{keywordflow}{for} (std::int64\_t k = 0; k < dim; ++k) \{}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00025}00025             vectors[i]-\/>val[k] += inner\_product*vectors[j]-\/>val[k];}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00026}00026          \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00027}00027       \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00028}00028    \}}
\DoxyCodeLine{\Hypertarget{namespacecompnal_1_1sparse__matrix_l00029}00029 \}}

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecompnal_1_1sparse__matrix_ae8cf0493ba9137c8bfe9d1d192402440_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}\label{namespacecompnal_1_1sparse__matrix_abc3cda835ae580805bef02651b4a7fbd}} 
\index{compnal::sparse\_matrix@{compnal::sparse\_matrix}!TIME\_UNIT\_CONSTANT@{TIME\_UNIT\_CONSTANT}}
\index{TIME\_UNIT\_CONSTANT@{TIME\_UNIT\_CONSTANT}!compnal::sparse\_matrix@{compnal::sparse\_matrix}}
\doxysubsubsection{\texorpdfstring{TIME\_UNIT\_CONSTANT}{TIME\_UNIT\_CONSTANT}}
{\footnotesize\ttfamily const int compnal\+::sparse\+\_\+matrix\+::\+TIME\+\_\+\+UNIT\+\_\+\+CONSTANT = 1000$\ast$1000}



Definition at line \mbox{\hyperlink{eigendecomposition_8hpp_source_l00027}{27}} of file \mbox{\hyperlink{eigendecomposition_8hpp_source}{eigendecomposition.\+hpp}}.

