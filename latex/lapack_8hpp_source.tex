\hypertarget{lapack_8hpp_source}{}\doxysection{lapack.\+hpp}
\label{lapack_8hpp_source}\index{src/sparse\_matrix/lapack.hpp@{src/sparse\_matrix/lapack.hpp}}
\mbox{\hyperlink{lapack_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00002}00002 \textcolor{comment}{//  lapack.hpp}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00003}00003 \textcolor{comment}{//  compnal}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00005}00005 \textcolor{comment}{//  Created by Kohei Suzuki on 2021/05/22.}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00006}00006 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00008}00008 \textcolor{preprocessor}{\#ifndef COMPNAL\_SPARSE\_MATRIX\_LAPACK\_HPP\_}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00009}00009 \textcolor{preprocessor}{\#define COMPNAL\_SPARSE\_MATRIX\_LAPACK\_HPP\_}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00011}00011 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{compressed__row__storage_8hpp}{compressed\_row\_storage.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00012}00012 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00014}00014 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00015}00015 \textcolor{keyword}{namespace }sparse\_matrix \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00016}00016 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00017}00017 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00018}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e}{00018}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e}{dsyev\_}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} \&JOBZ, \textcolor{keyword}{const} \textcolor{keywordtype}{char} \&UPLO, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&N, \textcolor{keywordtype}{double} **A, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&LDA, \textcolor{keywordtype}{double} *W, \textcolor{keywordtype}{double} *work, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&Lwork, \textcolor{keywordtype}{int} \&INFO);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00019}00019 \};}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00021}00021 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00022}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6}{00022}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6}{dstev\_}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} \&JOBZ, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&N, \textcolor{keywordtype}{double} *D, \textcolor{keywordtype}{double} *E, \textcolor{keywordtype}{double} **Z,  \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&LDZ, \textcolor{keywordtype}{double} *WORK, \textcolor{keywordtype}{int} \&INFO);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00023}00023 \};}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00025}00025 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00026}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80}{00026}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80}{dspgv\_}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&ITYPE,\textcolor{keyword}{const} \textcolor{keywordtype}{char} \&JOBZ, \textcolor{keyword}{const} \textcolor{keywordtype}{char} \&UPLO, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&N, \textcolor{keywordtype}{double} *AP, \textcolor{keywordtype}{double} *BP, \textcolor{keywordtype}{double} *W, \textcolor{keywordtype}{double} **Z, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&LDZ, \textcolor{keywordtype}{double} *WORK, \textcolor{keywordtype}{int} \&INFO);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00027}00027 \};}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00029}00029 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00030}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{00030}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a7b228b82df60b48a8e1b225bf3ec3bf7}{LapackDsyev}}(RealType *gs\_value,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00031}00031                  std::vector<RealType> *gs\_vector,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00032}00032                  \textcolor{keyword}{const} \mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s}{CRS<RealType>}} \&matrix\_in,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00033}00033                  \textcolor{keyword}{const} \textcolor{keywordtype}{int} target\_level = 0}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00034}00034                  ) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00035}00035    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00036}00036    \textcolor{keywordflow}{if} (matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} != matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} || matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} < 1 || matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} < 1) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00037}00037       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00038}00038       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00039}00039       ss << \textcolor{stringliteral}{"{}The input matrix is not a square one"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00040}00040       ss << \textcolor{stringliteral}{"{}row="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}} << \textcolor{stringliteral}{"{}, col="{}} << matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}} << std::endl;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00041}00041       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00042}00042    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00043}00043    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00044}00044    \textcolor{keywordflow}{if} (target\_level < 0) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00045}00045       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00046}00046       ss << \textcolor{stringliteral}{"{}Invalid target\_level"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00047}00047       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00048}00048    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00049}00049    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00050}00050    \textcolor{keywordtype}{double} matrix\_array[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}][matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00051}00051    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00052}00052    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00053}00053       \textcolor{keywordflow}{for} (std::int64\_t j = 0; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_af44d3f5b32bfe8204854cf9bd70349ee}{col\_dim}}; ++j) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00054}00054          matrix\_array[i][j] = 0.0;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00055}00055       \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00056}00056    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00057}00057    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00058}00058    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00059}00059       \textcolor{keywordflow}{for} (std::int64\_t j = matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i]; j < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a7c3c574b5fe94de93551f90ae9017cf0}{row}}[i + 1]; ++j) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00060}00060          matrix\_array[i][matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00061}00061          matrix\_array[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_aa1ac4274734dffa2a97dd9b4a12f7302}{col}}[j]][i] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_ad7d38a64390cfa0a645d635d396660ed}{val}}[j]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00062}00062       \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00063}00063    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00064}00064    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00065}00065    \textcolor{keywordtype}{int} info;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00066}00066    \textcolor{keywordtype}{double} val\_array[matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00067}00067    \textcolor{keywordtype}{double} work[3 * matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00068}00068    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00069}00069    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_aa98cff75f30d8d55bba0810a75d6ee9e}{dsyev\_}}(\textcolor{charliteral}{'V'}, \textcolor{charliteral}{'L'}, \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}),}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00070}00070           (\textcolor{keywordtype}{double}**)matrix\_array,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00071}00071           \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}), val\_array, work,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00072}00072           \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(3 * matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}), info);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00073}00073    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00074}00074    gs\_vector-\/>resize(matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}});}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00075}00075    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00076}00076    \textcolor{keywordflow}{for} (std::int64\_t i = 0; i < matrix\_in.\mbox{\hyperlink{structcompnal_1_1sparse__matrix_1_1_c_r_s_a4fb8bf6ab46de248b22f7f56ce3298ba}{row\_dim}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00077}00077        (*gs\_vector)[i] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(matrix\_array[target\_level][i]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00078}00078    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00079}00079    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00080}00080    *gs\_value = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(val\_array[target\_level]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00081}00081 \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00082}00082 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00083}00083 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00084}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}{00084}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ae2d62a5674340dcaccc874b8a1acbc26}{LapackDstev}}(RealType *gs\_value,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00085}00085                  std::vector<RealType> *gs\_vector,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00086}00086                  \textcolor{keyword}{const} std::vector<RealType> \&diag,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00087}00087                  \textcolor{keyword}{const} std::vector<RealType> \&off\_diag) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00088}00088    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00089}00089    \textcolor{keywordflow}{if} (off\_diag.size() + 1 != diag.size()) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00090}00090       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00091}00091       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00092}00092       ss << \textcolor{stringliteral}{"{}diag size="{}} << diag.size() << \textcolor{stringliteral}{"{}, off\_diag size="{}} << off\_diag.size() << std::endl;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00093}00093       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00094}00094    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00095}00095    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00096}00096    \textcolor{keywordtype}{int} dim = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(diag.size());}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00098}00098    \textcolor{keywordtype}{int} info;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00099}00099    \textcolor{keywordtype}{double} Lap\_D[dim];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00100}00100    \textcolor{keywordtype}{double} Lap\_E[dim -\/ 1];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00101}00101    \textcolor{keywordtype}{double} Lap\_Vec[dim][dim];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00102}00102    \textcolor{keywordtype}{double} Lap\_Work[2*dim];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00103}00103    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00104}00104    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim; i++) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00105}00105       Lap\_D[i] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(diag[i]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00106}00106    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00107}00107    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00108}00108    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim -\/ 1; i++) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00109}00109       Lap\_E[i] = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(off\_diag[i]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00110}00110    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00111}00111    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00112}00112    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_ab84831e2c300392944998bd0b1839af6}{dstev\_}}(\textcolor{charliteral}{'V'}, dim, Lap\_D, Lap\_E, (\textcolor{keywordtype}{double}**)Lap\_Vec, dim, Lap\_Work, info);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00113}00113    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00114}00114    gs\_vector-\/>resize(dim);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00115}00115    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00116}00116    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00117}00117       (*gs\_vector)[i] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(Lap\_Vec[0][i]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00118}00118    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00119}00119    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00120}00120    *gs\_value = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(Lap\_D[0]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00121}00121 \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00122}00122 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00123}00123 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00124}\mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78}{00124}} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_a027e3543114e86368649fd738a2f9f78}{LapackDspgv}}(std::vector<RealType> *eigenvalues,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00125}00125                  std::vector<RealType> *eigenvectors,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00126}00126                  \textcolor{keyword}{const} \textcolor{keywordtype}{int} i\_type,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00127}00127                  \textcolor{keyword}{const} \textcolor{keywordtype}{int} dim,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00128}00128                  \textcolor{keyword}{const} std::vector<RealType> \&mat\_a,}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00129}00129                  \textcolor{keyword}{const} std::vector<RealType> \&mat\_b) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00130}00130    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00131}00131    \textcolor{keyword}{const} \textcolor{keywordtype}{int} size = dim*(dim + 1)/2;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00132}00132    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00133}00133    \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(mat\_a.size()) < size || \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(mat\_b.size()) < size) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00134}00134       std::stringstream ss;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00135}00135       ss << \textcolor{stringliteral}{"{}Error in "{}} << \_\_func\_\_ << std::endl;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00136}00136       \textcolor{keywordflow}{throw} std::runtime\_error(ss.str());}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00137}00137    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00138}00138    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00139}00139    \textcolor{keywordtype}{double} lap\_ap[size];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00140}00140    \textcolor{keywordtype}{double} lap\_bp[size];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00141}00141    \textcolor{keywordtype}{double} lap\_w[dim];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00142}00142    \textcolor{keywordtype}{double} lap\_z[dim][dim];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00143}00143    \textcolor{keywordtype}{double} lap\_work[3*dim];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00144}00144    \textcolor{keywordtype}{int} lap\_ldz = dim;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00145}00145    \textcolor{keywordtype}{int} lap\_info;}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00146}00146    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00147}00147    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00148}00148       lap\_ap[i] = mat\_a[i];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00149}00149       lap\_bp[i] = mat\_b[i];}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00150}00150    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00151}00151    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00152}00152    \mbox{\hyperlink{namespacecompnal_1_1sparse__matrix_af18011fe44d52340366af2428a8d9d80}{dspgv\_}}(i\_type, \textcolor{charliteral}{'V'}, \textcolor{charliteral}{'U'}, dim, lap\_ap, lap\_bp, lap\_w, (\textcolor{keywordtype}{double}**)lap\_z, lap\_ldz, lap\_work, lap\_info);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00153}00153    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00154}00154    eigenvalues-\/>resize(dim);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00155}00155    eigenvectors-\/>resize(dim*dim);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00156}00156    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00157}00157    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dim; ++i) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00158}00158       (*eigenvalues)[i] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(lap\_w[i]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00159}00159       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim; ++j) \{}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00160}00160          (*eigenvectors)[i*dim + j] = \textcolor{keyword}{static\_cast<}RealType\textcolor{keyword}{>}(lap\_z[i][j]);}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00161}00161       \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00162}00162    \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00163}00163    }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00164}00164 \}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00166}00166 \}  \textcolor{comment}{// namespace sparse\_matrix}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00167}00167 \}  \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00169}00169 }
\DoxyCodeLine{\Hypertarget{lapack_8hpp_source_l00170}00170 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SPARSE\_MATRIX\_LAPACK\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
